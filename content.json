{"pages":[{"title":"å°åŸå¸‚çš„ä¾¥å¹¸","text":"ğŸ“šCSDNğŸƒâ€GithubğŸ¤—æ—…æ¸¸ç”Ÿæ´»ã€å…¬ä¼—å·ï¼šå°åŸå¸‚çš„ä¾¥å¹¸ã€‘","link":"/about/index.html"}],"posts":[{"title":"Android 7.0 Notification Sound Issue","text":"å‰è¨€æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šè‡ªå®šä¹‰Notificationé€šçŸ¥å£°éŸ³(ä¸€ä¸ªå¤–éƒ¨å­˜å‚¨MP3æ–‡ä»¶)ï¼ŒAndroid7.0ç‰ˆæœ¬ä¸Šæ— æ³•æ­£å¸¸æ’­æ”¾ã€‚ åˆ†æ æŸ¥é˜…ä»£ç æ˜¯å¦æ­£å¸¸æ‰§è¡Œï¼ŒsetSoundæ˜¯å¦è®¾ç½®æœ‰æ•ˆUriæ­£å¸¸æ‰§è¡Œ,è®¾ç½®çš„Uriæœ‰æ•ˆ æŸ¥çœ‹Logå‘ç°æƒé™é—®é¢˜ç›¸å…³Log 1MediaPlayer: Couldn&apos;t open content://xxxxxxxx/new_order.mp3: java.lang.SecurityException: Permission Denial: opening provider android.support.v4.content.FileProvider from ProcessRecord{ce87f22 2005:com.android.systemui/u0a18} (pid=2005, uid=10018) that is not exported from uid 10257 ä¼ é€’å‚æ•°FileProvider Uriï¼Œcom.android.systemuiæ— è®¿é—®æƒé™ï¼Œå¯¼è‡´è®¾ç½®çš„MP3æ— æ³•æ’­æ”¾ adb shell dumpsys notificationæŸ¥çœ‹soundæ˜¯å¦ä¸ºè®¾ç½®çš„Urisoundä¸ºè®¾ç½®çš„Uriï¼Œæ­£å¸¸ è§£å†³åŠæ³•ä½¿ç”¨grantUriPermissions()12grantUriPermission(\"com.android.systemui\", sound, Intent.FLAG_GRANT_READ_URI_PERMISSION); (è¿™ä¸ªå…·ä½“æƒ…å†µå¯ä»¥æ ¹æ®ä¸Šé¢åˆ†æä¸­çš„Logç¡®å®šåŒ…å) ä½¿ç”¨android.resourceå‡è®¾ä½¿ç”¨rawèµ„æºä¿å­˜test.mp3æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ 1Uri uri = Uri.parse(\"android.resource://â€œ+ context.getPackageName() + R.id.test); 1Uri uri = Uri.parse(\"android.resource://â€œ+ context.getPackageName() + \"/raw/test.mp3\"); ç¦æ­¢ä¸¥æ ¼æ¨¡å¼&amp;ä¸ä½¿ç”¨FileProviderï¼ˆä¸æ¨èï¼‰1StrictMode.setVmPolicy(new StrictMode.VmPolicy.Builder().build()); æ€»ç»“ Android7.0 æ³¨æ„Uriæƒé™é—®é¢˜ Android8.0 æ³¨æ„setSoundåœ¨NotificationChannelå®Œæˆ å‚è€ƒ Notifications, Sounds, Android 7.0, and Aggravation Google Issue Tracker Stackoverflow Issue Google Fixed","link":"/2019/01/11/Android 7.0 Notification Sound Issue/"},{"title":"Android Device Monitorå¯åŠ¨æ’ä»¶","text":"å‰è¨€æœ€è¿‘ä½¿ç”¨Android Studio3.3è°ƒè¯•åº”ç”¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨Android Device Monitorï¼Œä½†æ˜¯ç•Œé¢ä¸Šæ‰¾ä¸åˆ°å…¥å£ï¼Œå°è±¡ä¸­ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯å­˜åœ¨çš„ã€‚ å®˜æ–¹è§£é‡Šï¼š Android Device Monitor was deprecated in Android Studio 3.1 and removed from Android Studio 3.2. The features that you could use through the Android Device Monitor have been replaced by new features. The table below helps you decide which features you should use instead of these deprecated and removed features. å®˜æ–¹å‡†å¤‡å¼ƒç”¨Android Device Monitor å¹¶æ¨èå¼€å‘è€…ä½¿ç”¨å¯¹åº”çš„æ–°ç‰¹æ€§ä½œä¸ºæ›¿ä»£å“ã€‚å…·ä½“æŸ¥é˜…[å®˜ç½‘]ã€‚(https://developer.android.google.cn/studio/profile/monitor) å¯¹äºä¹ æƒ¯ä½¿ç”¨Android Device Monitorçš„å¼€å‘è€…æ¥è¯´ï¼Œæ¯æ¬¡éƒ½éœ€è¦ç›®å½•ä¸‹è§¦å‘monitorå¾ˆä¸æ–¹ä¾¿ã€‚æ‰€ä»¥ï¼Œç”¨æœ€ç®€å•çš„æ–¹å¼å°†å…¶é›†æˆåˆ°Android Studioç•Œé¢ä¸Šæ˜¯ç›¸å¯¹ä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚ å‡†å¤‡ å¼€å‘ç¯å¢ƒï¼šintellij IDEA å¼€å‘æ‰‹å†Œï¼šintellij Official Docs å‚è€ƒé¡¹ç›®ï¼šIntelliJ-OnlineSearch, svgtoandroid éœ€æ±‚ æ»¡è¶³å·¥ä½œç¯å¢ƒ(Windows, Mac Pro) Android Studioä¸»ç•Œé¢å¯åŠ¨ å•æ¬¡é…ç½® æºä»£ç AndroidDeviceMonitorPlugin plugin.xml å¦‚æœä¸æ¸…æ¥šèœå•åˆ†ç»„åˆ†ç±»ï¼Œå¯ä»¥å»Android Studio ä¸»å·¥å…·èœå•ç©ºç™½å¤„å³é”®æŸ¥é˜… ç‚¹å‡»â€œCustomize Menus And Toolbarsâ€ï¼Œå¾—è§ä¸‹æ–¹å†…å®¹ SettingsConfigurable LaunchMonitorAction æ€»ç»“ ç¬¬ä¸€æ¬¡å¼€å‘Intellij Pluginï¼šJavaç•Œé¢å¼€å‘æ—©å·²å¿˜å´ å•çº¯å®ç°åŠŸèƒ½ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯æ’ä»¶å¼€å‘é‡Œåº”è¯¥æœ‰å¾ˆå¤šé—¨é“ å¤šçœ‹å®˜æ–‡å’ŒæˆåŠŸæ¡ˆä¾‹","link":"/2019/03/16/Android Device Monitorå¯åŠ¨æ’ä»¶/"},{"title":"Android Studio å°æŠ€å·§ï¼ˆ1ï¼‰ï¼šå¦‚ä½•å¯¼å…¥AARæ–‡ä»¶","text":"å¯¼å…¥AARã€JARæ–‡ä»¶ File- &gt; New -&gt; New Module ç„¶ååœ¨appä¸­çš„build.gradleä¸­åšå¦‚ä¸‹æ·»åŠ  dependencies { â€¦â€¦ compile project(â€˜:MODULE-NAMEâ€™) } ä¾‹å¦‚ dependencies { â€¦â€¦ compile project(â€˜:circleimageview-2.0.0â€™) } ä¹Ÿå¯ä»¥ç›´æ¥åœ¨appçš„ä¾èµ–é€‰é¡¹ä¸­ç›´æ¥é€‰æ‹©æœ€åä¸€ä¸ªâ€œModule dependencyâ€,ç„¶åæ·»åŠ å¯¹åº”çš„MODULEå³å¯ jaråŒ…ä¹Ÿå¯ä»¥é‡‡ç”¨è¿™ç§æ–¹å¼å¯¼å…¥,ä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼ æ–¹å¼ ä½¿ç”¨ Library dependency å¯ä»¥é€‰æ‹©ä¸€äº›å¯ç”¨çš„androidåŸç”Ÿä¾èµ–åŒ… File dependency å¯ä»¥é€‰æ‹©ä¸€äº›æ–‡ä»¶å½¢å¼çš„ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ç¬¬ä¸‰JaråŒ…ç­‰ Module dependency å½“å‰å·¥ç¨‹ä¸‹çš„æ¨¡å—ä¾èµ– å¿«é€Ÿæ·»åŠ Material Design Drawableres/drawable å³é”® New-&gt; Vector Asset æˆ–è€…Image Asset åŒæ ·çš„æ–¹å¼ä½¿ç”¨Image Assetç•Œé¢å¤§åŒå°å¼‚ã€‚","link":"/2016/06/24/Android Studio å°æŠ€å·§ï¼ˆ1ï¼‰ï¼šå¦‚ä½•å¯¼å…¥AARæ–‡ä»¶/"},{"title":"Android Studio å°æŠ€å·§ï¼ˆ2ï¼‰ï¼šASä¸­Buttonæ–‡å­—é»˜è®¤å¤§å†™çš„é—®é¢˜","text":"é—®é¢˜ç±»å‹Layoutä¸­æ·»åŠ ä¸€ä¸ªButton 12345&lt;Button android:id=\"@+id/bt_showerror\" android:layout_width=\"200dp\" android:layout_height=\"wrap_content\" android:text=\"ShowError\"/&gt; é¢„è§ˆç•Œé¢å’ŒçœŸæœºè¿è¡Œå´æ˜¾ç¤ºï¼š ä¸ç›´æ¥è®¾ç½®çš„å­—ç¬¦ä¸²çš„æ˜¾ç¤ºä¸ä¸€æ ·ï¼Œæ˜¾ç¤ºçš„æ–‡å­—éƒ½æ˜¾ç¤ºäº†å¤§å†™ã€‚ åŸå› æ¢ç´¢ ASä¸­é’ˆå¯¹Activityä¸­è®¾ç½® android:theme=â€@style/AppThemeâ€ è€Œ è€ŒAppThemeçš„çˆ¶ä¸»é¢˜æ˜¯Theme.AppCompat.Light.DarkActionBarï¼Œä¸€ç›´è¿½æº¯ï¼Œè¿½æº¯çš„è¿‡ç¨‹ä¸­å…³æ³¨ä¸€ä¸ªå±æ€§å€¼ï¼š android:textAllCaps æœ€åå¯ä»¥æ‰¾åˆ°ä¸»é¢˜ä¸­å·²ç»å°†è¿™ä¸ªå±æ€§è®¾ç½®ä¸ºtrueï¼Œå¯¼è‡´æœ€åå‡ºç°äº†ä½ çœ‹åˆ°çš„ç°è±¡ã€‚ è§£å†³åŠæ³• é»˜è®¤çš„SDKä¸­çš„è®¾ç½®å±æ€§æ˜¯æ— æ³•æ”¹å˜çš„ï¼Œé™¤éä½ é‡æ–°ç¼–è¯‘å¯¹åº”çš„frameworkä»£ç ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å¯¹åº”çš„Buttonä¸­è®¾ç½®å±æ€§ï¼š android:textAllCaps=â€falseâ€ è¿™æ ·å­—ä½“çš„å¤§å°å†™å°±æ­£å¸¸äº† 123456&lt;Button android:id=\"@+id/bt_showerror\" android:layout_width=\"200dp\" android:layout_height=\"wrap_content\" android:text=\"ShowError\" android:textAllCaps=\"false\" /&gt;","link":"/2016/07/03/Android Studio å°æŠ€å·§ï¼ˆ2ï¼‰ï¼šASä¸­Buttonæ–‡å­—é»˜è®¤å¤§å†™çš„é—®é¢˜/"},{"title":"Android æŠ•å°„å·¥å…·å’Œå½•å±å·¥å…·","text":"å‰è¨€å†™åšå®¢ï¼Œéš¾å…éœ€è¦ä¸Šä¼ æ‰‹æœºæˆªå›¾æˆ–è€…æ˜¯Gifæ–‡ä»¶ï¼Œåˆ†äº«ä¸¤ä¸ªå¸¸ç”¨çš„å·¥å…· GifCamGifCam,ä¸€ä¸ªç®€å•çš„ å±å¹•å½•åˆ¶å·¥å…·ï¼Œå¯ä»¥å®ç°Gifçš„å½•åˆ¶ç¼–è¾‘å’Œä¿å­˜ Total ControlTotal Controlï¼Œ æ˜¯ä¸€ä¸ªç®€å•çš„æ‰‹æœºå±å¹•å…±äº«åˆ°PCçš„å·¥å…·ï¼Œç›´æ¥åœ¨PCä¸Šå®‰è£…å®¢æˆ·ç«¯ï¼Œç„¶åè¿æ¥æ‰‹æœºï¼Œä¼šè‡ªåŠ¨å®‰è£…ä¸€ä¸ªapkã€‚è¿™ä¸ªå·¥å…·åšå‡ºçš„ä¸æ˜¯ç®€å•çš„æŠ•å°„ï¼Œé€šè¿‡PCæ“ä½œï¼Œç‚¹å‡»æ‰‹æœºå±å¹•å¯ä»¥å®ç°å¯¹åº”çš„æ“ä½œã€‚ LICEcapMacç³»ç»Ÿä¸­GifCamçš„æ›¿ä»£å“","link":"/2016/11/14/Android æŠ•å°„å·¥å…·å’Œå½•å±å·¥å…·/"},{"title":"CentOS + Docker + Gitlab-ce","text":"Dockerå®‰è£…ä¸å¯åŠ¨æœç´¢1yum search docker å®‰è£…1yum install docker å¯åŠ¨1systemctl start docker å¼€æœºè‡ªå¯åŠ¨1systemctl enable docker.service æŸ¥çœ‹çŠ¶æ€1systemctl status docker æŸ¥çœ‹ç‰ˆæœ¬12docker versiondocker -v æŸ¥çœ‹ä¿¡æ¯1docker info é•œåƒæ‰“åŒ…å’Œå¯¼å…¥12//å°†åä¸ºgitlab/gitlab-ceçš„imageæ‰“åŒ…æˆgitlab.tardocker save -o gitlab.tar gitlab/gitlab-ce 12//å¯¼å…¥imagedocker load -i gitlab.tar Gitlab-ceå®‰è£…æœç´¢1docker search gitlab-ce ä¸‹è½½ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘éƒ½æ˜¯ä½¿ç”¨å®˜æ–¹é•œåƒæˆ–è€…é˜¿é‡Œé•œåƒ 1docker pull gitlab/gitlab-ce å®‰è£…123456789sudo docker run -i \\ --hostname centos \\ --publish 443:443 --publish 80:80 --publish 22:22 \\ --name gitlab \\ --restart always \\ --volume /srv/gitlab/config:/etc/gitlab \\ --volume /srv/gitlab/logs:/var/log/gitlab \\ --volume /srv/gitlab/data:/var/opt/gitlab \\ docker.io/gitlab/gitlab-ce /srvç›®å½•ä¸‹è‹¥æ²¡æœ‰å¯¹åº”æ–‡ä»¶å¤¹ï¼Œå¯è‡ªè¡Œåˆ›å»ºï¼Œä¹Ÿå¯ä¿®æ”¹æˆå…¶ä»–æ–‡ä»¶è·¯å¾„ ä½¿ç”¨è¿›å…¥Gitlab Dockerç¯å¢ƒ1docker exec -it gitlab /bin/bash å…¨å±€é…ç½®æ–‡ä»¶ä¿®æ”¹ä¸‹è½½åœ°å€ä¸­çš„æ˜¾ç¤ºIPä¹Ÿåœ¨æ­¤ä¿®æ”¹ 1/etc/gitlab/gitlab.rb sshç«¯å£ä¿®æ”¹åå¤„ç†1234567docker exec -it gitlab /bin/bashvi /etc/gitlab/gitlab.rb#ä¿®æ”¹sshå¯¹åº”hoståœ°å€gitlab_rails['gitlab_ssh_host'] = 'xxx.xxx.xxx.xxx'#ä¿®æ”¹sshæ˜ å°„ç«¯å£gitlab_rails['gitlab_shell_ssh_port'] = 23 æ³¨æ„æ‰“å¼€æœåŠ¡å™¨ä¸Šå¯¹åº”çš„ç«¯å£ å®šæ—¶å¤‡ä»½ä»¥åŠè‡ªåŠ¨ä¸Šä¼ ftpæœåŠ¡å™¨ç¼–è¾‘å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨ä¸¤ç‚¹å¤‡ä»½ï¼Œä¸‰ç‚¹ä¸Šä¼ ã€‚ä¸‹é¢shæ–‡ä»¶æ˜¯è‡ªç¼–çš„ä¸€ä¸ªftpä¸Šä¼ è„šæœ¬ï¼‰ 1234vi /var/spool/cron/root 0 2 * * * docker exec -t gitlab gitlab-rake gitlab:backup:create CRON=1 0 3 * * * /root/BKConfig/upload_bk.sh è„šæœ¬å†…å®¹ 1234567891011#!/bin/bashftp -n&lt;&lt;!open &lt;ftpæœåŠ¡å™¨åœ°å€&gt;user &lt;username&gt; &lt;password&gt;binarylcd &lt;å¾…ä¸Šä¼ çš„æ–‡ä»¶å¤¹è·¯å¾„&gt;promptmput *closebye! é˜¿é‡Œäº‘åŠ é€Ÿå™¨å¯»æ‰¾å±äºä½ çš„åŠ é€Ÿå™¨é˜¿é‡Œäº‘å®˜ç½‘ï¼Œç™»é™†ä»¥åï¼Œæ‰¾åˆ°â€œå¼¹æ€§è®¡ç®—â€œä¸‹çš„â€œå®¹å™¨é•œåƒæœåŠ¡â€œï¼Œç„¶åä½ å°±å¯ä»¥çœ‹åˆ°å±äºä½ è‡ªå·±çš„â€œé•œåƒåŠ é€Ÿå™¨â€œ æœåŠ¡å™¨Dockeré•œåƒé…ç½®/etc/docker/daemon.json 123{ \"registry-mirrors\": [\"&lt;your accelerate address&gt;\"]} æ›¿æ¢æˆä½ è‡ªå·±çš„åŠ é€Ÿå™¨åœ°å€å³å¯ã€‚ é…ç½®å®Œæˆåé‡å¯Dockerdocker overlay2 ç©ºé—´å æ»¡100%æ—¶ï¼Œå¤„ç†æ–¹æ³•åŸæ–‡: https://unix.stackexchange.com/questions/414483/docker-increase-available-disk-spaceè·Ÿæ¢overlay2ç›®å½•åœ°å€ï¼šYou could move the docker directory to somewhere under /home and create a symlink /var/lib/docker pointing to the new location. For example: shut down docker first mv /var/lib/docker /home/ ln -s /home/docker/ /var/lib/ restart docker now Use another directory if /home/docker already exists. Instead of, or as well as, the symlink from /var/lib/docker -&gt; /home/docker, you could also reconfigure docker so that it expects to find its directory under /home rather than /var/lib.","link":"/2018/04/21/CentOS + Docker + Gitlab-ce/"},{"title":"Androidå¼€å‘é—®é¢˜ç§¯ç´¯","text":"åœ¨çº¿GifåŠ è½½è§£å†³åŠæ³•Glideå®Œç¾è§£å†³ 1Glide.with(context).load(pic).placeholder(R.drawable.loading).into(imageView); pic: urlåœ°å€ R.drawable.loading: gifåŠ è½½ä¹‹å‰å›¾ç‰‡ imageViewï¼šç›®æ ‡imageview Intentè°ƒç”¨å›¾åº“ä½¿ç”¨Lç‰ˆæœ¬æ‰‹æœºçš„æ—¶å€™ï¼Œé€šè¿‡Intentè°ƒç”¨å›¾åº“ï¼Œé€‰æ‹©å›¾ç‰‡åå‡ºç°â€ä¸æ”¯æŒçš„åª’ä½“ç±»å‹â€æˆ–è€…æ˜¯â€Failed to read row 0, column 6 from a CursorWindow which has 1 rows, 6 columnsâ€ã€‚ç”±äºå¯¹æ•°æ®åº“è¿™ä¸€æ¬¾ç–äºäº†è§£ï¼Œä¸èƒ½å¾ˆå¿«çš„å®šä½å‡ºè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæƒ³åˆ°çš„åŠæ³•å°±æ˜¯å°†å‡ºé—®é¢˜çš„æ–‡ä»¶ä¸è¦æš´éœ²åœ¨ç”¨æˆ·çœ¼å‰ã€‚ è§£å†³åŠæ³•12345678910Intent intent = null;if (Build.VERSION.SDK_INT &lt; 19){ intent = new Intent(Intent.ACTION_GET_CONTENT); intent.setType(\"image/*\");}else{ intent = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);} ä¸åŒçš„Androidç‰ˆæœ¬ï¼Œé€‰æ‹©ç³»ç»Ÿå›¾åº“ä¸­å›¾ç‰‡çš„æ–¹å¼æœ‰ç‚¹å·®åˆ«ï¼Œè¿™ä¸ªæ˜¯éœ€è¦æ³¨æ„çš„ï¼ŒGoogleä¸æ–­æ›´æ–°APIè‚¯å®šæ˜¯æœ‰åŸå› çš„ï¼Œæ‰€ä»¥ï¼ŒAndroidç‰ˆæœ¬çš„å…¼å®¹æ€§é—®é¢˜æ˜¯è¿­ä»£å¼€å‘å’Œç»´æŠ¤å·¥ä½œä¸­ä¸å¯é¿å…çš„ã€‚å•çœ‹ä»£ç æ˜¯æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å½“å¼€å‘è€…ä¸çŸ¥é“çš„æ—¶å€™ï¼Œè¿™ä¸ªé—®é¢˜å¯èƒ½å°±ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´ã€‚ AlertDialogè·å–PositionButtonï¼ŒNeturalButton å’Œ NegativeButtonï¼Œä¸€å®šè¦å…ˆè°ƒç”¨show()æ–¹æ³•è§£å†³åŠæ³•1234dialog.show();//æ³¨æ„ å¿…é¡»å…ˆè°ƒç”¨è¿™ä¸ªï¼Œå¦åˆ™ä¸‹é¢ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸if(xxxxx) { dialog.getButton(DialogInterface.BUTTON_NEGATIVE).setVisibility(GONE);} else { dialog.getButton(DialogInterface.BUTTON_NEGATIVE).setVisibility(VISIBLE);} Lç‰ˆæœ¬ä¸ŠToastæ— æ³•æ˜¾ç¤ºè§£å†³åŠæ³• Lç‰ˆæœ¬ä¸Šé€šçŸ¥ç®¡ç†ä¸­ï¼Œå…³é—­äº†å¯¹åº”åº”ç”¨çš„é€šçŸ¥æƒé™ï¼Œå»â€œè®¾ç½®â€-&gt; â€œé€šçŸ¥ç®¡ç†â€ä¸­æ‰“å¼€å³å¯ é¿å…å› ä¸ºæƒé™é—®é¢˜å¯¼è‡´Toastæ— æ³•æ˜¾ç¤ºï¼Œå¯ä»¥å°è¯•è‡ªå®šä¹‰å®Œæˆç±»ä¼¼Toastçš„åŠŸèƒ½ TextViewèµ°é©¬ç¯è§£å†³åŠæ³•123456789TextView tv = new TextView(activity);tv.setText(\"XXXXXXXXXXXX\");tv.setSingleLine(true);tv.setEllipsize(TextUtils.TruncateAt.MARQUEE);tv.setMarqueeRepeatLimit(-1);tv.setFocusable(true);tv.setFocusableInTouchMode(true);tv.setHorizontallyScrolling(true);tv.requestFocus(); ä½¿ç”¨ç³»ç»ŸACTION_SEND å‘é€æ–‡å­—æˆ–è€…å›¾ç‰‡è§£å†³åŠæ³•å‘é€æ–‡å­— 123456String message = \"This is a sharing Text\";Intent shareIntent = new Intent();shareIntent.setAction(Intent.ACTION_SEND);shareIntent.setType(\"text/plain\");shareIntent.putExtra(Intent.EXTRA_TEXT, message);this.startActivity(shareIntent); å‘é€å›¾ç‰‡ 123456789/* localqrcodeæ˜¯ä¸€ä¸ªbitmapå¯¹è±¡*/String pathofBmp = Images.Media.insertImage( activity.getContentResolver(), localqrcode, \"title\", null);Uri bmpUri = Uri.parse(pathofBmp);//è·å–æœ¬åœ°UriIntent intent= new Intent( android.content.Intent.ACTION_SEND); intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); intent.putExtra(Intent.EXTRA_STREAM, bmpUri);//æµç±»å‹intent.setType(\"image/png\");activity.startActivity(intent.createChooser(intent, \"é€‰æ‹©\")); è°ƒç”¨ç³»ç»Ÿèµ„æºè§£å†³åŠæ³•12345678910/*è·å–å¯¼èˆªæ é«˜åº¦ */private int getNavigationBarHeight() { boolean hasNavigationBar = getResources().getBoolean(Resources.getSystem().getIdentifier(\"config_showNavigationBar\", \"bool\", \"android\")); if(hasNavigationBar) { return getResources().getDimensionPixelSize(Resources.getSystem().getIdentifier(\"navigation_bar_height\", \"dimen\",\"android\")); } return 0;} é€šè¿‡Resources.getSystem().getIdentifier(â€œconfig_showNavigationBarâ€, â€œboolâ€, â€œandroidâ€));è¿™ç±»æ–¹å¼è·å–IDï¼Œç„¶åé€šè¿‡æ­£å¸¸çš„èµ„æºä½¿ç”¨æ–¹å¼ä½¿ç”¨å³å¯ Okhttpå¼‚å¸¸ Okhttpå¼‚å¸¸ï¼š System.err: java.lang.IllegalStateException: closed System.err: at okio.RealBufferedSource.rangeEquals(RealBufferedSourc System.err: at okio.RealBufferedSource.rangeEquals(RealBufferedSourc System.err: at okhttp3.internal.Util.bomAwareCharset(Util.java:397) System.err: at okhttp3.ResponseBody.string(ResponseBody.java:173) è§£å†³åŠæ³•Response response = okHttpClient.newCall(request).execute();è¿™é‡Œè¿”å›çš„responseä¸€èˆ¬æˆ‘ä»¬åé¢å°±ä¼šæ‰§è¡Œresponse.body().string()ï¼Œä½†æ˜¯å¦‚æœè¿ç»­è°ƒç”¨ä¸¤æ¬¡response.body().string()ï¼Œå°±ä¼šå‡ºç°å¦‚ä¸Šçš„é”™è¯¯ actionBar.setDisplayHomeAsUpEnabled(true);åå¦‚ä½•ä¿®æ”¹è¿”å›å›¾æ ‡è§£å†³åŠæ³•actionBar.setHomeAsUpIndicator(R.drawable.__picker_back); toolbarä¸Šmenuçš„æ ‡é¢˜å­—ä½“é¢œè‰²å¦‚ä½•ä¿®æ”¹è§£å†³åŠæ³•style.xmlæ–‡ä»¶ä¸­æ·»åŠ  &lt;item name=&quot;actionMenuTextColor&quot;&gt;#ffffff&lt;/item&gt; WebViewæ— æ³•æ˜¾ç¤ºå›¾ç‰‡è§£å†³åŠæ³•1234webView.getSettings().setBlockNetworkImage(false); if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) { webView.getSettings().setMixedContentMode(WebSettings.MIXED_CONTENT_ALWAYS_ALLOW); } Unable to execute dex: method ID not in [0, 0xffff]: 65536è§£å†³åŠæ³• Eclipse: dex.force.jumbo=true Android Studio : multiDexEnabled true è‡ªå®šä¹‰Dialogå¤§å°è§£å†³åŠæ³•123456Window dialogWindow = dialog.getWindow();DensityUtil du = new DensityUtil(mContext);WindowManager.LayoutParams p = dialogWindow.getAttributes(); // è·å–å¯¹è¯æ¡†å½“å‰çš„å‚æ•°å€¼p.height = (int) (du.getHeight() * 0.5); // é«˜åº¦è®¾ç½®ä¸ºå±å¹•çš„0.6ï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´p.width = (int) (du.getWidth() * 0.8); // å®½åº¦è®¾ç½®ä¸ºå±å¹•çš„0.65ï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´dialogWindow.setAttributes(p); Eclipse Conversion to Dalvik format failed with error 1å¯¹æˆ‘æœ‰æ•ˆçš„è§£å†³åŠæ³•è¿™ä¸ªé—®é¢˜çš„åŸå› æ¯”è¾ƒå¤šï¼Œç½‘ä¸Šæœ‰çš„äººè¯´é‡å¯ä¸€ä¸‹Eclipseå°±å¥½äº†ï¼Œæ¢ä¸€ä¸ªå·¥ä½œç©ºé—´å°±å¥½äº†ã€‚æˆ‘å°è¯•äº†éƒ½ä¸è¡Œï¼Œæˆ–è®¸åªæ˜¯å¯¹æˆ‘ä¸è¡Œã€‚ä¸‹é¢æ˜¯å¯¹æˆ‘æœ‰æ•ˆçš„åŠæ³•ï¼š å…³é—­è‡ªåŠ¨Buildï¼šProject-&gt;Build Automatically cleané¡¹ç›®ï¼šProject-&gt;Clean æ‰‹åŠ¨Buildï¼Œå³é”®ç‚¹å‡»é¡¹ç›®ï¼Œç„¶åï¼šBuild Project ç„¶åå†Exporté¡¹ç›®ï¼ŒæŠ¥é”™æ¶ˆå¤±äº†ï¼","link":"/2016/10/31/Androidå¼€å‘é—®é¢˜ç§¯ç´¯/"},{"title":"CentOS + Docker + MySql","text":"Dockerå®‰è£…ä¸å¯åŠ¨æœç´¢1yum search docker å®‰è£…1yum install docker å¯åŠ¨1systemctl start docker æŸ¥çœ‹çŠ¶æ€1systemctl status docker æŸ¥çœ‹ç‰ˆæœ¬12docker versiondocker -v æŸ¥çœ‹ä¿¡æ¯1docker info Mysqlå®‰è£…æœç´¢1docker search mysql ä¸‹è½½ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘éƒ½æ˜¯ä½¿ç”¨å®˜æ–¹é•œåƒæˆ–è€…é˜¿é‡Œé•œåƒ 1docker pull mysql è¿è¡Œ1docker run --name onlyloveyd-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -p 3306:3306 -d mysql:latest â€“name æŒ‡å®šæ•°æ®åº“åç§° ï¼e MYSQL_ROOT_PASSWORD=my-secret-pw é…ç½®rootè´¦å·å¯†ç  ï¼p æŒ‡å®šç«¯å£æ˜ å°„ ï¼d æŒ‡å®šé•œåƒ æŸ¥çœ‹è¿è¡ŒçŠ¶æ€1docker ps -a ä½¿ç”¨è¿›å…¥Mysql Dockerç¯å¢ƒ1docker exec -it onlyloveyd-mysql /bin/bash onlyloveyd-mysql æ›¿æ¢æˆ å¯¹åº”å®¹å™¨å è¿›å…¥mysql1mysql -u root -p è¾“å…¥å¯†ç åè¿›å…¥mysql é…ç½®å…è®¸Mysqlè¿œç¨‹è¿æ¥ä½¿ç”¨mysqlå‘½ä»¤çš„æ—¶å€™æ³¨æ„ä»¥åˆ†å·ç»“å°¾ã€‚ 123use mysql;select host,user,authentication_string from user;update user set host = '%' where user = 'root'; å­˜åœ¨hostä¸ºâ€˜ï¼…â€˜ï¼Œuserä¸ºâ€˜rootâ€˜çš„è®°å½•å°±ä»£è¡¨ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•ä¸€å°æœºå™¨ä¸Šä½¿ç”¨rootè´¦å·ç™»é™†ã€‚","link":"/2018/04/21/CentOS + Docker + MySql/"},{"title":"AngularJSåŸºç¡€ï¼šå¼€å‘ç¯å¢ƒå‡†å¤‡","text":"Sublime Text 3æ³¨å†Œç  â€”â€“ BEGIN LICENSE â€”â€“ TwitterInc 200 User License EA7E-890007 1D77F72E 390CDD93 4DCBA022 FAF60790 61AA12C0 A37081C5 D0316412 4584D136 94D7F7D4 95BC8C1C 527DA828 560BB037 D1EDDD8C AE7B379F 50C9D69D B35179EF 2FE898C4 8E4277A8 555CE714 E1FB0E43 D5D52613 C3D12E98 BC49967F 7652EED2 9D2D2E61 67610860 6D338B72 5CF95C69 E36B85CC 84991F19 7575D828 470A92AB â€”â€” END LICENSE â€”â€” å®‰è£…AngularJSæç¤ºæ’ä»¶å®‰è£…Package Control ä½¿ç”¨Ctrl+`å¿«æ·é”®æˆ–è€…é€šè¿‡View-&gt;Show Consoleèœå•æ‰“å¼€å‘½ä»¤è¡Œï¼Œç²˜è´´å¦‚ä¸‹ä»£ç  1import urllib.request,os; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), 'wb').write(urllib.request.urlopen( 'http://sublime.wbond.net/' + pf.replace(' ','%20')).read()) ç‚¹å‡»Preferences -&gt; Package Controlèœå•ï¼Œé€‰æ‹©installã€‚è¾“å…¥AngularJSå³å¯å®‰è£…æ’ä»¶ Node.jså®‰è£…Angular CLI å®‰è£…1npm install -g @angular/cli åˆ›å»ºé¡¹ç›®åˆ›å»ºæ–°é¡¹ç›® 1ng new my-app å¯åŠ¨é¡¹ç›® 12cd my-appng serve --open ç¼–è¾‘é¡¹ç›®","link":"/2018/01/22/AngularJSå°ç™½ï¼ˆ1ï¼‰ï¼šå¼€å‘ç¯å¢ƒå‡†å¤‡/"},{"title":"CentOS + Tomcat + SSL","text":"å‰è¨€ æœ€è¿‘iOSå¼€å‘ä¼ä¸šåº”ç”¨éœ€è¦ä½¿ç”¨HTTPSåè®®çš„åœ°å€æ¥åšåº”ç”¨å‡çº§ï¼Œæ‰€ä»¥éœ€è¦æ­å»ºä¸€ä¸ªæ”¯æŒHTTPSçš„Tomcat ä¸‹è½½Tomcat1wget http://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-7/v7.0.86/bin/apache-tomcat-7.0.86.tar.gz é…ç½®SSLè¯ä¹¦ä¸‹è½½SSLè¯ä¹¦æ–‡ä»¶è…¾è®¯äº‘ä¸Šç”³è¯·å…è´¹SSLè¯ä¹¦ï¼Œè®°ä½è®¾ç½®çš„å¯†ç ï¼Œé…ç½®tomcatçš„æ—¶å€™ä¼šä½¿ç”¨åˆ°ï¼Œå¾…ç”³è¯·é€šè¿‡ï¼Œä¼šé¢å‘è¯ä¹¦ï¼Œä¸‹è½½è¯ä¹¦è§£å‹åï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œåº”è¯¥æ˜¯é’ˆå¯¹ä¸ç”¨çš„å®¹å™¨æœ‰ä¸ç”¨çš„é…ç½®æ–¹æ³•ã€‚ Tomcatä¸‹é…ç½®è¯ä¹¦ æ‹·è´ä¸Šå›¾ä¸­Tomcatä¸‹çš„jksæ–‡ä»¶åˆ° tomcatå®‰è£…ç›®å½•ä¸‹conf ç›®å½• â€œxxxxapache-tomcat-7.0.86/conf/â€ä¸‹ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–è·¯å¾„ï¼Œè¿™é‡Œæ–¹åç»­é…ç½®server.xmlï¼Œæ‰æ”¾åœ¨æ­¤å¤„ï¼‰ï¼› ç¼–è¾‘â€œxxxx/apache-tomcat-7.0.86/conf/server.xmlâ€ å–æ¶ˆä¸‹å›¾ä½ç½®æ³¨é‡Šï¼Œç„¶åæ·»åŠ  keystoreFile=&quot;conf/xxxx.jks&quot;keystorePass=&quot;xxx&quot; ï¼Œæœ€åç»“æœä¸‹å›¾äºŒ Tomcatå¯åŠ¨å®‰è£…ç›®å½•ï¼Œbinç›®å½•ä¸‹ 1./startup.sh è®¿é—® â€œhttps://xxxx:8443â€ å¸¸è§é—®é¢˜8443ç«¯å£æœªå¼€æ”¾123sudo firewall-cmd --zone=public --add-port=8443/tcp --permanentsystemctl restart firewalld.service 8443ç«¯å£è¢«å ç”¨12lsof -i tcp:8443//æŸ¥è¯¢8443ç«¯å£ä½¿ç”¨æƒ…å†µkill -9 xxx //killæ‰å¯¹åº”è¿›ç¨‹ lsof / netstat / wget not found123yum install lsofyum install net-toolsyum install wget","link":"/2018/04/25/CentOS + Tomcat + SSL/"},{"title":"Flutterç‰ˆ Gank.io","text":"å‰è¨€æ¯æ¬¡ç»ƒæ‰‹éƒ½æ˜¯ç”¨ã€ä»£ç å®¶ã€‘å¤§ä½¬çš„æ¥å£ï¼Œå†æ¬¡æ„Ÿè°¢ã€‚ FlutterGank GankIOClient GankIOWithKotlin å¹²è´§æ•°æ®æº åº”ç”¨ä¸­çš„æ‰€æœ‰å¹²è´§æ•°æ®å‡æ¥è‡ªå¹²è´§é›†ä¸­è¥ã€‚ Appè®¾è®¡ è‰²è°ƒï¼šè¿œå·é¼ ã€è½æ —ã€è‹èŠ³ã€çŸ³ç«¹ã€æ¯è‰ã€æŸ³ç…¤ç«¹èŒ¶ã€é”–é’ç£ã€é¸ ç¾½ç´«å…«ç§æ·¡é›…çš„é¢œè‰²ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„å¹²è´§æ•°æ®ã€‚ å¸ƒå±€ï¼šç®€çº¦é£æ ¼ï¼Œæç®€ä¸»ä¹‰ï¼Œå»ç¹å°±ç®€ã€‚ UIè®¾è®¡ é»‘ç™½ç°ç´«è“ åœ†è§’ ææ–™è®¾è®¡ Author CSDN Website JueJin Android ScreenShot iOS ScreenShot FAQ Missing xcode dependency: Python module â€œsixâ€è§£å†³åŠæ³• WebViewæ’ä»¶è§£å†³åŠæ³• Dart Html Parseè§£å†³æ–¹æ³• KeyBoard Causes Overflowè§£å†³åŠæ³• å…¶ä»–é—®é¢˜è§£å†³åŠæ³• å›½å†…ç½‘ç»œé—®é¢˜è§£å†³åŠæ³•","link":"/2018/05/12/Flutterç‰ˆ Gank.io/"},{"title":"Markdownåšæ–‡å¿«é€Ÿè½¬ä¸ºå¾®ä¿¡æ–‡ç« ","text":"ä»‹ç»æŠ€æœ¯åšæ–‡åœ¨CSDNä¸Šï¼Œå…¨æ˜¯Markdownæ ¼å¼ï¼Œæœ€è¿‘çœ‹å„ä½å¤§ä½¬åˆæ˜¯ä¸ªäººç½‘ç«™åˆæ˜¯ä¸ªäººå¾®ä¿¡å…¬ä¼—å·ï¼Œçªç„¶å‘ç°ï¼šâ€œä¸ªäººåšå®¢å°ç«™ + ä¸ªäººå¾®ä¿¡å…¬ä¼—å· + CSDN + æ˜é‡‘+ â€¦ = ç¨‹åºå‘˜æ ‡é…â€œã€‚æ‰€ä»¥æœ€è¿‘åœ¨æ•´ç†è‡ªå·±çš„ä¸ªäººè®¢é˜…å·ã€‚éƒ¨åˆ†æ–‡ç« å¼€å§‹å¾€å¾®ä¿¡å¹³å°è½¬ç§»ï¼Œä½†æ˜¯å¾®ä¿¡æ ¼å¼ä¸æ˜¯é‡‡ç”¨çš„Markdownè€Œæ˜¯é‡‡ç”¨çš„å¯Œæ–‡æœ¬ï¼Œé‡æ–°ä¹¦å†™çš„å·¥ä½œé‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥å¦‚ä½•é«˜æ•ˆçš„å°†Markdownæ–‡ç« è½¬æˆå¾®ä¿¡æ”¯æŒçš„æ ¼å¼ï¼Œæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ä¸‹é¢ä»‹ç»ä¸€ä¸‹æˆ‘è‡ªå·±çš„ä¸€å¥—æ–¹æ³•ï¼Œå¦‚æœ‰æ›´å¥½çš„åŠæ³•ï¼Œè¯·ä¸åèµæ•™ã€‚ å·¥å…· MacBook MarkEditoråŸºç¡€ç‰ˆéä»˜è´¹ Markdown Here æ’ä»¶ï¼ˆChromeï¼ŒSafariç­‰æµè§ˆå™¨æ”¯æŒï¼‰ 135å¾®ä¿¡æ–‡ç« åœ¨çº¿ç¼–è¾‘å™¨ æ­¥éª¤1. å°†Markdownæ ¼å¼çš„CSDNæ–‡ç« å¤åˆ¶åˆ°MarkEditorç¼–è¾‘å™¨2. å°†MarkEditorç¼–è¾‘å™¨ä¸­çš„å†…å®¹å¤åˆ¶åˆ°135ç¼–è¾‘å™¨æ–¹ä¾¿æˆ‘ä»¬æ·»åŠ ä¸€äº›å…¶ä»–çš„å†…å®¹3. æµè§ˆå™¨ä¸­ç‚¹å‡»â€œMarkdown Hereâ€œæ’ä»¶ï¼Œä¼˜åŒ–æ–‡ç« æ ¼å¼4. æœ€åå¤åˆ¶åˆ°å¾®ä¿¡å…¬ä¼—å·æ–‡ç« ç¼–è¾‘å™¨ä¸­å³å¯ã€‚é™¤äº†è¡¨æ ¼ï¼Œå…¶ä»–çš„æ ¼å¼åŸºæœ¬ä¸Šå…¨éƒ¨èƒ½æ­£ç¡®çš„è½¬æ¢","link":"/2017/05/07/Markdownåšæ–‡å¿«é€Ÿè½¬ä¸ºå¾®ä¿¡æ–‡ç« /"},{"title":"PowerDesign 12.0 & PDMReaderè½»æ¾ç”Ÿæˆæ•°æ®å­—å…¸","text":"å‰è¨€æœ€è¿‘éœ€è¦ç¼–åˆ¶é¡¹ç›®æ–‡æ¡£ï¼Œå…¶ä¸­å¿…ä¸å¯å°‘çš„å†…å®¹å°±æ˜¯æ•°æ®å­—å…¸ï¼Œæ‰‹åŠ¨ç¼–åˆ¶è¿‡äºéº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ï¼Œé‡‡ç”¨SQLè¯­å¥æŸ¥è¯¢è¡¨ä¿¡æ¯ç„¶åæ•´ç†æˆæ–‡æ¡£çš„æ–¹å¼ä¹Ÿæ˜¯éå¸¸çš„è€—æ—¶ã€‚äºæ˜¯å¼€å§‹æœå¯»è§£å†³æ–¹æ¡ˆï¼Œäº†è§£åˆ°PowerDesignè¿™ä¸ªå·¥å…·ã€‚æ‰€ä»¥ä¸‹è½½äº†PowerDesignï¼ŒæŒ‰ç…§ä¸ªäººä¹ æƒ¯ï¼Œæ€»æ˜¯å–œæ¬¢ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼Œä½†æ˜¯ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å¯¼å‡ºçš„PDMæ–‡ä»¶ï¼Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„PDMReaderæ— æ³•å¯¼å…¥ï¼Œè¿™å°±å°´å°¬äº†ï¼Œç½‘å‹è¯´ï¼Œä¸€èˆ¬è¿™ç§æƒ…å†µæ˜¯ä¸¤è€…çš„ç‰ˆæœ¬ä¸åŒ¹é…å¯¼è‡´çš„ï¼Œå¹¶ä¸”åœ¨æ“ä½œPDMReaderçš„æ—¶å€™ï¼Œæ— æ„ä¸­å‘ç°å¦‚ä¸‹ç•Œé¢äºæ˜¯æˆ‘å»ä¸‹è½½äº†PowerDesign12.0ï¼Œå†æ¬¡å°è¯•ï¼Œç«Ÿç„¶å¯ä»¥æˆåŠŸçš„ç”Ÿæˆæ•°æ®å­—å…¸ã€‚ å·¥å…·å¯¹åº”ç‰ˆæœ¬çš„PowerDesignå’ŒPDMReaderï¼Œå·²ä¸Šä¼ è‡³CSDNPowerDesign12ä»¥åŠPDMReader ä½¿ç”¨æ–¹å¼ PowerDesignç”ŸæˆPDMæ–‡ä»¶ PDMReaderå¯¼å…¥PowerDesignç”Ÿæˆçš„PDMæ–‡ä»¶ï¼Œå¹¶å¯¼å‡ºä¸ºwordå³å¯ é‡åˆ°é—®é¢˜ PowerDesigné’ˆå¯¹oracleåªèƒ½ä½¿ç”¨32ä½odbcï¼Œè‹¥æ²¡æœ‰å¯¹åº”é©±åŠ¨ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¸€ä¸‹ä¸‹è½½åœ°å€ï¼Œå¯¹åº”çš„é…ç½®æ–¹æ³•å¦‚å®˜ç½‘æ‰€è¿° æœ¬åœ°æ•°æ®æºå¯ä»¥é€šè¿‡ã€æ§åˆ¶é¢æ¿ã€‘-&gt;ã€ç®¡ç†å·¥å…·ã€‘-&gt;ã€ODBCæ•°æ®æº(32ä½)ã€‘è¿›è¡Œé…ç½®","link":"/2018/10/31/PowerDesign 12.0 & PDMReaderè½»æ¾ç”Ÿæˆæ•°æ®å­—å…¸/"},{"title":"RxJava2-åŸºç¡€ä½¿ç”¨","text":"ä»‹ç» RxJavaï¼Œå“åº”å¼ç¼–ç¨‹ï¼Œå‘Šåˆ«AsyncTaskï¼Œä¸Retrofitç»„æˆäº†æ—¥å¸¸å¼€å‘ç»å…¸ç»„åˆã€‚ä¹‹å‰ï¼Œå¥½è¯»ä¹¦ä¸æ±‚ç”šè§£å¾—æ€åº¦ï¼Œè®©æˆ‘å¯¹å…¶å°è±¡å¹¶ä¸æ·±åˆ»ï¼ŒçŸ¥è¯†å±‚é¢æ¯”è¾ƒæµ…è–„ã€‚ä¸ºäº†åŠ æ·±å°è±¡ï¼Œé‡æ–°å­¦ä¹ ã€‚ æ·»åŠ ä¾èµ–12implementation 'io.reactivex.rxjava2:rxandroid:2.0.1'implementation 'io.reactivex.rxjava2:rxjava:2.1.7' ä¸¾ä¾‹è¯´æ˜ä¸Šæ¸¸å’Œä¸‹æ¸¸ï¼ˆè¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ï¼‰12345678910111213141516171819202122232425262728293031Observable&lt;Integer&gt; observable = Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() { @Override public void subscribe(ObservableEmitter&lt;Integer&gt; e) throws Exception { e.onNext(111); e.onNext(222); e.onComplete(); }});Observer&lt;Integer&gt; observer = new Observer&lt;Integer&gt;() { @Override public void onSubscribe(Disposable d) { Logger(\"onSubscribe\"); } @Override public void onNext(Integer integer) { Logger(\"onNext integer = \" + integer); } @Override public void onError(Throwable e) { Logger(\"onError e = \" + e.getMessage()); } @Override public void onComplete() { Logger(\"onComplete\"); }};observable.subscribe(observer); è¿è¡Œç»“æœ æµç¨‹ åˆ›å»ºObservable åˆ›å»ºObserver Observerableè®¢é˜…ï¼ˆsubscribeï¼‰Observer ObservableObservableæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ç°ObservableSourceæ¥å£ 1public abstract class Observable&lt;T&gt; implements ObservableSource&lt;T&gt; è€ŒObservableSourceæ¥å£ä¸­åªæœ‰ä¸€ä¸ªè®¢é˜…æ–¹æ³• 123456789public interface ObservableSource&lt;T&gt; { /** * Subscribes the given Observer to this ObservableSource instance. * @param observer the Observer, not null * @throws NullPointerException if {@code observer} is null */ void subscribe(@NonNull Observer&lt;? super T&gt; observer);} é€šè¿‡createæ–¹æ³•åˆ›å»ºObservableï¼Œç¨å¾®è¿½ä¸‹æºç ï¼Œå¸®åŠ©ç†è§£ 1234public static &lt;T&gt; Observable&lt;T&gt; create(ObservableOnSubscribe&lt;T&gt; source) { ObjectHelper.requireNonNull(source, \"source is null\"); return RxJavaPlugins.onAssembly(new ObservableCreate&lt;T&gt;(source));} å‚æ•°ç±»å‹ä¸ºObservableOnSubscribeæ¥å£ 123456789public interface ObservableOnSubscribe&lt;T&gt; { /** * Called for each Observer that subscribes. * @param e the safe emitter instance, never null * @throws Exception on error */ void subscribe(@NonNull ObservableEmitter&lt;T&gt; e) throws Exception;} ObservableEmitterå¯ä»¥ç†è§£æˆå‘å°„å™¨ï¼Œçœ‹ä¸‹å®ƒçš„æºç ã€‚å®ƒç»§æ‰¿Emitterã€‚è€ŒEmitterä¸­æ‰æ˜¯æˆ‘ä»¬æœ€åŸºç¡€æœ€å¸¸ç”¨çš„åŠŸèƒ½ã€‚ 12345678public interface ObservableEmitter&lt;T&gt; extends Emitter&lt;T&gt; { void setDisposable(@Nullable Disposable d); void setCancellable(@Nullable Cancellable c); boolean isDisposed(); ObservableEmitter&lt;T&gt; serialize(); @Experimental boolean tryOnError(@NonNull Throwable t);} ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç ï¼Œåˆ é™¤äº†éƒ¨åˆ†æ³¨é‡Šï¼Œå¯åœ¨æºç ä¸­æŸ¥é˜…ã€‚ 12345678910111213141516171819public interface Emitter&lt;T&gt; { /** * Signal a normal value. * @param value the value to signal, not null */ void onNext(@NonNull T value); /** * Signal a Throwable exception. * @param error the Throwable to signal, not null */ void onError(@NonNull Throwable error); /** * Signal a completion. */ void onComplete();} ä»ä¸Šé¢Emitterçš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å‘å°„ä¸‰ç§æ¶ˆæ¯ï¼š onNext, onComplete, onErrorã€‚ä»è¯­ä¹‰ä¸Šå°±å¾ˆå®¹æ˜“çœ‹å‡ºä»–ä»¬çš„ä½œç”¨ã€‚ é’ˆå¯¹ä¸‰ä¸ªäº‹ä»¶ï¼Œåšä¸€äº›è¯´æ˜ï¼š å‘å°„å™¨å¯ä»¥å‘é€æ— é™ä¸ªonNext, Observerä¹Ÿå¯ä»¥æ¥æ”¶æ— é™ä¸ªonNextï¼› å‘å°„å™¨å‘é€ä¸€ä¸ªonCompleteå, onCompleteä¹‹åçš„äº‹ä»¶å°†ä¼šç»§ç»­å‘é€, è€ŒObserveræ”¶åˆ°ç¬¬ä¸€ä¸ªonCompleteäº‹ä»¶ä¹‹åå°†ä¸å†ç»§ç»­æ¥æ”¶äº‹ä»¶ï¼› å‘å°„å™¨å‘é€äº†ä¸€ä¸ªonErrorå, onErrorä¹‹åçš„äº‹ä»¶å°†ç»§ç»­å‘é€, è€ŒObserveræ”¶åˆ°onErroräº‹ä»¶ä¹‹åå°†ä¸å†ç»§ç»­æ¥æ”¶äº‹ä»¶ï¼› å‘å°„å™¨å¯ä»¥ä¸å‘é€onCompleteæˆ–onErrorï¼› å‘å°„å™¨ä¸èƒ½åŒæ—¶å‘å‡ºonCompleteå’ŒonErrorï¼› ä¸å…è®¸å‘å‡ºå¤šä¸ªonErroræˆ–è€…onCompleteã€‚ Observerç›¸å¯¹äºObservableè€Œè¨€ï¼ŒObserverå°±ç®€å•å¾ˆå¤šï¼Œæˆ‘ä»¬åªéœ€è¦é’ˆå¯¹æˆ‘ä»¬æ„Ÿå…´è¶£çš„äº‹ä»¶ä½œå‡ºç›¸åº”çš„å¤„ç†å³å¯ã€‚ 123456public interface Observer&lt;T&gt; { void onSubscribe(@NonNull Disposable d); void onNext(@NonNull T t); void onError(@NonNull Throwable e); void onComplete();} è¿™é‡Œæœ‰ä¸€ä¸ªæ–°å†…å®¹Disposableï¼Œå…ˆçœ‹ä»£ç ï¼Œâ€œè±¡å¾ä¸€ä¸ªä¸€æ¬¡æ€§èµ„æºâ€ï¼Œä»æ³¨é‡Šä¸Šçœ‹æ˜¯è¿™ä¸ªæ„æ€ã€‚ä½†æ˜¯å¦‚ä½•ç†è§£ï¼Ÿ 123456789101112131415/** * Represents a disposable resource. */public interface Disposable { /** * Dispose the resource, the operation should be idempotent. */ void dispose(); /** * Returns true if this resource has been disposed. * @return true if this resource has been disposed */ boolean isDisposed();} ä¸¾ä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839Observable&lt;Integer&gt; observable = Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() { @Override public void subscribe(ObservableEmitter&lt;Integer&gt; e) throws Exception { e.onNext(111); e.onNext(222); e.onNext(333); e.onComplete(); e.onNext(444); }});Observer&lt;Integer&gt; observer = new Observer&lt;Integer&gt;() { Disposable mDisposable; @Override public void onSubscribe(Disposable d) { Logger(\"onSubscribe\"); mDisposable = d; } @Override public void onNext(Integer integer) { Logger(\"onNext integer = \" + integer); if(integer== 222 &amp;&amp; !mDisposable.isDisposed()) { mDisposable.dispose(); } } @Override public void onError(Throwable e) { Logger(\"onError e = \" + e.getMessage()); } @Override public void onComplete() { Logger(\"onComplete\"); }};observable.subscribe(observer); è¿è¡Œç»“æœï¼š å¯ä»¥çœ‹åˆ°å‘å°„å™¨å‘é€äº†222ä¹‹åï¼Œå‰©ä¸‹çš„äº‹ä»¶Observerå¹¶æ²¡æœ‰å¤„ç†ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„äº‹ä»¶å‘å°„å™¨æœ‰æ²¡æœ‰å‘é€å‘¢ï¼Ÿåœ¨å‘å°„å™¨å‘å°„äº‹ä»¶ä¹‹å‰æ·»åŠ logã€‚ å¯ä»¥çœ‹åˆ°å‘å°„å™¨çš„äº‹ä»¶å¹¶æ²¡æœ‰å—åˆ°Disposableå½±å“ï¼Œåªæ˜¯Observeræ²¡æœ‰æ¥æ”¶åˆ°222ä¹‹åçš„äº‹ä»¶è€Œå·²ã€‚ Disposableçš„ä½œç”¨åº”è¯¥æ˜¯ï¼Œæˆªæ–­å‘å°„å™¨ä¸Observerä¹‹é—´çš„äº‹ä»¶é€šé“ã€‚","link":"/2018/01/06/RxJava2å°ç™½æ‰‹å†Œï¼ˆ1ï¼‰- åŸºç¡€ä½¿ç”¨/"},{"title":"MacOS 10.11.6 Androidæºç ç¼–è¯‘å¹¶åˆ·æœº","text":"å‰è¨€Mac OSä¹‹å‰æ˜¯10.14ç‰ˆæœ¬ï¼ŒXcodeä¹Ÿæ˜¯æœ€æ–°çš„Xcode 10ï¼Œä¸å®˜æ–‡è¦æ±‚çš„ç¼–è¯‘ç¯å¢ƒç›¸å·®å¾ˆå¤§ï¼Œå¯¼è‡´ç¼–è¯‘è¿‡ç¨‹ä¸­å‡ºç°å„ç§å¥‡è‘©é”™è¯¯ï¼Œæ— åŠ›è§£å†³ï¼Œé‚é‡è£…ç³»ç»Ÿã€‚å¥½åœ¨Mac OSé‡è£…ç³»ç»Ÿå¾ˆæ–¹ä¾¿ï¼Œåœ¨çº¿å®‰è£…å³å¯ã€‚æ‰€ä»¥ï¼Œå®‰è£…10.11ç‰ˆæœ¬ï¼Œç›®å‰ç¼–è¯‘Android6.0.1æºç æ— é—®é¢˜ã€‚ ç¯å¢ƒ Mac OS ï¼š10.11.6 OS X EI Capitan JDKï¼šjdk7 Xcodeï¼šç¦»çº¿å®‰è£…çš„Xcode 7.1 ä»¥åŠå¯¹åº”çš„Command Line Toolï¼ˆå®˜æ–¹ä¸‹è½½å®‰è£…ï¼‰ MacPorts åˆ›å»ºåˆ†åŒºmacç³»ç»Ÿé»˜è®¤æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ã€‚ 1hdiutil create -type SPARSE -fs 'Case-sensitive Journaled HFS+' -size 150g ~/android.dmg è¿™å°†åˆ›å»ºä¸€ä¸ª.dmg.sparseimageæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åœ¨è£…è½½åå¯ç”¨ä½œå…·æœ‰ Android å¼€å‘æ‰€éœ€æ ¼å¼çš„é©±åŠ¨ç›˜ã€‚è‹¥å‘ç°å¤§å°ä¸è¶³ï¼Œå¯ä»¥é‡æ–°ä¿®æ”¹ 1hdiutil resize -size &lt;new-size-you-want&gt;g ~/android.dmg.sparseimage åœ¨~/.bash_profileæ·»åŠ ä¸¤ä¸ªæ–¹æ³• 1234# mount the android file imagemountAndroid() { hdiutil attach ~/android.dmg.sparseimage -mountpoint /Volumes/android; }# unmount the android file imageumountAndroid() { hdiutil detach /Volumes/android; } ç¯å¢ƒå‡†å¤‡JDKå®‰è£…Xcode7.1/Command Line Toolå®‰è£…ï¼ˆå®˜æ–¹ä¸‹è½½å®‰è£…ï¼‰ä¸‹è½½æ—¶æ³¨æ„å’Œç³»ç»Ÿ10.11é…å¥—çš„Xcodeï¼Œä»¥åŠå’ŒXcodeç‰ˆæœ¬å¯¹åº”çš„Command Line Tool MacPorts ä»macports.org ä¸‹è½½å®‰è£…,è¯·ç¡®ä¿ /opt/local/bin åœ¨è·¯å¾„ä¸­æ˜¾ç¤ºåœ¨ /usr/bin å‰é¢ã€‚å¦åˆ™ï¼Œè¯·å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶(~/.bash_profile)ä¸­ï¼š 1export PATH=/opt/local/bin:$PATH é€šè¿‡ MacPorts è·å– Makeã€Git ã€ GPGã€BISON è½¯ä»¶åŒ… 1POSIXLY_CORRECT=1 sudo port install gmake libsdl git gnupg bison è®¾ç½®æ–‡ä»¶æè¿°ç¬¦æ•°é‡ä¸Šé™åœ¨ Mac OS ä¸­ï¼Œå¯åŒæ—¶æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„é»˜è®¤æ•°é‡ä¸Šé™å¤ªä½ï¼Œåœ¨é«˜åº¦å¹¶è¡Œçš„ç¼–è¯‘æµç¨‹ä¸­ï¼Œå¯èƒ½ä¼šè¶…å‡ºæ­¤ä¸Šé™ã€‚è¦æé«˜æ­¤ä¸Šé™ï¼Œåœ¨~/.bash_profileä¸‹æ·»åŠ  12# set the number of open files to be 1024ulimit -S -n 1024 ä¸‹è½½ å›½å†…é‡‡ç”¨æ¸…åæºï¼Œå›½å¤–è‡ªä¾¿ Repo ~ç›®å½•ä¸‹æ–°å»ºbinç›®å½•ï¼Œè¿›å…¥åä¸‹è½½repo 1234mkdir bincd bincurl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo -o repochmod +x repo /binç›®å½•åŠ å…¥PATHï¼Œ/.bash_profileæ·»åŠ  1export PATH=\"~/bin:$PATH\" repoçš„è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå°è¯•è®¿é—®å®˜æ–¹çš„gitæºæ›´æ–°è‡ªå·±ï¼Œå¦‚æœæƒ³ä½¿ç”¨tunaçš„é•œåƒæºè¿›è¡Œæ›´æ–°ï¼Œå¯ä»¥å°†å¦‚ä¸‹å†…å®¹å¤åˆ¶åˆ°ä½ çš„~/.bash_profileé‡Œ 1export REPO_URL='https://mirrors.tuna.tsinghua.edu.cn/git/git-repo/' ä¸‹è½½æºç 12345cd /Volumes/androidmkdir aospcd aosprepo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest -b android-6.0.1_r1repo sync ç¼–è¯‘æ¸…ç†1make clobber è®¾ç½®ç¯å¢ƒ1source build/envsetup.sh é€‰æ‹©ç¼–è¯‘å¯¹è±¡1lunch å¦‚æœæ˜¯è¿è¡Œæ¨¡æ‹Ÿå™¨ï¼Œé€‰æ‹©1å³å¯ï¼Œå¦‚æœæ˜¯ç¼–è¯‘åˆ·æœºï¼Œæ ¹æ®å…·ä½“æœºå‹é€‰æ‹©ç¼–è¯‘å¯¹è±¡ã€‚ æ‰§è¡Œç¼–è¯‘1make -j8 -jN è¡¨ç¤ºç¼–è¯‘å¹¶è¡Œä»»åŠ¡æ•°ï¼Œè¿™ä¸ªç¤ºç”µè„‘æƒ…å†µè€Œå®šï¼Œä¸€èˆ¬å–cpuæ•°çš„1ï½2å€å°±å¯ä»¥ ç¼–è¯‘AOSP 8.0.0_r17å¹¶åˆ·æœºç¯å¢ƒå˜åŒ–jdk7æ¢æˆ jdk8 ä¸ºäº†æ–¹ä¾¿jdkç‰ˆæœ¬åˆ‡æ¢ï¼Œåœ¨.bash_profileä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ 1234567export JAVA_7_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Homeexport JAVA_8_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_201.jdk/Contents/Homeexport JAVA_HOME=$JAVA_8_HOMEalias jdk8='export JAVA_HOME=$JAVA_8_HOME'alias jdk7='export JAVA_HOME=$JAVA_7_HOME' ç„¶ååœ¨ç»ˆç«¯ä¸‹ä½¿ç”¨jdk7æˆ–è€…jdk8æ¥åˆ‡æ¢ç¯å¢ƒ é©±åŠ¨ä¸‹è½½æŒ‰ç…§å¯¹åº”çš„ç»†åˆ†ç‰ˆæœ¬ä¸‹è½½é©±åŠ¨ ä¸‹é¢æ˜¯å…·ä½“ä¸‹è½½å†…å®¹ extract-huawei-angler.sh extract-huawei-angler.shä¸‹è½½æ”¾è‡³AOSPæ ¹ç›®å½•ï¼Œæ‰§è¡Œ æ‰§è¡Œç¼–è¯‘lunché€‰æ‹©anglerï¼Œæ‰§è¡Œç¼–è¯‘ï¼Œå¾…ç¼–è¯‘å®Œæˆ åˆ·æœº123456# æ‰‹æœºè¿æ¥ç”µè„‘æƒ…å†µä¸‹adb reboot bootloader# è¿›å…¥æºç ç¼–è¯‘è¾“å‡ºçš„ç›®å½•fastboot flashing unlockfastboot flashall -wfastboot reboot ç»“æœè™½ç„¶æœ€ååˆ·å…¥userdataå¤±è´¥ï¼Œä½†æ˜¯ä¸å½±å“è¿è¡Œï¼Œç³»ç»ŸæˆåŠŸåˆ·å…¥ã€‚ é—®é¢˜Gitä¸‹è½½å†…å®¹è¿‡å¤§1git config --global http.postBuffer 524288000 Android6.0.1ä¿®æ”¹build/core/combo/mac_version.mk1mac_sdk_versions_supported := 10.6 10.7 10.8 10.9 æ”¹ä¸º 1mac_sdk_versions_supported := 10.6 10.7 10.8 10.9 10.11","link":"/2019/04/01/MacOS 10.11.6 Androidæºç ç¼–è¯‘å¹¶åˆ·æœº/"},{"title":"WanAndroidClient","text":"å‰è¨€ é¸¿ç¥çš„WanAndroidç½‘ç«™åå°APIå·²ç»å¼€æ”¾ã€‚å…·ä½“æ¥å£è¯¦æƒ…å‚è€ƒåšæ–‡ï¼š http://www.wanandroid.com/blog/show/2 æ‰€ä»¥ï¼Œå¯¹äºä¸ç†Ÿæ‚‰Kotlinçš„æˆ‘è€Œè¨€ï¼Œå€Ÿæ­¤æœºä¼šç»ƒä¹ ä¸€ä¸‹ã€‚ ä½¿ç”¨å¼€æºåº“ CardView RecyclerView BGARefreshLayout BGABanner BGAViewPager BRVAH Retrofit RxJava RxAndroid Moshi Okhttp3 Anko Glide com.orhanobut:logger FlexBox Lottie AgentWeb FlycoTabLayout æ•ˆæœ æºä»£ç  WanAndroidClient","link":"/2018/02/25/WanAndroidClient/"},{"title":"Xenè™šæ‹Ÿæœºä¸‹æŒ‚è½½","text":"//åˆ›å»ºæºvdiskæŒ‚è½½ç›®å½•ï¼› mkdir vd1 //åˆ›å»ºç›®æ ‡vdiskæŒ‚è½½ç›®å½•ï¼›mkdir vd2 //åªéœ€ç¬¬ä¸€æ¬¡æ‰§è¡Œiscsiadm -m discovery â€“type sendtargets â€“portal 192.168.3.221 //æŒ‚è½½ï¼›\\root\\4xvd_loginxmount -o loop /dev/sdc /mnt/vdisk //æŒ‚è½½æºvdiskï¼›mount -o loop /mnt/vdisk/vmm4_vm9_dt.img /mnt/vd1 //åˆ¶ä½œvdiskï¼›ä»¥VMM1çš„VM1ä¸ºä¾‹(åˆå§‹åŒ–ï¼‰dd if=/dev/zero of=/mnt/vdisk/vmm1_vm1_dt.img bs=1M seek=81920 count=1mkfs -t ext4 /mnt/vdisk/vmm1_vm1_dt.img //æŒ‚è½½ç›®æ ‡vdiskï¼›ä»¥VMM1çš„VM1ä¸ºä¾‹mount -o loop /mnt/vdisk/vmm1_vm1_dt.img /mnt/vd2","link":"/2014/04/25/Xenè™šæ‹Ÿæœºä¸‹æŒ‚è½½/"},{"title":"RxJava2-map","text":"ä»‹ç» æ“ä½œç¬¦mapï¼Œå­—é¢ç†è§£ä¸€ä¸‹ï¼Œå°±æ˜¯æ˜ å°„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œç¬¦å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ ä¸¾ä¾‹è¯´æ˜ä»£ç ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041Observable&lt;Integer&gt; observable = Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() { @Override public void subscribe(ObservableEmitter&lt;Integer&gt; e) throws Exception { Logger(\"Emit 1\"); e.onNext(1); Logger(\"Emit 2\"); e.onNext(2); e.onComplete(); }});Observer&lt;String&gt; observer = new Observer&lt;String&gt;() { @Override public void onSubscribe(Disposable d) { Logger(\"onSubscribe\"); } @Override public void onNext(String object) { Logger(\" onNext \" + object); } @Override public void onError(Throwable e) { Logger(\"onError e = \" + e.getMessage()); } @Override public void onComplete() { Logger(\"onComplete\"); }};observable.subscribeOn(Schedulers.io()) .map(new Function&lt;Integer, String&gt;() { @Override public String apply(Integer integer) throws Exception { return \"i am \" + integer; } }) .observeOn(AndroidSchedulers.mainThread()) .subscribe(observer); è¿è¡Œç»“æœ å¯ä»¥çœ‹åˆ°é¦–å…ˆæ‰§è¡Œçš„æ˜¯onSubscribeæ–¹æ³•ï¼Œç„¶åå‘å°„ä¸¤ä¸ªonNextäº‹ä»¶ï¼Œä¸¤ä¸ªIntegerå‚æ•°ç»è¿‡è½¬æ¢ä¹‹åæˆä¸ºStringç±»å‹ï¼Œç„¶åä¼ é€’ç»™Observerä½œå‡ºåŠ¨ä½œï¼Œè¿™å°±æ˜¯Mapçš„ä½œç”¨ã€‚ æºç æµ…æä¸‹é¢æ˜¯mapæ“ä½œç¬¦çš„æºç ã€‚ 1234567//è§‚å¯Ÿmapä¸­Functionçš„ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯Tä¹Ÿå°±æ˜¯å˜åŒ–å‰çš„ç±»å‹ï¼ŒRä¸ºå˜åŒ–åçš„ç±»å‹ï¼Œæœ€åè¿”å›çš„æ˜¯Rç±»å‹çš„Observerable(å§‘ä¸”è¿™ä¹ˆè¯´)public final &lt;R&gt; Observable&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper) { //å¸¸è§„éç©ºæ£€æŸ¥ ObjectHelper.requireNonNull(mapper, \"mapper is null\"); //åˆæ˜¯onAssembly,ä¸é‡è¦ï¼Œå…³æ³¨ObservableMap return RxJavaPlugins.onAssembly(new ObservableMap&lt;T, R&gt;(this, mapper));} çœ‹ä¸‹ObservableMapçš„æ„é€ æ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ï¼Œsourceä¸ºè½¬æ¢å‰çš„Observable&lt; T &gt;, ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬å¾—functionã€‚ObservableMapç»§æ‰¿AbstractObservableWithUpstreamï¼Œè€Œåè€…ç»§æ‰¿Observableï¼Œå¯ä»¥çœ‹å‡ºæ¥ï¼Œç»è¿‡mapè½¬æ¢åçš„Observableå¯¹è±¡å°±æ˜¯ObservableMapç±»å‹ã€‚ 1234public ObservableMap(ObservableSource&lt;T&gt; source, Function&lt;? super T, ? extends U&gt; function) { super(source); this.function = function;} æ—¢ç„¶è½¬æ¢åæ˜¯ObservableMapç±»å‹ï¼Œé‚£ä¹ˆå¿…ç„¶å­˜åœ¨subscribeActualæ–¹æ³•ï¼Œæœç„¶ 123public void subscribeActual(Observer&lt;? super U&gt; t) { source.subscribe(new MapObserver&lt;T, U&gt;(t, function));} çœ‹çœ‹MapObserveræ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//MapObserverç»§æ‰¿BasicFuseableObserverï¼Œè€Œåè€…å®ç°äº†Observeræ¥å£static final class MapObserver&lt;T, U&gt; extends BasicFuseableObserver&lt;T, U&gt; { //mapæ“ä½œç¬¦ä¸­çš„function final Function&lt;? super T, ? extends U&gt; mapper; //actualæ˜¯æ —å­ä¸­æˆ‘ä»¬åé¢subscribeçš„Observer MapObserver(Observer&lt;? super U&gt; actual, Function&lt;? super T, ? extends U&gt; mapper) { super(actual); this.mapper = mapper; } @Override public void onNext(T t) { //doneåœ¨æ‰§è¡Œäº†onErroræˆ–è€…onCompleteä¹‹åä¸ºtrue,å…·ä½“æŸ¥çœ‹çˆ¶ç±»BasicFuseableObserverã€‚doneä¸ºtrueæ—¶ï¼Œä¸åšå¤„ç†ã€‚ if (done) { return; } if (sourceMode != NONE) { actual.onNext(null); return; } //Uç±»å‹ï¼Œè½¬æ¢åçš„ç±»å‹ï¼Œæ —å­ä¸­ä¸ºString U v; try { //å¸¸è§„éç©ºæ£€æŸ¥ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸ªapplyçš„æ“ä½œï¼Œè¿™ä¸ªapplyçš„æ“ä½œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢æ —å­ä¸­æŠŠIntegerè½¬æˆStringçš„æ“ä½œã€‚vå°±æ˜¯è½¬æ¢åçš„Stringç±»å‹ v = ObjectHelper.requireNonNull(mapper.apply(t), \"The mapper function returned a null value.\"); } catch (Throwable ex) { fail(ex); return; } //Observeræ‰§è¡ŒonNextæ“ä½œï¼Œvä¸ºè½¬æ¢åçš„ç±»å‹ï¼Œå¦‚æ —å­ä¸­çš„String actual.onNext(v); } @Override public int requestFusion(int mode) { return transitiveBoundaryFusion(mode); } @Nullable @Override public U poll() throws Exception { T t = qs.poll(); return t != null ? ObjectHelper.&lt;U&gt;requireNonNull(mapper.apply(t), \"The mapper function returned a null value.\") : null; } } ä¸ºä»€ä¹ˆå‘å°„ä¹‹åObserverçš„onNextæ²¡æœ‰ç«‹åˆ»æ‰§è¡Œï¼Œå› ä¸ºä¸Šæ–‡ä¾‹å­ä¸­subscribeOnå’ŒobserveOnæ‰€åœ¨çš„çº¿ç¨‹ä¸ä¸€æ ·ã€‚","link":"/2018/01/08/RxJava2å°ç™½æ‰‹å†Œï¼ˆ3ï¼‰- map/"},{"title":"ionic WanAndroid Client","text":"ionic-wanandroidåŸºäºionic4 + ng7æ„å»ºä¸€ä¸ªionic WanAndroid.comå®¢æˆ·ç«¯ä½¿ç”¨åˆ°é˜¿é‡Œç§»åŠ¨ç«¯ç»„ä»¶åº“ng-zorro-antd-mobileï¼Œ åŠŸèƒ½ç‚¹ é¦–é¡µè½®æ’­å›¾ é¦–é¡µå…¬ä¼—å·ï¼Œå¯¼èˆªæ•°æ® æœ€æ–°é¡¹ç›® æœç´¢ çŸ¥è¯†ä½“ç³» Nativeæ’ä»¶ Http Device File InAppBrowser AppMinimize ionic-Keyboard ionic-Webview SplashScreen StatusBar Whitelist é¡¹ç›®è¿è¡Œ12345678910111213141516# éœ€è¦å…¨å±€å®‰è£…cordova ionicnpm install -g cordova ionicgit clone https://github.com/onlyloveyd/ionic-wanandroid.gitcd ionic-wanandroidnpm installionic cordova platform add android# androidè¿è¡Œionic cordova platform run android --prod# æµè§ˆå™¨è¿è¡Œionic serve æˆªå›¾","link":"/2019/07/10/ionic_wanandroid/"},{"title":"Xenè™šæ‹Ÿæœºé•œåƒçš„å®‰è£…","text":"äº†è§£ç³»ç»Ÿå®‰è£…åœ¨å“ªä¸ªç£ç›˜ä¸Šï¼šfdisk -l å»ºç«‹å­˜æ”¾è™šæ‹Ÿæœºé•œåƒçš„ç›®å½•ï¼šmkdir /mnt/vmx æ›´æ”¹æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼š mkfs -t ext4 /dev/sdaæˆ–è€…/dev/sdb(ç³»ç»Ÿä¸åœ¨çš„é‚£ä¸ªç¡¬ç›˜ï¼‰ å°†éç³»ç»Ÿç¡¬ç›˜æŒ‚è½½åˆ°ç³»ç»Ÿç›˜çš„ä¸€ä¸ªç›®å½•ä¸‹ï¼š mount -o loop/dev/sdaæˆ–è€…/dev/sdb(ç³»ç»Ÿä¸åœ¨çš„é‚£ä¸ªç¡¬ç›˜ï¼‰ /mnt/vmx å†å°†vmé•œåƒcopyåˆ°/mnt/vmxä¸‹ mount -o loop xxxxx.img /mnt/vm åœ¨è½¬è‡³/mnt/vmä¸‹ é…ç½®æ–‡ä»¶","link":"/2014/04/23/Xenè™šæ‹Ÿæœºé•œåƒçš„å®‰è£…/"},{"title":"xm å‘½ä»¤","text":"xm console &lt;åŸŸID&gt; ctrl+ ] é€€å‡ºè™šæ‹Ÿæœºåˆ°å®¿ä¸» xm reboot &lt;åŸŸID&gt; xm pause &lt;åŸŸID&gt; xm resume &lt;åŸŸID&gt; xm shutdown &lt;åŸŸID&gt; xm destroy åŸŸå åˆ é™¤è™šæ‹Ÿæœº","link":"/2014/04/28/xm å‘½ä»¤/"},{"title":"ã€ŠAndroid  Studioã€‹  Android Studio ä½¿ç”¨Aliyun Maven","text":"Gradleé…ç½®1234567891011121314allprojects { repositories { maven{ url 'http://maven.aliyun.com/nexus/content/groups/public/'} jcenter() }}...allprojects { repositories { maven{ url 'http://maven.aliyun.com/nexus/content/groups/public/'} jcenter() }} é€Ÿåº¦ è‡ªå·±ç™»é™†è¿™ä¸ªç½‘ç«™Aliyun Mavenï¼ŒæŸ¥è¯¢ä¸‹å¯¹åº”çš„å¼€æºåº“æ„Ÿå—ä¸€ä¸‹å°±çŸ¥é“äº†ã€‚","link":"/2017/03/25/ã€ŠAndroid  Studioã€‹  Android Studio ä½¿ç”¨Aliyun Maven/"},{"title":"ã€Š Linux ã€‹Crond å®šæ—¶ä»»åŠ¡","text":"ç®€ä»‹ crondçš„æ¦‚å¿µå’Œcrontabæ˜¯ä¸å¯åˆ†å‰²çš„ã€‚crontabæ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¸¸è§äºUnixå’Œç±»Unixçš„æ“ä½œç³»ç»Ÿä¹‹ä¸­ï¼Œç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„æŒ‡ä»¤ã€‚è¯¥å‘½ä»¤ä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æŒ‡ä»¤ï¼Œå¹¶å°†å…¶å­˜æ”¾äºâ€œcrontabâ€æ–‡ä»¶ä¸­ï¼Œä»¥ä¾›ä¹‹åè¯»å–å’Œæ‰§è¡Œã€‚è¯¥è¯æ¥æºäºå¸Œè…Šè¯­chronos(Ï‡ÏÏŒÎ½Î¿Ï‚)ï¼ŒåŸæ„æ˜¯æ—¶é—´ã€‚è€Œcrondæ­£æ˜¯å®ƒçš„å®ˆæŠ¤è¿›ç¨‹ã€‚ è¯´æ˜ Linuxä¸‹çš„ä»»åŠ¡è°ƒåº¦åˆ†ä¸ºä¸¤ç±»ï¼Œç³»ç»Ÿä»»åŠ¡è°ƒåº¦å’Œç”¨æˆ·ä»»åŠ¡è°ƒåº¦ã€‚ ç³»ç»Ÿä»»åŠ¡è°ƒåº¦ï¼šç³»ç»Ÿå‘¨æœŸæ€§æ‰€è¦æ‰§è¡Œçš„å·¥ä½œï¼Œæ¯”å¦‚å†™ç¼“å­˜æ•°æ®åˆ°ç¡¬ç›˜ã€æ—¥å¿—æ¸…ç†ç­‰ã€‚ åœ¨/etcç›®å½•ä¸‹æœ‰ä¸€ä¸ªcrontabæ–‡ä»¶ï¼Œè¿™ä¸ªå°±æ˜¯ç³»ç»Ÿä»»åŠ¡è°ƒåº¦çš„é…ç½®æ–‡ä»¶ã€‚ ç”¨æˆ·ä»»åŠ¡è°ƒåº¦ï¼šç”¨æˆ·å®šæœŸè¦æ‰§è¡Œçš„å·¥ä½œï¼Œæ¯”å¦‚ç”¨æˆ·æ•°æ®å¤‡ä»½ã€å®šæ—¶é‚®ä»¶æé†’ç­‰ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨ crontab å·¥å…·æ¥å®šåˆ¶è‡ªå·±çš„è®¡åˆ’ä»»åŠ¡ã€‚æ‰€æœ‰ç”¨æˆ·å®šä¹‰çš„crontab æ–‡ä»¶éƒ½è¢«ä¿å­˜åœ¨ /var/spool/cronç›®å½•ä¸­ã€‚å…¶æ–‡ä»¶åä¸ç”¨æˆ·åä¸€è‡´ã€‚ æƒé™é—®é¢˜æ–‡ä»¶ | è¯´æ˜ --------------- | ---------------------- /etc/cron.deny | è¯¥æ–‡ä»¶ä¸­æ‰€åˆ—ç”¨æˆ·ä¸å…è®¸ä½¿ç”¨crontabå‘½ä»¤ /etc/cron.allow | è¯¥æ–‡ä»¶ä¸­æ‰€åˆ—ç”¨æˆ·å…è®¸ä½¿ç”¨crontabå‘½ä»¤ å¦‚æœä¸¤ä¸ªæ–‡ä»¶éƒ½ä¸å­˜åœ¨ï¼Œåˆ™åªæœ‰rootç”¨æˆ·æ‰èƒ½ä½¿ç”¨crontabå‘½ä»¤ã€‚ å¦‚æœcron.allowå­˜åœ¨ä½†cron.denyä¸å­˜åœ¨ï¼Œåˆ™åªæœ‰åˆ—åœ¨cron.allowæ–‡ä»¶é‡Œçš„ç”¨æˆ·æ‰èƒ½ä½¿ç”¨crontabå‘½ä»¤ï¼Œå¦‚æœrootç”¨æˆ·ä¹Ÿä¸åœ¨é‡Œé¢ï¼Œåˆ™rootç”¨æˆ·ä¹Ÿä¸èƒ½ä½¿ç”¨crontabã€‚ å¦‚æœcron.allowä¸å­˜åœ¨, cron.denyå­˜åœ¨ï¼Œåˆ™åªæœ‰åˆ—åœ¨cron.denyæ–‡ä»¶é‡Œé¢çš„ç”¨æˆ·ä¸èƒ½ä½¿ç”¨crontabå‘½ä»¤ï¼Œå…¶å®ƒç”¨æˆ·éƒ½èƒ½ä½¿ç”¨ã€‚ å¦‚æœä¸¤ä¸ªæ–‡ä»¶éƒ½å­˜åœ¨ï¼Œåˆ™åˆ—åœ¨cron.allowæ–‡ä»¶ä¸­è€Œä¸”æ²¡æœ‰åˆ—åœ¨cron.denyä¸­çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨crontabï¼Œå¦‚æœä¸¤ä¸ªæ–‡ä»¶ä¸­éƒ½æœ‰åŒä¸€ä¸ªç”¨æˆ·ï¼Œä»¥cron.allowæ–‡ä»¶é‡Œé¢æ˜¯å¦æœ‰è¯¥ç”¨æˆ·ä¸ºå‡†ï¼Œå¦‚æœcron.allowä¸­æœ‰è¯¥ç”¨æˆ·ï¼Œåˆ™å¯ä»¥ä½¿ç”¨crontabå‘½ä»¤ã€‚ å®šæ—¶ä»»åŠ¡ /var/spool/cron/ æ‰€æœ‰ç”¨æˆ·crontabæ–‡ä»¶å­˜æ”¾çš„ç›®å½•,ä»¥ç”¨æˆ·åå‘½åã€‚ ç”¨æˆ·æ‰€å»ºç«‹çš„crontabæ–‡ä»¶ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½ä»£è¡¨ä¸€é¡¹ä»»åŠ¡ï¼Œæ¯è¡Œçš„æ¯ä¸ªå­—æ®µä»£è¡¨ä¸€é¡¹è®¾ç½®ï¼Œå®ƒçš„æ ¼å¼å…±åˆ†ä¸ºå…­ä¸ªå­—æ®µï¼Œå‰äº”æ®µæ˜¯æ—¶é—´è®¾å®šæ®µï¼Œç¬¬å…­æ®µæ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤æ®µã€‚ åœ¨ä»¥ä¸Šå„ä¸ªå­—æ®µä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç‰¹æ®Šå­—ç¬¦ï¼š æ˜Ÿå·ï¼ˆ*ï¼‰ï¼šä»£è¡¨æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œä¾‹å¦‚monthå­—æ®µå¦‚æœæ˜¯æ˜Ÿå·ï¼Œåˆ™è¡¨ç¤ºåœ¨æ»¡è¶³å…¶å®ƒå­—æ®µçš„åˆ¶çº¦æ¡ä»¶åæ¯æœˆéƒ½æ‰§è¡Œè¯¥å‘½ä»¤æ“ä½œã€‚ é€—å·ï¼ˆ,ï¼‰ï¼šå¯ä»¥ç”¨é€—å·éš”å¼€çš„å€¼æŒ‡å®šä¸€ä¸ªåˆ—è¡¨èŒƒå›´ï¼Œä¾‹å¦‚ï¼Œâ€œ1,2,5,7,8,9â€ ä¸­æ ï¼ˆ-ï¼‰ï¼šå¯ä»¥ç”¨æ•´æ•°ä¹‹é—´çš„ä¸­æ è¡¨ç¤ºä¸€ä¸ªæ•´æ•°èŒƒå›´ï¼Œä¾‹å¦‚â€œ2-6â€è¡¨ç¤ºâ€œ2,3,4,5,6â€ æ­£æ–œçº¿ï¼ˆ/ï¼‰ï¼šå¯ä»¥ç”¨æ­£æ–œçº¿æŒ‡å®šæ—¶é—´çš„é—´éš”é¢‘ç‡ï¼Œä¾‹å¦‚â€œ0-23/2â€è¡¨ç¤ºæ¯ä¸¤å°æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚åŒæ—¶æ­£æ–œçº¿å¯ä»¥å’Œæ˜Ÿå·ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚*/10ï¼Œå¦‚æœç”¨åœ¨minuteå­—æ®µï¼Œè¡¨ç¤ºæ¯ååˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚ CrondæœåŠ¡å®‰è£…crontab1yum install crontabs å¸¸ç”¨æ“ä½œ1234567891011service crond start //å¯åŠ¨æœåŠ¡service crond stop //å…³é—­æœåŠ¡service crond restart //é‡å¯æœåŠ¡service crond reload //é‡æ–°è½½å…¥é…ç½®service crond status //å¯åŠ¨æœåŠ¡chkconfig -level 35 crond on //è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ crontabå‘½ä»¤ ç¤ºä¾‹ æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡ŒGitlabå¤‡ä»½ æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œä¸€ä¸ªshè„šæœ¬","link":"/2018/08/20/ã€Š Linux ã€‹Crond å®šæ—¶ä»»åŠ¡/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆå››ï¼‰â€”â€”æ¡†æ¶æ€»ç»“","text":"å‰è¨€ ä»ä¹‹å‰çš„å‡ ç¯‡æ–‡ä»¶ï¼Œå¯ä»¥åŸºæœ¬å¼„æ¸…æ¥š Cameraä»APKï¼Œç»è¿‡frameworkçš„è¡”æ¥ï¼Œä¸HALå±‚è¿›è¡Œäº¤äº’ï¼Œæœ€ç»ˆé€šè¿‡é©±åŠ¨å®ŒæˆCameraçš„ä¸€äº›åŠ¨ä½œã€‚ Cameraå±‚æ¬¡åˆ†æ APPå±‚ Frameworkå±‚ åº“å±‚ å¤§è‡´çš„æ¡†æ¶å›¾å¦‚ä¸‹ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°å‡ ä¸ªå…³é”®çš„åœ°æ–¹ï¼š APPä»JAVAå±‚è¿‡æ¸¡åˆ°CPPå±‚ä¸­é—´é€šè¿‡JNIå±‚çš„android_hardware_Camera.cppæ–‡ä»¶å®ç°ï¼Œæ–‡ä»¶ä¸­ä¸»è¦æ¶‰åŠä»javaæ–¹æ³•åˆ°cppå‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œæ–¹ä¾¿ä½œå‡ºå¯¹åº”çš„å¤„ç†; Cameraäº¤äº’å¯¹è±¡ï¼Œä»å¼€å§‹è¿æ¥è¿‡ç¨‹ä¸­å¼Cameraä¸CameraServiceï¼Œè¿æ¥ä¹‹ååŸºæœ¬ä¸Šå°±æ˜¯Cameraä¸CameraClientè¿›è¡Œäº¤äº’ï¼Œè¿™é‡Œæ³¨æ„åˆ°CameraClientæ˜¯ç»§æ‰¿CameraService::Clientçš„ï¼Œè€Œåè€…åˆ™æ˜¯ç»§æ‰¿BnCamera,ç»§æ‰¿ICameraï¼ŒCameraç±»ä¸­å­˜åœ¨ä¸€ä¸ªICameraå˜é‡ï¼Œå°±æ˜¯è¿™ä¸ªå†…å®¹; Cameraç±»ç»§æ‰¿BnCameraClientï¼Œç»§æ‰¿ICameraClientï¼Œè¿™æ ·å°±å¯ä»¥å®ç°Cameraä¸CameraClientçš„äº¤äº’; è‡³äºCameraServiceä¸Cameraåº•å±‚åº“çš„äº¤äº’ï¼Œåªæ˜¯Camera HAL å±‚çš„æ¨¡å—åŠ è½½æ˜¯åœ¨CameraServiceä¸­å®ç°çš„ï¼ŒçœŸæ­£çš„HALå±‚çš„åˆ›å»ºæ˜¯åœ¨CameraClientçš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­ ä»Šå¤©çš„å†…å®¹æ¯”è¾ƒçš„å°‘ï¼Œä¸»è¦æ˜¯æ€»ç»“ä¸‹ã€‚ æœ¬æ–‡ä¸­ä»£ç ä½¿ç”¨çš„æ˜¯Android5.1åŸå§‹ä»£ç ","link":"/2015/09/13/ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆå››ï¼‰â€”â€”æ¡†æ¶æ€»ç»“/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹BootAnimationï¼ˆ1ï¼‰","text":"ä»‹ç» å¼€æœºåŠ¨ç”»ï¼ŒBootAnimationï¼Œå°±æ˜¯Androidæ‰‹æœºå¼€æœºéƒ­æ™¨å„ç§ä»¥ä¸€ä¸ªå±•ç¤ºç»™ç”¨æˆ·çš„ç•Œé¢ï¼Œå®é™…æ˜¯ä¸€ä¸ªå¤šä¸ªå¸§ç»„æˆçš„åŠ¨ç”»ï¼Œåœ¨ç•Œé¢ä¸Šè¿›è¡Œä¸€å¸§ä¸€å¸§çš„æ’­æ”¾ï¼Œå½¢æˆå¼€æœºåŠ¨ç”»çš„æ•ˆæœã€‚æœ¬æ–‡é’ˆå¯¹Android5.1æºç åˆ†æBootAnimation æºç åˆ†ææ–‡ä»¶äº§ç”ŸAndroidå¹³å°çš„å¼€æœºåŠ¨ç”»ç”±system/binä¸‹çš„bootanimationæ–‡ä»¶å®Œæˆï¼Œè€Œè¿™ä¸ªæ–‡ä»¶äº§ç”Ÿäº frameworks/base/cmds/bootanimation/Android.mk 12345678910111213141516171819202122232425262728293031LOCAL_PATH:= $(call my-dir)include $(CLEAR_VARS)LOCAL_SRC_FILES:= \\ bootanimation_main.cpp \\ AudioPlayer.cpp \\ BootAnimation.cppLOCAL_CFLAGS += -DGL_GLEXT_PROTOTYPES -DEGL_EGLEXT_PROTOTYPESLOCAL_C_INCLUDES += external/tinyalsa/includeLOCAL_SHARED_LIBRARIES := \\ libcutils \\ liblog \\ libandroidfw \\ libutils \\ libbinder \\ libui \\ libskia \\ libEGL \\ libGLESv1_CM \\ libgui \\ libtinyalsaLOCAL_MODULE:= bootanimationifdef TARGET_32_BIT_SURFACEFLINGERLOCAL_32_BIT_ONLY := trueendifinclude $(BUILD_EXECUTABLE) ç¼–è¯‘ç»“æœä¸ºbootanimationçš„binæ–‡ä»¶ï¼Œæ‰€ä»¥ï¼Œåœ¨æœ‰è¶³å¤Ÿæƒé™çš„å‰æä¸‹ï¼Œåœ¨adb shellä¸‹æ‰§è¡Œbootanimationä¹Ÿæ˜¯å¯ä»¥çœ‹åˆ°å¯¹åº”çš„å¼€æœºåŠ¨ç”»æ•ˆæœçš„ã€‚ å¯åŠ¨å¼€æœºåŠ¨ç”»å¼€æœºåŠ¨ç”»æ˜¯ä»¥binæ–‡ä»¶çš„å½¢å¼å­˜åœ¨äºæ‰‹æœºç³»ç»Ÿä¸­ï¼Œå¼€æœºè¿‡ç¨‹ä¸­é€šè¿‡init.rcå®šä¹‰ system/core/rootdir/init.rc 123456service bootanim /system/bin/bootanimation class core user graphics group graphics audio disabled//å®šä¹‰äº†disableï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ä¸ä¼šè‡ªåŠ¨çš„å¯åŠ¨ oneshot è¿™é‡Œä¸ä¼šå¯åŠ¨ï¼Œé‚£ä¹ˆåœ¨å“ªé‡Œå¯åŠ¨ï¼Ÿ ç”±äºå¼€æœºåŠ¨ç”»å¯¹SurfaceFlingeræœ‰ä¾èµ–ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯åœ¨SurfaceFlingerå¯åŠ¨ä¹‹åå†å¼€å§‹æ‰§è¡Œï¼Œçœ‹ä¸€ä¸‹æºç ã€‚ SurfaceFlingerçš„å¯åŠ¨åœ¨init.rcæ–‡ä»¶ä¸­ 12345service surfaceflinger /system/bin/surfaceflinger class core user system group graphics drmrpc onrestart restart zygote ä¸SurfaceFlingerç›¸å…³çš„æºç å­˜åœ¨äºframeworks\\native\\services\\surfaceflingerå…¥å£frameworks/native/services/surfaceflinger/main_surfaceflinger.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142#if defined(HAVE_PTHREADS)#include &lt;sys/resource.h&gt;#endif#include &lt;cutils/sched_policy.h&gt;#include &lt;binder/IServiceManager.h&gt;#include &lt;binder/IPCThreadState.h&gt;#include &lt;binder/ProcessState.h&gt;#include &lt;binder/IServiceManager.h&gt;#include \"SurfaceFlinger.h\"using namespace android;int main(int, char**) { // When SF is launched in its own process, limit the number of // binder threads to 4. ProcessState::self()-&gt;setThreadPoolMaxThreadCount(4); // start the thread pool sp&lt;ProcessState&gt; ps(ProcessState::self()); ps-&gt;startThreadPool(); // instantiate surfaceflinger sp&lt;SurfaceFlinger&gt; flinger = new SurfaceFlinger();#if defined(HAVE_PTHREADS) setpriority(PRIO_PROCESS, 0, PRIORITY_URGENT_DISPLAY);#endif set_sched_policy(0, SP_FOREGROUND); // initialize before clients can connect flinger-&gt;init();//å¼€æœºåŠ¨ç”»åœ¨è¿™é‡Œæ‰§è¡Œï¼Œæ¥ç€å¾€ä¸‹çœ‹ // publish surface flinger sp&lt;IServiceManager&gt; sm(defaultServiceManager()); sm-&gt;addService(String16(SurfaceFlinger::getServiceName()), flinger, false); // run in this thread flinger-&gt;run(); return 0;} frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp 1234567void SurfaceFlinger::init() { ALOGI( \"SurfaceFlinger's main thread ready to run. \" \"Initializing graphics H/W...\"); .... // start boot animation startBootAnim();} æ¥ç€æ‰§è¡ŒstartBootAnim(); 12345void SurfaceFlinger::startBootAnim() { // start boot animation property_set(\"service.bootanim.exit\", \"0\"); property_set(\"ctl.start\", \"bootanim\");} è¿™é‡Œé‡‡ç”¨çš„æ˜¯é€šè¿‡property_setä¸­â€ctl.startâ€çš„æ–¹å¼æ‰§è¡Œbootanim,è¿™é‡Œæ˜¯é€šè¿‡è®¾ç½®å±æ€§å€¼çš„æ–¹å¼æ¥å¯åŠ¨çš„ï¼Œå±æ€§å€¼çš„è®¾ç½®é‡‡ç”¨çš„æ˜¯C/Sæ¨¡å¼ï¼Œsocketè¿æ¥ï¼Œè¿™é‡Œä¸è¯¦è¿°ï¼Œå¤§è‡´è¯´ä¸‹ï¼Œè¿™è¡Œä»£ç ä¼šæ‰§è¡Œåˆ° system/core/init/property_service.c 123456789101112131415161718192021222324252627282930313233343536373839void handle_property_set_fd(){ ...... switch(msg.cmd) { case PROP_MSG_SETPROP: ...... //è¿™é‡Œå¾ˆå…³é”® if(memcmp(msg.name,\"ctl.\",4) == 0) { // Keep the old close-socket-early behavior when handling // ctl.* properties. close(s); if (check_control_mac_perms(msg.value, source_ctx)) { handle_control_message((char*) msg.name + 4, (char*) msg.value); } else { ERROR(\"sys_prop: Unable to %s service ctl [%s] uid:%d gid:%d pid:%d\\n\", msg.name + 4, msg.value, cr.uid, cr.gid, cr.pid); } //è¿™é‡Œå¾ˆå…³é”® } else { if (check_perms(msg.name, source_ctx)) { property_set((char*) msg.name, (char*) msg.value); } else { ERROR(\"sys_prop: permission denied uid:%d name:%s\\n\", cr.uid, msg.name); } // Note: bionic's property client code assumes that the // property server will not close the socket until *AFTER* // the property is written to memory. close(s); } freecon(source_ctx); break; default: close(s); break; }} æ¥ä¸‹æ¥æ‰§è¡Œåˆ°system/core/init/init.c 123456789101112void handle_control_message(const char *msg, const char *arg){ if (!strcmp(msg,\"start\")) { msg_start(arg);//å°±æ˜¯è¿™æ¡è·¯ } else if (!strcmp(msg,\"stop\")) { msg_stop(arg); } else if (!strcmp(msg,\"restart\")) { msg_restart(arg); } else { ERROR(\"unknown control msg '%s'\\n\", msg); }} æ¥ç€å¾€ä¸‹æ‰§è¡Œ 123456789101112131415161718192021222324252627static void msg_start(const char *name){ struct service *svc = NULL; char *tmp = NULL; char *args = NULL; if (!strchr(name, ':')) svc = service_find_by_name(name); else { tmp = strdup(name); if (tmp) { args = strchr(tmp, ':'); *args = '\\0'; args++; svc = service_find_by_name(tmp); } } if (svc) { service_start(svc, args); } else { ERROR(\"no such service '%s'\\n\", name); } if (tmp) free(tmp);} è¿™é‡Œæ‰¾åˆ°â€œbootanimâ€ç„¶åæ‰§è¡Œservice_startå‡½æ•°ï¼Œè¿™é‡Œå°±æ˜¯å¯åŠ¨bootanimçš„åœ°æ–¹ã€‚","link":"/2016/08/07/ã€ŠAndroid Framework ä¹‹è·¯ã€‹BootAnimationï¼ˆ1ï¼‰/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹å¤šçº¿ç¨‹","text":"å¤šçº¿ç¨‹ç¼–ç¨‹JAVAå¤šçº¿ç¨‹æ–¹å¼ ç»§æ‰¿Threadçº¿ç¨‹ï¼Œå®ç°runæ–¹æ³• å®ç°Runnableæ¥å£ JAVAå•ç»§æ‰¿æ€§ï¼Œå½“æˆ‘ä»¬æƒ³å°†ä¸€ä¸ªå·²ç»ç»§æ‰¿äº†å…¶ä»–ç±»çš„å­ç±»æ”¾åˆ°Threadä¸­æ—¶ï¼Œå•ç»§æ‰¿çš„å±€é™å°±ä½“ç°å‡ºæ¥äº†ä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œæ‰€ä»¥ç¬¬äºŒç§æ–¹æ³•ç›¸å¯¹äºç¬¬ä¸€ç§æ¥è¯´çµæ´»è®¸å¤šå…¶æ¬¡ï¼Œé€šè¿‡new Thread(Runnable runnable).start()å¯åŠ¨çº¿ç¨‹çš„æ–¹å¼ï¼Œè‹¥å˜é‡åœ¨runnableä¸­å®šä¹‰ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±ç”¨ï¼Œå› ä¸ºæ¥è‡ªåŒä¸€ä¸ªå¯¹è±¡æ¯”è¾ƒé€‚åˆå¤šä¸ªç›¸åŒç¨‹åºä»£ç çš„çº¿ç¨‹å»å¤„ç†åŒä¸€èµ„æºçš„æƒ…å†µ Androidå¤šçº¿ç¨‹æ–¹å¼ ä¸»è¦é›†ä¸­åœ¨UIçº¿ç¨‹å’Œå…¶ä»–çº¿ç¨‹çš„äº¤äº’é—®é¢˜ä¸Š Thread,Handler,Message AsyncTask Runnable ç¬¬ä¸€ç§æ–¹å¼ï¼Œnew Thread()ç„¶åé€šè¿‡Handler sendMessage,ç”±Handlerçš„handleMessageæ–¹æ³•å®ç°å¯¹åº”çš„å¤„ç†ï¼Œå®Œæˆä¸UIè¿›ç¨‹çš„äº¤äº’ 123456789101112131415private Handler mHandler = new Handler(){ public void handleMessage(Message msg) { /*do sth through msg */ }}public BadThread extends Thread { private final static String TAG = this.getClass().getName(); public void run() { /*coding*/ }};new BadThread().start(); ç¬¬äºŒç§æ–¹å¼ï¼Œå¼‚æ­¥çº¿ç¨‹çš„æ–¹å¼ï¼ŒdoInBackground()ä¸­æ‰§è¡Œä»»åŠ¡ï¼ŒonPreExecute()å‡†å¤‡å·¥ä½œï¼ŒonPostExecute()ä»»åŠ¡ç»“æŸåè°ƒç”¨ï¼ŒonProgressUpdateä¸publishProgressé…åˆä½¿ç”¨ï¼Œå®ç°å’ŒUIçº¿ç¨‹çš„äº¤äº’ 123456789AsyncTask mLoadingTask = new AsyncTask(){ protected Object doInBackground(Object[] objects) { } protected void onProgressUpdate(Object[] values) { } ......}mLoadingTask.execute(); ç¬¬ä¸‰ç§æ–¹å¼ï¼ŒRunnableå¯¹è±¡ï¼Œé€šè¿‡Handlerç›´æ¥Postç­‰æ–¹æ³•å¯åŠ¨çº¿ç¨‹ï¼Œå®ç°ä¸UIçº¿ç¨‹çš„äº¤äº’ 1234567private Runnable mRunnable = new Runnable(){ public void run() { /*do sth*/ }}mHandler.post(mRunnable);","link":"/2016/04/26/ã€ŠAndroid Framework ä¹‹è·¯ã€‹å¤šçº¿ç¨‹/"},{"title":"ã€ŠAndroid Studioã€‹ Android Studio é…ç½®Code Style","text":"æ­¥éª¤ä¸€ï¼šä¸‹è½½ ä¸‹è½½Squareçš„ä»£ç è§„èŒƒ git clone https://github.com/square/java-code-styles.git æ­¥éª¤äºŒï¼šå®‰è£… windows install.bat Macos/Linux install.sh çœ‹ä¸‹è„šæœ¬å†…å®¹ï¼šinstall.bat 12345678910111213141516171819202122REM Installs Square's IntelliJ configs into your user configs.@echo offecho Installing Square IntelliJ configs...setlocal enableDelayedExpansionfor /D %%i in (\"%userprofile%\"\\.AndroidStudio*) do call :copy_config \"%%i\"for /D %%i in (\"%userprofile%\"\\.IdeaIC*) do call :copy_config \"%%i\"for /D %%i in (\"%userprofile%\"\\.IntelliJIdea*) do call :copy_config \"%%i\"echo.echo Restart IntelliJ and/or AndroidStudio, go to preferences, and apply 'Square' or 'SquareAndroid'.exit /bREM sub function for copy config files:copy_configset config_dir=%~1\\configecho Installing to \"!config_dir!\"xcopy /s configs \"!config_dir!\"echo Done.echo.exit /b install.sh 123456789101112131415161718192021222324252627282930313233#!/bin/bash# Installs Square's IntelliJ configs into your user configs.echo \"Installing Square IntelliJ configs...\"CONFIGS=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" &amp;&amp; pwd )/configs\"for i in $HOME/Library/Preferences/IntelliJIdea* \\ $HOME/Library/Preferences/IdeaIC* \\ $HOME/Library/Preferences/AndroidStudio* \\ $HOME/.IntelliJIdea*/config \\ $HOME/.IdeaIC*/config \\ $HOME/.AndroidStudio*/configdo if [[ -d $i ]]; then # Install codestyles mkdir -p $i/codestyles cp -frv \"$CONFIGS/codestyles\"/* $i/codestyles # Install inspections mkdir -p $i/inspection cp -frv \"$CONFIGS/inspection\"/* $i/inspection # Install options (\"Exclude from Import and Completion\") mkdir -p $i/options cp -frv \"$CONFIGS/options\"/* $i/options fidoneecho \"Done.\"echo \"\"echo \"Restart IntelliJ and/or AndroidStudio, go to preferences, and apply 'Square' or 'SquareAndroid'.\" ä»ä»£ç ä¸Šçœ‹ï¼Œå’Œæ‰‹åŠ¨é…ç½®ä¸€æ ·ï¼Œä½†æ˜¯è„šæœ¬çš„æ‰§è¡Œæ•ˆç‡äº‹ä¸è¨€è€Œå–»çš„ã€‚æ‰§è¡Œå®Œæˆä¹‹åå¤§è‡´å°±æ˜¯å¦‚ä¸‹logï¼š æ­¥éª¤ä¸‰ï¼šé…ç½® Preference &gt; CodeStyle &gt; Java and then you can choose what you like ~ over!","link":"/2017/03/26/ã€ŠAndroid Studioã€‹ Android Studio é…ç½®Code Style/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰ åï¼‰ã€‹Fragment (3) ~ PreferenceFragment","text":"ç®€ä»‹ PreferenceFragment , å±•ç¤ºä¸€ç³»åˆ—çš„Preferenceæ¡ç›®å¹¶ä¸”å½“ä¸ç”¨æˆ·æœ‰äº¤äº’æ—¶ï¼Œäº§ç”Ÿçš„å€¼ä¼šè‡ªåŠ¨ä¿å­˜åˆ°SharedPreferencesä¸­ï¼Œé€šè¿‡PreferenceManager#getDefaultSharedPreferences(android.content.Context)å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„SharedPreferencesçš„å€¼ã€‚å±•ç¤ºçš„Preferencesçš„é£æ ¼ä¼šéšç€ç³»ç»Ÿè€Œæ”¹å˜ï¼Œé€šè¿‡XMLæ–‡ä»¶å¯ä»¥å¿«é€Ÿçš„åˆ›å»ºPreferencesï¼Œå®˜æ–¹æ¨èä½¿ç”¨Fragmentæ¥å®ç°è¿™ç±»åŠŸèƒ½ã€‚ åˆ›å»ºXML Tag æ„ä¹‰ PreferenceScreen å¿…é¡»ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œä»£è¡¨æ•´ä¸ªPreferenceså±å¹• PreferenceCategory ä¸€ç»„Preferences,ä¾¿äºåˆ†ç±» SwitchPreference ä¸¤ç§çŠ¶æ€çš„preference,å¼€å…³ ListPreference åˆ—è¡¨æ˜¾ç¤ºPreference, android:entriesè®¾ç½®çš„å†…å®¹æ˜¯æˆ‘ä»¬åœ¨è®¾ç½®æ—¶çœ‹åˆ°çš„å†…å®¹ï¼Œè€Œandroid:entryValueså°±æ˜¯ä¿å­˜åœ¨preferences.xmlä¸­çš„å€¼ CheckBoxPreference å¤é€‰æ¡†Preferenceï¼Œå‹¾é€‰å’Œä¸å‹¾é€‰ RingtonePreference Ringtoneé€‰æ‹©Preference EditTextPreference ç¼–è¾‘ç±»Preference MultiSelectListPreference å¤šé€‰ç±»Preference å¸¸ç”¨å±æ€§ å±æ€§ ç”¨æ³• android:title æ ‡é¢˜ android:defaultValue é»˜è®¤å€¼ android:key SharedPreferenceä¸­ä¿å­˜å€¼æ—¶ä½¿ç”¨çš„Keyå€¼ android:entries åˆ—è¡¨æˆ–è€…å¤šé€‰æ¡†çš„æ˜¾ç¤ºå†…å®¹ android:entryValues åˆ—è¡¨æˆ–è€…å¤šé€‰æ¡†ä¿å­˜è¿‡ç¨‹ä¸­å¯¹åº”çš„å€¼ ä»£ç ä½¿ç”¨XMLæ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;PreferenceScreen xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;PreferenceCategory android:title=\"æ— çº¿å’Œç½‘ç»œ\"&gt; &lt;SwitchPreference android:defaultValue=\"false\" android:title=\"WLAN\" android:key=\"switch_preference_wlan\" /&gt; &lt;SwitchPreference android:defaultValue=\"false\" android:title=\"è“ç‰™\" android:key=\"switch_preference_bluetooth\" /&gt; &lt;ListPreference android:defaultValue=\"1\" android:title=\"ä¼‘çœ \" android:entries=\"@array/pref_sleep_interval\" android:entryValues=\"@array/pref_sleep_interval\" android:key=\"list_preference_sleep\" /&gt; &lt;/PreferenceCategory&gt; &lt;PreferenceCategory android:title=\"è®¾å¤‡\" android:persistent=\"false\" android:orderingFromXml=\"false\"&gt; &lt;CheckBoxPreference android:defaultValue=\"false\" android:title=\"é™éŸ³\" android:key=\"check_box_preference_virate\" /&gt; &lt;RingtonePreference android:defaultValue=\"\" android:title=\"é“ƒå£°\" android:key=\"ringtone_preference_ringtone\" /&gt; &lt;/PreferenceCategory&gt; &lt;PreferenceCategory android:title=\"éšç§å’Œå®‰å…¨\"&gt; &lt;EditTextPreference android:defaultValue=\"Default value\" android:selectAllOnFocus=\"true\" android:singleLine=\"true\" android:title=\"è®¾å¤‡åç§°\" android:key=\"edit_text_preference_devicename\" /&gt; &lt;MultiSelectListPreference android:title=\"è¾…åŠ©åŠŸèƒ½\" android:defaultValue=\"@array/pref_assit_function\" android:entries=\"@array/pref_assit_function\" android:entryValues=\"@array/pref_assit_function\" android:key=\"multi_select_list_preference_assit\" /&gt; &lt;/PreferenceCategory&gt;&lt;/PreferenceScreen&gt; arrays.xmlæ–‡ä»¶12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources&gt; &lt;array name=\"pref_sleep_interval\"&gt; &lt;item&gt;30ç§’&lt;/item&gt; &lt;item&gt;1åˆ†é’Ÿ&lt;/item&gt; &lt;item&gt;2åˆ†é’Ÿ&lt;/item&gt; &lt;item&gt;5åˆ†é’Ÿ&lt;/item&gt; &lt;item&gt;10åˆ†é’Ÿ&lt;/item&gt; &lt;item&gt;30åˆ†é’Ÿ&lt;/item&gt; &lt;/array&gt; &lt;array name=\"pref_assit_function\"&gt; &lt;item&gt;çµçŠ€ä¸€æŒ‡&lt;/item&gt; &lt;item&gt;æŒ‡å…³èŠ‚æˆªå±&lt;/item&gt; &lt;item&gt;é€šè¯å½•éŸ³&lt;/item&gt; &lt;item&gt;ç™½ç§‘æŠ€&lt;/item&gt; &lt;item&gt;é»‘ç§‘æŠ€&lt;/item&gt; &lt;/array&gt;&lt;/resources&gt; è‡ªå®šä¹‰PreferenceFragment PreferenceFragmentæ˜¯æŠ½è±¡ç±»ï¼Œéœ€è¦è‡ªå·±å®ç° 1234567891011121314public class BaseFragment extends PreferenceFragment { @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); addPreferencesFromResource(R.xml.prefs); } @Override public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen, Preference preference) { Toast.makeText(getActivity(), preference.toString() + \" is Clicked\", Toast.LENGTH_LONG).show(); return super.onPreferenceTreeClick(preferenceScreen, preference); }} Activityä¸­ä½¿ç”¨12345BaseFragment baseFragment = new BaseFragment();FragmentManager fm = getFragmentManager();FragmentTransaction transaction = fm.beginTransaction();transaction.replace(xxxxxx,baseFragment);transaction.commit(); ç»“æœ SharedPreferenceç»“æœ&lt;ä¸­æ–‡ä¹±ç æ˜¯ç³»ç»Ÿé—®é¢˜&gt;","link":"/2016/11/18/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰ åï¼‰ã€‹Fragment (3) ~ PreferenceFragment/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¸ƒï¼‰ã€‹ è‡ªå®šä¹‰ViewPagerIndicator","text":"ç®€ä»‹å­¦ä¹ Androidï¼Œè‡ªå®šä¹‰Viewä¸å¯é¿å…ï¼Œä¹‹å‰ä¸€ç›´å¿½è§†è¿™å—å†…å®¹ï¼Œç°åœ¨å¼€å§‹å­¦ï¼Œåº”è¯¥ä¸ç®—å¤ªæ™šã€‚ä»å¸¸è§çš„ViewPagerIndicatorå¼€å§‹ï¼Œå½“ç„¶ï¼Œä¸‡èƒ½çš„Githubä¸ŠåŒ…ç½—ä¸‡è±¡ï¼Œå¥½ç”¨çš„indicatorä¹Ÿæ˜¯ä¸èƒœæšä¸¾ï¼Œæ—¨åœ¨å­¦ä¹ è‡ªå®šä¹‰Viewçš„ä¸€èˆ¬æ“ä½œè¿‡ç¨‹ã€‚ æ€è·¯ åšä¸€ä¸ªç®€å•çš„ViewPagerIndicatorï¼Œåªæ”¯æŒå¹³å‡å¤§å°çš„TextViewï¼Œæ”¯æŒç‚¹ï¼ŒçŸ©å½¢å’Œä¸‰è§’å½¢ã€‚ ä½¿ç”¨LinearLayoutä½œä¸ºçˆ¶ç±»ï¼› å®šä¹‰indicatorçš„é¢œè‰²ï¼Œé«˜åº¦å’ŒåŠå¾„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰å…¶ä»–çš„å±æ€§ï¼› ä½¿ç”¨åˆ°Pathï¼ŒPaintï¼ŒCanvasç­‰å›¾å½¢ç»˜åˆ¶çš„å†…å®¹ï¼› ä½¿ç”¨Kotlin å®ç°åœ†å½¢indicatorå®šä¹‰è‡ªå®šä¹‰å±æ€§styles.xml 123456&lt;attr name=\"y_indicator_color\" format=\"color\"/&gt;&lt;attr name=\"y_indicator_radius\" format=\"dimension\"/&gt;&lt;declare-styleable name=\"YVPDotIndicator\"&gt; &lt;attr name=\"y_indicator_color\"/&gt; &lt;attr name=\"y_indicator_radius\"/&gt;&lt;/declare-styleable&gt; ä»£ç å®ç° é€šè¿‡è®¾ç½®ViewPagerï¼Œç„¶åä»Adapterçš„getPageTitleæ–¹æ³•è·å–TextViewçš„æ˜¾ç¤ºå†…å®¹ï¼Œç„¶åæ·»åŠ æ ‡ç­¾ï¼Œç„¶åç»˜åˆ¶åœ†å½¢æŒ‡ç¤ºå™¨ï¼Œé€šè¿‡ViewPagerçš„æ»‘åŠ¨å›è°ƒæ–¹æ³•ï¼Œè®¾ç½®åœ†å½¢æŒ‡ç¤ºå™¨çš„ä½ç½®ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117class YVPDotIndicator : LinearLayout { private var mStartPos: Float = 0.0F//indicatorå¼€å§‹ä½ç½® private var mWidthOffset: Int = 0//åˆå§‹offset private var mPaint: Paint? = null private var mIndicatorColor = Color.parseColor(\"#FFFFFF\")//indicatoré¢œè‰² private var mIndicatorRadius = 2//åœ†å½¢indicatoråŠå¾„ private var mVp: ViewPager? = null private var pageListener = InterPageChangeListener() private var mTabCount: Int? = 0 private var mTabWidth: Float? = 0.0F private val defaultLayoutParams = LinearLayout.LayoutParams(0, LayoutParams.MATCH_PARENT, 1.0f) constructor(context: Context, attrs: AttributeSet) : this(context, attrs, 0) constructor(context: Context, attrs: AttributeSet, defStyle: Int) : super(context, attrs, defStyle) { setWillNotDraw(false) val dm = resources.displayMetrics val a = context.theme.obtainStyledAttributes(attrs, R.styleable.YVPDotIndicator, defStyle, 0) mIndicatorRadius = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, mIndicatorRadius.toFloat(), dm).toInt() mIndicatorColor = a.getColor(R.styleable.YVPDotIndicator_y_indicator_color, Color.parseColor(\"#FFFFFF\")) mIndicatorRadius = a.getDimensionPixelSize(R.styleable.YVPDotIndicator_y_indicator_radius, 2) a.recycle() initPaint() } /** * è®¾ç½®ViewPager */ fun setViewPager(vp: ViewPager) { mVp = vp if (vp.adapter == null) { throw IllegalArgumentException() } notifyDataSetChanged() mVp?.addOnPageChangeListener(pageListener) } fun notifyDataSetChanged() { this.removeAllViews() mTabCount = mVp?.adapter?.count for (i in 0..mTabCount?.let { it - 1 } as Int) { addTextTab(i, mVp?.adapter?.getPageTitle(i).toString()) } } fun addTextTab(position: Int, title: String) { var tab = TextView(context) tab.text = title tab.gravity = Gravity.CENTER tab.setSingleLine() tab.isFocusable = true tab.setOnClickListener { mVp?.currentItem = position } this.addView(tab, position, defaultLayoutParams) } /** * åˆå§‹åŒ–ç”»ç¬” */ private fun initPaint() { mPaint = Paint() mPaint?.color = mIndicatorColor mPaint?.isAntiAlias = true mPaint?.style = Paint.Style.FILL } override fun onSizeChanged(w: Int, h: Int, oldw: Int, oldh: Int) { super.onSizeChanged(w, h, oldw, oldh) mTabWidth = (w / childCount).toFloat() mStartPos = mTabWidth?.let { it/2 } as Float } override fun dispatchDraw(canvas: Canvas?) { canvas?.save() canvas?.translate(0.0F, height.toFloat()) canvas?.drawCircle(mStartPos + mWidthOffset, -mIndicatorRadius.toFloat(), mIndicatorRadius.toFloat(), mPaint) canvas?.restore() super.dispatchDraw(canvas) } inner class InterPageChangeListener: ViewPager.OnPageChangeListener { override fun onPageScrollStateChanged(state: Int) { } override fun onPageSelected(position: Int) { } override fun onPageScrolled(position: Int, positionOffset: Float, positionOffsetPixels: Int) { val tabWidth = screenWidth / childCount mWidthOffset = (tabWidth * position + tabWidth * positionOffset).toInt() invalidate() } } /** * è·å–å±å¹•å®½åº¦ * @return */ private val screenWidth: Int get() { val windowManager = context.getSystemService(Context.WINDOW_SERVICE) as WindowManager val displayMetrics = DisplayMetrics() windowManager.defaultDisplay.getMetrics(displayMetrics) return displayMetrics.widthPixels }} å…¶ä»–Indicator ç±»ä¼¼çš„çŸ©å½¢æŒ‡ç¤ºå™¨å’Œä¸‰è§’å½¢æŒ‡ç¤ºå™¨ï¼Œå‡å¯æŒ‰ç…§ä¸Šé¢çš„æ–¹å¼å®ç°ã€‚ å…·ä½“æ•ˆæœ ç¤ºä¾‹æºç YVPIndicator","link":"/2017/07/28/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¸ƒï¼‰ã€‹ è‡ªå®šä¹‰ViewPagerIndicator/"},{"title":"ã€ŠAndroid HAL ä¹‹è·¯ã€‹ HAL ç®€ä»‹","text":"HALå±‚æ¦‚è¿° åç§°ï¼š HALï¼Œ Hardware Abstracting Layerï¼Œä¸­æ–‡åå­—ï¼šç¡¬ä»¶æŠ½è±¡å±‚ã€‚ ä½œç”¨ï¼šå¯¹Linuxå†…æ ¸é©±åŠ¨ç¨‹åºçš„å°è£…ï¼Œå‘ä¸Šæä¾›æ¥å£ï¼Œå±è”½ä½å±‚çš„å®ç°ç»†èŠ‚ã€‚å‘ä¸Šè¡”æ¥Android Runtimeå’ŒFrameworkï¼Œå‘ä¸‹è¡”æ¥é©±åŠ¨ç¨‹åº äº§ç”ŸåŸå› ï¼šåˆ©ç›Šï¼Œç«äº‰ Androidä»£ç ç»“æ„ä¸­ï¼ŒHALå±‚çš„å†…å®¹ä¸»è¦é›†ä¸­åœ¨Hardwareç›®å½•ä¸­ï¼Œç»“åˆä¹‹å‰è®²è§£Cameraæ¨¡å—çš„æ—¶å€™æåˆ°çš„ system/lib/hw/camera.$(TARGET_BOARD_PLATFORM).so HALå±‚çš„å†…å®¹é›†æˆåœ¨åŠ¨æ€åº“ä¸­ï¼Œç„¶åCameraServiceé€šè¿‡è¿™ä¸ªSoè®¿é—®å…¶ä¸­çš„å†…å®¹ã€‚ å¦‚ä½•è®¿é—® void CameraService::onFirstRef() hw_get_module(CAMERA_HARDWARE_MODULE_ID, (const hw_module_t **)&amp;rawModule) æ¯ä¸€ä¸ªç‹¬ç«‹çš„HALå±‚çš„soï¼Œæœ‰ä¸€ä¸ªä¸å…¶å¯¹åº”çš„Id #define CAMERA_HARDWARE_MODULE_ID â€œcameraâ€ å®šä¹‰åœ¨hardware/libhardware/include/hardware/camera_common.h åˆæˆ–è€… system/lib/hw/audio.primary.$(TARGET_BOARD_PLATFORM) frameworks/av/services/audioflinger/AudioFlinger.cpp rc = hw_get_module_by_class(AUDIO_HARDWARE_MODULE_ID, if_name, &amp;mod); #define AUDIO_HARDWARE_MODULE_ID â€œaudioâ€ å®šä¹‰åœ¨ hardware/libhardware/include/hardware/audio.h å½“ç„¶è¿™é‡Œåªæ˜¯ä¸¾ä¸ªä¾‹å­ï¼ŒAudioéœ€è¦åŠ è½½çš„æ¨¡å—ä¸æ­¢è¿™ä¸€ä¸ªã€‚ åŸºæœ¬ä¸Šæ¯ä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªSoï¼Œå‘½åæ–¹å¼ä¹Ÿæ˜¯æ¯”è¾ƒç›¸ä¼¼ï¼Œxxx.$(TARGET_BOARD_PLATFORM),å­˜æ”¾è·¯å¾„ system/lib/hw system/lib64/hw hw_get_module -&gt;hw_get_module_by_class å®šä¹‰åœ¨hardware/libhardware/include/hardware/hardware.h å®ç°åœ¨hardware/libhardware/hardware.c 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950int hw_get_module(const char *id, const struct hw_module_t **module){ return hw_get_module_by_class(id, NULL, module);}â€¦â€¦int hw_get_module_by_class(const char *class_id, const char *inst, const struct hw_module_t **module){ int i = 0; char prop[PATH_MAX] = {0}; char path[PATH_MAX] = {0}; char name[PATH_MAX] = {0}; char prop_name[PATH_MAX] = {0}; if (inst)//å¦‚æœinstä¸ä¸ºç©ºï¼Œname= class_id.inst snprintf(name, PATH_MAX, \"%s.%s\", class_id, inst); else //å¦‚æœä¸ºç©ºçš„è¯ï¼Œname = class_id strlcpy(name, class_id, PATH_MAX); //åˆ¤æ–­æ˜¯å¦æœ‰é…ç½®é¡¹å®šä¹‰äº†å¯¹åº”çš„Halå±‚ snprintf(prop_name, sizeof(prop_name), \"ro.hardware.%s\", name); if (property_get(prop_name, prop, NULL) &gt; 0) { if (hw_module_exists(path, sizeof(path), name, prop) == 0) {//è‹¥å­˜åœ¨åˆ™è·³è½¬ goto found; } } //å¾ªç¯æŸ¥æ‰¾ro.hardwareï¼Œro.product.boardï¼Œro.board.platformï¼Œro.arch for (i=0 ; i&lt;HAL_VARIANT_KEYS_COUNT; i++) { if (property_get(variant_keys[i], prop, NULL) == 0) { continue; } if (hw_module_exists(path, sizeof(path), name, prop) == 0) { goto found; } } /* Nothing found, try the default */ if (hw_module_exists(path, sizeof(path), name, \"default\") == 0) { goto found; } return -ENOENT;found: /* load the module, if this fails, we're doomed, and we should not try * to load a different variant. */ return load(class_id, path, module);} å†çœ‹çœ‹hw_module_existsè¿™ä¸ªæ–¹æ³• 12345678910111213141516static int hw_module_exists(char *path, size_t path_len, const char *name, const char *subname){ //æ‹¼å‡‘HAL soåº“çš„åå­— /vendor/lib/hw/name.subname.soæˆ–è€…/vendor/lib64/hw/name.subname.so snprintf(path, path_len, \"%s/%s.%s.so\", HAL_LIBRARY_PATH2, name, subname); if (access(path, R_OK) == 0) return 0; //æ‹¼å‡‘HAL soåº“çš„åå­— /system/lib/hw/name.subname.soæˆ–è€…/system/lib64/hw/name.subname.so snprintf(path, path_len, \"%s/%s.%s.so\", HAL_LIBRARY_PATH1, name, subname); if (access(path, R_OK) == 0) return 0; return -ENOENT;} ä»¥audioå…¶ä¸­çš„ä¸€ä¸ªsoä¸ºä¾‹ï¼Œåœ¨æºç ä¸­æ‰¾ä¸€ä¸ªèŠ¯ç‰‡å¹³å°é«˜é€šmsm8974 system/lib/hw/audio.primary.msm8974.so é¡ºç€ä»¥ä¸Šçš„ä»£ç å¾ˆå¥½ç†è§£ï¼Œå½“ç„¶è¿™ä¸ªmsm8974å¿…ç„¶æ˜¯å¯ä»¥ç”¨è¿‡å¾ªç¯çš„é‚£å‡ ä¸ªé…ç½®é¡¹å…¶ä¸­çš„ä¸€ä¸ªè·å–ï¼Œå¦åˆ™å°±æ˜¯ system/lib/hw/audio.promary.default.so å¦‚ä½•åŠ è½½ ä»¥ä¸Šä»£ç è·³è½¬åˆ°foundä¹‹å return load(class_id, path, module); 12345678910111213141516171819static int load(const char *id, const char *path, const struct hw_module_t **pHmi){ â€¦â€¦ //æ‰“å¼€so,è·å–å¥æŸ„ handle = dlopen(path, RTLD_NOW); â€¦â€¦ /* Get the address of the struct hal_module_info. */ //è·å–åœ°å€ç©ºé—´çš„å…¥å£ const char *sym = HAL_MODULE_INFO_SYM_AS_STR; hmi = (struct hw_module_t *)dlsym(handle, sym); â€¦â€¦ â€¦â€¦ hmi-&gt;dso = handle; â€¦â€¦ *pHmi = hmi; //èµ‹å€¼ç»™ä¼ å…¥å‚æ•° â€¦â€¦} æœ€åä¸Šå±‚æ‹¿åˆ°çš„å°±æ˜¯hw_module_t * ç„¶åé€šè¿‡è¿™ä¸ªå…¥å£æ“ä½œåº“ä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªHALæ¨¡å—åœ¨å®šä¹‰è‡ªå·±çš„ç»“æ„çš„æ—¶å€™ä¹Ÿæ˜¯éœ€è¦æŒ‰ç…§ä¸€å®šçš„è§„èŒƒæ¥æ‰§è¡Œã€‚è¿™ä¸ªç•™ç€æ˜å¤©å†å†™å§â€¦â€¦","link":"/2016/04/20/ã€ŠAndroid HAL ä¹‹è·¯ã€‹ HAL ç®€ä»‹/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åäºŒï¼‰ã€‹ ViewFlipper","text":"ç®€ä»‹ View Flipperï¼Œæ˜¯ViewAnimatorçš„å­ç±»ï¼Œè€ŒViewAnimatoråˆæ˜¯ç»§æ‰¿è‡ªFrameLayoutï¼Œè€ŒFrameLayoutå°±æ˜¯å¹³æ—¶åŸºæœ¬ä¸Šåªæ˜¾ç¤ºä¸€ä¸ªå­è§†å›¾çš„å¸ƒå±€ï¼Œç”±äºFrameLayoutä¸‹ä¸å¥½ç¡®å®šå­è§†å›¾çš„ä½ç½®ï¼Œæ‰€ä»¥å¾ˆå¤šæƒ…å†µä¸‹å­è§†å›¾ä¹‹å‰å­˜åœ¨ç›¸äº’é®æŒ¡ï¼Œè¿™æ ·å°±é€ æˆäº†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬åŸºæœ¬ä¸Šåªè¦æ±‚FrameLayoutæ˜¾ç¤ºä¸€ä¸ªå­è§†å›¾ï¼Œç„¶åé€šè¿‡æŸäº›æ§åˆ¶æ¥å®ç°åˆ‡æ¢ã€‚æ­£å¥½ï¼ŒViewFlipperå¸®æˆ‘ä»¬å®ç°äº†è¿™ä¸ªå·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ï¼Œé€‰æ‹©æ°å½“çš„æ—¶æœºè°ƒç”¨å…¶æ°å½“çš„æ–¹æ³•å³å¯ ç±»ç»“æ„ æ–¹æ³• æ„ä¹‰ startFlipping å¼€å§‹æµè§ˆ stopFlipping åœæ­¢æµè§ˆ setFlipInterval è®¾ç½®Viewä¹‹é—´åˆ‡æ¢çš„æ—¶é—´é—´éš” getAccessibilityClassName è·å–ç±»åç§° isFlipping åˆ¤æ–­æ˜¯å¦æ­£åœ¨æµè§ˆ setAutoStart è®¾ç½®æ˜¯å¦è‡ªåŠ¨å¼€å§‹æµè§ˆ isAutoStart åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªåŠ¨å¼€å§‹æµè§ˆ åŸºæœ¬ä½¿ç”¨åŠ¨ç”»å®šä¹‰scalein.xml 12345678910111213&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;scale android:duration=\"1000\" android:fromXScale=\"0.2\" android:fromYScale=\"0.2\" android:toYScale=\"1\" android:toXScale=\"1\" android:pivotX=\"50%\" android:pivotY=\"50%\" &gt; &lt;/scale&gt;&lt;/set&gt; scaleout.xml 123456789101112&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;scale android:duration=\"1000\" android:fromXScale=\"1\" android:fromYScale=\"1\" android:toYScale=\"0.2\" android:toXScale=\"0.2\" android:pivotX=\"50%\" android:pivotY=\"50%\"&gt; &lt;/scale&gt;&lt;/set&gt; å¸ƒå±€æ–‡ä»¶activity_main.xml 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/activity_main\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" tools:context=\"jzfp.gs.com.animationdemo.MainActivity\"&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" android:background=\"@color/colorPrimary\"&gt;&lt;/android.support.v7.widget.Toolbar&gt; &lt;ï¼--æ¸å…¥åŠ¨ç”» å’Œ æ¸å‡ºåŠ¨ç”»å®šä¹‰--&gt; &lt;ViewFlipper android:id=\"@+id/vf\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:inAnimation=\"@anim/scalein\" android:outAnimation=\"@anim/scaleout\"&gt; &lt;ImageView android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@mipmap/one\" /&gt; &lt;ImageView android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@mipmap/two\" /&gt; &lt;ImageView android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@mipmap/three\" /&gt; &lt;/ViewFlipper&gt;&lt;/LinearLayout&gt; å·¦å³æ»‘åŠ¨åˆ‡æ¢123456789101112131415161718192021222324252627282930313233343536public class MainActivity extends AppCompatActivity { private ViewFlipper viewFlipper = null; float PosX = 0, CurrentX = 0; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); toolbar.setNavigationIcon(R.drawable.left); setSupportActionBar(toolbar);//è®¾ç½®ActionBar viewFlipper = (ViewFlipper) findViewById(R.id.vf); } @Override public boolean onTouchEvent(MotionEvent event) { switch (event.getAction()) { case MotionEvent.ACTION_DOWN: PosX = event.getX(); break; case MotionEvent.ACTION_MOVE: CurrentX = event.getX(); break; case MotionEvent.ACTION_UP: if (CurrentX - PosX &gt; 25.0) {//å‘å³æ»‘åŠ¨åˆ‡æ¢åˆ°ä¸Šä¸€é¡µ viewFlipper.showPrevious(); } else if (CurrentX - PosX &lt; -25.0) {//å‘å·¦æ»‘åŠ¨ï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€é¡µ viewFlipper.showNext(); } } return true; }} å®é™…æ•ˆæœ","link":"/2016/11/28/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åäºŒï¼‰ã€‹ ViewFlipper/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åå…­ï¼‰ã€‹ Spinner","text":"ç®€ä»‹å¾®è°ƒæ¡†æä¾›ä¸€ç§æ–¹æ³•ï¼Œè®©ç”¨æˆ·å¯ä»¥ä»å€¼é›†ä¸­å¿«é€Ÿé€‰æ‹©ä¸€ä¸ªå€¼ã€‚é»˜è®¤çŠ¶æ€ä¸‹ï¼Œå¾®è°ƒæ¡†æ˜¾ç¤ºå…¶å½“å‰æ‰€é€‰çš„å€¼ã€‚ è§¦æ‘¸å¾®è°ƒæ¡†å¯æ˜¾ç¤ºä¸‹æ‹‰èœå•ï¼Œå…¶ä¸­åˆ—æœ‰æ‰€æœ‰å…¶ä»–å¯ç”¨å€¼ï¼Œç”¨æˆ·å¯ä»ä¸­é€‰æ‹©ä¸€ä¸ªæ–°å€¼ã€‚ ä½¿ç”¨æ–¹æ³•1234&lt;Spinner android:id=\"@+id/planets_spinner\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" /&gt; å±æ€§å€¼ XMLå±æ€§å€¼ å«ä¹‰ android:dropDownHorizontalOffset ä¸‹æ‹‰æ¡†æ¨ªå‘åç§»é‡ android:dropDownSelector ä¸‹æ‹‰åˆ—è¡¨è¢«é€‰ä¸­è¡ŒèƒŒæ™¯ android:dropDownVerticalOffset ä¸‹æ‹‰åˆ—è¡¨çš„çºµå‘åç§»é‡,ç›¸å¯¹äºspinneræ§ä»¶ android:dropDownWidth ä¸‹æ‹‰åˆ—è¡¨å­é¡¹å®½åº¦ android:gravity é€‰ä¸­é¡¹çš„ä½ç½®æ‘†æ”¾ android:popupBackground ä¸‹æ‹‰åˆ—è¡¨èƒŒæ™¯ android:prompt å¼¹å‡ºå¯¹è¯æ¡†çš„æ ‡é¢˜ï¼Œåªèƒ½ä½¿ç”¨å­—ç¬¦ä¸²å¼•ç”¨ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²,â€dialogâ€æ¨¡å¼ä¸‹å¯ç”¨ android:spinnerMode â€œspinnerâ€,â€œdialogâ€ ä¸¤ç§æ¨¡å¼ android:entries æ˜¾ç¤ºå¯é€‰æ•°æ®æº,â€@array/xxxâ€,è¿™ä¸ªå±æ€§ç»§æ‰¿è‡ªAbsSpinner æ³¨æ„ï¼š android:dropDownHorizontalOffsetä½¿ç”¨è¿‡ç¨‹ä¸­æ²¡æœ‰ä»»ä½•æ•ˆæœ, Google Issueè·Ÿè¸ª https://code.google.com/p/android/issues/detail?id=70754 ä¸»è¦æ–¹æ³• ä¸¤ç§æ¨¡å¼ç®€å•ä½¿ç”¨Spinner1234567891011121314151617181920212223&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/container\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;Spinner android:id=\"@+id/sp\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"20dp\" android:dropDownSelector=\"@color/colorPrimaryDark\" android:dropDownVerticalOffset=\"50dp\" android:dropDownWidth=\"200dp\" android:entries=\"@array/fruit\" android:gravity=\"center_horizontal\" android:popupBackground=\"@color/colorAccent\" android:spinnerMode=\"dropdown\" /&gt;&lt;/LinearLayout&gt; Dialog123456789101112131415161718&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:id=\"@+id/container\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;Spinner android:id=\"@+id/sp\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"20dp\" android:entries=\"@array/fruit\" android:prompt=\"@string/app_name\" android:spinnerMode=\"dialog\" /&gt;&lt;/LinearLayout&gt; æ•°æ®å¡«å……çœ‹ä¸‹å½“æˆ‘ä»¬è®¾ç½®â€android:entriesâ€ï¼Œç³»ç»Ÿæ˜¯å¦‚ä½•å¸®æˆ‘å¤„ç†æ•°æ®çš„ã€‚Spinnerç»§æ‰¿AbsSpinner, android:entrieså±æ€§ä¹Ÿæ˜¯ä»å…¶ç»§æ‰¿è¿‡æ¥ã€‚ 123456789101112131415161718public AbsSpinner(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) { super(context, attrs, defStyleAttr, defStyleRes); initAbsSpinner(); final TypedArray a = context.obtainStyledAttributes( attrs, R.styleable.AbsSpinner, defStyleAttr, defStyleRes); //è·å–entrieå¯¹åº”çš„å­—ç¬¦ä¸²æ•°ç»„ final CharSequence[] entries = a.getTextArray(R.styleable.AbsSpinner_entries); if (entries != null) { //æ„å»º ArrayAdapter,ä½¿ç”¨é»˜è®¤å¸ƒå±€ final ArrayAdapter&lt;CharSequence&gt; adapter = new ArrayAdapter&lt;CharSequence&gt;( context, R.layout.simple_spinner_item, entries); //è®¾ç½®ä¸‹æ‹‰åˆ—è¡¨å­é¡¹çš„å¸ƒå±€ adapter.setDropDownViewResource(R.layout.simple_spinner_dropdown_item); // å’ŒSpinnerç»‘å®š setAdapter(adapter); } a.recycle(); } å€˜è‹¥æˆ‘ä»¬ä¸ä½¿ç”¨â€android:entriesâ€å±æ€§ï¼Œä¾ç„¶å¯ä»¥ä½¿ç”¨ç®€æ´çš„ä»£ç æ¥å®ç°ä»¥ä¸Šæ•ˆæœï¼š 123456Spinner mSp = (Spinner)findViewById(R.id.sp);ArrayAdapter&lt;CharSequence&gt; adapter = ArrayAdapter.createFromResource(this,R.array.fruit, android.R.layout.simple_spinner_item); adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);mSp.setAdapter(adapter); ä»ä»£ç ä¸Šçœ‹å’Œç³»ç»Ÿå¸®æˆ‘ä»¬å®Œæˆçš„å†…å®¹ç›¸ä¼¼ï¼Œåªæ˜¯è·å–å­—ç¬¦ä¸²æ•°ç»„çš„æ–¹å¼ä¸ä¸€æ ·äº†è€Œå·²ã€‚createFromResource() æ–¹æ³•å…è®¸ä»å­—ç¬¦ä¸²æ•°ç»„åˆ›å»º ArrayAdapterã€‚ æ­¤æ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¸ƒå±€èµ„æºï¼Œå…¶å®šä¹‰æ‰€é€‰é€‰æ‹©å¦‚ä½•æ˜¾ç¤ºåœ¨å¾®è°ƒæ¡†æ§ä»¶ä¸­ã€‚ simple_spinner_item å¸ƒå±€ç”±å¹³å°æä¾›ï¼Œæ˜¯é»˜è®¤å¸ƒå±€ï¼Œé™¤éæ‚¨æƒ³ä¸ºå¾®è°ƒæ¡†å¤–è§‚å®šä¹‰è‡ªå·±çš„å¸ƒå±€ï¼Œå¦åˆ™åº”ä½¿ç”¨æ­¤å¸ƒå±€ã€‚ ç„¶åï¼Œåº”è°ƒç”¨ setDropDownViewResource(int) æŒ‡å®šé€‚é…å™¨åº”ç”¨äºæ˜¾ç¤ºå¾®è°ƒæ¡†é€‰æ‹©åˆ—è¡¨çš„å¸ƒå±€ï¼ˆsimple_spinner_dropdown_item æ˜¯å¹³å°å®šä¹‰çš„å¦ä¸€æ ‡å‡†å¸ƒå±€ï¼‰ã€‚è°ƒç”¨ setAdapter() ä»¥å°†é€‚é…å™¨åº”ç”¨åˆ° Spinnerã€‚ä¸ºå¾®è°ƒæ¡†æä¾›çš„é€‰æ‹©å¯æ¥è‡ªä»»ä½•æ¥æºï¼Œä½†å¿…é¡»é€šè¿‡ SpinnerAdapter æ¥æä¾›ï¼Œä¾‹å¦‚ï¼Œå¦‚æœé€‰æ‹©å¯é€šè¿‡æ•°ç»„è·å–ï¼Œåˆ™é€šè¿‡ ArrayAdapterï¼‰æ¥æä¾›ï¼Œå¦‚æœé€‰æ‹©å¯é€šè¿‡æ•°æ®åº“æŸ¥è¯¢è·å–ï¼Œåˆ™é€šè¿‡ CursorAdapter æ¥æä¾›ã€‚ ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰çš„åœ°æ–¹è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œæ¯”å¦‚è¯´ä¸¤ä¸ªå¸ƒå±€ï¼šandroid.R.layout.simple_spinner_itemandroid.R.layout.simple_spinner_dropdown_itemæˆ‘ä»¬å¯ä»¥æ›¿æ¢æˆè‡ªå·±çš„å¸ƒå±€ï¼Œå®ç°ä¸€äº›è‡ªå®šä¹‰çš„æ•ˆæœ å“åº”ç”¨æˆ·é€‰æ‹© å½“ç”¨æˆ·ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ä¸€ä¸ªé¡¹ç›®æ—¶ï¼ŒSpinner å¯¹è±¡ä¼šæ”¶åˆ°ä¸€ä¸ª on-item-selected äº‹ä»¶ã€‚ è¦ä¸ºå¾®è°ƒæ¡†å®šä¹‰é€‰æ‹©äº‹ä»¶å¤„ç†ç¨‹åºï¼Œè¯·å®ç° AdapterView.OnItemSelectedListener æ¥å£ä»¥åŠç›¸åº”çš„ onItemSelected() å›è°ƒæ–¹æ³•ã€‚ 12345678910111213141516mSp.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() { //parent The AdapterView where the selection happened //view The view within the AdapterView that was clicked //position The position of the view in the adapter //id The row id of the item that is selected @Override public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id) { TextView textView = (TextView)view; Toast.makeText(MainActivity.this, textView.getText().toString() + \" was selected and position is \" + position, Toast.LENGTH_SHORT).show(); } @Override public void onNothingSelected(AdapterView&lt;?&gt; parent) { Toast.makeText(MainActivity.this, \"nothing selected \", Toast.LENGTH_SHORT).show(); } }); AdapterView.OnItemSelectedListener éœ€è¦ onItemSelected() å’Œ onNothingSelected() å›è°ƒæ–¹æ³•ã€‚ å¤‡æ³¨ å‚è€ƒGoogleå®˜æ–¹å†…å®¹ï¼š https://developer.android.com/guide/topics/ui/controls/spinner.html","link":"/2017/04/09/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åå…­ï¼‰ã€‹ Spinner/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰ï¼‰ã€‹ MVPæ¨¡å¼","text":"å‰è¨€ MVPï¼Œè¿™é‡ŒæŒ‡çš„å¹¶ä¸æ˜¯ç¯®çƒæ¯”èµ›ä¸­çš„MVPï¼ˆæœ€æœ‰ä»·å€¼çƒå‘˜ï¼‰ï¼Œè€Œæ˜¯ä¸€ç§ä»£ç æ¡†æ¶å’Œè®¾è®¡æ€æƒ³ï¼Œå®ƒæ˜¯ç”±MVCæ¼”å˜è€Œæ¥çš„ã€‚MVPæ¨¡å¼ï¼ˆModel-View-Presenterï¼‰æ˜¯MVCæ¨¡å¼çš„ä¸€ä¸ªè¡ç”Ÿã€‚ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è§£è€¦ï¼Œä½¿é¡¹ç›®æ˜“äºç»´æŠ¤ã€‚Model æ˜¯ä¸šåŠ¡é€»è¾‘å’Œå®ä½“æ¨¡å‹,View æ˜¯åŒ…å«Presenterçš„å¼•ç”¨ã€‚æ‰€è¦åšçš„å°±æ˜¯å½“æœ‰äº¤äº’æ—¶ï¼Œè°ƒç”¨Presenteré‡Œçš„å¯¹åº”æ–¹æ³•ã€‚é€šå¸¸ä¼šé€šè¿‡Activityå®ç°Presenter æ˜¯è´Ÿè´£å®ŒæˆViewäºModelé—´çš„äº¤äº’ï¼Œä»Modelé‡Œå–æ•°æ®ï¼Œè¿”å›ç»™Viewå¤„ç†å¥½çš„æ•°æ®ã€‚ MVCæ¨¡å¼ï¼ˆModel-View-Controllerï¼‰ ä¸»è¦ç›®çš„æ˜¯è®²æ˜¾ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘ç‹¬ç«‹å‡ºæ¥ï¼ŒModel æ˜¯åº”ç”¨ç¨‹åºä¸­ç”¨äºå¤„ç†åº”ç”¨ç¨‹åºæ•°æ®é€»è¾‘çš„éƒ¨åˆ†ï¼ŒView æ˜¯åº”ç”¨ç¨‹åºä¸­å¤„ç†æ•°æ®æ˜¾ç¤ºçš„éƒ¨åˆ†ï¼ŒController æ˜¯åº”ç”¨ç¨‹åºä¸­å¤„ç†ç”¨æˆ·äº¤äº’çš„éƒ¨åˆ† ä»æ„é€ å›¾ä¸Šå¯ä»¥çœ‹åˆ°æœ€ä¸»è¦çš„å·®å¼‚å°±æ˜¯ MVCä¸­æ˜¯å…è®¸Modelå’ŒViewè¿›è¡Œäº¤äº’çš„ï¼Œè€ŒMVPä¸­å¾ˆæ˜æ˜¾ï¼ŒModelä¸Viewä¹‹é—´çš„äº¤äº’ç”±Presenterå®Œæˆã€‚è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯Presenterä¸Viewä¹‹é—´çš„äº¤äº’æ˜¯é€šè¿‡æ¥å£çš„ MVPä½¿ç”¨æ–¹æ³•ä»£ç ç»“æ„ ä»£ç å†…å®¹ LoginActivity.java 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162public class LoginActivity extends AppCompatActivity implements ILoginView { @Bind(R.id.usernameWrapper) TextInputLayout usernameWrapper; @Bind(R.id.passwordWrapper) TextInputLayout passwordWrapper; @Bind(R.id.bt_clear) Button btClear; @Bind(R.id.bt_login) Button btLogin; private LoginPresenterCompl loginPresenterCompl; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_login); ButterKnife.bind(this); loginPresenterCompl = new LoginPresenterCompl(this); } @OnClick({R.id.bt_clear, R.id.bt_login}) public void onClick(View view) { String username = usernameWrapper.getEditText().getText().toString(); String password = passwordWrapper.getEditText().getText().toString(); switch (view.getId()) { case R.id.bt_clear: loginPresenterCompl.clearText(); break; case R.id.bt_login: loginPresenterCompl.doLogin(username, password); break; } } @Override public void onLoginResult(boolean isLogged) { if (isLogged) { Toast.makeText(this, \"Logged in Successfully\", Toast.LENGTH_SHORT).show(); } else { Toast.makeText(this, \"Logged Failed\", Toast.LENGTH_SHORT).show(); } return; } @Override public void onClearText() { usernameWrapper.getEditText().setText(\"\"); passwordWrapper.getEditText().setText(\"\"); usernameWrapper.clearFocus(); passwordWrapper.clearFocus(); InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE); if (imm != null) { imm.hideSoftInputFromWindow(getWindow().getDecorView().getWindowToken(), 0); } }} LoginActivityå®ç°ILoginViewæ¥å£ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364public interface ILoginView { void onLoginResult(boolean isLogged); void onClearText();}```java LoginPresenterCompl.javaå®ç°ILoginPresenteræ¥å£```javapublic class LoginPresenterCompl implements ILoginPresenter{ private ILoginView iLoginView; Handler handler; public LoginPresenterCompl(ILoginView loginView) { iLoginView = loginView; handler = new Handler(Looper.getMainLooper()); } @Override public void doLogin(String username, String password) { final String tp_username = username; final String tp_password = password; new Thread(new Runnable() { @Override public void run() { boolean isLogged = false ; if(UserModel.isValidUser(tp_username , tp_password)) { isLogged = true; } final boolean tp_isLogged = isLogged; handler.post(new Runnable() { @Override public void run() { iLoginView.onLoginResult(tp_isLogged); } }); } }).start(); } @Override public void clearText() { new Thread(new Runnable() { @Override public void run() { handler.post(new Runnable() { @Override public void run() { iLoginView.onClearText(); } }); } }).start(); }} 1234567891011121314151617181920212223242526272829303132333435363738public interface ILoginPresenter { void doLogin(String username, String password); void clearText();}```java UserModel.javaè¿™ä¸ªæ²¡æœ‰æ€ä¹ˆä½¿ç”¨ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸åŒçš„Modelä¼šæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼```javapublic class UserModel { public String username; public String password; public UserModel(String username, String password) { this.username = username; this.password = password; } public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } public String getPassword() { return password; } public void setPassword(String password) { this.password = password; } public static boolean isValidUser(String username, String password){ return (username.equals(\"guagua\") &amp;&amp; password.equals(\"guagua\")); }} ç®€çº¦ç±»å›¾ï¼š æ•ˆæœå›¾","link":"/2016/05/31/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰ï¼‰ã€‹ MVPæ¨¡å¼/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¹ï¼‰ã€‹  Ndké…ç½®ä¸Demo","text":"ä»‹ç» The NDK is a toolset that allows you to implement parts of your app using native-code languages such as C and C++. For certain types of apps, this can be helpful so you can reuse existing code libraries written in these languages, but most apps do not need the Android NDK. Before downloading the NDK, you should understand that the NDK will not benefit most apps. As a developer, you need to balance its benefits against its drawbacks. Notably, using native code on Android generally does not result in a noticable performance improvement, but it always increases your app complexity. In general, you should only use the NDK if it is essential to your appâ€”never because you simply prefer to program in C/C++. é…ç½® SDK Toolä¸­å®‰è£…Ndk è®¾ç½®â€Android NDK ocationâ€ï¼Œè‹¥ä¸ºè‡ªåŠ¨ä¸‹è½½ï¼Œåº”è¯¥å°±æ˜¯åœ¨SDKç›®å½•ä¸‹ æ–°å»ºJNIç›®å½•ï¼ˆsrc/main/jniï¼‰ï¼Œå¹¶ä¸”åœ¨build.gradleä¸‹æ·»åŠ ndkå†…å®¹ 12345678910defaultConfig { applicationId â€œmraz.com.jnidemoâ€ minSdkVersion 15 targetSdkVersion 24 versionCode 1 versionName â€œ1.0â€ ndk { moduleName â€˜jniTestâ€™//è¿™é‡Œå°±æ˜¯ç”Ÿæˆsoçš„æ¨¡å—åï¼Œ[ä¹Ÿå°±æ˜¯libjniTest.so](http://xn--libjniTest-k92py04kef1a.so) } } Rebuild Projectä¹‹åå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼Œåˆ™éœ€è¦åœ¨gradle.propertiesä¸­è®¾ç½®â€android.useDeprecatedNdk=trueâ€ æ–°å»ºä¸€ä¸ªJavaç±» å®é™…ä½¿ç”¨ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªjavaç±»ï¼Œå…¶ä¸­å®šä¹‰ä¸¤ä¸ªnativeæ–¹æ³•JniTest.java 12345678package mraz.com.jnidemo;public class JniTest { static { System.loadLibrary(\"jniTest\"); } public native String getHello(); public native int getSum(int a , int b);} é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆè¿™ä¸ªç±»å¯¹åº”çš„nativeä»£ç ä¸­çš„å¤´æ–‡ä»¶ï¼Œä½¿ç”¨javahåœ¨Android Studioä¸­ä½¿ç”¨Terminalï¼Œå…·æœ‰tabé”®è”æƒ³åŠŸèƒ½ä»¥Demoä¸ºä¾‹ï¼Œç”Ÿæˆå¯¹åº”çš„å¤´æ–‡ä»¶åˆ°jniç›®å½•ä¸‹ï¼šjavah -d app\\src\\main\\jni-classpath app\\build\\intermediates\\classes\\debug mraz.com.jnidemo.JniTestç”Ÿæˆå¤´æ–‡ä»¶mraz_com_jnidemo_JniTest.h 1234567891011121314151617181920212223242526272829/* DO NOT EDIT THIS FILE - it is machine generated */#include &lt;jni.h&gt;/* Header for class mraz_com_jnidemo_JniTest */#ifndef _Included_mraz_com_jnidemo_JniTest#define _Included_mraz_com_jnidemo_JniTest#ifdef __cplusplusextern \"C\" {#endif/* * Class: mraz_com_jnidemo_JniTest * Method: getHello * Signature: ()Ljava/lang/String; */JNIEXPORT jstring JNICALL Java_mraz_com_jnidemo_JniTest_getHello (JNIEnv *env, jobject object);/* * Class: mraz_com_jnidemo_JniTest * Method: getSum * Signature: (II)I */JNIEXPORT jint JNICALL Java_mraz_com_jnidemo_JniTest_getSum (JNIEnv *env, jobject object, jint a, jint b);#ifdef __cplusplus}#endif#endif ç„¶ååœ¨JNIç›®å½•ä¸‹åˆ›å»ºå¯¹åº”çš„æºæ–‡ä»¶mraz_com_jnidemo_JniTest.cå…·ä½“å®ç°å¦‚ä¸‹ï¼š 12345678910111213141516171819#include \"mraz_com_jnidemo_JniTest.h\"#include&lt;jni.h&gt;//// Created by Mraz on 2016/6/28.//JNIEXPORT jstring JNICALL Java_mraz_com_jnidemo_JniTest_getHello(JNIEnv *env, jobject object){ return (*env)-&gt;NewStringUTF(env, \"hello\");}/* * Class: mraz_com_jnidemo_JniTest * Method: getSum * Signature: (II)I */JNIEXPORT jint JNICALL Java_mraz_com_jnidemo_JniTest_getSum (JNIEnv *env, jobject object, jint a, jint b) { return (a + b);} å¯¹åº”javaç±»JniTest.javaï¼ŒåŠ è½½soï¼Œå®šä¹‰nativeæ–¹æ³• 1234567891011package mraz.com.jnidemo;/** * Created by Mraz on 2016/6/28. */public class JniTest { static { System.loadLibrary(\"jniTest\"); } public native String getHello(); public native int getSum(int a , int b);} MainActivity.javaä¸­ä½¿ç”¨JniTest.java 1234567891011121314151617181920package mraz.com.jnidemo;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.util.Log;import android.widget.TextView;public class MainActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); JniTest jniTest = new JniTest(); Log.e(\"yidong\", \" hello = \" + jniTest.getHello()); Log.e(\"yidong\", \" sum = \" + jniTest.getSum(4, 6)); TextView textView = (TextView) findViewById(R.id.tv_jni); textView.setText(String.valueOf(jniTest.getSum(5, 6))); }} ç»“æœ","link":"/2016/06/28/ã€ŠAndroid åŸºç¡€ï¼ˆä¹ï¼‰ã€‹  Ndké…ç½®ä¸Demo/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¸ƒï¼‰ã€‹ Android Studioå¸¸ç”¨æŠ€å·§ï¼ˆå…è´¹ä»£ç†ä¸‹è½½Googleå†…å®¹ï¼‰","text":"ç®€ä»‹ç”±äºAndroid Studioè¿™ä¸ªå¼€å‘å·¥å…·ä½“é‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥å¾ˆå¤šåŠŸèƒ½å¹³æ—¶å¼€å‘çš„æ—¶å€™ä¸åšç§¯ç´¯ï¼Œåç»­å°±ä¼šéšç€ä½¿ç”¨çš„å‡å°‘æ¸æ¸å¿˜å´ï¼Œæ‰€ä»¥ï¼Œå†™ç¬”è®°ã€‚ æŠ€å·§é›†åˆå¼€å‘ç‰ˆSHA1å’Œå‘å¸ƒç‰ˆSHA1çš„è·å– å‘å¸ƒç‰ˆ å‘å¸ƒç‰ˆå°±æ˜¯ä½¿ç”¨è‡ªå·±åˆ›å»ºçš„keystoreæ–‡ä»¶ keytool -list -v -keystore xxxxxxxx å¼€å‘æ¿ keytool -list -v -keystore C:/Users/xxx/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android (xxxä»£è¡¨ç”µè„‘å½“å‰ç”¨æˆ·å) åŠ å¿«Gradleæ„å»ºé€Ÿåº¦ Build,Execution,Deployment &gt; Compiler æ·»åŠ  åˆ›å»ºAssetæ–‡ä»¶å¤¹ï¼ŒJNIæ–‡ä»¶å¤¹ç­‰ ä¸‹è½½é•œåƒå…è´¹ä»£ç†è®¾ç½® Appearance &amp; Behavior &gt; System Settings &gt; HTTP Proxy æ‰‹åŠ¨ç­¾åjarsgner-verbose-keystore[keystorePath]-singnedjar [apkOut] [apkln] [alias]","link":"/2016/11/04/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¸ƒï¼‰ã€‹ Android Studioå¸¸ç”¨æŠ€å·§ï¼ˆå…è´¹ä»£ç†ä¸‹è½½Googleå†…å®¹ï¼‰/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¸‰ï¼‰ã€‹ Android Studioå¿«æ·é”®","text":"å‰è¨€Android Studioå¯¹äºå¿«æ·é”®çš„è®¾ç½®æ¯”è¾ƒçš„çµæ´»ï¼Œå¼€å‘è€…åœ¨ä»ä¸åŒçš„å¹³å°è½¬ç§»åˆ°Android Studioè¿›è¡ŒAndroidå¼€å‘çš„æ—¶å€™ï¼Œåº”è¯¥éƒ½èƒ½æ‰¾åˆ°åˆé€‚çš„KeyMapå’Œå¿«æ·é”®ä½¿ç”¨æ–¹å¼ï¼Œå› ä¸ºASç›´æ¥å…¶ä»–å¹³å°çš„å¿«æ·é”®æ˜ å°„æˆ–è€…æ˜¯è‡ªå®šä¹‰å¿«æ·é”®ï¼Œæ¯”è¾ƒçš„æ–¹ä¾¿ï¼Œæ­¤æ–‡åªä¸ºè®°å½•ã€‚ KeyMapé’ˆå¯¹ä¸åŒçš„å¹³å°æœ‰ä¸åŒçš„æ˜ å°„ è¿˜å¯ä»¥è‡ªå®šä¹‰å¿«æ·é”®ï¼Œå³é”®ç‚¹å‡»ä¸€é¡¹ï¼Œå±•å¼€èœå•ï¼Œå¯ä»¥è®¾ç½®é”®ç›˜å¿«æ·é”®å’Œé¼ æ ‡å¿«æ·é”® é’ˆå¯¹ä¸åŒçš„æ¨¡å—ï¼Œéƒ½å¯ä»¥è®¾ç½®å¿«æ·é”®ï¼Œæ¯”å¦‚è¯´ç¼–è¾‘è¿‡ç¨‹ä¸­çš„ä¸€äº›æ“ä½œä»¥åŠIDEä¸Šæ–¹çš„ä¸»èœå•ï¼Œç‰ˆæœ¬æ§åˆ¶ç­‰ç­‰ï¼Œå°½ç®¡å¿«æ·é”®å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è®°å¿†ä¹Ÿæ˜¯æ¯”è¾ƒè´¹åŠ²çš„ï¼Œæ‰€ä»¥è®°ä½ä¸€äº›ä½¿ç”¨æ¦‚ç‡å¾ˆé«˜çš„å¿«æ·é”®åŸºæœ¬ä¸Šå°±å¯ä»¥å¾ˆå¤§ç¨‹åº¦çš„æé«˜å¼€å‘æ•ˆç‡ å¸¸ç”¨å¿«æ·é”® File å¿«æ·é”® æ‰“å¼€Settings Ctrl + ALt + S æ‰“å¼€Project Struct Ctrl + ALt + Shift + S ä¿å­˜ Ctrl + S åŒæ­¥ Ctrl + Y æ–‡ä»¶æ¯”è¾ƒï¼Œé€‰ä¸­ä¸€ä¸ªæ–‡ä»¶åæŒ‰å¿«æ·é”® Ctrl + D å¿«æ·åˆ›å»º Ctrl + Alt + Insert Edit å¿«æ·é”® Undo Ctrl + Z Redo Ctrl + Shift + Z Cut Ctrl + X Copy Ctrl + C å¤åˆ¶è·¯å¾„å Ctrl + Shift + C å¤åˆ¶å¼•ç”¨ Ctrl + Shift +Alt + C Paste Ctrl + V ä»å¤åˆ¶å†å²ä¸­é€‰æ‹©åç²˜è´´ Ctrl + Shift + V åˆ é™¤ Delete æŸ¥æ‰¾ Ctrl + F æ›¿æ¢ Ctrl + R æµè§ˆä¸‹ä¸€ä¸ªæŸ¥è¯¢ç»“æœ F3 æµè§ˆä¸Šä¸€ä¸ªæŸ¥è¯¢ç»“æœ Shift + F3 å‘ä¸‹æŸ¥æ‰¾å½“å‰é€‰ä¸­å†…å®¹ Ctrl + F3 é€‰ä¸­æ‰€æœ‰å’Œå½“å‰é€‰ä¸­å†…å®¹çš„æŸ¥æ‰¾ç»“æœ Ctrl + Alt + Shift + J æ·»åŠ å½“å‰é€‰ä¸­å¯¹è±¡ä¸ºä¸‹ä¸ªæŸ¥æ‰¾å¯¹è±¡ Alt + J é«˜äº®é€‰ä¸­å¯¹è±¡çš„å¼•ç”¨ Ctrl + Shift + F7 åˆ—é€‰ä¸­æ¨¡å¼å¼€å…³ Alt + Shift + Insert å…¨é€‰ Ctrl + A æ‰©å¤§é€‰ä¸­èŒƒå›´ Ctrl + W ç¼©å°é€‰ä¸­èŒƒå›´ Ctrl + Shift + W è‡ªåŠ¨è¡¥å…¨ Ctrl + Shift + Enter æ˜¾ç¤ºæç¤ºä¿¡æ¯ Ctrl + Shift + Space åˆå¹¶è¡Œ Ctrl + Shift + J å¤åˆ¶ä¸€è¡Œ Ctrl + D åˆ é™¤ä¸€è¡Œ Ctrl + Y é€‰ä¸­å†…å®¹åˆ‡æ¢å¤§å°å†™ Ctrl + Shift + U å¢åŠ ç¼©è¿› Tab å‡å°‘ç¼©è¿› Shift + Tab å¤‡æ³¨ åˆ—é€‰ä¸­ è¡Œé€‰ä¸­, åœ¨Column Selection Modeå…³é—­çš„æƒ…å†µä¸‹ï¼ŒæŒ‰ä½ Alt é”®æ‰§è¡Œé€‰ä¸­ï¼Œä¾ç„¶å¯ä»¥å‡ºç°åˆ—é€‰ä¸­çš„æ•ˆæœ View å¿«æ·é”® JSON View Meta + Ctrl + Shift + N Navigation å¿«æ·é”® è·³è½¬åˆ°è¡Œ Ctrl + G æŸ¥æ‰¾ç±» Ctrl + N æŸ¥æ‰¾æ–‡ä»¶ Ctrl + Shift + N æŸ¥æ‰¾Symbols Ctrl + Shift + Alt + N Back Ctrl + Alt + å‘å·¦ç®­å¤´ Forward Ctrl + Alt + å‘å³ç®­å¤´ ä¸Šä¸€ä¸ªç¼–è¾‘è¿‡çš„åœ°æ–¹ Ctrl + Alt + BackSpace ä»£ç ä¸­ä¸‹ä¸€ä¸ªæŠ¥é”™çš„åœ°æ–¹ F2 ä»£ç ä¸­ä¸Šä¸€ä¸ªæŠ¥é”™çš„åœ°æ–¹ Shift + F2 ä¸‹ä¸€ä¸ªæ–¹æ³• Alt + å‘ä¸‹ç®­å¤´ ä¸Šä¸€ä¸ªæ–¹æ³• Alt + å‘ä¸Šç®­å¤´ Code å¿«æ·é”® å¯ä»¥è¦†å†™çš„æ–¹æ³• Ctrl + O å¯ä»¥è¦†å†™çš„æ–¹æ³• Ctrl + I ç”Ÿæˆå„ç§ä¸œè¥¿ Alt + Insertï¼Œä¸€äº›æ’ä»¶æç¤ºçš„å†…å®¹ä¹Ÿå¯ä»¥ç”¨è¿‡Generateäº§ç”Ÿï¼Œæ¯”å¦‚å¦‚ä¸­çš„GsonFormat Surround With Ctrl + Alt + T å–æ¶ˆè¡Œæ³¨é‡Šï¼Œåœ¨æ‰§è¡Œä¸€æ¬¡Alt + / Alt + / æ’å…¥æ¨¡æ¿å†…å®¹ Ctrl + Jï¼Œè¿™ä¸ªå¯ä»¥ç”¨æ¥å¿«é€Ÿæ‰“logï¼Œæ³¨é‡Šæˆ–è€…é€šç”¨çš„æ–¹æ³•ï¼Œæ¯”è¾ƒæ–¹ä¾¿ ç”¨æ¨¡æ¿åŒ…è£¹ Ctrl + Alt + J å—æ³¨é‡Š Alt + Shift + / å–æ¶ˆè¡Œæ³¨é‡Šï¼Œåœ¨æ‰§è¡Œä¸€æ¬¡Alt + Shift+ / Alt + Shift + / æ ¼å¼åŒ–ä»£ç  Alt + Shift + L è§£å†³ç¼©è¿›æ ¼å¼é”™è¯¯ Alt + Shift + I å¿«é€Ÿå¯¼å…¥åŒ…å’Œåˆ é™¤ä¸è¦çš„åŒ… Alt + Shift + O Statementsä¸Šç§» Ctrl + Shift + å‘ä¸Šç®­å¤´ Statementsä¸‹ç§» Ctrl + Shift + å‘ä¸‹ç®­å¤´ è¡Œä¸Šç§» Alt+ Shift + å‘ä¸Šç®­å¤´ è¡Œä¸‹ç§» Alt+ Shift + å‘ä¸‹ç®­å¤´ Build å¿«æ·é”® æ„å»ºé¡¹ç›® Ctrl + F9 Run å¿«æ·é”® Run Alt + Shift + F10 Debug Alt + Shift + F9","link":"/2016/09/25/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¸‰ï¼‰ã€‹ Android Studioå¿«æ·é”®/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåäºŒï¼‰ã€‹ EditText æ— æ³•æ˜¾ç¤ºå®Œå…¨ä»¥åŠå°é²œAndroid  N","text":"ç®€ä»‹æœ€è¿‘å°†Android Studioæ›´æ–°åˆ°äº†2.2 ,æ¨¡æ‹Ÿå™¨çš„Androidç‰ˆæœ¬ä¹Ÿæ¥åˆ°äº†æœ€æ–°çš„Nougatã€‚ é—®é¢˜æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼ŒEditTextåªè¯»çš„æƒ…å†µä¸‹ï¼Œåœ¨ScrollViewä¸‹æ— æ³•æ»šåŠ¨ï¼ŒåŸå› åº”è¯¥å°±æ˜¯æ»‘åŠ¨äº‹ä»¶ä¼˜å…ˆè¢«ScrollViewæ¶ˆè€—ï¼Œå¯¼è‡´EditTextå¹¶æ²¡æœ‰æ”¶åˆ°æ»šåŠ¨äº‹ä»¶ï¼Œå¯¼è‡´å¦‚æ˜¯é—®é¢˜ è§£å†³åŠæ³•123456789101112131415EditText editText = (EditText) findViewById(R.id.EditText01);EtOne.setOnTouchListener(new OnTouchListener() { @Override public boolean onTouch(View v, MotionEvent event) { if (v.getId() == R.id.comment1) { v.getParent().requestDisallowInterceptTouchEvent(true);//ç»„ç»‡çˆ¶èŠ‚ç‚¹æ¶ˆè€—æ»‘åŠ¨äº‹ä»¶ switch (event.getAction() &amp; MotionEvent.ACTION_MASK) { case MotionEvent.ACTION_UP: v.getParent().requestDisallowInterceptTouchEvent(false); break; } } return false; }}); è¿™ç§æƒ…å†µä¸‹ï¼ŒEditTextåº”è¯¥æ˜¯å¯ç¼–è¾‘çŠ¶æ€ï¼Œä½†æ˜¯æˆ‘ä»¬çš„è¦æ±‚æ˜¯åªè¯»ï¼Œä¹Ÿå°±æ˜¯æ— æ³•ç¼–è¾‘ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœç”¨æˆ·ç‚¹å‡»åˆ°äº†æ–‡æœ¬åŒºåŸŸå†…ï¼Œä¼šå¼¹å‡ºè¾“å…¥æ³•ï¼Œç”¨æˆ·ä¾¿å¯ä»¥ç›´æ¥è¾“å…¥ï¼Œè¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³ è§£å†³åŠæ³•é˜»æ­¢è¾“å…¥æ³•å¼¹å‡º123456789101112editText = (EditText) findViewById(R.id.editText);editText.setOnTouchListener(new View.OnTouchListener() { public boolean onTouch(View v, MotionEvent event) { // TODO Auto-generated method stub int inType = editText.getInputType(); // backup the input type editText.setInputType(InputType.TYPE_NULL); // disable soft input editText.onTouchEvent(event); // call native handler editText.setInputType(inType); // restore input type editText.setSelection(editText.getText().length()); return true; }}); é˜»æ­¢è¾“å…¥æ³•å¼¹å‡º1edittext.setKeyListener(null); Sets the key listener to be used with this TextView. This can be nullto disallow user input. Note that this method has significant andsubtle interactions with soft keyboards and other input method:see {@link KeyListener#getInputType() KeyListener.getContentType()}for important details. Calling this method will replace the currentcontent type of the text view with the content type returned by thekey listener. Android Nougatæ¨¡æ‹Ÿå™¨ Android Studio2.2ä¸Šçš„æ¨¡æ‹Ÿå™¨é€Ÿåº¦è¿˜æ˜¯æ¯”è¾ƒå¿«çš„ã€‚ GoogleåŸç”Ÿçš„å†…å®¹ä¾ç„¶æ˜¯é‚£ä¹ˆçš„å¹²å‡€ï¼Œæ¸…æ™°ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚æ¨¡æ‹Ÿå™¨çš„åŠŸèƒ½ä¹Ÿæ˜¯æ¯”è¾ƒå¥å…¨çš„ã€‚ Nç‰ˆæœ¬å…·ä½“æ›´æ–°å†…å®¹ï¼Œè¯·å…³æ³¨å®˜ç½‘ï¼š https://developer.android.com/about/versions/nougat/android-7.0.html Android Studio 2.2æ•´ä½“ç•Œé¢é£æ ¼æ²¡æœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œå›¾æ ‡æœ‰å˜åŒ–ï¼Œç»™æˆ‘å°è±¡æœ€æ·±çš„æ˜¯UIç¼–è¾‘å™¨ ç¼–è¾‘å™¨ä¸­å¤šäº†ä¸€ä¸ªè§†å›¾ï¼Œä¸Šæ–¹å¤šäº†ä¸€äº›æŒ‰é’®ï¼Œå³ä¾§çš„å±æ€§å¯èƒ½æ›´ä¸°å¯Œäº†å§ï¼Œä¹‹å‰æˆ‘éƒ½æ˜¯å…¨éƒ¨æ‰‹å†™çš„ï¼ŒçœŸæ˜¯æµªè´¹å¥½çš„å¼€å‘å·¥å…·ã€‚å…·ä½“çš„æ›´æ–°å†…å®¹è¯·å…³æ³¨å®˜ç½‘ï¼š https://developer.android.com/studio/releases/index.html","link":"/2016/09/22/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåäºŒï¼‰ã€‹ EditText æ— æ³•æ˜¾ç¤ºå®Œå…¨ä»¥åŠå°é²œAndroid  N/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¸€ï¼‰ã€‹Android å±å¹•é€‚é…","text":"åŸºæœ¬æ¦‚å¿µä»€ä¹ˆæ˜¯å±å¹•å°ºå¯¸ã€å±å¹•åˆ†è¾¨ç‡ã€å±å¹•åƒç´ å¯†åº¦ï¼Ÿ å±å¹•å°ºå¯¸æ˜¯æŒ‡å±å¹•å¯¹è§’çº¿çš„é•¿åº¦ã€‚å•ä½æ˜¯è‹±å¯¸ï¼Œ1è‹±å¯¸=2.54å˜ç±³ å±å¹•åˆ†è¾¨ç‡æ˜¯æŒ‡åœ¨æ¨ªçºµå‘ä¸Šçš„åƒç´ ç‚¹æ•°ï¼Œå•ä½æ˜¯pxï¼Œ1px=1åƒç´ ç‚¹ï¼Œä¸€èˆ¬æ˜¯çºµå‘åƒç´ æ¨ªå‘åƒç´ ï¼Œå¦‚1280Ã—720 å±å¹•åƒç´ å¯†åº¦æ˜¯æŒ‡æ¯è‹±å¯¸ä¸Šçš„åƒç´ ç‚¹æ•°ï¼Œå•ä½æ˜¯dpiï¼Œå³â€œdot per inchâ€çš„ç¼©å†™ï¼Œåƒç´ å¯†åº¦å’Œå±å¹•å°ºå¯¸å’Œå±å¹•åˆ†è¾¨ç‡æœ‰å…³ å±å¹•åƒç´ å¯†åº¦è®¡ç®—å…¬å¼ å±å¹•åƒç´ å¯†åº¦=çºµå‘åˆ†è¾¨ç‡2+æ¨ªå‘åˆ†è¾¨ç‡2å±å¹•å°ºå¯¸ å±å¹•åƒç´ å¯†åº¦ = \\dfrac{\\sqrt{çºµå‘åˆ†è¾¨ç‡^2 + æ¨ªå‘åˆ†è¾¨ç‡^2}}{å±å¹•å°ºå¯¸} å±å¹•åƒç´ å¯†åº¦=å±å¹•å°ºå¯¸çºµå‘åˆ†è¾¨ç‡2+æ¨ªå‘åˆ†è¾¨ç‡2â€‹â€‹ ä¾‹å¦‚ï¼šè®¡ç®—Nexus5çš„å±å¹•åƒç´ å¯†åº¦ï¼š å±å¹•å°ºå¯¸ï¼š4.95inchã€åˆ†è¾¨ç‡ï¼š1920Ã—1080ï¼Œå±å¹•åƒç´ å¯†åº¦ï¼š445 å±å¹•åƒç´ å¯†åº¦=19202+108024.95=445 å±å¹•åƒç´ å¯†åº¦ = \\dfrac{\\sqrt{1920^2 + 1080^2}}{4.95} =445å±å¹•åƒç´ å¯†åº¦=4.9519202+10802â€‹â€‹=445 è®¡ç®—ç»“æœå¯ä»¥å¯¹åº”ä¸Šï¼Œè¯æ˜è¿™ä¸ªç»“è®ºæ˜¯OKçš„ã€‚ ä»€ä¹ˆæ˜¯dpã€dipã€dpiã€spã€pxï¼Ÿ dp/dipâ€”-&gt; dipå’Œdpæ˜¯ä¸€ä¸ªæ„æ€ï¼Œéƒ½æ˜¯Density Independent Pixelsçš„ç¼©å†™ï¼Œå³å¯†åº¦æ— å…³åƒç´ ï¼Œä¸Šé¢æˆ‘ä»¬è¯´è¿‡ï¼Œdpiæ˜¯å±å¹•åƒç´ å¯†åº¦ï¼Œå‡å¦‚ä¸€è‹±å¯¸é‡Œé¢æœ‰160ä¸ªåƒç´ ï¼Œè¿™ä¸ªå±å¹•çš„åƒç´ å¯†åº¦å°±æ˜¯160dpiï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œdpå’Œpxå¦‚ä½•æ¢ç®—å‘¢ï¼Ÿåœ¨Androidä¸­ï¼Œè§„å®šä»¥160dpiä¸ºåŸºå‡†ï¼Œ1dip=1pxï¼Œå¦‚æœå¯†åº¦æ˜¯320dpiï¼Œåˆ™1dip=2pxï¼Œä»¥æ­¤ç±»æ¨ã€‚ dpiâ€”&gt; å±å¹•åƒç´ å¯†åº¦çš„å•ä½ï¼Œâ€œdot per inchâ€çš„ç¼©å†™,ä¸Šé¢æœ‰ä»‹ç» spâ€”&gt; Scale-Independent Pixelsçš„ç¼©å†™ï¼Œå¯ä»¥æ ¹æ®æ–‡å­—å¤§å°é¦–é€‰é¡¹è‡ªåŠ¨è¿›è¡Œç¼©æ”¾ã€‚Googleæ¨èæˆ‘ä»¬ä½¿ç”¨12spä»¥ä¸Šçš„å¤§å°ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨12spï¼Œ14spï¼Œ18spï¼Œ22spï¼Œæœ€å¥½ä¸è¦ä½¿ç”¨å¥‡æ•°å’Œå°æ•°ã€‚ pxâ€”&gt; åƒç´ ï¼Œç‰©ç†ä¸Šçš„ç»å¯¹å•ä½ ä»€ä¹ˆæ˜¯mdpiã€hdpiã€xdpiã€xxdpiã€xxxdpiï¼Ÿ åç§° åƒç´ å¯†åº¦èŒƒå›´ å›¾æ ‡å°ºå¯¸ æ¯”ä¾‹ mdpi 120dpi~160dpi 48x48px 1 hdpi 160dpi~240dpi 72x72px 1.5 xhdpi 240dpi~320dpi 96x96px 2 xxhdpi 320dpi~480dpi 144x144px 3 xxxhdpi 480dpi~640dpi 192x192px 4 åœ¨å¤„ç†å›¾æ ‡çš„æ—¶å€™ï¼Œé€šè¿‡mdpiçš„48x48ç„¶åæŒ‰ç…§ä¸€å®šçš„æ¯”ä¾‹åˆ¶ä½œå¯¹åº”çš„å›¾æ ‡æ”¾å…¥å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸‹å³å¯ã€‚ è§£å†³æ–¹æ¡ˆä½¿ç”¨wrap_contentã€match_parentã€layout_weightwrap_contentâ€”â€”â€”â€”â€”â€”-&gt; åŒ…è£¹å†…å®¹match_parent/fill_parent â€”&gt; å¡«æ»¡çˆ¶å¸ƒå±€layout_weightâ€”â€”â€”â€”â€”â€”-&gt; å¸ƒå±€æƒé‡å‰é¢ä¸¤ä¸ªä¸åŒå¤šè®²ï¼Œlayout_weight layout_weightåªæœ‰åœ¨Linearlayoutä¸­æ‰æœ‰æ•ˆã€‚ä¹‹æ‰€ä»¥android:layout_weightä¼šå¼•èµ·äº‰è®®ï¼Œæ˜¯å› ä¸ºåœ¨è®¾ç½®è¯¥å±æ€§çš„åŒæ—¶ï¼Œè®¾ç½®android:layout_widthä¸ºwrap_contentå’Œmatch_parentä¼šé€ æˆä¸¤ç§æˆªç„¶ç›¸åçš„æ•ˆæœã€‚ å…¬å¼ï¼šæ‰€å å®½åº¦=åŸæ¥å®½åº¦+å‰©ä½™ç©ºé—´æ‰€å ç™¾åˆ†æ¯”çš„å®½åº¦ ä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬éƒ½æ˜¯è®¾ç½®è¦è¿›è¡Œæ¯”ä¾‹åˆ†é…çš„æ–¹å‘çš„å®½åº¦ä¸º0dpï¼Œç„¶åå†ç”¨æƒé‡è¿›è¡Œåˆ†é…A.widthï¼šB.widht = A.layout_weight : B.layout_weight ä½†æ˜¯å¦‚æœè®¾ç½®è¦è¿›è¡Œæ¯”ä¾‹åˆ†é…çš„æ–¹å‘çš„å®½åº¦ä¸ºmatch_parent,æ•ˆæœå°±æˆªç„¶ç›¸åã€‚A.widthï¼šB.widht = B.layout_weight : A.layout_weight Googleå®˜æ–¹æ¨èï¼Œå½“ä½¿ç”¨weightå±æ€§æ—¶ï¼Œå°†widthè®¾ä¸º0dipå³å¯ï¼Œæ•ˆæœè·Ÿè®¾æˆwrap_contentæ˜¯ä¸€æ ·çš„ã€‚è¿™æ ·weightå°±å¯ä»¥ç†è§£ä¸ºå æ¯”äº†ï¼ ä½¿ç”¨çº¿æ€§å¸ƒå±€å’Œç›¸å¯¹å¸ƒå±€,å°½é‡å‡å°‘å¯¹ç»å¯¹å¸ƒå±€çš„ä½¿ç”¨çº¿æ€§å¸ƒå±€ä¸­å¯ä»¥ä½¿ç”¨layout_weightçš„æ–¹å¼ç›¸å¯¹å¸ƒå±€å¯ä»¥ä¿æŒå®¹å™¨ä¸­å­Viewç›¸å¯¹ä½ç½®çš„ç¨³å®šç»å¯¹å¸ƒå±€å¤ªè¿‡äºæ­»æ¿ ä½¿ç”¨é™å®šç¬¦å°ºå¯¸é™å®šç¬¦ res/layout-large/main.xml (é€‚ç”¨ä¸android 3.2ä¹‹å‰) æœ€å°é™å®šç¬¦ res/layout-sw600dp/main.xml (Small Width, é€‚ç”¨äºandroid 3.2ä¹‹å) ä½¿ç”¨å¸ƒå±€åˆ«åè¿™ç§æ–¹å¼æ˜¯é€šè¿‡èµ„æºæ–‡ä»¶ä½¿ç”¨åˆ«å 123&lt;resource &gt;&lt;item name=\"main\" type=\"layout\"&gt;@layout/main_twopanes&lt;/item&gt;&lt;resource&gt; æ›¿æ¢åé¢çš„main_twopanesçš„åç§°ä¸ºä¸åŒçš„å¸ƒå±€ï¼Œç„¶åå®šä¹‰åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä½¿ç”¨ 1setContentView(R.layout.main) åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œå°±å¯ä»¥æ ¹æ®å±å¹•å°ºå¯¸å’Œandroidç‰ˆæœ¬åŠ è½½ä¸åŒçš„å¸ƒå±€ï¼Œä½†æ˜¯åˆ«åéƒ½æ˜¯mainã€‚ ä½¿ç”¨å±å¹•æ–¹å‘é™å®šç¬¦æ¨ªå±å’Œç«–å±çš„æ˜¾ç¤ºæ–¹å¼å¾€å¾€æœ‰ä¸€äº›å·®å¼‚ã€‚ æ¨ªå±ï¼š res/values-sw600dp-land/layouts.xml ç«–å±ï¼š res/values-sw600dp-port/layouts.xml ä½¿ç”¨è‡ªåŠ¨æ‹‰ä¼¸ä½å›¾ è‡ªåŠ¨æ‹‰ä¼¸ä½å›¾ï¼Œå³androidä¸‹ç‰¹æœ‰çš„.9.pngå›¾ç‰‡æ ¼å¼ã€‚ å·¥å…·ï¼Œdraw9patch.bat ç‰¹ç‚¹ï¼Œ å·¦è¾¹å’Œä¸Šè¾¹ç‚¹ä¸‹ä¸€ä¸ªåƒç´ æˆ–å¤šä¸ªåƒç´ ç‚¹ï¼Œæ˜¯é€‰æ‹©äº†æ‹‰ä¼¸çš„åƒç´ ï¼Œå³æŠŠé€‰æ‹©çš„åƒç´ ç‚¹è¿›è¡Œæ‹‰ä¼¸ã€‚é€‰æ‹©çš„åƒç´ ç‚¹è¶Šå¤šï¼Œæ‹‰ä¼¸çš„ç¨‹åº¦ä¹Ÿè¶Šå¤§ã€‚ å³è¾¹å’Œä¸‹è¾¹æ˜¯é€‰æ‹©å†…å®¹åŒºåŸŸï¼Œåœ¨å³è¾¹å’Œä¸‹è¾¹ç”»ä¸Šç›´çº¿ï¼Œäº¤å‰çš„åŒºåŸŸå°±æ˜¯å†…å®¹åŒºåŸŸã€‚","link":"/2016/09/21/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¸€ï¼‰ã€‹Android å±å¹•é€‚é…/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåäº”ï¼‰ã€‹ View Animation","text":"ç®€ä»‹ è§†å›¾åŠ¨ç”»ï¼Œä¸»è¦åŒ…æ‹¬ä½ç§»ï¼Œé€æ˜åº¦ï¼Œæ—‹è½¬å’Œç¼©æ”¾ï¼ŒViewæœ¬èº«çš„å±æ€§å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåªæ˜¯åœ¨è¿™ä¸ªè§†å›¾ä¸Šæ·»åŠ ä¸€äº›æ¸å˜çš„æ•ˆæœï¼Œæ‰€ä»¥æ€»ä½“è€Œè¨€ï¼Œè§†å›¾åŠ¨ç”»åªèƒ½å®ç°ä¸€äº›ç®€å•çš„åŠ¨ç”»æ•ˆæœï¼Œå±æ€§åŠ¨ç”»åŠŸèƒ½æ›´å¼ºå¤§ã€‚ åŸºæœ¬ä½¿ç”¨res/animç›®å½•ä¸‹åˆ›å»ºåŠ¨ç”»èµ„æºæ–‡ä»¶,å­˜æ”¾å¸§åŠ¨ç”»å’Œæ¸å˜åŠ¨ç”»ï¼Œä¸»è¦tag: set, alpha, scale, tranlate, rotateåˆ†åˆ«å¯¹åº”åŠ¨ç”»é›†åˆï¼Œé€æ˜åŠ¨ç”»ï¼Œç¼©æ”¾åŠ¨ç”»ï¼Œä½ç§»åŠ¨ç”»ï¼Œæ—‹è½¬åŠ¨ç”» æ ¼å¼12345678910111213141516171819202122232425262728293031323334353637&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\" android:interpolator=\"@[package:]anim/interpolator_resource\" android:shareInterpolator=[\"true\" | \"false\"] &gt;//å­å…ƒç´ æ˜¯å¦å…±äº«è¿™ä¸ªæ’å€¼å™¨ &lt;!--[0.0 , 1.0] --&gt; &lt;alpha android:fromAlpha=\"float\" android:toAlpha=\"float\" /&gt; &lt;!--[0.0, ï¼Ÿ] --&gt; &lt;!-- pivotX,pivotYç”¨æ¥æ§åˆ¶ç¼©æ”¾çš„ä¸­å¿ƒç‚¹--&gt; &lt;scale android:fromXScale=\"float\" android:toXScale=\"float\" android:fromYScale=\"float\" android:toYScale=\"float\" android:pivotX=\"float\" android:pivotY=\"float\" /&gt; &lt;!-- in pixels relative to the normal position (such as \"5\"), in percentage relative to the element width (such as \"5%\"), or in percentage relative to the parent width (such as \"5%p\")--&gt; &lt;translate android:fromXDelta=\"float\" android:toXDelta=\"float\" android:fromYDelta=\"float\" android:toYDelta=\"float\" /&gt; &lt;!-- android:pivotX, android:pivotY n pixels relative to the object's left edge (such as \"5\"), in percentage relative to the object's left edge (such as \"5%\"), or in percentage relative to the parent container's left edge (such as \"5%p\") --&gt; &lt;rotate android:fromDegrees=\"float\" android:toDegrees=\"float\" android:pivotX=\"float\" android:pivotY=\"float\" /&gt; &lt;set&gt; ... &lt;/set&gt;&lt;/set&gt; Scale1234567891011&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;scale android:duration=\"2000\"//æ—¶å¸¸(è¿è¡Œä»£ç ä¸è¦åœ¨è¿™é‡Œåšæ³¨é‡Š) android:pivotX=\"50%\" android:pivotY=\"50%\"//ç¼©æ”¾ä¸­å¿ƒç‚¹ä¸ºè§†å›¾çš„ä¸­å¿ƒ android:fromXScale=\"1.0\"//èµ·ç‚¹å¤§å° android:fromYScale=\"1.0\" android:toXScale=\"2.0\"//ç›®æ ‡å¤§å° android:toYScale=\"2.0\" /&gt;&lt;/set&gt; Alpha12345678&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;alpha android:duration=\"2000\"//æ—¶å¸¸ android:fromAlpha=\"1.0\"//èµ·å§‹é€æ˜åº¦ android:interpolator=\"@android:anim/accelerate_decelerate_interpolator\"//æ’å€¼ android:toAlpha=\"0.0\" /&gt;//ç›®æ ‡é€æ˜åº¦&lt;/set&gt; Rotate12345678910&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;rotate android:duration=\"2000\"//æ—¶å¸¸ android:fromDegrees=\"0\"//èµ·å§‹è§’åº¦ android:interpolator=\"@android:anim/decelerate_interpolator\"//æ’å€¼ android:pivotX=\"50%\" android:pivotY=\"50%\"//æ—‹è½¬ä¸­å¿ƒç‚¹ä¸ºè§†å›¾ä¸­å¿ƒ android:toDegrees=\"180\" /&gt;//ç›®æ ‡è§’åº¦&lt;/set&gt; Translate12345678910&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;set xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;translate android:duration=\"2000\"//æ—¶å¸¸ android:fromXDelta=\"0\" android:fromYDelta=\"0\"//èµ·å§‹ä½ç½®ç›¸å¯¹äºè§†å›¾çš„ä½ç§» android:interpolator=\"@android:anim/accelerate_interpolator\" android:toXDelta=\"300\" android:toYDelta=\"300\" /&gt;//ç›®æ ‡ä½ç½®ç›¸å¯¹äºè§†å›¾çš„ä½ç§»&lt;/set&gt; Setå°†ä¸Šé¢çš„ä»£ç å„ç§æ¸å˜åŠ¨ç”»å…¨éƒ¨é˜²æ­¢åœ¨&lt; set &gt;tagä¸‹ï¼Œå®ç°å…±åŒæ•ˆæœ å¤‡æ³¨ä»£ç ä¸­åŠ è½½åŠ¨ç”»ï¼Œä¾‹å¦‚æ—‹è½¬åŠ¨ç”»ï¼š 12rotateAnim = AnimationUtils.loadAnimation(this, R.anim.rotate_anim);imageView.startAnimation(rotateAnim);","link":"/2016/10/16/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåäº”ï¼‰ã€‹ View Animation/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåäº”ï¼‰ã€‹Frame Animation","text":"ç®€ä»‹Frame Animation, é€å¸§åŠ¨ç”»ï¼Œé€šè¿‡å®šä¹‰ä¸€ç³»åˆ—çš„Drawableå¯¹è±¡æ¥å®ç°åŠ¨ç”»æ•ˆæœï¼Œå¯ä»¥ç”¨æ¥ä½œä¸ºè§†å›¾çš„èƒŒæ™¯ã€‚Frame Animationåœ¨ä»£ç ä¸­ä½“ç°ä¸ºAnimationDrawableå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡xmlæ–‡ä»¶å¿«åˆ›å»ºï¼Œæ”¾åœ¨åœ¨/res/drawable/ç›®å½•ä¸‹ï¼Œè®¾ç½®ä¸ºè§†å›¾èƒŒæ™¯åï¼Œè°ƒç”¨start()æ–¹æ³•å³å¯æ‰§è¡Œé€å¸§åŠ¨ç”»ã€‚ XMLæ–‡ä»¶Tags: &lt; animation-list &gt; ä½œä¸ºçˆ¶èŠ‚ç‚¹ï¼Œä»£è¡¨Animation Drawable &lt; item &gt;ä½œä¸ºå­èŠ‚ç‚¹ï¼Œä»£è¡¨é€å¸§åŠ¨ç”»å†…å®¹ï¼Œä¸€å¼ ä¸€å¼ å›¾ç‰‡ Attributes: å±æ€§ å«ä¹‰ android:oneshot=â€false trueâ€ android:variablePadding=â€false trueâ€ android:visible=â€false trueâ€ android:drawable=â€@drawable/xxxxxâ€ itemå›¾ç‰‡èµ„æº android:duration=â€œxxxxxâ€ drawableæ’­æ”¾æ—¶é—´ï¼Œå•ä½ms Res:/res/drawable/{folder} 1234567891011121314&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;animation-list xmlns:android=\"http://schemas.android.com/apk/res/android\" android:id=\"@+id/selected\" android:oneshot=\"true\" android:variablePadding=\"false\" android:visible=\"true\"&gt; &lt;item android:drawable=\"@drawable/ic_action_add\" android:duration=\"500\"/&gt; &lt;item android:drawable=\"@drawable/ic_action_anchor\" android:duration=\"500\"/&gt; &lt;item android:drawable=\"@drawable/ic_action_alarm\" android:duration=\"500\"/&gt; &lt;item android:drawable=\"@drawable/ic_action_amazon\" android:duration=\"500\"/&gt; &lt;item android:drawable=\"@drawable/ic_action_ac\" android:duration=\"500\"/&gt;&lt;/animation-list&gt; Codingä½¿ç”¨XMLèµ„æº12345imageView.setBackgroundResource(R.drawable.frame_anim);//è®¾ç½®èƒŒæ™¯Drawable bgDrawable = imageView.getBackground();//è·å–èƒŒæ™¯if(bgDrawable instanceof AnimationDrawable) { ((AnimationDrawable) bgDrawable).start();//å¦‚æœä¸ºAnimationDrawableåˆ™æ‰§è¡ŒåŠ¨ç”»} çº¯ä»£ç å®ç°1234567891011121314151617181920â€¦â€¦imageView.setBackground(createAnimationDrawable());//è®¾ç½®èƒŒæ™¯Drawable bg = imageView.getBackground();if(bg instanceof AnimationDrawable) { ((AnimationDrawable) bg).start();//å¼€å§‹åŠ¨ç”»}â€¦â€¦private AnimationDrawable createAnimationDrawable() { AnimationDrawable animationDrawable = new AnimationDrawable(); animationDrawable.addFrame(getResources().getDrawable(R.drawable.ic_action_add), 500); animationDrawable.addFrame(getResources().getDrawable(R.drawable.ic_action_anchor), 500); animationDrawable.addFrame(getResources().getDrawable(R.drawable.ic_action_alarm), 500); animationDrawable.addFrame(getResources().getDrawable(R.drawable.ic_action_amazon), 500); animationDrawable.addFrame(getResources().getDrawable(R.drawable.ic_action_ac), 500); animationDrawable.setOneShot(false); animationDrawable.setVisible(true,true); return animationDrawable;} æ•ˆæœå›¾","link":"/2016/10/24/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåäº”ï¼‰ã€‹Frame Animation/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåå…«ï¼‰ã€‹ Fragment (1)","text":"ç®€ä»‹Fragmentï¼Œç¢ç‰‡ï¼Œå¸¸ç”¨çš„å†…å®¹ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰ç³»ç»Ÿçš„å­¦ä¹ ä¸‹å®ƒçš„ä½¿ç”¨æ–¹æ³•ï¼ŒèŠ±å‡ å¤©æŠ½ç©ºçœ‹çœ‹éšä¾¿è®°å½•ä¸€ä¸‹ã€‚ ç”Ÿå‘½å‘¨æœŸ æ¥è‡ªå®˜ç½‘çš„å›¾ç‰‡ä¸€ç›®äº†ç„¶ã€‚ è‡ªæµ‹è¯•ç»“æœï¼š åŸºæœ¬ä½¿ç”¨è‡ªå®šä¹‰ä¸€ä¸ªFragmentï¼šBaseFragment1234567891011121314151617181920212223/*å¸¦å‚æ•°æ„é€ æ–¹æ³•*/public static BaseFragment newInstance(String content) { Bundle args = new Bundle(); args.putString(\"CONTENT\", content); BaseFragment fragment = new BaseFragment(); fragment.setArguments(args);//ä¼ é€’å‚æ•°ï¼Œè®¾ç½®å†…å®¹æ–‡æœ¬ return fragment;}@Nullable@Overridepublic View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) { Log.i(TAG, \"onCreateView\"); View view = inflater.inflate(R.layout.content_fragment , container, false); Bundle args = getArguments();//è·å–å‚æ•°å¹¶è®¾ç½®æ–‡æœ¬å†…å®¹ if (args != null) { String content = args.getString(\"CONTENT\"); tv = (TextView) view.findViewById(R.id.tv_content); tv.setText(content); } return view;} å¯¹åº”å¸ƒå±€æ–‡ä»¶12345678910&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;TextView android:id=\"@+id/tv_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:layout_gravity=\"center\" android:gravity=\"center\" android:textColor=\"@color/colorAccent\" android:textSize=\"30sp\" android:textStyle=\"italic|bold\" /&gt; ä¸»Activityå¸ƒå±€æ–‡ä»¶123456789101112131415161718192021&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/activity_main\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" tools:context=\"jzfp.gs.com.animationdemo.MainActivity\"&gt; &lt;!-- å·¥å…·æ --&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" android:background=\"@color/colorPrimary\"&gt;&lt;/android.support.v7.widget.Toolbar&gt; &lt;!-- å†…å®¹åŒºåŸŸ--&gt; &lt;FrameLayout android:id=\"@+id/fl_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt;&lt;/FrameLayout&gt;&lt;/LinearLayout&gt; Fragmentåˆ‡æ¢1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class MainActivity extends AppCompatActivity { BaseFragment leftFragment = null;//å·¦ä¾§fragment BaseFragment rightFragment = null;//å³ä¾§Fragment BaseFragment defaultFragment= null;//é»˜è®¤Fragment @TargetApi(Build.VERSION_CODES.LOLLIPOP) @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); toolbar.setNavigationIcon(R.drawable.left); setSupportActionBar(toolbar);//è®¾ç½®ActionBar toolbar.setNavigationOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { showLeftFragment(); } }); defaultFragment = BaseFragment.newInstance(\"This is default fragment\"); FragmentManager fm = getSupportFragmentManager(); FragmentTransaction transaction = fm.beginTransaction(); transaction.replace(R.id.fl_content, defaultFragment); transaction.commit();//æ˜¾ç¤ºé»˜è®¤ç¢ç‰‡ } @Override public boolean onCreateOptionsMenu(Menu menu) { getMenuInflater().inflate(R.menu.toolbar, menu); return true; } @Override public boolean onOptionsItemSelected(MenuItem item) { int id = item.getItemId(); switch(id){ case R.id.right: showRightFragment();break; default:break; } return true; } public void showLeftFragment(){ FragmentManager fm = getSupportFragmentManager(); FragmentTransaction transaction = fm.beginTransaction(); if(leftFragment == null) { leftFragment = BaseFragment.newInstance(\"This is Left Fragment\"); } transaction.replace(R.id.fl_content, leftFragment); transaction.commit(); } public void showRightFragment(){ FragmentManager fm = getSupportFragmentManager(); FragmentTransaction transaction = fm.beginTransaction(); if(rightFragment == null) { rightFragment = BaseFragment.newInstance(\"This is Right Fragment\"); } transaction.replace(R.id.fl_content, rightFragment); transaction.commit(); }} ç»“æœç‚¹å‡»å·¦å³æŒ‰é’®åˆ‡æ¢fragment","link":"/2016/11/08/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåå…«ï¼‰ã€‹ Fragment (1)/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåå…­ï¼‰ã€‹ æ¸å˜è‰²åœ†è§’Button","text":"ç®€ä»‹æ€»ç»“ä¸‹ä¹‹å‰çœ‹çš„è‡ªå®šä¹‰Viewçš„å†…å®¹ï¼Œç»“åˆä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œé˜è¿°ä¸‹åŸºæœ¬ç”¨æ³•å’Œå¤§è‡´çš„ä½¿ç”¨æµç¨‹ï¼Œè¿™ä¸ªä¾‹å­æ¯”è¾ƒç®€å•ï¼Œæ›´å¤æ‚çš„è‡ªå®šä¹‰Viewï¼Œéšç€è‡ªå·±çš„å­¦ä¹ ï¼Œåé¢å†æ…¢æ…¢æ·»åŠ ã€‚ä½œä¸ºä¸€ä¸ªAndroidå¼€å‘è€…ï¼Œè¿™éƒ¨åˆ†åº”è¯¥æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚ è‡ªå®šä¹‰å±æ€§ä½ç½®ï¼šres/values/attrs.xmlæ ¼å¼ï¼š 123456&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources&gt; &lt;declare-styleable name=\"name_of_style\"&gt; &lt;attr name=\"name_of_attr\" format=\"reference|string|color|boolean|dimension|enum|flag|float|fraction|integer\"/&gt; &lt;/declare-styleable&gt;&lt;/resources&gt; format æ„ä¹‰ reference å‚è€ƒæŸä¸€èµ„æºID, å¦‚R.drawable.xxx string å­—ç¬¦ä¸² color é¢œè‰² boolean å¸ƒå°”å€¼ dimension å°ºå¯¸å€¼ enum æšä¸¾å€¼ flag ä½æˆ–è¿ç®— float æµ®ç‚¹æ•° fraction ç™¾åˆ†æ•°ï¼Œä¾‹å¦‚pivotX,pivotYè¿™ä¸€ç±»å±æ€§ integer æ•´æ•° è·å–è‡ªå®šä¹‰å±æ€§1234TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.name_of_style);Color mColor = typedArray.getColor(R.styleable.name_of_style_name_of_attr, Color.BLUE);//å…¶ä»–çš„å±æ€§è·å–ç±»ä¼¼typedArray.recycle();//è®°å¾—å›æ”¶ åå­—ï¼š R.styleable.{name_of_style} R.styleable.{name_of_style}_{name_of_attr} ä¸¾ä¾‹è¯´æ˜ä¸¾ä¸ªä¾‹å­ï¼Œå®ç°ä¸€ä¸ªèƒŒæ™¯ä¸ºæ¸å˜è‰²çš„åœ†è§’æŒ‰é’®ï¼Œåœ†è§’åŠå¾„ï¼Œå¼€å§‹é¢œè‰²ï¼Œä¸­å¿ƒé¢œè‰²ï¼Œç»“æŸé¢œè‰²ï¼Œæ¸å˜æ–¹å‘ç”¨æˆ·å¯è‡ªå®šä¹‰ã€‚ attrs.xml12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources&gt; &lt;declare-styleable name=\"CornerButton\"&gt; &lt;attr name=\"corner_radius\" format=\"dimension\" /&gt; &lt;attr name=\"background_start_color\" format=\"color\" /&gt; &lt;attr name=\"background_center_color\" format=\"color\" /&gt; &lt;attr name=\"background_end_color\" format=\"color\" /&gt; &lt;attr name=\"backgrouund_gradient_orientation\"&gt; &lt;enum name=\"TOP_BOTTOM\" value=\"0\" /&gt; &lt;enum name=\"TR_BL\" value=\"1\" /&gt; &lt;enum name=\"RIGHT_LEFT\" value=\"2\" /&gt; &lt;enum name=\"BR_TL\" value=\"3\" /&gt; &lt;enum name=\"BOTTOM_TOP\" value=\"4\" /&gt; &lt;enum name=\"BL_TR\" value=\"5\" /&gt; &lt;enum name=\"LEFT_RIGHT\" value=\"6\" /&gt; &lt;enum name=\"TL_BR\" value=\"7\" /&gt; &lt;/attr&gt; &lt;/declare-styleable&gt;&lt;/resources&gt; CornerButton123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class CornerButton extends Button { private GradientDrawable mBg; private float mRandius; private int mStartColor; private int mCenterColor; private int mEndColor; private int mOrientation; public CornerButton(Context context, AttributeSet attrs) { super(context, attrs); TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.CornerButton); mRandius = typedArray.getDimension(R.styleable.CornerButton_corner_radius, 10); mStartColor = typedArray.getColor(R.styleable.CornerButton_background_start_color, Color.BLUE); mCenterColor = typedArray.getColor(R.styleable.CornerButton_background_center_color, Color.GREEN); mEndColor = typedArray.getColor(R.styleable.CornerButton_background_end_color, Color.BLACK); mOrientation = typedArray.getInt(R.styleable.CornerButton_backgrouund_gradient_orientation, 0); typedArray.recycle(); int[] colors = {mStartColor, mCenterColor, mEndColor}; mBg = new GradientDrawable(); mBg.setCornerRadius(mRandius); mBg.setOrientation(Orientation.TR_BL); mBg.setColors(colors); switch (mOrientation) { case 0: mBg.setOrientation(Orientation.TOP_BOTTOM); break; case 1: mBg.setOrientation(Orientation.TR_BL); break; case 2: mBg.setOrientation(Orientation.RIGHT_LEFT); break; case 3: mBg.setOrientation(Orientation.BR_TL); break; case 4: mBg.setOrientation(Orientation.BOTTOM_TOP); break; case 5: mBg.setOrientation(Orientation.BL_TR); break; case 6: mBg.setOrientation(Orientation.LEFT_RIGHT); break; case 7: mBg.setOrientation(Orientation.TL_BR); break; } this.setBackground(mBg); }} activity_main.xml1234567891011121314151617181920212223&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:yidong=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/activity_main\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"gs.com.customview.MainActivity\"&gt; &lt;gs.com.customview.CornerButton android:id=\"@+id/cb_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" yidong:background_start_color=\"#CCFF0000\" yidong:background_center_color=\"#CCAADD00\" yidong:background_end_color=\"#CC00EEFF\" yidong:corner_radius=\"100dp\" yidong:backgrouund_gradient_orientation=\"BOTTOM_TOP\" /&gt;&lt;/RelativeLayout&gt; xmlns:yidong=â€œhttp://schemas.android.com/apk/res-autoâ€ å’Œyidong:corner_radius=â€œ100dpâ€XMLå‘½åç©ºé—´å’Œå±æ€§çš„Tagå¯¹åº”ã€‚ æ•ˆæœ","link":"/2016/10/25/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåå…­ï¼‰ã€‹ æ¸å˜è‰²åœ†è§’Button/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¹ï¼‰ã€‹ Fragment (2) ~ DialogFragment","text":"ç®€ä»‹ ä¸Šä¸€ç¯‡ç®€å•çš„ä»‹ç»äº†ä¸‹Fragmentçš„ä½¿ç”¨æ–¹æ³•ï¼Œè¿™ä¸€ç¯‡ä¸»è¦çœ‹ä¸‹DialogFragmentã€‚åœ¨android 3.0æ—¶è¢«å¼•å…¥ã€‚æ˜¯ä¸€ç§ç‰¹æ®Šçš„Fragmentï¼Œç”¨äºåœ¨Activityçš„å†…å®¹ä¹‹ä¸Šå±•ç¤ºä¸€ä¸ªæ¨¡æ€çš„å¯¹è¯æ¡†ã€‚å…¸å‹çš„ç”¨äºï¼šå±•ç¤ºè­¦å‘Šæ¡†ï¼Œè¾“å…¥æ¡†ï¼Œç¡®è®¤æ¡†ç­‰ç­‰ã€‚ä¹‹å‰çš„åšå®¢ä¸­æœ‰é’ˆå¯¹AlertDialogä½œå‡ºè¿‡è¯¦ç»†çš„ä»‹ç»ï¼Œè¿™ä¸ªçš„åŠŸèƒ½å’Œå®ƒæ¯”è¾ƒç±»ä¼¼ï¼Œä½†æ˜¯å®˜æ–¹æ¨èçš„å¿…ç„¶ä¼šæœ‰å…¶ç‰›é€¼ä¹‹å¤„~ ä½¿ç”¨æ–¹æ³•ï¼šå‚è€ƒFragmentä½¿ç”¨æ–¹æ³•å’ŒFragmentåŸºæœ¬ç›¸åŒï¼Œä½†æ˜¯DialogFragmentå¤šå‡ºæ¥ä¸€ä¸ªonCreateDialogæ–¹æ³• åˆ›å»ºFragmentå¯¹åº”çš„å¸ƒå±€æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"250dp\" android:layout_height=\"wrap_content\" android:orientation=\"vertical\"&gt; &lt;TextView android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_gravity=\"center_horizontal\" android:gravity=\"center_horizontal\" android:text=\"MOBLIE APP\" android:textColor=\"@color/colorAccent\" android:textStyle=\"bold|italic\" /&gt; &lt;android.support.design.widget.TextInputLayout android:layout_width=\"250dp\" android:layout_height=\"wrap_content\"&gt; &lt;EditText android:id=\"@+id/et_username\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:hint=\"Username\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;android.support.design.widget.TextInputLayout android:layout_width=\"250dp\" android:layout_height=\"wrap_content\"&gt; &lt;EditText android:id=\"@+id/et_passwrod\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:hint=\"Password\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;Button android:id=\"@+id/bt_login\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:text=\"ç™»å½•\" /&gt;&lt;/LinearLayout&gt; åˆ›å»ºç»§æ‰¿DialogFragmentçš„Fragmentå¹¶é‡å†™onCreateViewæ–¹æ³•12345678public class ContentFragment extends DialogFragment { @Nullable @Override public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) { View view = inflater.inflate(R.layout.content_fragment, container); return view; }} Activityä¸­ä½¿ç”¨1234private void showRunDialog() { ContentFragment dialog = new ContentFragment(); dialog.show(getFragmentManager(), \"login\");//åé¢çš„å­—ä¸²æ˜¯Tag } æ•ˆæœ ä½¿ç”¨æ–¹æ³•: DialogFragmentç‹¬æœ‰åˆ›å»ºFragmentå¯¹åº”çš„å¸ƒå±€æ–‡ä»¶è¿™ä¸ªå¸ƒå±€å¯ä»¥å’Œä¸Šé¢ç›¸åŒï¼Œä½†æ˜¯ä¸ºäº†åŒºåˆ†æ•ˆæœï¼Œå•ç‹¬ç¼–å†™ä¸€ä¸ª 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;TextView android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_gravity=\"center_horizontal\" android:gravity=\"center\" android:text=\"Mobile APP\" android:textColor=\"@color/colorAccent\" android:textSize=\"20sp\" android:textStyle=\"bold|italic\" /&gt; &lt;android.support.design.widget.TextInputLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\"&gt; &lt;EditText android:id=\"@+id/et_username\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:hint=\"Username\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;android.support.design.widget.TextInputLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\"&gt; &lt;EditText android:id=\"@+id/et_passwrod\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:hint=\"Password\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt;&lt;/LinearLayout&gt; åˆ›å»ºç»§æ‰¿DialogFragmentçš„Fragmentå¹¶é‡å†™onCreateDialogæ–¹æ³•123456789101112131415161718192021222324252627282930public class DialogContent extends DialogFragment { @RequiresApi(api = Build.VERSION_CODES.LOLLIPOP) @Override public Dialog onCreateDialog(Bundle savedInstanceState) { AlertDialog.Builder builder = new AlertDialog.Builder(getActivity()); final View view = getActivity().getLayoutInflater().inflate(R.layout.content_dialog, null, false); builder.setView(view) .setPositiveButton(\"ç™»å½•\", new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialog, int which) { final String username = ((EditText) (view.findViewById(R.id.et_username))).getText().toString(); final String password = ((EditText) (view.findViewById(R.id.et_passwrod))).getText().toString(); ((MainActivity) getActivity()).setUsernameAndPassword(username, password);//ä¸Activityäº¤äº’ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ç°æ¥å£çš„æ–¹å¼å®ç° } }) .setNegativeButton(\"æ³¨å†Œ\", new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialog, int which) { final String username = ((EditText) (view.findViewById(R.id.et_username))).getText().toString(); final String password = ((EditText) (view.findViewById(R.id.et_passwrod))).getText().toString(); ((MainActivity) getActivity()).setUsernameAndPassword(\"æ³¨å†Œ\", \"æ³¨å†Œ\");//ä¸Activityäº¤äº’ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ç°æ¥å£çš„æ–¹å¼å®ç° } }); return builder.create(); }} åœ¨onCreateDialogæ–¹æ³•ä¸­ï¼Œé€šè¿‡åˆ›å»ºAlertDialogçš„æ–¹å¼æ¥ç”ŸæˆDialog Activityä¸­ä½¿ç”¨æ–¹å¼å’Œä¸Šé¢ç›¸åŒæ•ˆæœ ä¼˜åŠ¿å±å¹•æ—‹è½¬è¿‡ç¨‹ä¸­å¯¹è¯æ¡†ä¸æ¶ˆå¤±","link":"/2016/11/08/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåä¹ï¼‰ã€‹ Fragment (2) ~ DialogFragment/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåå››ï¼‰ã€‹ EditText","text":"ç®€ä»‹ A text field allows the user to type text into your app. It can be either single line or multi-line. Touching a text field places the cursor and automatically displays the keyboard. In addition to typing, text fields allow for a variety of other activities, such as text selection (cut, copy, paste) and data look-up via auto-completion.You can add a text field to you layout with the EditText object. You should usually do so in your XML layout with a &lt; EditText &gt; element. æ–‡æœ¬åŒºåŸŸç»™ç”¨æˆ·è¾“å…¥æ–‡å­—æä¾›äº†æ–¹ä¾¿ï¼Œå®ƒå¯ä»¥æ˜¯å•è¡Œçš„ä¹Ÿå¯ä»¥æ˜¯å¤šè¡Œçš„ã€‚è§¦æ‘¸ä¸€ä¸ªæ–‡æœ¬åŒºåŸŸè·å–å…‰æ ‡å¹¶ä¸”è‡ªåŠ¨å¼¹å‡ºé”®ç›˜ã€‚é™¤äº†å¯ä»¥è¾“å…¥æ–‡å­—ï¼Œæ–‡æœ¬åŒºåŸŸè¿˜å¯ä»¥ç”¨æ¥æ‰§è¡Œå¦‚æ–‡æœ¬é€‰ä¸­ï¼ˆå‰ªåˆ‡ï¼Œå¤åˆ¶å’Œç²˜è´´ï¼‰å’Œé€šè¿‡è‡ªåŠ¨è¡¥å…¨å®ç°çš„æ•°æ®æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨å¸ƒå±€ä¸­æ·»åŠ ä¸€ä¸ªEditTextå¯¹è±¡æ¥å®ç°æ–‡æœ¬åŒºåŸŸï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ EditText Tag. æŒ‡å®šé”®ç›˜ç±»å‹Text fields can have different input types, such as number, date, password, or email address. The type determines what kind of characters are allowed inside the field, and may prompt the virtual keyboard to optimize its layout for frequently used characters. You can specify the type of keyboard you want for your EditText object with the android:inputType attribute. For example, if you want the user to input an email address, you should use the textEmailAddress input type: æ–‡æœ¬åŒºåŸŸæœ‰ä¸åŒçš„è¾“å…¥ç±»å‹ï¼Œå¦‚æ•°å­—ï¼Œæ—¥æœŸï¼Œå¯†ç æˆ–è€…é‚®ç®±åœ°å€ã€‚è¾“å…¥ç±»å‹å†³å®šäº†æ–‡æœ¬åŒºåŸŸå†…å…è®¸è¾“å…¥çš„å­—ç¬¦ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿæç¤ºç€è™šæ‹Ÿé”®ç›˜ç»™ç”¨æˆ·å±•ç¤ºæ›´åŠ å¸¸ç”¨çš„å­—ç¬¦é›†åˆã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ android:inputType å±æ€§æ¥æ˜ç¡®æˆ‘ä»¬çš„è¾“å…¥æ¡†æƒ³è¦çš„é”®ç›˜ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦è¾“å…¥é‚®ç®±åœ°å€ï¼Œä½ å¯ä»¥ä½¿ç”¨textEmailAddressè¾“å…¥ç±»å‹ã€‚ 123456&lt;EditText android:id=\"@+id/email_address\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:hint=\"@string/email_hint\" android:inputType=\"textEmailAddress\" /&gt; android:inputType è§£é‡Š â€œnoneâ€ ä¸å¼¹å‡ºé”®ç›˜ â€œtextâ€ æ™®é€šæ–‡æœ¬é”®ç›˜ â€œtextEmailAddressâ€ æ™®é€šæ–‡æœ¬é”®ç›˜ï¼Œâ€@â€ â€œtextUriâ€ æ™®é€šæ–‡æœ¬é”®ç›˜ï¼Œâ€/â€œ â€œnumberâ€ æ•°å­—é”®ç›˜ â€œphoneâ€ Phone-Styleé”®ç›˜ æ§åˆ¶å…¶ä»–è¡Œä¸ºandroid:inputTypeå±æ€§ä¸ä»…å¯ä»¥ç”¨æ¥æ§åˆ¶æ˜¾ç¤ºç‰¹å®šçš„é”®ç›˜ç±»å‹ï¼Œè€Œä¸”è¿˜å¯ä»¥ç”¨æ¥æ˜ç¡®ä¸€äº›é”®ç›˜çš„è¡Œä¸ºï¼Œä¾‹å¦‚æ˜¯å¦å¤§å†™ï¼Œè‡ªåŠ¨è¡¥å…¨æˆ–è€…æ˜¯æ‹¼å†™å»ºè®®ç­‰ã€‚android:inputTypeä½¿ç”¨æŒ‰ä½ä¸çš„æ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šå¤šç§è¡Œä¸º android:inputType è§£é‡Š â€œtextCapSentencesâ€ æ­£å¸¸çš„æ–‡æœ¬é”®ç›˜ä½†æ˜¯æ¯ä¸€å¥è¯ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™ â€œtextCapWordsâ€ æ­£å¸¸æ–‡æœ¬é”®ç›˜ä½†æ˜¯æ¯ä¸€ä¸ªå•è¯çš„ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™ â€œtextAutoCorrectâ€ è‡ªåŠ¨æç¤ºæ‹¼å†™é”™è¯¯ â€œtextPasswordâ€ è¾“å…¥çš„æ–‡å­—éƒ½å˜æˆç‚¹ç‚¹ â€œtextMultiLineâ€ å…è®¸è¾“å…¥å¤šè¡Œæ–‡æœ¬ï¼Œå¯ä»¥æ¢è¡Œ å…³äºandroid:inputTypeå±æ€§æœ‰å¾ˆå¤šï¼Œä¸Šé¢éƒ½åªæ˜¯ä¸€äº›ä¾‹å­ï¼Œæ„Ÿè§‰åº”è¯¥å¾ˆå…¨äº†ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚ æŒ‡å®šé”®ç›˜è¡Œä¸ºé™¤äº†æ”¹å˜é”®ç›˜çš„è¾“å…¥ç±»å‹,Androidå…è®¸å½“ç”¨æˆ·å®Œæˆè¾“å…¥æŒ‡å®šä¸€ä¸ªåŠ¨ä½œï¼Œå‡ºç°çš„æ“ä½œæŒ‡å®šæŒ‰é’®çš„å›è½¦é”®å’ŒåŠ¨ä½œ,å¦‚â€œæœç´¢â€æˆ–â€œå‘é€â€é”®ã€‚ä¾‹å¦‚ï¼š 1234567&lt;EditText android:id=\"@+id/search\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:hint=\"@string/search_hint\" android:inputType=\"text\" android:imeOptions=\"actionSearch\" /&gt; é”®ç›˜ä¼šæ˜¾ç¤ºå‡ºâ€œæœç´¢â€æŒ‰é’®ï¼Œæ¨ªå±ä¹‹åä¸ä»…é”®ç›˜ä¼šå‡ºç°æœç´¢æŒ‰é’®ï¼Œå³ä¾§è¿˜ä¼šå‡ºç°å¯¹åº”çš„å­—ä¸² ä¸»è¦æ˜¯å¯¹ android:imeOptions å±æ€§çš„ä½¿ç”¨è¿™ä¹ˆå¤šçš„è¡Œä¸ºå¯ä¾›é€‰æ‹©ï¼Œä¸Šé¢åªæ˜¯ä¸¾ä¾‹è¯´æ˜ å¯¹é”®ç›˜ä¸­å®šä¹‰çš„è¡Œä¸ºçš„å“åº”é€šè¿‡android:imeOptions å®šä¹‰çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒå®šä¹‰çš„è¡Œä¸ºä½œå‡ºå“åº”.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨TextView.OnEditorActionListeneræ¥è¿›è¡Œäº‹ä»¶çš„ç›‘å¬å’Œå¤„ç†ã€‚é€šè¿‡å¦‚ IME_ACTION_SEND æˆ–è€…IME_ACTION_SEARCHç­‰äº‹ä»¶IDæ¥é’ˆå¯¹ä¸åŒçš„äº‹ä»¶è¡Œä¸ºåšå‡ºä¸åŒçš„å¤„ç†ã€‚ä¾‹å¦‚ 123456789101112EditText editText = (EditText) findViewById(R.id.search);editText.setOnEditorActionListener(new OnEditorActionListener() { @Override public boolean onEditorAction(TextView v, int actionId, KeyEvent event) { boolean handled = false; if (actionId == EditorInfo.IME_ACTION_SEND) { sendMessage(); handled = true; } return handled; }}); è‡ªå®šä¹‰è¾“å…¥å®Œæˆåé”®ç›˜è¡Œä¸ºçš„æ ‡ç­¾android:imeActionLabelå±æ€§å°±æ˜¯ç”¨æ¥è®¾ç½®è¿™ä¸ªå†…å®¹çš„ 1234567&lt;EditText android:id=\"@+id/launch_codes\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:hint=\"@string/enter_launch_codes\" android:inputType=\"number\" android:imeActionLabel=\"å¯åŠ¨\" /&gt; è‡ªåŠ¨è¡¥å…¨å»ºè®®ä½¿ç”¨AutoCompleteTextView å¸ƒå±€å®šä¹‰123456&lt;AutoCompleteTextView android:completionThreshold=\"1\"//é»˜è®¤æ˜¯2ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆé»˜è®¤è¾“å…¥ä¸¤ä¸ªå­—ç¬¦æ‰èƒ½æ˜¾ç¤ºå‡ºæç¤ºä¿¡æ¯çš„åŸå›  android:id=\"@+id/autocomplete_country\" android:layout_width=\"match_parent\" android:text=\"@android:string/dialog_alert_title\" android:layout_height=\"wrap_content\" /&gt; ä»£ç å®ç°1234567891011121314@Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); // Get a reference to the AutoCompleteTextView in the layout AutoCompleteTextView textView = (AutoCompleteTextView) findViewById(R.id.autocomplete_country); // Get the string array String[] countries = getResources().getStringArray(R.array.countries_array); // Create the adapter and set it to the AutoCompleteTextView ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_list_item_1, countries); textView.setAdapter(adapter);//è®¾ç½®æç¤ºå†…å®¹ } æç¤ºæ•°ç»„12345678910&lt;string-array name=\"countries_array\"&gt; &lt;item&gt;Afghanistan&lt;/item&gt; &lt;item&gt;Albania&lt;/item&gt; &lt;item&gt;Algeria&lt;/item&gt; &lt;item&gt;American Samoa&lt;/item&gt; &lt;item&gt;Andorra&lt;/item&gt; &lt;item&gt;Angola&lt;/item&gt; &lt;item&gt;Anguilla&lt;/item&gt; &lt;item&gt;Antarctica&lt;/item&gt;&lt;/string-array&gt; å¤‡æ³¨å†…å®¹ä¸»è¦æ¥è‡ªäºAndroidå®˜ç½‘æ•™ç¨‹ï¼š[https://developer.android.com/guide/topics/ui/controls/text.html(https://developer.android.com/guide/topics/ui/controls/text.html)","link":"/2016/09/28/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåå››ï¼‰ã€‹ EditText/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒï¼‰ã€‹ BroadcastReceiver","text":"ä»‹ç»BroadcastReceiverï¼šå¹¿æ’­æ¥æ”¶è€…ï¼Œå¾ˆå½¢è±¡ï¼Œå¹¿æ’­å‘é€ï¼Œç±»æ¯”ç”Ÿæ´»ä¸­çš„å¹¿æ’­ï¼Œæœ‰èƒ½åŠ›å¬å¾—åˆ°çš„éƒ½å¯ä»¥ä»‹ç»åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œç„¶ååœ¨å¤§è„‘ä¸­åæ˜ ã€‚å¯¹åº”åˆ°Androidä¸­å°±æ˜¯SendBroadcastå’ŒonReceiveã€‚å¹¿æ’­ä¹‹é—´ä¿¡æ¯çš„ä¼ é€’æ˜¯é€šè¿‡Intentå¯¹è±¡æ¥ä¼ é€’çš„ï¼ŒIntentè°ƒç”¨åˆ†ä¸ºæ˜¾ç¤ºè°ƒç”¨çš„éšå¼è°ƒç”¨ä¸¤ç§ã€‚ ä½¿ç”¨æ–¹æ³•å¹¿æ’­æ¥æ”¶è€…1234567891011121314public class MyReceiver extends BroadcastReceiver { public static final String HELLOACTION = \"com.example.mraz.learnbroadcastreceiver.android.intent.action.HELLO\"; public MyReceiver() { } @Override public void onReceive(Context context, Intent intent) { String str = intent.getStringExtra(\"message\"); System.out.println(\"on Reveiver\" + str); }} é™æ€æ³¨å†ŒAndroidManifest.xml 123456789&lt;receiver android:name=\".MyReceiver\" android:enabled=\"true\" android:exported=\"true\" &gt; &lt;intent-filter&gt; &lt;action android:name=\"com.example.mraz.learnbroadcastreceiver.android.intent.action.HELLO\"/&gt; &lt;/intent-filter&gt;&lt;/receiver&gt; åŠ¨æ€æ³¨å†Œ123IntentFilter intentFilter = new IntentFilter();intentFilter.addAction(MyReceiver.HELLOACTION);registerReceiver(myReceiver, intentFilter); 1unregisterReceiver(myReceiver);//è§£é™¤æ³¨å†Œ ç»“æœ Demoç•Œé¢ é™æ€æ³¨å†Œæ–¹å¼ä¸‹ï¼š å‘é€å¹¿æ’­-&gt;å–æ¶ˆæ³¨å†Œ -&gt;å‘é€å¹¿æ’­ åŠ¨æ€æ³¨å†Œæ–¹å¼ä¸‹ï¼š å‘é€å¹¿æ’­-&gt;æ³¨å†Œå¹¿æ’­-&gt;å‘é€å¹¿æ’­-&gt; å–æ¶ˆæ³¨å†Œ -&gt; å‘é€å¹¿æ’­","link":"/2016/05/25/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒï¼‰ã€‹ BroadcastReceiver/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäº”ï¼‰ã€‹MVVM","text":"ä»‹ç» MVVMï¼ŒModel-View-ViewModelï¼Œä¸ä¸Šæ¬¡è®²çš„MVPæ¨¡å¼æ¯”è¾ƒçš„ç±»ä¼¼ï¼ŒMVPä¸­éœ€è¦å¤§é‡çš„æ¥å£æ–‡ä»¶ï¼Œè€ŒMVVMæ¨¡å¼ä¸‹ï¼ŒViewå’ŒViewModelç›´æ¥å…³è”ï¼Œä½¿ç”¨ä¸Šæ¯”è¾ƒæ–¹ä¾¿ï¼Œç®€åŒ–äº†ä»£ç .å¤§è‡´çš„ç»“æ„å›¾å¦‚ä¸‹ï¼šå¯ä»¥çœ‹å¾…Viewå’ŒViewModelæ˜¯åŒå‘çš„äº¤äº’ï¼Œè¿™ä¸€ç‚¹å¾ˆå…³é”® DataBinding Data Binding Libraryæ˜¯Googleæ¨å‡ºçš„ï¼Œå¯ä»¥è¯´æ˜¯é’ˆå¯¹MVVMæ¨¡å¼çš„æ”¯æŒåº“ï¼Œé€šè¿‡åœ¨Layoutä¸­è¿›è¡Œæ•°æ®çš„è®¿é—®ï¼Œæ¥å®ç°Viewå’ŒDataçš„åŒå‘ç»‘å®šã€‚ä¸ä»…ä½¿ç”¨çµæ´»ï¼Œç”¨æ³•ä¸°å¯Œï¼Œè€Œä¸”æ”¯æŒä¹Ÿæ˜¯ç›¸å½“çš„å¹¿æ³›ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½äº†ä»£ç é‡å’Œè€¦åˆæ€§ï¼Œå‡å°‘äº†å¼€å‘è€…çš„å‹åŠ›ã€‚ build.gradle123dataBinding { enabled= true} è¿™æ ·ä½¿ç”¨æ¯”è¾ƒçš„æ–¹æ³•ï¼Œå½“ç„¶è¿™ä¸ªéœ€è¦å½“å‰çš„Gradleç‰ˆæœ¬æ”¯æŒè¿™ä¸ªå±æ€§ Layout Data1234567891011121314&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;layout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\"&gt; &lt;data&gt; &lt;import type=\"com.example.mraz.mvvmdemo.Model.User\"&gt;&lt;/import&gt; &lt;variable name=\"user\" type=\"User\"&gt; &lt;/variable&gt; &lt;/data&gt; &lt;LinearLayout ... &lt;/LinearLayout&gt;&lt;/layout&gt; æœ€å®Œæˆä½¿ç”¨Layoutå±æ€§ï¼Œé€šè¿‡dataå±æ€§å€¼ï¼Œæ·»åŠ éœ€è¦åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨çš„å˜é‡å’Œå¯¹åº”çš„å˜é‡ç±»å‹ï¼Œä¹Ÿå¯ä»¥å…ˆimportæ–‡ä»¶ï¼Œç„¶åç›´æ¥ä½¿ç”¨ï¼Œä¸ç„¶å°±éœ€è¦åœ¨typeä¸­ä½¿ç”¨ç±»å‹çš„å®Œæ•´è·¯å¾„ï¼Œå½“é‡åˆ°ç›¸åŒçš„ç±»åçš„æ—¶å€™ï¼ŒDataBindingæ”¯æŒåˆ«åçš„å®šä¹‰ï¼Œalias Layout Access Dataå¸ƒå±€æ–‡ä»¶æ–‡ä»¶ä¸­å¦‚ä½•å®ç°å¯¹ç»‘å®šæ•°æ®çš„è®¿é—® 1234567891011&lt;TextView android:id=\"@+id/tv_username\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:text=\"@{user.getUsername()}\" /&gt;&lt;TextView android:id=\"@+id/tv_password\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:text=\"@{user.getPassword()}\" /&gt; ä½¿ç”¨æ ¼å¼ä¸ºâ€œ@{ }â€ï¼Œå¤§æ‹¬å·ä¸­çš„ä½¿ç”¨æ–¹å¼ä¸ä»£ç ä¸­çš„åŸºæœ¬æ— å·®åˆ«ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¯¹åº”çš„æˆå‘˜å˜é‡ï¼Œå½“ç„¶å¦‚æœæƒé™å…è®¸çš„è¯ï¼Œå¦‚æœè¦ç›´æ¥è®¿é—®privateå˜é‡æˆ–è€…æ–¹æ³•ï¼Œæ˜¾ç„¶æ˜¯ä¸ç°å®çš„ã€‚ Activity Set Data123456789101112131415161718192021222324252627282930313233public class MainActivity extends AppCompatActivity { User user = new User(\"\", \"\"); @Bind(R.id.et_username) EditText etUsername; @Bind(R.id.et_password) EditText etPassword; @Bind(R.id.tv_username) TextView tvUsername; @Bind(R.id.tv_password) TextView tvPassword; ActivityMainBinding activityMainBinding; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); activityMainBinding = DataBindingUtil.setContentView(this, R.layout.activity_main); ButterKnife.bind(this);} @OnTextChanged(value = R.id.et_username, callback = OnTextChanged.Callback.TEXT_CHANGED) void onUserNameChanged(CharSequence s,int start,int before,int count) { user.setUsername(s.toString()); activityMainBinding.setUser(user); } @OnTextChanged(value = R.id.et_password, callback = OnTextChanged.Callback.TEXT_CHANGED) void onPasswordChangedps(CharSequence s,int start,int before,int count) { user.setPassword(s.toString()); activityMainBinding.setUser(user); }} å‡ ä¸ªå…³é”®ç‚¹ï¼š ActivityMainBinding activityMainBindingè¿™é‡Œå®šä¹‰çš„å˜é‡ç±»å‹ActivityMainBinding ä¸å¸ƒå±€æ–‡ä»¶å¯¹åº”activity_main â€”â€”-&gt; ActivityMainBindingfirst_second â€”â€”-&gt; FirstSecondingBindingBindingç±»çš„å‘½åæ˜¯åŸºäºæ‰€è¿°layoutæ–‡ä»¶çš„åç§°ï¼Œç”¨å¤§å†™å¼€å¤´ï¼Œé™¤å»ä¸‹åˆ’çº¿ï¼ˆï¼‰ä»¥åŠï¼ˆï¼‰åçš„ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™ï¼Œç„¶åæ·»åŠ â€œBindingâ€åç¼€ã€‚è¿™ä¸ªç±»å°†è¢«æ”¾ç½®åœ¨ä¸€ä¸ªæ¨¡å—å°è£…åŒ…é‡Œçš„databindingå°è£…åŒ…ä¸‹ Bindingç±»å¯é€šè¿‡è°ƒæ•´dataå…ƒç´ ä¸­çš„classå±æ€§æ¥é‡å‘½åæˆ–æ”¾ç½®åœ¨ä¸åŒçš„åŒ…ä¸­ã€‚ä¾‹å¦‚ï¼š 123&lt;data class=\"UserBinding\"&gt; ...&lt;/data&gt; activityMainBinding = DataBindingUtil.setContentView(this, R.layout.activity_main);è·å–ActivityMainBindingå¯¹è±¡ï¼Œç”¨äºåé¢è®¾ç½®å˜é‡activityMainBinding.setUser(user);è®¾ç½®æ•°æ®ï¼ŒUserå˜é‡ è¡¨è¾¾å¼å¸¸ç”¨çš„è¡¨è¾¾å¼å’Œæ­£å¸¸çš„javaä»£ç æ¯”è¾ƒç±»ä¼¼ æ•°å­¦ + - / * % å­—ç¬¦ä¸²è¿æ¥ +; é€»è¾‘ &amp;&amp; || äºŒè¿›åˆ¶ &amp; | ^ ä¸€å…ƒè¿ç®— + - ! ~ ç§»ä½ &gt;&gt; &gt;&gt;&gt; &lt;&lt; æ¯”è¾ƒ == &gt; &lt; &gt;= &lt;= instanceof åˆ†ç»„ () null Cast æ–¹æ³•è°ƒç”¨ æ•°æ®è®¿é—® [] ä¸‰å…ƒè¿ç®— ?: ä¸æ”¯æŒçš„æ“ä½œ this super new æ˜¾å¼æ³›å‹è°ƒç”¨ å®é™…æ•ˆæœå›¾ å¤‡æ³¨ï¼š å…³äºDataBindingï¼Œè¿™é‡Œæœ‰ä¸€ç¯‡æ–‡ç« è®²å¾—å¾ˆæ¸…æ™°ï¼Œæ¨èä¸€ä¸‹ https://segmentfault.com/a/1190000002876984 æ•ˆæœå›¾å¯¹åº”çš„ä»£ç è´´äº†ä¸€éƒ¨åˆ†ï¼Œå®ç°ç›¸å¯¹æ¯”è¾ƒå®¹æ˜“ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œå¦‚æœæœ‰éœ€è¦çš„ç•™è¨€ï¼Œæˆ‘å†é™„ä¸Šã€‚","link":"/2016/06/05/ã€ŠAndroid åŸºç¡€ï¼ˆäº”ï¼‰ã€‹MVVM/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåä¸€ï¼‰ã€‹ Snackbar","text":"ç®€ä»‹ Snackbars provide lightweight feedback about an operation. They show a brief message at thebottom of the screen on mobile and lower left on larger devices. Snackbars appear above all otherelements on screen and only one can be displayed at a time. They automatically disappear after a timeout or after user interaction elsewhere on the screen,particularly after interactions that summon a new surface or activity. Snackbars can be swipedoff screen. Snackbars can contain an action which is set via{@link #setAction(CharSequence, android.view.View.OnClickListener)}.To be notified when a snackbar has been shown or dismissed, you can provide a {@link Callback} via {@link #setCallback(Callback)}. ç¿»è¯‘ï¼šSnackbarä¸ºç”¨æˆ·çš„ä¸€ä¸ªæ“ä½œæä¾›è½»é‡çº§çš„åé¦ˆï¼Œä»–ä¼šåœ¨æ‰‹æœºå±å¹•çš„åº•éƒ¨æˆ–è€…æ˜¯å¤§è®¾å¤‡çš„å·¦ä¸‹æ–¹æ˜¾ç¤ºä¸€ä¸ªç®€æ´çš„æ¶ˆæ¯ã€‚Snackbarå‡ºç°åœ¨å±å¹•æ‰€æœ‰å…ƒç´ çš„ä¸Šé¢ï¼Œæ˜¾ç¤ºä¸€å°ä¼šã€‚Snackbaræ˜¾ç¤ºä¸€ä¼šåä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œç”¨æˆ·ç‚¹å‡»å…¶ä»–åœ°æ–¹çš„æ—¶å€™ä¹Ÿä¼šæ¶ˆå¤±ï¼Œå°¤å…¶ï¼Œå½“æ˜¾ç¤ºä¸€ä¸ªæ–°çš„ç•Œé¢çš„æ—¶å€™ï¼ŒSnackbarä¼šæ»‘å‡ºç•Œé¢ã€‚Snackbar å¯ä»¥é€šè¿‡setAction(CharSequence, android.view.View.OnClickListener) æ¥è®¾ç½®ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡setCallback(Callback)æ¥ç›‘å¬snackbarçš„æ˜¾ç¤ºå’Œæ¶ˆå¤±ã€‚ ç±»ç»“æ„Snackbarä¸­Publicå±æ€§åˆ—è¡¨ æ–¹æ³•æˆ–æ¥å£ æ„ä¹‰ Callback æŠ½è±¡å‡½æ•°ç”¨æ¥è®¾ç½®SnackBaræ˜¾ç¤ºå’Œæ¶ˆå¤±çš„å›è°ƒ make åˆ›å»ºSnackBar setAction è®¾ç½®ActionViewçš„å“åº”äº‹ä»¶ show æ˜¾ç¤ºSnackBar dismiss æ”¶èµ·SnackBar setActionTextColor è®¾ç½®ActionViewçš„å­—ä½“é¢œè‰² setText è®¾ç½®TextViewçš„æ˜¾ç¤ºå†…å®¹ setDuration è®¾ç½®SnackBarçš„æ˜¾ç¤ºæ—¶é—´ getDuration è·å–SnackBarçš„æ˜¾ç¤ºæ—¶é—´ getView è·å–SnackBarçš„Viewè§†å›¾ setCallback è®¾ç½®æ˜¾ç¤ºå’Œæ¶ˆå¤±çš„äº‹ä»¶ç›‘å¬ isShown æ˜¯å¦å·²ç»æ˜¾ç¤º shownOrQueued æ˜¯å¦å·²ç»æ˜¾ç¤ºæˆ–è€…åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…æ˜¾ç¤º æ•´ç†è€Œè¨€çš„è¯ï¼Œæ„Ÿè§‰Snackbarå°±æ˜¯Toastçš„ä¸€ä¸ªå‡çº§ç‰ˆæœ¬ï¼Œä½¿ç”¨çš„æ–¹å¼å’ŒToastä¹Ÿæ¯”è¾ƒç›¸ä¼¼ã€‚ åˆ›å»ºSnackbarä¹‹åä¸€å®šè¦è®°å¾—è°ƒç”¨show()æ–¹æ³• åŸºç¡€ä½¿ç”¨ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667package mraz.com.snackdemo;import android.os.Bundle;import android.support.design.widget.Snackbar;import android.support.v7.app.AppCompatActivity;import android.view.View;import android.widget.Button;import android.widget.RelativeLayout;import android.widget.Toast;public class MainActivity extends AppCompatActivity implements View.OnClickListener { RelativeLayout rootLayout; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); rootLayout = (RelativeLayout) findViewById(R.id.root_layout); Button shortButton = (Button) findViewById(R.id.short_button); Button longButton = (Button) findViewById(R.id.long_button); shortButton.setOnClickListener(this); longButton.setOnClickListener(this); } @Override public void onClick(View view) { switch (view.getId()) { case R.id.short_button: final Snackbar shortSnackbar = Snackbar.make(rootLayout, \" Short SnackBar\", Snackbar.LENGTH_SHORT); shortSnackbar.setAction(\"Click\", new View.OnClickListener() { @Override public void onClick(View view) { Toast.makeText(rootLayout.getContext(), \"Shoort Snackbar onClick\", Toast.LENGTH_SHORT).show(); } } ); shortSnackbar.setActionTextColor(getResources().getColor(R.color.colorPrimaryDark)); shortSnackbar.show(); break; case R.id.long_button: Snackbar longSnackbar = Snackbar.make(rootLayout, \" Long SnackBar\", Snackbar.LENGTH_LONG); longSnackbar.setCallback(new SnackCallback()); longSnackbar.show(); break; } } class SnackCallback extends Snackbar.Callback { @Override public void onDismissed(Snackbar snackbar, int event) { super.onDismissed(snackbar, event); Toast.makeText(rootLayout.getContext(), \"SnackBar onDismissed\", Toast.LENGTH_SHORT).show(); } @Override public void onShown(Snackbar snackbar) { super.onShown(snackbar); Toast.makeText(rootLayout.getContext(), \"SnackBar onShown\", Toast.LENGTH_SHORT).show(); } }} æ•ˆæœ","link":"/2016/07/03/ã€ŠAndroid åŸºç¡€ï¼ˆåä¸€ï¼‰ã€‹ Snackbar/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåäºŒï¼‰ã€‹ TextInputLayoutï¼Œè®©è¾“å…¥æ¡†æ›´æœ‰çµæ€§","text":"ä»‹ç» Layout which wraps an {@link android.widget.EditText} (or descendant) to show a floating labelwhen the hint is hidden due to the user inputting text. Also supports showing an error via {@link #setErrorEnabled(boolean)} and{@link #setError(CharSequence)}, and a character counter via{@link #setCounterEnabled(boolean)} ç¿»è¯‘ï¼šTextInputLayoutéœ€è¦åŒ…è£¹ä¸€ä¸ªEditTextæ¥å®ç°å½“ç”¨æˆ·è¾“å…¥æ–‡æœ¬çš„æ—¶å€™ï¼Œå°†hintä½œä¸ºä¸€ä¸ªæµ®åŠ¨çš„æ ‡ç­¾æ˜¾ç¤ºçš„æ•ˆæœã€‚ä½¿ç”¨æ¯”è¾ƒå¤šå¤§çš„ä¸¤ä¸ªæ–¹æ³•ï¼šsetError(CharSequence) - &gt; ä½¿èƒ½é”™è¯¯æ¶ˆæ¯æç¤ºå¯¹åº”å±æ€§å€¼ï¼šapp:errorEnabled=â€œtrueâ€setCounterEnabled(boolean) -&gt; ä½¿èƒ½å­—ç¬¦é•¿åº¦æ˜¾ç¤ºå¯¹åº”å±æ€§å€¼ï¼šapp:counterEnabled=â€œtrueâ€ ç±»ä»‹ç»TextInputLayoutçš„çˆ¶ç±»æ˜¯LinearLayoutï¼Œæºç ä½ç½®frameworks/support/design/src/android/support/design/widget/TextInputLayout.javaç±»ç»“æ„è§†å›¾ æ–¹æ³• æ„ä¹‰ setTypeface è®¾ç½®tfå­—ä½“ getEditText è·å–EditTextè§†å›¾ setHint è®¾ç½®Hintå†…å®¹ setHintEnabled ä½¿èƒ½hint setHintTextAppearance è®¾ç½®hintçš„Text Style setErrorEnabled ä½¿èƒ½é”™è¯¯æç¤º setError è®¾ç½®é”™è¯¯æç¤ºæ¶ˆæ¯ setCounterEnabled ä½¿èƒ½è®¡æ•° setCounterMaxLength è®¾ç½®è¾“å…¥æ¡†æœ€å¤§é•¿åº¦ setHintAnimationEnabled ä½¿èƒ½Hintæµ®åŠ¨åŠ¨ç”»ï¼Œé»˜è®¤ä¸ºtrue æ€»ä½“æ¥çœ‹ï¼Œç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯é”™è¯¯æ¶ˆæ¯æç¤ºå’Œè®¡æ•°åŠŸèƒ½ï¼Œå¯¹å­—ä½“çš„ä¸€äº›è®¾ç½®å’ŒTextViewå’ŒEditTextä½¿ç”¨æ–¹æ³•ç±»ä¼¼ï¼Œè¿™ä¸ªå¸ƒå±€çš„ç‰¹ç‚¹å°±æ˜¯è§†è§‰æ„Ÿå—å’Œç”¨æˆ·ä½“éªŒæ¯”ç®€å•çš„è¾“å…¥æ¡†æ–‡æœ¬æ¡†æå‡å¾ˆå¤šã€‚ç¬¦åˆgoogleçš„å¯¼å‘ï¼Œä½†æ˜¯å¾ˆå¤šapkä¸­å¾ˆå°‘çœ‹åˆ°äººä½¿ç”¨ï¼Œåº”è¯¥å¤§å®¶æœ‰æ›´ç‚«é…·çš„æ–¹æ³•ã€‚ åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶activity_main.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:focusable=\"true\" android:focusableInTouchMode=\"true\" android:orientation=\"vertical\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"mraz.com.tabdemo.MainActivity\"&gt; &lt;android.support.design.widget.TextInputLayout android:id=\"@+id/til_username\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" app:errorEnabled=\"true\"&gt; &lt;android.support.design.widget.TextInputEditText android:id=\"@+id/et_username\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:hint=\"Username...\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;android.support.design.widget.TextInputLayout android:id=\"@+id/til_password\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" app:counterEnabled=\"true\" app:counterMaxLength=\"40\"&gt; &lt;EditText android:id=\"@+id/et_password\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:hint=\"Password...\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;Button android:id=\"@+id/bt_showerror\" android:layout_width=\"200dp\" android:layout_height=\"wrap_content\" android:text=\"ShowError\" android:textAllCaps=\"false\" /&gt; &lt;Button android:id=\"@+id/bt_clearerror\" android:layout_width=\"200dp\" android:layout_height=\"wrap_content\" android:text=\"ClearError\" android:textAllCaps=\"false\" /&gt;&lt;/LinearLayout&gt; ä»£ç å†…å®¹MainActivity.java 12345678910111213141516171819202122232425262728293031323334353637package mraz.com.tabdemo;import android.os.Bundle;import android.support.design.widget.TextInputLayout;import android.support.v7.app.AppCompatActivity;import android.view.View;import android.widget.Button;public class MainActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); final TextInputLayout userTextInputLayout = (TextInputLayout) findViewById(R.id.til_username); TextInputLayout passTextInputLayout = (TextInputLayout) findViewById(R.id.til_password); Button showErrorBtn = (Button) findViewById(R.id.bt_showerror); showErrorBtn.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { userTextInputLayout.setError(\"UserName is not correct!\"); } }); Button clearErrorBtn = (Button) findViewById(R.id.bt_clearerror); clearErrorBtn.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { userTextInputLayout.setError(\"\"); } }); }} ä»£ç ä¸Šå°±ä¸ä¸Šæ³¨é‡Šäº†ï¼Œå¦‚æœæœ‰ç–‘é—®è¯·æå‡ºæ¥ï¼Œä¸è¿‡ä»£ç å¾ˆç®€æ´ï¼Œåº”è¯¥é—®é¢˜ä¸å¤§ã€‚ æ•ˆæœ","link":"/2016/07/03/ã€ŠAndroid åŸºç¡€ï¼ˆåäºŒï¼‰ã€‹ TextInputLayoutï¼Œè®©è¾“å…¥æ¡†æ›´æœ‰çµæ€§/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåå…«ï¼‰ã€‹ XLIFF","text":"ä»‹ç» XLIFF ï¼ŒXML Localization Interchange File Formatï¼ŒXMLæœ¬åœ°åŒ–æ•°æ®äº¤æ¢æ ¼å¼ã€‚ åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶activity_main.xml 12345678910111213141516171819202122232425&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;ScrollView xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"mraz.com.uiwidgetdemo.MainActivity\"&gt; &lt;TextView android:id=\"@+id/tv_hello\" android:textSize=\"10pt\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:text=\"@string/hello\" /&gt; &lt;/LinearLayout&gt;&lt;/ScrollView&gt; Stringèµ„æºæ–‡ä»¶12345&lt;resources xmlns:xliff=\"http://schemas.android.com/tools\"&gt; &lt;string name=\"hello\"&gt;your name is &lt;xliff:g id=\"NAME\"&gt;%1$s&lt;/xliff:g&gt;, and your age is&lt;xliff:g id=\"AGE\"&gt;%2$s&lt;/xliff:g&gt;&lt;/string&gt; &lt;string name=\"hello_simple\"&gt;your name is %1$s, and your age is %2$s&lt;/string&gt;&lt;/resources&gt; ä¸¤ç§ï¼Œä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨%1$sç±»ä¼¼çš„æ ¼å¼ï¼Œå¦å¤–ä¸€ç§å°±æ˜¯ä½¿ç”¨ xliff:g ç»™éœ€è¦æ›¿æ¢çš„å†…å®¹åŠ äº†ä¸ªåå­—è€Œå·²ï¼Œæ•ˆæœæ˜¯ç›¸åŒçš„ã€‚å±æ€§idå¯ä»¥éšä¾¿å‘½å%n$msï¼šä»£è¡¨è¾“å‡ºçš„æ˜¯å­—ç¬¦ä¸²ï¼Œnä»£è¡¨æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè®¾ç½®mçš„å€¼å¯ä»¥åœ¨è¾“å‡ºä¹‹å‰æ”¾ç½®ç©ºæ ¼%n$mdï¼šä»£è¡¨è¾“å‡ºçš„æ˜¯æ•´æ•°ï¼Œnä»£è¡¨æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè®¾ç½®mçš„å€¼å¯ä»¥åœ¨è¾“å‡ºä¹‹å‰æ”¾ç½®ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥è®¾ä¸º0m,åœ¨è¾“å‡ºä¹‹å‰æ”¾ç½®mä¸ª0%n$mfï¼šä»£è¡¨è¾“å‡ºçš„æ˜¯æµ®ç‚¹æ•°ï¼Œnä»£è¡¨æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè®¾ç½®mçš„å€¼å¯ä»¥æ§åˆ¶å°æ•°ä½æ•°ï¼Œå¦‚m=2.2æ—¶ï¼Œè¾“å‡ºæ ¼å¼ä¸º00.00 ä»£ç 12345TextView textView= (TextView) findViewById(R.id.tv_hello);String hello = getString(R.string.hello_simple, \"android\", \"28\");textView.setText(hello); æ•ˆæœ","link":"/2016/08/03/ã€ŠAndroid åŸºç¡€ï¼ˆåå…«ï¼‰ã€‹ XLIFF/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåå››ï¼‰ã€‹ selector","text":"ä»‹ç» A StateListDrawable is a drawable object defined in XML that uses a several different images to represent the same graphic, depending on the state of the object. For example, a Button widget can exist in one of several different states (pressed, focused, or niether) and, using a state list drawable, you can provide a different background image for each state. You can describe the state list in an XML file. Each graphic is represented by an â€œitemâ€ element inside a single â€œselectorâ€ element. Each â€œitemâ€ uses various attributes to describe the state in which it should be used as the graphic for the drawable.During each state change, the state list is traversed top to bottom and the first item that matches the current state is usedâ€”the selection is not based on the â€œbest match,â€ but simply the first item that meets the minimum criteria of the state. ç¿»è¯‘ï¼šStateListDrawable æ˜¯ä¸€ç§é€šè¿‡XMLæ–‡ä»¶æ¥å®šä¹‰çš„drawableï¼Œä½¿ç”¨å‡ ä¸ªä¸åŒçš„å›¾ç‰‡æ¥å‘ˆç°åŒä¸€ä¸ªå›¾å½¢ï¼Œé€šè¿‡objectçš„çŠ¶æ€æ¥å®ç°åˆ‡æ¢ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªButtonæœ‰å‡ ä¸ªä¸åŒçš„çŠ¶æ€ï¼ˆæŒ‰å‹ï¼Œè·å–ç„¦ç‚¹ç­‰ç­‰ï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡ä½¿ç”¨ state list drawableï¼Œä½ å°±å¯ä»¥å®ç°åœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ä½¿ç”¨ä¸åŒçš„èƒŒæ™¯å›¾ç‰‡ã€‚ä½ å¯ä»¥åœ¨ä¸€ä¸ªXMLæ–‡ä»¶ä¸­æè¿°state listã€‚é€šè¿‡åœ¨æ ¹èŠ‚ç‚¹selectorä¸‹å®šä¹‰ä¸€ä¸ªitemå…ƒç´ æ¥æ·»åŠ æ¯ä¸ªå›¾å½¢ã€‚æ¯ä¸€å„itemä¸­ä½¿ç”¨ä¸åŒçš„çŠ¶æ€å±æ€§æ¥å®šä¹‰ä¸ç”¨çš„drawableã€‚å½“æ¯ä¸€æ¬¡çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œstate listéƒ½ä¼šä»ä¸Šåˆ°ä¸‹è¢«éå†ä¸€éï¼Œç¬¬ä¸€ä¸ªä¸å½“å‰stateç›¸åŒ¹é…çš„itemå°†ä¼šè¢«ä½¿ç”¨â€”- è¿™ä¸ªé€‰æ‹©å¹¶ä¸æ˜¯ä½œå‡ºâ€œæœ€åŒ¹é…â€ç»“æœï¼Œè€Œæ˜¯ç®€å•çš„æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„çŠ¶æ€ã€‚ selectorä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥ä½œä¸ºæœ‰çŠ¶æ€æ”¹å˜çš„Viewçš„èƒŒæ™¯ï¼Œä»¥æ­¤æ¥è¾¾åˆ°å½“ç”¨æˆ·å¯¹Viewè¿›è¡Œæ“ä½œï¼Œå¯¼è‡´ViewçŠ¶æ€æ”¹å˜æ—¶ï¼Œä½œå‡ºæ”¹å˜ï¼Œè®©ç”¨æˆ·æ„ŸçŸ¥Viewçš„çŠ¶æ€å˜åŒ–ã€‚ å®˜æ–¹è¯´æ˜æ–‡ä»¶ä½ç½®ï¼šres/drawable/filename.xml ç¼–è¯‘èµ„æºç±»å‹ï¼šStateListDrawable èµ„æºå¼•ç”¨ï¼šIn Java: R.drawable.filenameIn XML: @[package:]drawable/filename è¯­æ³•ï¼š 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;selector xmlns:android=\"http://schemas.android.com/apk/res/android\" android:constantSize=[\"true\" | \"false\"] android:dither=[\"true\" | \"false\"] android:variablePadding=[\"true\" | \"false\"] &gt; &lt;item android:drawable=\"@[package:]drawable/drawable_resource\" android:state_pressed=[\"true\" | \"false\"] android:state_focused=[\"true\" | \"false\"] android:state_hovered=[\"true\" | \"false\"] android:state_selected=[\"true\" | \"false\"] android:state_checkable=[\"true\" | \"false\"] android:state_checked=[\"true\" | \"false\"] android:state_enabled=[\"true\" | \"false\"] android:state_activated=[\"true\" | \"false\"] android:state_window_focused=[\"true\" | \"false\"] /&gt;&lt;/selector&gt; æ›´å¤šè¯¦ç»†è¯´æ˜ï¼Œè¯·æŸ¥é˜…xsoftlab åŸºæœ¬ä½¿ç”¨ä¸‹é¢åšä¸€ä¸ªç®€å•çš„å®ä¾‹ï¼Œå¯¹Buttonçš„èƒŒæ™¯æ ¹æ®çŠ¶æ€åšä¸€ä¸‹å¤„ç† XMLæ–‡ä»¶selector_ts.xml 1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;selector xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;item android:drawable=\"@color/pink\" android:state_pressed=\"true\" /&gt; &lt;item android:drawable=\"@color/yellow\" android:state_selected=\"true\" /&gt; &lt;item android:drawable=\"@drawable/shaperect\" android:state_enabled=\"false\" /&gt; &lt;item android:drawable=\"@color/stone\" android:state_enabled=\"true\" /&gt;&lt;/selector&gt; ä¸»å¸ƒå±€æ–‡ä»¶ï¼ˆactivity_main.xmlï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:focusable=\"true\" android:focusableInTouchMode=\"true\" android:orientation=\"vertical\" android:padding=\"10dp\" tools:context=\"mraz.com.tabdemo.MainActivity\"&gt; &lt;Button android:id=\"@+id/bt_content\" android:layout_width=\"match_parent\" android:layout_height=\"300dp\" android:background=\"@drawable/selector_ts\" /&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"50dp\" android:orientation=\"horizontal\"&gt; &lt;Button android:id=\"@+id/bt_selected\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_weight=\"1\" android:text=\"Select\" android:textAllCaps=\"false\" /&gt; &lt;Button android:id=\"@+id/bt_disable\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_weight=\"1\" android:text=\"Disable\" android:textAllCaps=\"false\" /&gt; &lt;Button android:id=\"@+id/bt_pressed\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_weight=\"1\" android:text=\"Press\" android:textAllCaps=\"false\" /&gt; &lt;/LinearLayout&gt;&lt;/LinearLayout&gt; ä»£ç éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸å ç”¨è¿‡å¤šçš„ç¯‡å¹…äº†ï¼Œçœ‹ä¸‹ç®€å•çš„æ•ˆæœï¼Œå¤§å®¶åº”è¯¥å°±çŸ¥é“å¦‚ä½•ç¼–å†™å°å°çš„Activityäº†ã€‚ æ•ˆæœ æ›´å¤šçš„å†…å®¹ç­‰å¾…ç€æŒ–æ˜æœºçš„åˆ°æ¥~","link":"/2016/07/05/ã€ŠAndroid åŸºç¡€ï¼ˆåå››ï¼‰ã€‹ selector/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåå…­ï¼‰ã€‹Toast","text":"ä»‹ç» A toast provides simple feedback about an operation in a small popup. It only fills the amount of space required for the message and the current activity remains visible and interactive. For example, navigating away from an email before you send it triggers a â€œDraft savedâ€ toast to let you know that you can continue editing later. Toasts automatically disappear after a timeout. ç¿»è¯‘ï¼šToastä»¥ä¸€ç§å°å¼¹æ¡†çš„æ–¹å¼æ¥ç»™äºˆç”¨æˆ·åé¦ˆï¼Œå®ƒåªéœ€è¦æ¶ˆæ¯å¯ä»¥æ˜¾ç¤ºå‡ºæ¥çš„é‚£å°éƒ¨åˆ†ç©ºé—´ï¼ŒåŒæ—¶Activityä¾ç„¶å¯è§å¯äº¤äº’ã€‚ä¾‹å¦‚ï¼Œå½“ä½ å†™é‚®ä»¶çš„æ—¶å€™é€€å‡ºï¼Œä¼šè§¦å‘â€œè‰ç¨¿å·²ä¿å­˜â€çš„Toastæ¥è®©ä½ çŸ¥é“ä½ ä»¥åå¯ä»¥ç»§ç»­ç¼–è¾‘è¿™å°é‚®ä»¶ã€‚Toastä¼šåœ¨ä¸€æ®µæ—¶é—´åè‡ªå·±æ¶ˆå¤±ã€‚ ç±»ç»“æ„Toastæˆå‘˜ æˆå‘˜ä»‹ç» æˆå‘˜ å«ä¹‰ Toast(Context) æ„é€ å‡½æ•° show() æ˜¾ç¤ºToast cancel() å–æ¶ˆToast setMargin(float,float) è®¾ç½®æ¨ªå‘çš„marginå’Œçºµçš„margin setGravity(int ,int, int) è®¾ç½®toastçš„ä½ç½®é‡å¿ƒç›¸å¯¹çš„XOffset, YOffset makeText(Context, CharSequence, int) åˆ©ç”¨å­—ç¬¦ä¸²åˆ›å»ºToast makeText(Context, int, int) åˆ©ç”¨å­—ç¬¦ä¸²èµ„æºåˆ›Toast setView(View) è®¾ç½®è‡ªå®šä¹‰Toastæ˜¾ç¤ºView setDuration(int) è®¾ç½®Toastçš„æ˜¾ç¤ºæ—¶é—´ setText è®¾ç½®Messageæ–‡æœ¬å†…å®¹ åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶activity_main.xml 123456789101112131415161718192021222324252627&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"mraz.com.toastdemo.MainActivity\"&gt; &lt;Button android:id=\"@+id/bt_simple\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"@color/colorAccent\" android:text=\"Simple Toast\" /&gt; &lt;Button android:id=\"@+id/bt_custom\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"30dp\" android:background=\"@color/colorPrimary\" android:text=\"Custom Toast\" /&gt;&lt;/LinearLayout&gt; è‡ªå®šä¹‰çš„Toastå¸ƒå±€custom_toast.xml 123456789101112131415161718192021&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"40dp\" android:background=\"@drawable/shape_bg\" android:orientation=\"horizontal\"&gt; &lt;ImageView android:layout_width=\"40dp\" android:layout_height=\"40dp\" android:src=\"@drawable/ic_account_circle_black_24dp\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"40dp\" android:layout_marginLeft=\"10dp\" android:layout_marginRight=\"10dp\" android:gravity=\"center\" android:text=\"This is a Custom Toast !\" android:textStyle=\"italic\" /&gt;&lt;/LinearLayout&gt; ä»£ç å†…å®¹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package mraz.com.toastdemo;import android.content.Context;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.view.Gravity;import android.view.LayoutInflater;import android.view.View;import android.widget.Button;import android.widget.Toast;public class MainActivity extends AppCompatActivity implements View.OnClickListener { Context mContext; Button btSimple, btCustom; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); mContext = this; btSimple = (Button) findViewById(R.id.bt_simple); btCustom = (Button) findViewById(R.id.bt_custom); btSimple.setOnClickListener(this); btCustom.setOnClickListener(this); } @Override public void onClick(View view) { switch (view.getId()) { case R.id.bt_simple: Toast.makeText(mContext, \" This is a simple toast\", Toast.LENGTH_SHORT).show(); break; case R.id.bt_custom: LayoutInflater layoutInflater = LayoutInflater.from(mContext); View custToast = layoutInflater.inflate(R.layout.custom_toast, null); Toast toast = new Toast(mContext); toast.setView(custToast); toast.setDuration(Toast.LENGTH_SHORT); toast.setGravity(Gravity.CENTER_VERTICAL, 0, 0); toast.show(); break; } }} å®é™…æ•ˆæœ å¤‡æ³¨Toastçš„å†…å®¹æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¼€å‘è¿‡ç¨‹ä¸­åº”è¯¥ä¼šç»å¸¸ç”¨åˆ°ï¼Œè¯´ä¸å®šå¶å°”è¿˜ä¼šç¢°åˆ°æ˜¾ç¤ºä¸å‡ºæ¥çš„æƒ…å†µï¼Œä¸è¦å¿˜è®°æ‰§è¡Œshow()æ–¹æ³•ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯å…¶ä»–çš„åŸå› å¯¼è‡´ä½ çš„Toastæ— æ³•æ˜¾ç¤º~","link":"/2016/07/06/ã€ŠAndroid åŸºç¡€ï¼ˆåå…­ï¼‰ã€‹Toast/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåï¼‰ã€‹FloatingActionButton","text":"ç®€ä»‹ Source Codeä¸­çš„ä»‹ç»å¦‚ä¸‹ï¼š Floating action buttons are used for a special type of promoted action. They are distinguishedby a circled icon floating above the UI and have special motion behaviors related to morphing,launching, and the transferring anchor point. Floating action buttons come in two sizes: the default and the mini. The size can becontrolled with the {@code fabSize} attribute. As this class descends from {@link ImageView}, you can control the icon which is displayedvia {@link # setImageDrawable(Drawable)}.The background color of this view defaults to the your themeâ€™s {@code colorAccent}. If youwish to change this at runtime then you can do so via{@link # setBackgroundTintList(ColorStateList)}. @attr ref android.support.design.R.styleable#FloatingActionButton_fabSize å±æ€§å€¼ å±æ€§å€¼ å«ä¹‰ app:backgroundTint è®¾ç½®èƒŒæ™¯é¢œè‰² app:fabSize è®¾ç½®FABçš„å¤§å°ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå–å€¼normal,mini android:src è®¾ç½®FABçš„å›¾æ ‡å†…å®¹ app:rippleColor è®¾ç½®FABç‚¹å‡»è¿‡ç¨‹ä¸­çš„é¢œè‰² app:elevation è®¾ç½®FABæ­£å¸¸æƒ…å†µä¸‹çš„é˜´å½±æ•ˆæœ app:pressedTranslationZ è®¾ç½®FABç‚¹å‡»æ—¶çš„é˜´å½±å¤§å° app:borderWidth è®¾ç½®è¾¹æ¡†å®½åº¦ android:clickable æ˜¯å¦å¯ç‚¹å‡»true or false app:layout_anchor è®¾ç½®FABçš„é”šç‚¹ï¼Œå³ä»¥å“ªä¸ªæ§ä»¶ä¸ºå‚ç…§ç‚¹è®¾ç½®ä½ç½® app:layout_anchorGravity è®¾ç½®FABç›¸å¯¹é”šç‚¹çš„ä½ç½®ï¼Œå–å€¼:topbottom.left,right,center_vertical,fill_vertical,center_horizontal,fill_horizontal,center,fill,clip_verticalclip_horizontal,start,end åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶activity_main.xml 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.design.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"?attr/colorPrimaryDark\" android:minHeight=\"?attr/actionBarSize\" app:navigationIcon=\"@drawable/ic_account_balance_black_24dp\" app:title=\"Mraz FAB Demo\"&gt;&lt;/android.support.v7.widget.Toolbar&gt; &lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab_left\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"left|bottom\" android:layout_marginBottom=\"@dimen/activity_vertical_margin\" android:layout_marginLeft=\"@dimen/activity_horizontal_margin\" android:clickable=\"true\" android:onClick=\"leftClick\" android:src=\"@drawable/ic_arrow_back_black_24dp\" app:backgroundTint=\"@color/colorPrimary\" app:fabSize=\"mini\" app:rippleColor=\"@color/colorPress\" /&gt; &lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab_right\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"right|bottom\" android:layout_marginBottom=\"@dimen/activity_vertical_margin\" android:layout_marginRight=\"@dimen/activity_horizontal_margin\" android:clickable=\"true\" android:onClick=\"rightClick\" android:src=\"@drawable/ic_arrow_forward_black_24dp\" app:backgroundTint=\"@color/colorLight\" app:borderWidth=\"0dp\" app:elevation=\"20dp\" app:fabSize=\"normal\" app:pressedTranslationZ=\"50dp\" app:rippleColor=\"@color/colorPress\" /&gt; &lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab_anchor\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"right|bottom\" android:layout_marginRight=\"10dp\" android:layout_marginTop=\"20dp\" android:clickable=\"true\" android:onClick=\"topClick\" android:src=\"@drawable/ic_arrow_forward_black_24dp\" app:backgroundTint=\"#ff87ffeb\" app:borderWidth=\"0dp\" app:elevation=\"6dp\" app:fabSize=\"normal\" app:layout_anchor=\"@+id/toolbar\" app:layout_anchorGravity=\"right\" app:pressedTranslationZ=\"12dp\" app:rippleColor=\"#33728dff\" /&gt;&lt;/android.support.design.widget.CoordinatorLayout&gt; å¸ƒå±€ä¸­ä¸€å…±è®¾ç½®äº†3ä¸ªFABï¼Œä¸€ä¸ªåœ¨å·¦ä¸‹è§’ï¼Œä¸€ä¸ªåœ¨å³ä¸‹è§’ï¼Œä¸€ä¸ªè®¾ç½®äº†é”šç‚¹ï¼Œé¢œè‰²å¯ä»¥è‡ªå·±è°ƒæ•´ï¼Œç®€å•çš„ç”¨æ³•å°±æ˜¯è¿™ä¸ªæ ·å­ï¼Œå¯¹åº”çš„onClickäº‹ä»¶åœ¨MainActivityä¸­å®ç°ã€‚ ä»£ç MainActivity.java 123456789101112131415161718192021222324252627282930313233343536package mraz.com.appbardemo;import android.annotation.TargetApi;import android.os.Build;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.Toolbar;import android.view.View;public class MainActivity extends AppCompatActivity { Toolbar toolbar; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); toolbar = (Toolbar) findViewById(R.id.toolbar); setSupportActionBar(toolbar); } @TargetApi(Build.VERSION_CODES.LOLLIPOP) public void leftClick(View view) { toolbar.setTitle(\"Left FAB onClick\"); } public void rightClick(View view) { toolbar.setTitle(\"Right FAB onClick\"); } public void topClick(View view) { toolbar.setTitle(\"Top FAB onClick\"); }} æ•ˆæœ","link":"/2016/07/02/ã€ŠAndroid åŸºç¡€ï¼ˆåï¼‰ã€‹FloatingActionButton/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åäºŒï¼‰ã€‹ MultiDex","text":"1. å‰è¨€æœ€è¿‘åšé¡¹ç›®å¼€å‘çš„æ—¶å€™ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼ŒNoClassDef,NoMethodä¹‹ç±»çš„é”™è¯¯ï¼Œä½†æ˜¯æŠŠlogå¾€å‰çœ‹ï¼Œä¼šå‘ç°ä¸€äº›Dalvikçš„ä¸€äº›æŠ¥é”™ï¼Œçœ‹åˆ°è¿™äº›logä¹‹åï¼Œå°±ä¼šè§‰å¾—åé¢çš„ä»€ä¹ˆæ–¹æ³•æ‰¾ä¸åˆ°ï¼Œç±»æ²¡æœ‰å®šä¹‰ä»€ä¹ˆçš„é”™è¯¯çœŸæ˜¯çš„åº”è¯¥å‡ºç°ï¼Œé‚£ä¹ˆè¿™äº›Dalvikçš„é”™è¯¯æ€ä¹ˆè§£é‡Šå‘¢ï¼Ÿå› ä¸ºç±»ä¼¼çš„æŠ¥é”™åªå‡ºç°åœ¨äº†ä¸€ä¸ªåŒäº‹çš„æ‰‹æœºä¸Šï¼Œè€Œä¸”æ˜¯KKç‰ˆæœ¬ï¼Œæ¯”è¾ƒè€ã€‚ä»‹ç»ä¸‹æˆ‘çš„åˆ†ææ€è·¯ï¼š ç¡®å®šé—®é¢˜å‘ç”Ÿä½ç½®ï¼Œæ³¨é‡Šæ‰ï¼ˆå¹¶è§£å†³å› æ³¨é‡Šå¼•èµ·çš„ç¼–è¯‘é”™è¯¯ï¼‰â€”&gt; Defeat å› ä¸ºæ˜¯KKç‰ˆæœ¬ï¼Œè°ƒæ•´minSDKåˆ°19 â€”&gt; Defeat åˆ é™¤æˆ–è€…æ›´æ–°å¼•èµ·é—®é¢˜çš„jaråŒ… â€”&gt; Defeat è€ƒè™‘åˆ°MultiDexåœ¨Android5.0 ä»¥åé»˜è®¤æ”¯æŒï¼Œä¸ºå…¼å®¹æ—§ç‰ˆæœ¬ï¼Œæ‰‹åŠ¨å…¼å®¹ä¸€ä¸‹ â€”â€”â€”â€”â€”â€”â€”â€”&gt;Victory 2. é…ç½®MultiDexAndroid5.0åŠä»¥ä¸Šç‰ˆæœ¬é»˜è®¤æ”¯æŒMultiDex 2.1 ä¿®æ”¹build.gradle1234567891011121314151617android { compileSdkVersion 21 buildToolsVersion \"21.1.0\" defaultConfig { ... minSdkVersion 14 targetSdkVersion 21 ... // Enabling MultiDex support. multiDexEnabled true } ... } dependencies { compile 'com.android.support:multidex:1.0.1'} 2.2 ä¿®æ”¹applicationä¸‰ç§æ–¹æ³• 2.2.1 åœ¨AndroidManifest.xmlçš„applicationä¸­å£°æ˜android.support.MultiDex.MultiDexApplication2.2.2 è®©è‡ªå·±çš„applicationç±»ç»§æ‰¿MultiDexApplication2.2.3 é‡å†™attachBaseContext()æ–¹æ³•12345@Overrideprotected void attachBaseContext(Context base) { super.attachBaseContext(base); MultiDex.install(this);} 3. æ¨èæ–‡ç« æ›´å¤šå…³äºMultiDexå¯ä»¥æŸ¥é˜…ç¾å›¢æŠ€æœ¯æ²™é¾™å…³äºåˆ†åŒ…çš„åšå®¢æˆ–è€…ç›´æ¥æŸ¥çœ‹MultiDexæºç ã€‚","link":"/2017/09/12/ã€ŠAndroid åŸºç¡€ï¼ˆå››åäºŒï¼‰ã€‹ MultiDex/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åå…­ï¼‰ã€‹ LayerDrawable & layer-list","text":"ä»‹ç» LayerDrawable æ˜¯ç®¡ç†å…¶ä»–å¯ç»˜åˆ¶å¯¹è±¡é˜µåˆ—çš„å¯ç»˜åˆ¶å¯¹è±¡ã€‚åˆ—è¡¨ä¸­çš„æ¯ä¸ªå¯ç»˜åˆ¶å¯¹è±¡æŒ‰ç…§åˆ—è¡¨çš„é¡ºåºç»˜åˆ¶ï¼Œåˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªå¯ç»˜åˆ¶å¯¹è±¡ç»˜äºé¡¶éƒ¨ã€‚ æ¯ä¸ªå¯ç»˜åˆ¶å¯¹è±¡ç”±å•ä¸€ &lt; layer-list &gt; å…ƒç´ å†…çš„ &lt; item &gt; å…ƒç´ è¡¨ç¤ºã€‚ è¯­æ³•1234567891011&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;layer-list xmlns:android=\"http://schemas.android.com/apk/res/android\" &gt; &lt;item android:drawable=\"@[package:]drawable/drawable_resource\" android:id=\"@[+][package:]id/resource_name\" android:top=\"dimension\" android:right=\"dimension\" android:bottom=\"dimension\" android:left=\"dimension\" /&gt;&lt;/layer-list&gt; ä½œç”¨ layer-listï¼Œå›¾å±‚åˆ—è¡¨ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»˜åˆ¶ä¸€äº›ç‰¹æ®Šçš„å›¾å½¢ã€‚ éƒ¨åˆ†å®è·µLine &amp; Dotlayer-list12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;layer-list xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;item android:bottom=\"2dp\" android:right=\"2dp\" android:top=\"2dp\"&gt; &lt;shape android:shape=\"rectangle\"&gt; &lt;solid android:color=\"#1750ff\" /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:gravity=\"right\"&gt; &lt;shape android:shape=\"oval\"&gt; &lt;solid android:color=\"#1750ff\" /&gt; &lt;size android:width=\"5dp\" android:height=\"5dp\" /&gt; &lt;/shape&gt; &lt;/item&gt;&lt;/layer-list&gt; use in layout123456&lt;View android:layout_width=\"100dp\" android:layout_height=\"5dp\" android:layout_marginLeft=\"50dp\" android:layout_marginTop=\"50dp\" android:background=\"@drawable/horizontal_line_dot\" /&gt; result ä»£ç ä¿®æ”¹Drawableé¢œè‰² é€šè¿‡LayerDrawableç±»ä¸­çš„éƒ¨åˆ†æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ¯ä¸€å±‚çš„Drawableï¼Œè¿™æ ·é’ˆå¯¹ä¸é€šå±‚çº§çš„Drawableï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œåœ¨ç”¨æˆ·äº¤äº’è¿‡ç¨‹ä¸­æ‰§è¡Œä¿®æ”¹ç­‰æ“ä½œã€‚ 1234567bt_change_color.setOnClickListener({ var background: LayerDrawable = horizontal_line_dot.background as LayerDrawable for (index in 0..(background.numberOfLayers - 1)) { var drawable: GradientDrawable = background.getDrawable(index) as GradientDrawable drawable.setColor(Color.BLACK) }}) Shape å…³äºShapeçš„ç”¨æ³•ï¼Œè¯·é˜…Shape","link":"/2018/06/09/ã€ŠAndroid åŸºç¡€ï¼ˆå››åå…­ï¼‰ã€‹ LayerDrawable & layer-list/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆé›¶)ã€‹ AndroidçŸ¥è¯†æ¡†æ¶æ¢³ç†","text":"1. å‰è¨€æœ€è¿‘æƒ³æ¢³ç†ä¸€ä¸‹Androidçš„åŸºç¡€çŸ¥è¯†ï¼Œè®©çŸ¥è¯†æœ‰ä¸€äº›ä½“ç³»çš„æ¦‚å¿µã€‚ 2. Android åŸºç¡€çŸ¥è¯†ä½“ç³»","link":"/2017/09/23/ã€ŠAndroid åŸºç¡€ï¼ˆé›¶)ã€‹ AndroidçŸ¥è¯†æ¡†æ¶æ¢³ç†/"},{"title":"ã€ŠAndroid å®‰å…¨ï¼ˆä¸€ï¼‰ã€‹AndroidManifest.xmlä¹‹allowBackupå±æ€§","text":"å‰è¨€â€œ android:allowBackupâ€æ˜¯ä¸€ä¸ªæ˜¯å¦å…è®¸å¤‡ä»½ç³»ç»Ÿå’Œç”¨æˆ·æ•°æ®çš„å±æ€§ã€‚å½“è¿™ä¸ªæ ‡å¿—è¢«è®¾ç½®ä¸ºtrueæ—¶åº”ç”¨ç¨‹åºæ•°æ®å¯ä»¥åœ¨æ‰‹æœºæœªè·å– ROOT çš„æƒ…å†µä¸‹é€šè¿‡adbè°ƒè¯•å·¥å…·æ¥å¤‡ä»½å’Œæ¢å¤ã€‚ æ¡ˆä¾‹åˆ†æä»åº”ç”¨å•†åŸé‡Œä¸‹è½½ä¸€ä¸ªâ€œå¯†ç æœ¬â€ä¹‹ç±»çš„åº”ç”¨ã€‚ 1. ä½¿ç”¨AndroidStudioåˆ†æåº”ç”¨â€œBuildâ€ ã€‹â€œAnalyze APKâ€¦â€ï¼Œé€‰æ‹©å¯¹åº”çš„åº”ç”¨è¿›è¡Œåˆ†æï¼Œå…³æ³¨åŒ…åå’ŒallowBackupå±æ€§ è‹¥â€œallowBackupâ€å±æ€§ä¸ºtrueï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹è¿›è¡Œã€‚ 2. å®‰è£…åº”ç”¨3. ä½¿ç”¨adbå‘½ä»¤å¯¼å‡ºè¯¥åº”ç”¨æ•°æ®ï¼Œè¿‡ç¨‹ä¸­æ‰‹æœºä¼šè¦æ±‚è®¾ç½®å¯†ç ï¼Œè®¾ç½®å¯†ç åç‚¹å‡»â€å¤‡ä»½æˆ‘çš„æ•°æ®â€œ 4. ä½¿ç”¨abeå·¥å…·è§£å‹abæ–‡ä»¶ä½¿ç”¨abe-all.jaræ–‡ä»¶è§£æabæ–‡ä»¶ä¸ºraræ–‡ä»¶ï¼ŒjaråŒ…ä¸‹è½½åœ°å€ä¸ºï¼šabe-all.jar 5. æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶è§£å‹æ–‡ä»¶ï¼ŒæŸ¥çœ‹é‡Œé¢æœ‰å¾ˆå¤šæœ‰ç”¨çš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚æ•°æ®åº“dbæ–‡ä»¶å’ŒSharedPreferenceæ–‡ä»¶ æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“æ–‡ä»¶,é‡Œé¢æœ‰ä¸€æ¡æˆ‘ä¹‹å‰ä¿å­˜çš„æµ‹è¯•æ•°æ® æŸ¥çœ‹ä¸€ä¸‹spæ–‡ä»¶ä¸­çš„xmlï¼Œé‡Œé¢æœ‰æˆ‘è®¾ç½®çš„æ•°å­—å¯†ç è™½ç„¶æ˜¯åŠ è¿‡å¯†çš„ 6. ä¿®æ”¹å†…å®¹å¹¶æ¢å¤æ•°æ®æ•°æ®åº“æ–‡ä»¶ç¨ä½œä¿®æ”¹â€œpwdâ€å­—æ®µä¿®æ”¹ä¸ºâ€œ23456789â€å¹¶ä¿å­˜ã€‚æ¢å¤è¿‡ç¨‹ä¸­è¦æ±‚è¾“å…¥å¯†ç ï¼Œå’Œä¹‹å‰ä¸€æ ·å°±è¡Œ 7. æ¢å¤ç»“æœä½¿ç”¨adb restoreæ¢å¤æ•°æ®åï¼Œåº”ç”¨å†…æ˜¾ç¤ºçš„æ•°æ®ä¾ç„¶æ˜¯â€œ234567â€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿®æ”¹åçš„æ•°æ®æ²¡æœ‰è¢«æ¥å—ã€‚ä¸¤æ–¹é¢è®¤è¯ï¼š é‡æ–°å¯¼å‡ºæ•°æ®ï¼ˆä¾ç„¶æ˜¯â€œ234567â€ï¼‰ å°†ç”¨äºæ¢å¤æ•°æ®çš„abæ–‡ä»¶è§£ææˆraræ–‡ä»¶ï¼ˆæ˜¯æˆ‘ä»¬ä¿®æ”¹åçš„â€œ23456789â€ï¼‰ åˆ¤æ–­ï¼Œæ¢å¤æ•°æ®çš„æ—¶å€™ï¼Œç³»ç»Ÿæˆ–è€…åº”ç”¨æœ¬èº«åšäº†å¤„ç†ã€‚ 8. ç»“è®ºè™½ç„¶æˆ‘ä»¬æœ€åä¿®æ”¹æ•°æ®å¹¶æ¢å¤ï¼Œç»“æœæ²¡æœ‰æˆåŠŸï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªâ€œå¯†ç æœ¬â€ç±»çš„åº”ç”¨ï¼Œå¯ä»¥çŸ¥é“çœ‹åˆ°ç”¨æˆ·å‚¨å­˜çš„è´¦å·å¯†ç ä¿¡æ¯å·²ç»æ˜¯ç›¸å½“ææ€–äº†ï¼Œå¹¶ä¸”æ­¤åº”ç”¨ä¸‹è½½é‡è¿˜æ˜¯æŒºé«˜çš„ã€‚å¹¶ä¸”ç»è¿‡å¤šä¸ªåº”ç”¨æµ‹è¯•ï¼Œå¥½å¤šåº”ç”¨çš„â€œallowBackupâ€å±æ€§å‡ä¸ºtrueã€‚å¯èƒ½æ˜¯å› ä¸ºæ–°å»ºå·¥ç¨‹é»˜è®¤ä¸ºtrueçš„åŸå› å§ã€‚","link":"/2018/12/29/ã€ŠAndroid å®‰å…¨ï¼ˆä¸€ï¼‰ã€‹AndroidManifest.xmlä¹‹allowBackupå±æ€§/"},{"title":"ã€ŠAndroid å®‰å…¨ï¼ˆä¸‰ï¼‰ã€‹åŠ¨æ€è°ƒè¯•Smali","text":"ç¯å¢ƒ Android Studio 3.3.2 SmaliIdea Plugin è‡ªå·±éšæ‰‹å†™ä¸€ä¸ªAndroidåº”ç”¨ baksmali æ“ä½œå®‰è£…SmaliIdeaæ’ä»¶ SmaliIDEA æ’ä»¶ åœ¨çº¿å®‰è£… ç¼–åˆ¶æµ‹è¯•åº”ç”¨1234567891011121314151617public class MainActivity extends AppCompatActivity { private int count = 0; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); TextView textView = findViewById(R.id.tv_content); Button button = findViewById(R.id.bt_change_text); button.setOnClickListener(v -&gt; { count++; textView.setText(String.format(Locale.CHINESE, \"Tap %d\", count)); }); }} æ‰“åŒ…æˆApkæ–‡ä»¶ä¸ºäº†ä¿è¯android:debuggable=&quot;true&quot;ï¼Œæˆ‘ä»¬æ‰“åŒ…æˆdebugç‰ˆæœ¬å³å¯ã€‚æˆ–è€…æ‰‹åŠ¨åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­è®¾ç½®ä¹Ÿè¡Œã€‚ åç¼–è¯‘ baksmali d app-debug.apk -o ~/projects/myapp/src å¯åŠ¨ç¨‹åºå¹¶è½¬å‘ç«¯å£ å¯åŠ¨æµ‹è¯•ç¨‹åºä¸»ç•Œé¢adb shell am start -D -n cn.onlyloveyd.smali/cn.onlyloveyd.smali.MainActivity å¯åŠ¨â€œAndroid Device Monitorâ€ï¼Œè®°ä½pidå’Œåé¢8700ç«¯å£ï¼Œç„¶åä¸€å®šå…³é—­Android Device Monitor è½¬å‘ç«¯å£ å¯¼å…¥å·¥ç¨‹è‡³Android Studio â€œNewâ€ -ã€‹â€œimport Projectâ€ï¼Œé€‰æ‹©åˆšæ‰åˆ›å»ºçš„å·¥ç¨‹ç›®å½• é€‰æ‹©â€Create project from existing sourcesâ€ ä¸€ç›´ç»§ç»­ç›´åˆ°â€œFinishâ€ è®¾ç½®â€œsrcâ€æ–‡ä»¶åŠ ä¸ºæºæ–‡ä»¶ â€œEdit Configurationsâ€å¹¶é…ç½®JDK è°ƒè¯• æ‰§è¡Œâ€œRunâ€ -ã€‹ â€œDebug XXXâ€ è·³è½¬åˆ°æ–­ç‚¹å¤„ï¼Œå¯æ‰§è¡Œå•æ­¥è°ƒè¯•","link":"/2019/03/22/ã€ŠAndroid å®‰å…¨ï¼ˆä¸‰ï¼‰ã€‹åŠ¨æ€è°ƒè¯•Smali/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ JuheNews For aNdroid (æ”¹è¿›ç‰ˆ)","text":"ç®€ä»‹æœ€æ–°ç‰ˆåº”ç”¨å·²ç»ä¸Šçº¿ï¼Œæ¬¢è¿ä¸‹è½½ä½¿ç”¨ï¼Œæå‡ºå®è´µæ„è§ï¼šhttp://shouji.baidu.com/software/10720907.html ä¸Šä¸€ç¯‡ä»‹ç»çš„æ˜¯æœ€å¼€å§‹è‡ªå·±åˆ¶ä½œçš„ä¸€ä¸ªé‡‡ç”¨èšåˆæ•°æ®å…è´¹æ¥å£åˆ¶ä½œçš„ä¸€ä¸ªå¤´æ¡ç±»æ–°é—»åº”ç”¨ï¼Œæœ€è¿‘å¯¹å…¶åœ¨ç•Œé¢ä¸Šåšäº†å¾ˆå¤§çš„æ”¹åŠ¨ï¼Œç»“åˆä¹‹å‰ä»‹ç»çš„TabHostä½œä¸ºåº•éƒ¨ä»¿å¾®ä¿¡èœå•ï¼Œç„¶åæ–°é—»å†…å®¹ä¸°å¯Œåˆ°10ç§åˆ†ç±»ï¼Œæœç´¢åŠŸèƒ½æ”¾åœ¨ToolBarä¸Šï¼Œæ•´ä½“æ•ˆæœä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒOKã€‚ ä»£ç å¼€æºï¼šhttps://github.com/onlyloveyd/JuheNews è§‰å¾—ä¸é”™çš„è¯ï¼Œç»™æˆ‘ä¸€ä¸ªå°çº¢æ˜Ÿå§ï¼Œ æœ‰æ„è§çš„è¯å¯ä»¥åœ¨åšæ–‡ä¸‹ç•™è¨€ï¼Œä¼šåŠæ—¶æ”¹æ­£ ä½¿ç”¨åˆ°çš„å¼€æºå†…å®¹ä¸»è¦ç”¨åˆ°çš„å¼€æºåº“æœ‰ä»¥ä¸‹ä¸€äº› 12345678910compile 'com.squareup.okhttp3:okhttp:3.5.0'compile 'com.android.support:recyclerview-v7:25.0.1'compile 'com.google.code.gson:gson:2.8.0'compile 'io.reactivex:rxandroid:1.2.1'compile 'com.android.support:design:25.0.1'compile 'com.github.bumptech.glide:glide:3.7.0'compile 'com.android.support:cardview-v7:25.0.1'compile 'com.jakewharton:butterknife:8.4.0'annotationProcessor 'com.jakewharton:butterknife-compiler:8.4.0'compile 'com.astuetz:pagerslidingtabstrip:1.0.1' ä¸»è¦æ¶‰åŠåˆ°ç½‘ç»œé€šä¿¡ï¼Œå“åº”å¼ç¼–ç¨‹ï¼Œæ³¨è§£ï¼ŒRecyclerView,CardViewå’ŒPageIndicatorç­‰æ–¹é¢ï¼Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œå‡ä½äº†ä¸å°‘å¼€å‘çš„éš¾åº¦ ä½¿ç”¨åˆ°çš„èšåˆæ•°æ®æ¥å£ æ–°é—»å¤´æ¡ ä¸»è¦åˆ†ä¸ºå¤´æ¡ï¼Œç¤¾ä¼šï¼Œå›½å†…ï¼Œå¨±ä¹ï¼Œä½“è‚²ï¼Œå†›äº‹ï¼Œç§‘æŠ€ï¼Œè´¢ç»ï¼Œæ—¶å°šç­‰æ–°é—»ä¿¡æ¯ æ–°é—» è¿™ä¸ªå’Œä¸Šé¢çš„æ–°é—»å¤´æ¡ä¸å¤ªä¸€æ ·ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥æœç´¢çƒ­ç‚¹ä¿¡æ¯çš„ ç¬‘è¯å¤§å…¨ è¶£å›¾ è¶£å›¾å’Œä¸Šé¢çš„ç¬‘è¯å¤§å…¨æ˜¯ä¸€ä¸ªæ¥å£ï¼Œåªæ˜¯è¯·æ±‚æ•°æ®çš„å†…å®¹ä¸åŒè€Œå·² å†å²ä¸Šçš„ä»Šå¤© å…·ä½“çš„ä½¿ç”¨æ–¹å¼å’Œæ¥å£ä»‹ç»ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å»èšåˆæ•°æ®å®˜ç½‘ä¸Šå»äº†è§£ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚ å…·ä½“æ•ˆæœ ç”±äºæ¨¡æ‹Ÿå™¨ä¸Šæ²¡æœ‰ä¸€äº›ä¸­æ–‡è¾“å…¥æ³•ï¼Œä¸ºäº†æ–¹ä¾¿å¼•ç”¨ä¸‹Githubä¸Šçš„Gif å¤‡æ³¨å…·ä½“ä»£ç å†…å®¹è¯·ç§»æ­¥Github,è°¢è°¢ï¼ä¸€ç›´æƒ³å€Ÿè¿™ä¸ªæœºä¼šå†™ä¸€ä¸ªä¸‡èƒ½çš„RecyclerView.Adapterï¼Œä½†æ˜¯ç›®å‰è¿˜æ²¡å®Œæˆï¼Œåé¢æ¥ç€çœ‹ä¸‹æ€ä¹ˆå†™æ¯”è¾ƒåˆé€‚ã€‚","link":"/2016/12/19/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ JuheNews For aNdroid (æ”¹è¿›ç‰ˆ)/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~BubbleChart(æ°”æ³¡å›¾) and RadarChart(é›·è¾¾å›¾)","text":"ç®€ä»‹MPAndroidChartæ˜¯PhilJayå¤§ç¥ç»™Androidå¼€å‘è€…å¸¦æ¥çš„ç¦åˆ©ã€‚MPAndroidChartæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§å¹¶ä¸”ä½¿ç”¨çµæ´»çš„å›¾è¡¨å¼€æºåº“ï¼Œæ”¯æŒAndroidå’ŒiOSä¸¤ç§ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶åªå…³æ³¨Androidç‰ˆæœ¬ã€‚ Wikihttps://github.com/PhilJay/MPAndroidChart/wiki Javadochttps://jitpack.io/com/github/PhilJay/MPAndroidChart/v3.0.0-beta1/javadoc/ ä»Šæ—¥ä¹‹å›¾~BubbleChart æ°”æ³¡å›¾å‚ç…§ä¸Šä¸€ç¯‡æ–‡ç« çš„ä»£ç ï¼Œç¨ä½œä¿®æ”¹ï¼Œå¾—å‡ºæ°”æ³¡å›¾ ä»Šæ—¥ä¹‹å›¾~RadarChart é›·è¾¾å›¾ æ³¨è§£BubbleChartæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒåŸºæœ¬ä¸Šå’Œå‰å‡ ç¯‡æ–‡ç« ç›¸ä¼¼çš„å†…å®¹ï¼Œå…³äºRadarChartï¼Œè®²å‡ ä¸ªæ–¹æ³• 12345678//ç‰¹æœ‰radarchart.setWebLineWidth(3f);//è®¾ç½®ç›´å¾„æ–¹å‘ä¸Šé‚£æ¡çº¿çš„å®½åº¦radarchart.setDrawWeb(true);//æ˜¯å¦ç”»èœ˜è››ç½‘ï¼ŒåŒ…æ‹¬åœˆçº¿å’Œç›´å¾„çº¿radarchart.setSkipWebLineCount(3); //è®¾ç½®è¿‡æ»¤æ‰å‡ ä¸ªç›´å¾„çº¿ï¼Œå¦‚å›¾ï¼Œçœç•¥äº†3æ ¹å°±æ˜¯è¿™é‡Œè®¾ç½®çš„radarchart.setWebLineWidthInner(1f);//è®¾ç½®æƒé™çš„å®½åº¦radarchart.setWebColor(Color.GREEN);//è®¾ç½®ç›´å¾„çº¿çš„é¢œè‰²radarchart.setWebColorInner(Color.YELLOW);//è®¾ç½®åœˆçº¿çš„é¢œè‰²radarchart.setWebAlpha(240);//è®¾ç½®é¢œè‰²çš„é€æ˜åº¦ å¤‡æ³¨å…³äºå…¶ä»–çš„ä»€ä¹ˆCandleStickChartï¼ŒHorizontal-BarChartï¼ŒCombined-Chart and so on åŸºæœ¬ä¸Šéƒ½æ˜¯å¤§åŒå°å¼‚ï¼ŒåŸºæœ¬çš„ä½¿ç”¨æ–¹å¼æ¯”è¾ƒçš„ç®€å•ï¼Œæ·±å…¥çš„ä½¿ç”¨æ–¹å¼éƒ½æ˜¯éœ€è¦ç»“åˆè‡ªå·±çš„å®è·µæ¥ä¸€ç‚¹ä¸€ç‚¹çš„æ¢ç´¢ã€‚MPAndroidChartåŸºæœ¬ä½¿ç”¨æƒ…å†µå°±æ˜¯è¿™æ ·å­ã€‚","link":"/2016/09/13/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~BubbleChart(æ°”æ³¡å›¾) and RadarChart(é›·è¾¾å›¾)/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~LineChart","text":"ç®€ä»‹MPAndroidChartæ˜¯PhilJayå¤§ç¥ç»™Androidå¼€å‘è€…å¸¦æ¥çš„ç¦åˆ©ã€‚MPAndroidChartæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§å¹¶ä¸”ä½¿ç”¨çµæ´»çš„å›¾è¡¨å¼€æºåº“ï¼Œæ”¯æŒAndroidå’ŒIOSä¸¤ç§ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶åªå…³æ³¨Androidç‰ˆæœ¬ã€‚ Wikihttps://github.com/PhilJay/MPAndroidChart/wiki Javadochttps://jitpack.io/com/github/PhilJay/MPAndroidChart/v3.0.0-beta1/javadoc/ ä»Šæ—¥ä¹‹å›¾~LineChartå…ˆçœ‹ä¸‹æ•ˆæœå‹å‹æƒŠï¼Œå³è¾¹çš„å›¾ä¸ºå·¦è¾¹çš„å›¾æ¨ªå‘æ‹‰ä¼¸åçš„æ•ˆæœ å¸ƒå±€æ–‡ä»¶123456789101112&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"com.example.mpandroidchartdemo.MainActivity\" &gt; &lt;com.github.mikephil.charting.charts.LineChart android:id=\"@+id/chart\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" /&gt;&lt;/RelativeLayout&gt; å¯¹äºChart,å¯ä»¥é‡‡ç”¨å¸ƒå±€æ–‡ä»¶æ·»åŠ æ–¹å¼ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä»£ç æ·»åŠ æ–¹å¼ã€‚ ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253requestWindowFeature(Window.FEATURE_NO_TITLE);//no titleï¼Œå»æ‰actionbarsetContentView(R.layout.activity_main);//è®¾ç½®ä¸»è§†å›¾chart = (LineChart) findViewById(R.id.chart);xVals = new ArrayList&lt;&gt;();yVals = new ArrayList&lt;&gt;();random = new Random();//äº§ç”Ÿéšæœºæ•°å­—for(int i = 0 ; i&lt;12; i++) { float x = random.nextInt(10000);//è·å–valueå€¼ yVals.add(new Entry(x, i));//åˆ›å»ºEntryå¹¶ä¸”æ·»åŠ åˆ°Yå€¼çš„listä¸­ï¼ŒYè½´çš„å€¼ï¼Œä¸€ä¸ªentryä»£è¡¨ä¸€ä¸ªæ˜¾ç¤ºçš„å€¼ xVals.add( (i+1) + \"æœˆ\");//æ¨ªåæ ‡æ˜¾ç¤ºxxxæœˆ}dataSet = new LineDataSet(yVals, \"é‡‘é¢\");//åˆ›å»ºæ•°æ®é›†å¹¶è®¾ç½®æ ‡ç­¾dataSet.setColors(ColorTemplate.COLORFUL_COLORS);//è®¾ç½®æ•°æ®é›†æ˜¾ç¤ºçš„é¢œè‰²ï¼Œé¢„æ”¯é¢œè‰²æ¨¡ç‰ˆColorTemplateï¼Œä¹Ÿå¯ä»¥è®¾ç½®å•ä¸€é¢œè‰²å’ŒcolorsdataSet.setHighlightEnabled(true);//è®¾ç½®é«˜äº®dataSet.setValueTextColor(Color.BLUE);//è®¾ç½®Valueå€¼çš„æ˜¾ç¤ºæ–‡å­—é¢œè‰²ï¼Œå­—ä½“å¤§å°å’Œå­—ä½“ç§ç±»ï¼Œè¿™é‡Œæˆ‘æ²¡æœ‰æ·»åŠ å¯¹åº”å­—ä½“å¯ä»¥è‡ªå·±ä¿®æ”¹dataSet.setValueTextSize(10.0f);dataSet.setValueTypeface(null);data = new LineData(xVals, dataSet);//åˆ›å»ºLineData,xè½´Listå’ŒYè½´æ•°æ®é›†ä¸ºå‚æ•°chart.setData(data);//ç»™å›¾è¡¨æ·»åŠ æ•°æ®chart.setDescription(\"æ”¶æ”¯çŠ¶æ€\");//è®¾ç½®å›¾è¡¨æè¿°çš„å†…å®¹ä½ç½®ï¼Œå­—ä½“ç­‰ç­‰chart.setDescriptionColor(Color.YELLOW);chart.setDescriptionTextSize(15f);chart.setDescriptionPosition(540, 40);chart.getXAxis().setPosition(XAxisPosition.BOTTOM);//è®¾ç½®Xè½´çš„æ˜¾ç¤ºä½ç½®ï¼Œé€šè¿‡XAxisPositionæšä¸¾ç±»å‹æ¥è®¾ç½®chart.getXAxis().setAxisMinValue(0.0f);//è®¾ç½®Xè½´çš„æœ€å°å€¼chart.getAxisRight().setEnabled(false);//å…³é—­å³è¾¹çš„Yè½´ï¼Œå› ä¸ºé»˜è®¤æœ‰ä¸¤æ¡ï¼Œå·¦è¾¹ä¸€æ¡ï¼Œå³è¾¹ä¸€æ¡ï¼ŒMPAndroidChartä¸­æœ‰setEnabledæ–¹æ³•çš„å…ƒç´ åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿èƒ½çš„ä½œç”¨chart.animateY(3000);//åŠ¨ç”»æ•ˆæœï¼ŒMPAndroidChartä¸­è¿˜æœ‰å¾ˆå¤šåŠ¨ç”»æ•ˆæœå¯ä»¥æŒ–æ˜//å½“å€¼è¢«é€‰ä¸­çš„æ—¶å€™ï¼Œæ‰§è¡Œæ“ä½œæ˜¾ç¤ºä¸€ä¸ªToastchart.setOnChartValueSelectedListener(new OnChartValueSelectedListener() { @Override public void onValueSelected(Entry e, int dataSetIndex, Highlight h) { // TODO Auto-generated method stub Toast.makeText(MainActivity.this, String.valueOf(e.getVal()), Toast.LENGTH_SHORT).show(); } @Override public void onNothingSelected() { // TODO Auto-generated method stub } }); å¤‡æ³¨ä¸­åˆæŠ½ç©ºçœ‹ä¸‹MPAndroidChartå¹¶è®°å½•ä¸‹ç®€å•çš„å…¥é—¨ï¼Œåˆšå¼€å§‹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç›´æ¥å»GitHubä¸Šçœ‹ä¸‹Wikiï¼Œå½“ç„¶ä¹Ÿæœ‰äººç¿»è¯‘äº†è¿™ç¯‡è‹±æ–‡Wikiï¼Œç›´æ¥æœç´¢MPAndroidChartåº”è¯¥å°±éƒ½å¯ä»¥çœ‹åˆ°äº†ã€‚è‡³äºä½¿ç”¨æ–¹å¼ï¼Œå¤§å®¶åº”è¯¥éƒ½å¾ˆæ¸…æ¥šï¼Œå¼•ç”¨jaråŒ…æˆ–è€…ä¸‹è½½æºç ç¼–è¯‘å§ï¼Œæˆ‘æ˜¯æ‡’äººï¼Œå‰è€…å¯é€‰ã€‚ä¸–ç•Œç‰›äººå¤ªå¤šï¼Œè·Ÿä¸ä¸Šè„šæ­¥äº†ã€‚","link":"/2016/09/02/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~LineChart/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~BarChart","text":"ç®€ä»‹MPAndroidChartæ˜¯PhilJayå¤§ç¥ç»™Androidå¼€å‘è€…å¸¦æ¥çš„ç¦åˆ©ã€‚MPAndroidChartæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§å¹¶ä¸”ä½¿ç”¨çµæ´»çš„å›¾è¡¨å¼€æºåº“ï¼Œæ”¯æŒAndroidå’ŒIOSä¸¤ç§ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶åªå…³æ³¨Androidç‰ˆæœ¬ã€‚ Wikihttps://github.com/PhilJay/MPAndroidChart/wiki Javadochttps://jitpack.io/com/github/PhilJay/MPAndroidChart/v3.0.0-beta1/javadoc/ ä»Šæ—¥ä¹‹å›¾~BarChartå…ˆçœ‹å›¾ï¼Œå‹å‹æƒŠ å¸ƒå±€æ–‡ä»¶ 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"mapdemo.example.com.mpandroidchartdemo.MainActivity\"&gt; &lt;!-- ä¸»å¸ƒå±€ä¸­æ·»åŠ BarChart--&gt; &lt;com.github.mikephil.charting.charts.BarChart android:id=\"@+id/barchart\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"Hello World!\" /&gt;&lt;/RelativeLayout&gt; å¯¹äºChart,å¯ä»¥é‡‡ç”¨å¸ƒå±€æ–‡ä»¶æ·»åŠ æ–¹å¼ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä»£ç æ·»åŠ æ–¹å¼ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public class MainActivity extends AppCompatActivity { @Bind(R.id.barchart) BarChart barchart; private Random random;//ç”¨äºäº§ç”Ÿéšæœºæ•°å­— @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); random = new Random(); initBarChart(); } private void initBarChart() { ArrayList&lt;BarEntry&gt; yVals = new ArrayList&lt;&gt;();//Yè½´æ–¹å‘ç¬¬ä¸€ç»„æ•°ç»„ ArrayList&lt;BarEntry&gt; yVals2 = new ArrayList&lt;&gt;();//Yè½´æ–¹å‘ç¬¬äºŒç»„æ•°ç»„ ArrayList&lt;BarEntry&gt; yVals3 = new ArrayList&lt;&gt;();//Yè½´æ–¹å‘ç¬¬ä¸‰ç»„æ•°ç»„ ArrayList&lt;String&gt; xVals = new ArrayList&lt;&gt;();//Xè½´æ•°æ® for (int i = 0; i &lt; 12; i++) {//æ·»åŠ æ•°æ®æº xVals.add((i + 1) + \"æœˆ\"); yVals.add(new BarEntry(random.nextInt(10000), i)); yVals2.add(new BarEntry(random.nextInt(10000), i)); yVals3.add(new BarEntry(random.nextInt(10000), i)); } BarDataSet barDataSet = new BarDataSet(yVals, \"å°æ˜æ¯æœˆæ”¯å‡º\"); barDataSet.setColor(Color.RED);//è®¾ç½®ç¬¬ä¸€ç»„æ•°æ®é¢œè‰² BarDataSet barDataSet2 = new BarDataSet(yVals2, \"å°èŠ±æ¯æœˆæ”¯å‡º\"); barDataSet2.setColor(Color.GREEN);//è®¾ç½®ç¬¬äºŒç»„æ•°æ®é¢œè‰² BarDataSet barDataSet3 = new BarDataSet(yVals3, \"å°è”¡æ¯æœˆæ”¯å‡º\"); barDataSet3.setColor(Color.YELLOW);//è®¾ç½®ç¬¬ä¸‰ç»„æ•°æ®é¢œè‰² ArrayList&lt;IBarDataSet&gt; threebardata = new ArrayList&lt;&gt;();//IBarDataSet æ¥å£å¾ˆå…³é”®ï¼Œæ˜¯æ·»åŠ å¤šç»„æ•°æ®çš„å…³é”®ç»“æ„ï¼ŒLineChartä¹Ÿæ˜¯å¯ä»¥é‡‡ç”¨å¯¹åº”çš„æ¥å£ç±»ï¼Œä¹Ÿå¯ä»¥æ·»åŠ å¤šç»„æ•°æ® threebardata.add(barDataSet); threebardata.add(barDataSet2); threebardata.add(barDataSet3); BarData bardata = new BarData(xVals, threebardata); barchart.setData(bardata); barchart.getLegend().setPosition(Legend.LegendPosition.ABOVE_CHART_LEFT);//è®¾ç½®æ³¨è§£çš„ä½ç½®åœ¨å·¦ä¸Šæ–¹ barchart.getLegend().setForm(Legend.LegendForm.CIRCLE);//è¿™æ˜¯å·¦è¾¹æ˜¾ç¤ºå°å›¾æ ‡çš„å½¢çŠ¶ barchart.getXAxis().setPosition(XAxis.XAxisPosition.BOTTOM);//è®¾ç½®Xè½´çš„ä½ç½® barchart.getXAxis().setDrawGridLines(false);//ä¸æ˜¾ç¤ºç½‘æ ¼ barchart.getAxisRight().setEnabled(false);//å³ä¾§ä¸æ˜¾ç¤ºYè½´ barchart.getAxisLeft().setAxisMinValue(0.0f);//è®¾ç½®Yè½´æ˜¾ç¤ºæœ€å°å€¼ï¼Œä¸ç„¶0ä¸‹é¢ä¼šæœ‰ç©ºéš™ barchart.getAxisLeft().setDrawGridLines(false);//ä¸è®¾ç½®Yè½´ç½‘æ ¼ barchart.setDescription(\"No Deal\");//è®¾ç½®æè¿° barchart.setDescriptionTextSize(20.f);//è®¾ç½®æè¿°å­—ä½“ barchart.animateXY(1000, 2000);//è®¾ç½®åŠ¨ç”» }} è¿™é‡Œï¼Œä¸€äº›ä½¿ç”¨æ–¹å¼å¯ä»¥å…·ä½“å»çœ‹çœ‹å¯¹åº”çš„ç±»æœºæ„ï¼Œæ¯”å¦‚BarChart é€šè¿‡æŸ¥çœ‹å®ƒå¯¹åº”çš„æºç ï¼Œå¯ä»¥æ›´å¥½çš„ä½¿ç”¨åŠŸèƒ½ï¼ŒASä¼šè‡ªåŠ¨çš„å¸®æˆ‘ä»¬åç¼–è¯‘ä¸€äº›å†…å®¹ï¼Œèƒ½å€ŸåŠ©ASå¾ˆå¥½çš„å­¦ä¹ ä¸€äº›å¼€æºJaråŒ…ã€‚ åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚ä½•è®©ç°å®çš„æ•°å€¼ä¸ºâ€œxxxå…ƒâ€å‘¢ï¼Ÿ MPAndroidChartä¸­å­˜åœ¨ValueFormatterè¿™ä¸ªä¸œè¥¿ï¼Œé€šè¿‡è¿™ä¸ªè¿˜åšä¸€ä¸ªè½¬æ¢ï¼Œå¦‚å®ç°â€œxxxå…ƒâ€çš„æ•ˆæœ 123456bardata.setValueFormatter(new ValueFormatter() { @Override public String getFormattedValue(float v, Entry entry, int i, ViewPortHandler viewPortHandler) { return entry.getVal() + \"å…ƒ\";//åªç”¨æ‹¿åˆ°å¯¹åº”Entryçš„å€¼ç„¶ååŠ ä¸ªâ€œå…ƒâ€å³å¯ï¼Œä¼ å…¥çš„è¿™å‡ ä¸ªå‚æ•°ï¼Œvå°±æ˜¯Yè½´çš„value, entryä¸ºæ•°æ®å…¥å£ï¼Œiå°±æ˜¯Xè½´æ–¹å‘çš„ä½ç½®ï¼ŒviewPortHandleråº”è¯¥å°±æ˜¯å¯¹åº”Viewçš„æ“ä½œæ‰‹ï¼Œæ§åˆ¶è§†å›¾çš„ç§»åŠ¨ç¼©æ”¾ä»€ä¹ˆçš„ } });","link":"/2016/09/03/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~BarChart/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~PieChart","text":"ç®€ä»‹MPAndroidChartæ˜¯PhilJayå¤§ç¥ç»™Androidå¼€å‘è€…å¸¦æ¥çš„ç¦åˆ©ã€‚MPAndroidChartæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§å¹¶ä¸”ä½¿ç”¨çµæ´»çš„å›¾è¡¨å¼€æºåº“ï¼Œæ”¯æŒAndroidå’ŒIOSä¸¤ç§ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶åªå…³æ³¨Androidç‰ˆæœ¬ã€‚ Wikihttps://github.com/PhilJay/MPAndroidChart/wiki Javadochttps://jitpack.io/com/github/PhilJay/MPAndroidChart/v3.0.0-beta1/javadoc/ ä»Šæ—¥ä¹‹å›¾~PieChartå…ˆçœ‹ä¸‹æ•ˆæœå‹å‹æƒŠï¼Œå³è¾¹çš„å›¾ä¸ºå·¦è¾¹çš„å›¾æ¨ªå‘æ‹‰ä¼¸åçš„æ•ˆæœ å®é™…é™æ€æ•ˆæœï¼Œä¸Šé¢é‚£ä¸ªæ˜¯å› ä¸ºåŠ äº†åŠ¨ç”»ï¼Œå½•åˆ¶Gifçš„æ—¶å€™ä¸å°å¿ƒå¼„æˆäº†ä¸€ç›´æ—‹è½¬çš„æ•ˆæœ å¸ƒå±€æ–‡ä»¶1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"mapdemo.example.com.mpandroidchartdemo.MainActivity\"&gt; &lt;com.github.mikephil.charting.charts.PieChart android:id=\"@+id/piechart\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"Hello World!\" /&gt;&lt;/RelativeLayout&gt; å¯¹äºChart,å¯ä»¥é‡‡ç”¨å¸ƒå±€æ–‡ä»¶æ·»åŠ æ–¹å¼ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä»£ç æ·»åŠ æ–¹å¼ã€‚ ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263public class MainActivity extends AppCompatActivity { @Bind(R.id.piechart) PieChart piechart; private Random random;//ç”¨äºäº§ç”Ÿéšæœºæ•°å­— @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); random = new Random(); initPieChart();//åˆå§‹åŒ–é¥¼å›¾ } private void initPieChart() { ArrayList&lt;Entry&gt; yVals = new ArrayList&lt;&gt;(); //å€¼åæ ‡ ArrayList&lt;String&gt; xVals = new ArrayList&lt;&gt;();//å¯¹åº”çš„Lable,å¯ä»¥ç†è§£æˆXè½´ for (int i = 0; i &lt; 5; i++) { xVals.add((i + 1) + \"æœˆ\"); yVals.add(new BarEntry(random.nextInt(10000), i)); } PieDataSet pieDataSet = new PieDataSet(yVals, \"å°æ˜æ¯æœˆæ”¯å‡º\");//åˆ›å»ºé¥¼å›¾çš„ä¸€ä¸ªæ•°æ®é›† pieDataSet.setColors(ColorTemplate.COLORFUL_COLORS); //è®¾ç½®æˆä¸°å¯Œå¤šå½©çš„é¢œè‰² DisplayMetrics metrics = getResources().getDisplayMetrics(); float px = 10 * (metrics.densityDpi / 160f); pieDataSet.setSelectionShift(px); //ç‚¹å‡»åå»¶ä¼¸å‡ºæ¥çš„é•¿åº¦ PieData piedata = new PieData(xVals, pieDataSet);//ç”ŸæˆPieData piechart.setData(piedata);//ç»™PieChartå¡«å……æ•°æ® piechart.getLegend().setPosition(Legend.LegendPosition.ABOVE_CHART_LEFT); piechart.getLegend().setForm(Legend.LegendForm.CIRCLE);//è®¾ç½®æ³¨è§£çš„ä½ç½®å’Œå½¢çŠ¶ piechart.setOnChartValueSelectedListener(new OnChartValueSelectedListener() {//è®¾ç½®å€¼é€‰æ‹©æ—¶çš„Listener @Override public void onValueSelected(Entry entry, int i, Highlight highlight) { Toast.makeText(MainActivity.this, \"Something selected value = \" + entry.getVal(), Toast.LENGTH_SHORT).show();//å•çº¯åœ°æ˜¾ç¤ºä¸€ä¸ªToast } @Override public void onNothingSelected() { } }); piechart.setCenterText(\"æ”¶æ”¯æ˜ç»†\");//ä¸­é—´å†™çš„æ–‡å­— piechart.setCenterTextColor(Color.RED);//è®¾ç½®ä¸­é—´æ–‡å­—çš„é¢œè‰² piechart.setCenterTextRadiusPercent(0.5f);//è®¾ç½®æ–‡å­—æ˜¾ç¤ºçš„è§’åº¦ï¼Œ180æ¨ªç€ï¼Œé»˜è®¤æ˜¯ç«–ç€ piechart.setCenterTextSize(12f);//è®¾ç½®ä¸­å¿ƒæ–‡å­—çš„å­—ä½“å¤§å° piechart.setCenterTextTypeface(null);//è®¾ç½®å­—ä½“ piechart.setDrawCenterText(true);//ä¸­å¿ƒå­—ä½¿èƒ½å¼€å…³ï¼Œfalseæ—¶ä¸­é—´æ— æ³•æ˜¾ç¤ºæ–‡å­— piechart.setTransparentCircleAlpha(100);//é€æ˜åœˆçš„é€æ˜åº¦ï¼Œåˆ†3åœˆï¼Œä¸€ä¸ªæ˜¯å¤–é¢çš„å€¼ï¼Œç„¶åæ˜¯è¿™ä¸ªï¼Œç„¶åå°±æ˜¯ä¸‹é¢çš„é‚£ä¸ªHole piechart.setTransparentCircleColor(Color.RED); //è®¾ç½®é¢œè‰² piechart.setTransparentCircleRadius(50f);//è®¾ç½®åŠå¾„ piechart.setDrawHoleEnabled(true);//åŸºæœ¬åŒä¸Š piechart.setHoleColor(Color.GREEN); piechart.setHoleRadius(30f); piechart.setDescription(\"No Deal\");//è®¾ç½®æè¿°æ–‡å­— piechart.setDescriptionTextSize(20.f);//è®¾ç½®æè¿°æ–‡å­—çš„å­—ä½“ piechart.animateXY(1000, 1000); }} å€¼é€‰æ‹©æ—¶çš„äº‹ä»¶å¤„ç†ä¸Šé¢çš„ä¾‹å­ä¸­å…¶å®å·²ç»æœ‰äº† 123456789piechart.setOnChartValueSelectedListener(new OnChartValueSelectedListener() {//è®¾ç½®å€¼é€‰æ‹©æ—¶çš„Listener @Override public void onValueSelected(Entry entry, int i, Highlight highlight) { Toast.makeText(MainActivity.this, \"Something selected value = \" + entry.getVal(), Toast.LENGTH_SHORT).show();//å•çº¯åœ°æ˜¾ç¤ºä¸€ä¸ªToast } @Override public void onNothingSelected() { }}); é€‰ä¸­å’Œå•¥éƒ½æ²¡å¹²çš„å›è°ƒï¼Œåˆ©ç”¨è¿™ä¸ªå›è°ƒæˆ‘ä»¬å¯ä»¥åšä¸€äº›è·³è½¬æ“ä½œï¼Œæ¯”å¦‚ä»å›½å®¶çº§æŠ¥è¡¨ï¼Œè·³è½¬åˆ°çœçº§ï¼Œç„¶åå¸‚çº§ and so on.","link":"/2016/09/05/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~PieChart/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~ScatterChart","text":"ç®€ä»‹MPAndroidChartæ˜¯PhilJayå¤§ç¥ç»™Androidå¼€å‘è€…å¸¦æ¥çš„ç¦åˆ©ã€‚MPAndroidChartæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§å¹¶ä¸”ä½¿ç”¨çµæ´»çš„å›¾è¡¨å¼€æºåº“ï¼Œæ”¯æŒAndroidå’ŒIOSä¸¤ç§ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶åªå…³æ³¨Androidç‰ˆæœ¬ã€‚ Wikihttps://github.com/PhilJay/MPAndroidChart/wiki Javadochttps://jitpack.io/com/github/PhilJay/MPAndroidChart/v3.0.0-beta1/javadoc/ ä»Šæ—¥ä¹‹å›¾~ScatterChart å¸ƒå±€æ–‡ä»¶1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:paddingBottom=\"@dimen/activity_vertical_margin\" android:paddingLeft=\"@dimen/activity_horizontal_margin\" android:paddingRight=\"@dimen/activity_horizontal_margin\" android:paddingTop=\"@dimen/activity_vertical_margin\" tools:context=\"mapdemo.example.com.mpandroidchartdemo.MainActivity\"&gt; &lt;com.github.mikephil.charting.charts.ScatterChart android:id=\"@+id/scatterchart\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"Hello World!\" /&gt;&lt;/RelativeLayout&gt; ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public class MainActivity extends AppCompatActivity { @Bind(R.id.scatterchart) ScatterChart scatterChart; private Random random; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); random = new Random(); initScatterChart(); } private void initScatterChart() { ArrayList&lt;Entry&gt; yVals = new ArrayList&lt;&gt;(); ArrayList&lt;String&gt; xVals = new ArrayList&lt;&gt;();//åˆå§‹åŒ–æ¨ªçºµåæ ‡å†…å®¹ for (int i = 0; i &lt; 5; i++) { xVals.add((i + 1) + \"æœˆ\"); yVals.add(new Entry(random.nextInt(1000), i));//äº§ç”Ÿæ•°æ® } ScatterDataSet scatterDataSet = new ScatterDataSet(yVals, \"å°æ˜æ¯æœˆæ”¯å‡º\"); scatterDataSet.setColors(ColorTemplate.COLORFUL_COLORS);//è®¾ç½®ä¸°å¯Œå¤šå½©çš„é¢œè‰² ScatterData scatterData = new ScatterData(xVals, scatterDataSet);//ç”ŸæˆScatterdataå¯¹è±¡ scatterChart.setData(scatterData);//è®¾ç½®å¯¹åº”æ•°æ® scatterChart.getLegend().setPosition(Legend.LegendPosition.ABOVE_CHART_LEFT); scatterChart.getLegend().setForm(Legend.LegendForm.CIRCLE); scatterChart.setOnChartValueSelectedListener(new OnChartValueSelectedListener() { @Override public void onValueSelected(Entry entry, int i, Highlight highlight) { Toast.makeText(MainActivity.this, \"Something selected value = \" + entry.getVal(), Toast.LENGTH_SHORT).show(); } @Override public void onNothingSelected() { } }); scatterChart.getXAxis().setPosition(XAxis.XAxisPosition.BOTTOM);//è®¾ç½®Xè½´ä½ç½® scatterChart.getAxisRight().setEnabled(false);//å³ä¾§Yè½´å…³é—­ scatterChart.getAxisLeft().setAxisMinValue(0.0f);//è®¾ç½®æœ€å°Yå€¼ scatterChart.getXAxis().setGridColor(Color.RED);//è®¾ç½®çºµå‘ç½‘æ ¼çº¿æ¡é¢œè‰² scatterChart.getAxisLeft().setGridColor(Color.GREEN);//è®¾ç½®æ¨ªå‘ç½‘æ ¼é¢œè‰² scatterChart.setDescription(\"No Deal\");//è®¾ç½®æè¿°å†…å®¹ scatterChart.setDescriptionTextSize(20.f);//è®¾ç½®æè¿°æ–‡å­—çš„å­—ä½“é¢œè‰² scatterChart.animateXY(1000, 1000);//åŠ¨ç”»æ•ˆæœ }} å¤‡æ³¨ScatterChartå’ŒLineChartï¼ŒBarChartå¾ˆç›¸ä¼¼ï¼Œä½¿ç”¨æ–¹å¼ä¹ŸåŸºæœ¬ç›¸åŒï¼ŒåŸºæœ¬ç”¨æ³•å°±æ˜¯è¿™æ ·ï¼Œåé¢é‡åˆ°é—®é¢˜åœ¨è§£å†³å¯¹åº”çš„é—®é¢˜ï¼Œç¢°åˆ°æ–°çš„éœ€æ±‚å†è§£å†³æ–°çš„éœ€æ±‚ã€‚ä»»ä½•é—®é¢˜è‚¯å®šä¼šæœ‰è§£å†³åŠæ³•ã€‚","link":"/2016/09/09/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ MPAndroidChart~ScatterChart/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆä¸€ï¼‰","text":"Androidå¤©æ°”é¢„æŠ¥å®¢æˆ·ç«¯è®¾è®¡æ€è·¯ æ¬¢è¿ç•Œé¢ï¼Œç‰ˆæœ¬å·ï¼Œåº”ç”¨å + æ•°æ®åå°åŠ è½½ï¼ˆæ‰€æœ‰åŸå¸‚çš„ä¿¡æ¯è·å–ï¼‰ æ•°æ®åŠ è½½å®Œæˆåè·³è½¬åˆ°æ˜¾ç¤ºç•Œé¢ï¼Œæ˜¾ç¤ºæ‰€æœ‰æŸ¥è¯¢åˆ°çš„åŸå¸‚çš„å¤©æ°”ä¿¡æ¯ æ¬¢è¿ç•Œé¢å’Œå¤©æ°”æ˜¾ç¤ºç•Œé¢åˆ†åˆ«ä¸ºå•ç‹¬çš„Activity Activityæ•°æ®ä¼ é€’ä½¿ç”¨Bundle ç½‘ç»œè¯·æ±‚é‡‡ç”¨GoogleåŸå§‹çš„VolleyåŒ… åå°æ•°æ®è¯·æ±‚é‡‡ç”¨å¼‚æ­¥AsyncTaskçš„æ–¹å¼ä»¥åŠå®æ—¶çš„è¿›åº¦æ¡çš„æ›´æ–° å¤©æ°”æ˜¾ç¤ºç•Œé¢é‡‡ç”¨ç®€å•çš„ListView ####ä½¿ç”¨çš„Androidå†…å®¹#### Activityçš„è·³è½¬ä»¥åŠæ•°æ®çš„ä¼ é€’ ç½‘ç»œæ•°æ®è¯·æ±‚ä»¥åŠJsonæ•°æ®çš„è§£æ Volleyçš„åˆçº§ä½¿ç”¨ ListViewçš„åˆçº§ä½¿ç”¨ AsyncTaskçš„åˆçº§ä½¿ç”¨ ProgressBarçš„åˆçº§ä½¿ç”¨ å¦‚ä½•è·å–å¤©æ°”ä¿¡æ¯ é‡‡ç”¨www.weather.com.cnæä¾›ç»™æˆ‘ä»¬çš„æ¥å£ä¾‹å¦‚è¯·æ±‚ï¼ŒåŒ—äº¬çš„å¤©æ°”é¢„æŠ¥http://www.weather.com.cn/data/cityinfo/101010100.htmlè·å–çš„ä¿¡æ¯ {â€œweatherinfoâ€: {â€œcityâ€:â€œåŒ—äº¬â€,â€œcityidâ€:â€œ101010100â€,â€œtemp1â€:â€-2â„ƒâ€,â€œtemp2â€:â€œ16â„ƒâ€,â€œweatherâ€:â€œæ™´â€, â€œimg1â€:â€œn0.gifâ€,â€œimg2â€:â€œd0.gifâ€,â€œptimeâ€:â€œ18:00â€}} JSonæ•°æ®æ ¼å¼ æ”¯æŒçš„åŸå¸‚è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465private int[] mCityCodeList = {101010100, 101010300, 101010400, 101010500, 101010600, 101010700, 101010800, 101010900, 101011000, 101011100, 101011200, 101011300, 101011400, 101011500, 101011600, 101011700, 101011800, 101011900, 101012000, 101012100, 101012200, 101010200, 101030100, 101030300, 101030400, 101030500, 101030600, 101031400, 101030800, 101030900, 101031000, 101031100, 101031200, 101030200, 101030700, 101020100, 101020300, 101020500, 101020600, 101021300, 101020800, 101020900, 101021000, 101021100, 101021200, 101020200, 101020700, 101090101, 101090301, 101090402, 101090501, 101091101, 101090701, 101090801, 101090901, 101091001, 101090201, 101090601, 101180101, 101180301, 101180401, 101180501, 101180601, 101180701, 101180801, 101180901, 101181001, 101181101, 101181201, 101181301, 101181401, 101181501, 101181601, 101181701, 101181801, 101180201, 101220101, 101220301, 101220401, 101220501, 101220601, 101220701, 101220801, 101220901, 101221001, 101221101, 101221201, 101221301, 101221401, 101221501, 101221601, 101221701, 101220201, 101210101, 101211101, 101210201, 101210301, 101210901, 101210501, 101210601, 101210701, 101210801, 101211001, 101210401, 101040100, 101040300, 101040400, 101040500, 101040600, 101040700, 101040800, 101040900, 101041000, 101041100, 101041200, 101041300, 101041400, 101041500, 101041600, 101041700, 101041800, 101041900, 101042000, 101042100, 101042200, 101042300, 101042400, 101042500, 101042600, 101042700, 101042800, 101042900, 101043000, 101043100, 101043200, 101043300, 101043400, 101043600, 101043700, 101040200, 101230101, 101230501, 101230601, 101230701, 101230509, 101230901, 101230201, 101230301, 101230401, 101230801, 101160101, 101160301, 101160401, 101160501, 101160601, 101161401, 101160801, 101160901, 101161001, 101161101, 101161201, 101161301, 101160201, 101160701, 101280101, 101280301, 101280401, 101280501, 101280601, 101280701, 101280800, 101280901, 101281001, 101281101, 101281201, 101281301, 101281401, 101281501, 101281601, 101281701, 101281801, 101281901, 101282001, 101282101, 101280201, 101300101, 101300301, 101300401, 101300501, 101300601, 101301401, 101300801, 101300901, 101301001, 101301101, 101301201, 101301301, 101300201, 101300701, 101260101, 101260301, 101260401, 101260906, 101260601, 101260701, 101260801, 101260201, 101260501, 101290101, 101290301, 101290601, 101290701, 101290801, 101290901, 101291001, 101291101, 101291201, 101291301, 101291401, 101291501, 101291601, 101290201, 101290401, 101290501, 101080101, 101080301, 101080401, 101080501, 101081201, 101080701, 101080801, 101080901, 101081000, 101081101, 101080201, 101080601, 101240101, 101240301, 101240401, 101240501, 101241101, 101240701, 101240801, 101240901, 101241001, 101240201, 101240601, 101200101, 101200501, 101200801, 101200901, 101201001, 101201101, 101201201, 101201301, 101201401, 101201501, 101201601, 101201701, 101200201, 101200301, 101200401, 101200601, 101200701, 101270101, 101270301, 101270401, 101270501, 101270601, 101270701, 101270801, 101270901, 101271001, 101271101, 101271201, 101271301, 101271401, 101271501, 101271601, 101271701, 101271801, 101271901, 101272001, 101272101, 101270201, 101170101, 101170501, 101170401, 101170201, 101170301, 101150101, 101150301, 101150801, 101150501, 101150601, 101150701, 101150201, 101150401, 101120101, 101120601, 101120901, 101121001, 101121101, 101121201, 101121301, 101121401, 101121501, 101121601, 101121701, 101120201, 101120301, 101120401, 101120501, 101120701, 101120801, 101110101, 101110300, 101110401, 101111001, 101110601, 101110701, 101110801, 101110901, 101110200, 101110501, 101100101, 101100701, 101100801, 101100901, 101101001, 101100501, 101100201, 101100301, 101100401, 101100601, 101101100, 101130101, 101130301, 101130401, 101130501, 101130601, 101130701, 101130801, 101130901, 101131001, 101131101, 101131201, 101131301, 101131401, 101131501, 101131601, 101130201, 101140101, 101140301, 101140701, 101140501, 101140601, 101140201, 101140401, 101340101, 101340201, 101340401, 101310101, 101310201, 101310202, 101310203, 101310204, 101310205, 101310206, 101310207, 101310208, 101310209, 101310210, 101310211, 101310212, 101310214, 101310215, 101310216, 101310217, 101310220, 101310221, 101310222, 101310102, 101250101, 101250301, 101250401, 101250501, 101250601, 101250700, 101250801, 101250901, 101251001, 101251101, 101251201, 101251301, 101251401, 101251501, 101250201, 101190101, 101190301, 101190401, 101190501, 101190601, 101191301, 101190801, 101190901, 101191001, 101191101, 101191201, 101190201, 101190701, 101050101, 101050301, 101050401, 101050501, 101050601, 101051301, 101050801, 101050901, 101051002, 101051101, 101051201, 101050201, 101050701, 101060101, 101060301, 101060401, 101060901, 101060601, 101060701, 101060801, 101060201, 101060501, 101070101, 101070301, 101070401, 101070501, 101070601, 101071401, 101070801, 101070901, 101071001, 101071101, 101071201, 101071301, 101070201, 101070701}; å¤§æ¦‚å°±æ˜¯è¿™ä¹ˆå¤šï¼Œå…·ä½“å¯¹åº”çš„å†…å®¹ï¼Œç”±äºè¿™ä¸ªç®€å•çš„å¤©æ°”é¢„æŠ¥ä¸»è¦æ˜¯ä¸ºäº†ç»ƒæ‰‹ï¼Œç›´æ¥éå†è·å–å¯¹åº”çš„ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨ListViewå±•ç¤ºï¼Œæ²¡æœ‰åšUIä¼˜åŒ–ã€‚","link":"/2016/04/25/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆä¸€ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆå››ï¼‰","text":"å‰è¨€ ç¬¬äºŒæ¬¡å°è¯•å®Œæˆå¤©æ°”é¢„æŠ¥åº”ç”¨ï¼Œä¸ä¸Šæ¬¡ä¸åŒçš„æ˜¯ï¼Œä¸ªäººæ„Ÿè§‰è¿™æ¬¡çš„Uiä¸é‚£ä¹ˆä¸‘é™‹ï¼Œæ•´ä½“çš„å®ç”¨æ€§å’Œç•Œé¢æ•ˆæœï¼Œç”¨æˆ·ä½“éªŒç›¸è¾ƒä¸Šä¸€æ¬¡æœ‰æ‰€æå‡ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦å®Œå–„ã€‚ è¿™æ¬¡ä½¿ç”¨åˆ°çš„å†…å®¹æ¯”è¾ƒä¸°å¯Œï¼ŒåŒ…æ‹¬èšåˆæ•°æ®Sdkï¼ŒButterKnife,Gson,fastjson,å…¶å®è¿˜æƒ³ç”¨ä¸€ä¸‹volleyçš„ï¼Œä½†æ˜¯èšåˆæ•°æ®ä¸­å·²ç»æœ‰å¯¹ç½‘ç»œè¯·æ±‚çš„å¤„ç†ï¼Œå°±æ²¡æœ‰æ·±ç©¶ï¼Œé¡ºå¸¦çš„çœ‹äº†ä¸‹Material Designçš„å†…å®¹ï¼Œè¿™ä¹ˆæ—©å‡ºæ¥çš„å†…å®¹ï¼Œç°åœ¨æ‰å»äº†è§£ï¼Œæ„Ÿè§‰è¦çœ‹çš„ä¸œè¥¿æœ‰å¾ˆå¤šï¼Œå…ˆåœ¨è¿™é‡ŒMarkingä¸€ä¸‹ï¼Œåé¢ä¼šç»§ç»­å­¦ä¹ å¯¹åº”çš„å†…å®¹ã€‚ æˆæœå±•ç¤º å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ ButterKnifeæ³¨å…¥åï¼ŒæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ è§£å†³åŠæ³•ï¼š è®¾ç½®â€“&gt;æœç´¢Annotation Processorï¼Œä¿è¯Enable Annotation Processingæ‰“ä¸Šå‹¾ åœ†è§’ç¼–è¯‘æ¡†çš„Shape 123456789101112131415161718&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\"&gt; &lt;solid android:color=\"#ffffff\"/&gt; &lt;stroke android:width=\"2dip\" android:color=\"#A0A0A0\"/&gt; &lt;padding android:bottom=\"10dp\" android:left=\"10dp\" android:right=\"10dp\" android:top=\"10dp\"/&gt; &lt;corners android:radius=\"10dp\"/&gt;&lt;/shape&gt; ç„¶åé‡‡ç”¨android:background=â€@drawable/shapeâ€ä½¿ç”¨ 3.å·²ç»ä½¿ç”¨äº†shapeæ–‡ä»¶ä½œä¸ºbackgroundçš„Viewå¦‚ä½•è®¾ç½®èƒŒæ™¯è‰² GradientDrawable myGrad = (GradientDrawable)XXXView.getBackground(); myGrad.setColor(getResources().getColor(R.color.choosecitysearchbackground));","link":"/2016/05/14/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆå››ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆä¸‰ï¼‰","text":"æ˜¨å¤©ä»‹ç»äº†åŸºæœ¬çš„è½½å…¥ç•Œé¢ï¼Œä»Šå¤©ä»‹ç»ä¸‹å¤©æ°”ä¿¡æ¯æ˜¾ç¤ºç•Œé¢çš„ä»£ç  åŸºæœ¬ListViewæ˜¾ç¤º æœç´¢æ¡†ï¼ŒæŸ¥è¯¢åŸå¸‚ ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œè½½å…¥ç•Œé¢é€šè¿‡showWeatherInfo()æ–¹æ³•è·³è½¬åˆ°å¤©æ°”ä¿¡æ¯æ˜¾ç¤ºç•Œé¢ 123456789private void showWeatherInfo() { Bundle bundle = new Bundle();//bundleç”¨æ¥ä¼ é€’weatherinfolist bundle.putSerializable(Utils.WEATHERINFO, (Serializable) weatherInfoList); Intent intent = new Intent(MyActivity.this, MainActivity.class); //è·³è½¬åˆ°MainActivity intent.putExtra(Utils.WEATHERINFO, bundle); startActivity(intent); finish();//ç»“æŸå½“å‰Activity} å¦‚ä¸‹æ˜¯ç”¨äºæ˜¾ç¤ºå¤©æ°”ä¿¡æ¯çš„MainActivityçš„å†…å®¹ï¼Œæ³¨æ„æ³¨é‡Š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class MainActivity extends Activity { //å®šä¹‰TAGæ˜¯ç”¨æ¥æ‰“Logçš„ private static final String TAG = \"MyActivity\"; private ListView mListView;//ListViewç”¨æ¥æ˜¾ç¤ºå¤©æ°”ä¿¡æ¯ private WeatherAdapter mWeatherAdapter;//ListViewå¯¹åº”çš„Adapter private EditText mSearchEt;//æœç´¢æ¡† private ArrayList&lt;WeatherInfo&gt; weatherInfoList;//å…¨éƒ¨å¤©æ°”ä¿¡æ¯List private ArrayList&lt;WeatherInfo&gt; resultList;//æ ¹æ®æœç´¢æ¡†è¾“å…¥çš„å†…å®¹æ˜¾ç¤ºçš„ç»“æœList /** * Called when the activity is first created. */ @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); requestWindowFeature(Window.FEATURE_NO_TITLE); setContentView(R.layout.main); resultList = new ArrayList&lt;WeatherInfo&gt;(); Intent intent = getIntent(); Bundle bundle = intent.getBundleExtra(Utils.WEATHERINFO);//è·å–Intentä¸­æºå¸¦çš„ä¿¡æ¯ weatherInfoList = (ArrayList&lt;WeatherInfo&gt;) bundle.getSerializable(Utils.WEATHERINFO); Log.e(TAG, \"weatherinfo = \" + weatherInfoList.toString()); mSearchEt = (EditText) findViewById(R.id.et_search); mListView = (ListView) findViewById(R.id.lvView); mWeatherAdapter = new WeatherAdapter(this, weatherInfoList); mListView.setAdapter(mWeatherAdapter); //è®¾ç½®TextWathcer()æ ¹æ®è¾“å…¥æ¡†çš„æ–‡æœ¬å˜åŒ–æ˜¾ç¤ºä¸åŒçš„list mSearchEt.addTextChangedListener(new TextWatcher() { @Override public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) { } @Override public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) { } @Override public void afterTextChanged(Editable editable) { resultList.clear(); String searchstr = mSearchEt.getText().toString(); if(searchstr==null) { mWeatherAdapter.setWeatherInfoList(weatherInfoList); mWeatherAdapter.notifyDataSetChanged(); } else { for (int i = 0; i &lt; weatherInfoList.size(); i++) { String cityname = weatherInfoList.get(i).getCity(); if (cityname.contains(searchstr) || searchstr.contains(cityname)) { resultList.add(weatherInfoList.get(i)); } } //æ›´æ–°Adatperå¯¹åº”çš„æ•°æ® mWeatherAdapter.setWeatherInfoList(resultList); mWeatherAdapter.notifyDataSetChanged(); } } }); }} çœ‹çœ‹WeatherAdapterçš„ä»£ç ï¼ŒWeatherAdapterç»§æ‰¿BaseAdapter 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263//ç»§æ‰¿BaseAdapterï¼Œéœ€è¦å¤å†™å‡ ä¸ªæ–¹æ³•public class WeatherAdapter extends BaseAdapter { private static final String TAG = \"WeatherAdapter\"; private Context context; private List&lt;WeatherInfo&gt; weatherInfoList; public WeatherAdapter(Context context, List&lt;WeatherInfo&gt; weatherInfoList) { this.context = context; this.weatherInfoList = weatherInfoList; } @Override public int getCount() { return weatherInfoList.size(); }//listçš„size @Override public WeatherInfo getItem(int i) { return weatherInfoList.get(i); }//è·å–å¤©æ°”ä¿¡æ¯ @Override public long getItemId(int i) { return i; }//è·å–Itemçš„id @Override public View getView(int i, View view, ViewGroup viewGroup) { //è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒå…³é”®ï¼Œè¿”å›Item view if (view == null) { view = LayoutInflater.from(context).inflate(R.layout.listviewitem, null); } ImageView weatherimage = (ImageView) view.findViewById(R.id.weatherimage); TextView cityname = (TextView) view.findViewById(R.id.cityname); TextView temp = (TextView) view.findViewById(R.id.temp); TextView weather = (TextView) view.findViewById(R.id.weather); WeatherInfo weatherInfo = weatherInfoList.get(i); cityname.setText(weatherInfo.getCity()); temp.setText(weatherInfo.getTemp1() + \" ~ \" + weatherInfo.getTemp2()); String weatherstr = weatherInfo.getWeather(); weather.setText(weatherstr); //è¿™é‡Œå¤§è‡´ä½¿ç”¨å‡ ä¸ªå›¾ç‰‡ï¼Œå…·ä½“åšæ³•ï¼Œä¸åŒçš„jsonæ•°æ®æŸ¥è¯¢apiä¸­åº”è¯¥å¯ä»¥æŸ¥è¯¢åˆ°æ”¯æŒçš„å¤©æ°”ç§ç±»ï¼Œæ ¹æ®æŸ¥è¯¢åˆ°çš„ç§ç±»è®¾ç½®ä¸ç”¨çš„å›¾ç‰‡ï¼Œè¿™é‡Œæš‚ä¸”åªåˆ†ä¸º4ç§ï¼Œé¿å…æˆ‘çš„apkç•Œé¢å¤ªä¸‘ ä¸å¿ç›´è§† if(weatherstr.contains(\"é›¨\")) { weatherimage.setImageResource(R.drawable.rain); } else if(weatherstr.contains(\"é˜´\")) { weatherimage.setImageResource(R.drawable.yin); } else if(weatherstr.contains(\"äº‘\")) { weatherimage.setImageResource(R.drawable.cloud); } else if(weatherstr.contains(\"é›ª\")) { weatherimage.setImageResource(R.drawable.snow); } else { weatherimage.setImageResource(R.drawable.sun); } return view; } //æ–¹ä¾¿æ›¿æ¢List public void setWeatherInfoList(List&lt;WeatherInfo&gt; list) { this.weatherInfoList = list; }} åŸºæœ¬æ•ˆæœå›¾ï¼šï¼ˆå½•å±å¤§å¸ˆå½•å±ï¼‰ æºä»£ç ä¸‹è½½è·¯å¾„ï¼š http://download.csdn.net/detail/poorkick/9510243 ç¼ºé™·ï¼š æ¯æ¬¡è¿›å…¥éœ€è¦è½½å…¥æ•°æ®ï¼Œå¯ä»¥æ›¿æ¢æˆæ ¹æ®æ—¶é—´æˆ³åˆ¤æ–­æ˜¯å¦æ•°æ®æœ‰æ›´æ–°,å½“ç„¶è¿™ä¸ªå¯¹æŸ¥è¯¢å€Ÿå£æœ‰ç‚¹ä¾èµ–ï¼Œæœ¬åœ°é€šè¿‡æ•°æ®åº“å­˜å‚¨å½“å‰ä¿¡æ¯ å¤©æ°”ä¿¡æ¯ç”±äºä½¿ç”¨çš„æ˜¯æ°”è±¡å°çš„ï¼Œæ•°æ®æ›´æ–°è‡ªå·±æœ¬èº«æ— æ³•æŒæ¡ï¼Œå¯ä»¥æ›¿æ¢æˆå…¶ä»–æŸ¥è¯¢æ¥å£ åç»­å¯èƒ½ä¼šå†åšä¸€ä¸ªæ›´å®Œå–„çš„å¤©æ°”é¢„æŠ¥åº”ç”¨ï¼Œé‡‡ç”¨æ–°çš„æŸ¥è¯¢æ¥å£å’ŒUIç•Œé¢ ç•Œé¢ç®€é™‹ï¼Œä»£ç ä¸å®Œå–„ï¼Œè§è°…ï¼Œå·¥ä½œä¹‹ä½™ç»ƒæ‰‹ä¹‹ä½œã€‚","link":"/2016/05/04/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆä¸‰ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ æ¯æ—¥ä¸€æ–‡ç®€å•ç‰ˆ","text":"1. ç®€ä»‹å‰æ®µæ—¶é—´å­¦ä¹ Kotlinï¼Œå‡†å¤‡æ‰¾ä¸ªä¸œè¥¿ä¸‹æ‰‹ï¼Œå¤æ‚çš„å†…å®¹æš‚æ—¶ä¹Ÿå¤„ç†ä¸äº†ï¼Œæ‰€ä»¥é€‰äº†â€œæ¯æ—¥ä¸€æ–‡â€çš„æ¥å£ä½œä¸ºæµ‹è¯•ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç†Ÿæ‚‰Kotlinçš„è¯­æ³•å’Œankoä¸­çš„æ•°æ®åº“æ“ä½œã€‚ 2. å†…å®¹ KotlinåŸºæœ¬è¯­æ³• anko-commonä½¿ç”¨ anko-sqliteä½¿ç”¨ Navigation+DrawerLayoutå®ç°å·¦å³æŠ½å±‰èœå• Retrofit + Okhttp + Rxjava2 + Gson å¤„ç†ç½‘ç»œè¯·æ±‚ Material Design 3. æ€è·¯å¯ç”¨å¼€å‘è€…æ¨¡å¼ï¼Œæ‰“å¼€â€œæ˜¾ç¤ºè¾¹ç•Œå¸ƒå±€â€ï¼Œä½ å¯ä»¥çœ‹åˆ°åº”ç”¨å”¯ä¸€çš„ä¸€ä¸ªä¸»ç•Œé¢é‡‡ç”¨æ˜¯ä¸€ä½“çš„ï¼Œæ²¡æœ‰æ§ä»¶çš„åˆ†ç¦»ï¼ŒçŒœæµ‹é‡‡ç”¨çš„æ˜¯æ··åˆå¼å¼€å‘ï¼Œæ‰€ä»¥å‘¢ï¼Œå¯¹æˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ã€‚åªèƒ½æŒ‰ç…§è‡ªå·±çš„æ–¹å¼ï¼Œå®ç°å®ƒçš„åŠŸèƒ½ã€‚æ¯•ç«Ÿæ˜¯ä¸ºäº†ç†Ÿæ‚‰è¯­è¨€ï¼Œä¸æ·±ç©¶ã€‚ 4. ä¾èµ–åº“12ext.kotlin_version = '1.1.2-5'ext.anko_version = '0.10.0' 123456789101112131415161718192021compile fileTree(include: ['*.jar'], dir: 'libs')compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"compile \"org.jetbrains.anko:anko-common:$anko_version\"compile \"org.jetbrains.anko:anko-sqlite:$anko_version\"compile \"org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlin_version\"compile 'com.android.support:appcompat-v7:25.3.1'compile 'com.android.support:design:25.3.1'compile 'com.android.support:recyclerview-v7:25.3.1'compile 'com.android.support:cardview-v7:25.3.1'compile 'com.android.support:support-v13:25.3.1'compile 'com.google.code.gson:gson:2.7'compile 'com.squareup.retrofit2:retrofit:2.2.0'compile 'com.squareup.retrofit2:converter-gson:2.1.0'compile 'com.squareup.retrofit2:adapter-rxjava2:2.2.0'compile 'io.reactivex.rxjava2:rxandroid:2.0.1'compile 'io.reactivex.rxjava2:rxjava:2.x.y'compile 'com.squareup.okhttp3:logging-interceptor:3.4.1'compile 'com.squareup.okhttp3:okhttp:3.4.1'compile 'com.android.support:support-vector-drawable:25.3.1'compile 'info.hoang8f:android-segmented:1.0.6'compile 'com.kyleduo.switchbutton:library:1.4.6' 5. æ•ˆæœ 6. GithubOneArticle 7. å¤‡æ³¨æ¯æ—¥ä¸€æ–‡æ¥å£é‡‡ç”¨éæ­£å¼æ–¹å¼è·å–ï¼Œä»…ä¾›å­¦ä¹ ï¼Œè‹¥æœ‰ä¾µæƒè¯·å‘ŠçŸ¥ï¼Œå³åˆ»åˆ é™¤ã€‚","link":"/2017/07/31/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ æ¯æ—¥ä¸€æ–‡ç®€å•ç‰ˆ/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¹²è´§é›†ä¸­è¥ï½æŠ€æœ¯èˆ¹","text":"æŠ€æœ¯èˆ¹ æ¯æ—¥æä¾›æŠ€æœ¯å¹²è´§çš„ App ä¸‹è½½fir é…·å®‰ å¹²è´§æ•°æ®æºåº”ç”¨ä¸­çš„æ‰€æœ‰å¹²è´§æ•°æ®å‡æ¥è‡ªå¹²è´§é›†ä¸­è¥ã€‚ Appè®¾è®¡è‰²è°ƒï¼šè¿œå·é¼ ã€è½æ —ã€è‹èŠ³ã€çŸ³ç«¹ã€æ¯è‰ã€æŸ³ç…¤ç«¹èŒ¶ã€é”–é’ç£ã€é¸ ç¾½ç´«å…«ç§æ·¡é›…çš„é¢œè‰²ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„å¹²è´§æ•°æ®ã€‚å¸ƒå±€ï¼šç®€çº¦é£æ ¼ï¼Œæç®€ä¸»ä¹‰ï¼Œå»ç¹å°±ç®€ã€‚æ’ç‰ˆï¼šæœ€ç®€å•çš„Toolbar + RecyclerView UIè®¾è®¡ é»‘ç™½ç° åœ†è§’ ææ–™è®¾è®¡ ä»£ç è®¾è®¡ Retrofit+RxJava çš„ç»„åˆè·å–ç½‘ç»œæ•°æ®; FlycoTabLayoutä½œä¸ºä¸»ç•Œé¢ç»“æ„ï¼Œé…åˆFragmentï¼Œå®ç°â€œæ¯æ—¥å¹²è´§â€ï¼Œâ€œåˆ†ç±»æ•°æ®â€ï¼Œâ€œå¦¹çº¸å›¾ç‰‡â€å’Œå…³äºå››ä¸ªç•Œé¢; BGARefreshLayouté…åˆRecyclerViewå’Œè‡ªå®šä¹‰å¤šç±»å‹Itemç»“æ„å®ç°å¹²è´§æ•°æ®çš„å±•ç¤º; MaterialAboutä½œä¸ºâ€œå…³äºâ€ç•Œé¢çš„åŸºç¡€ï¼› Glideä½œä¸ºå›¾ç‰‡åŠ è½½æ¡†æ¶ï¼› RxJava+Retrofité…åˆfir.imçš„æ¥å£å®ç°ç‰ˆæœ¬æ›´æ–°åŠŸèƒ½ï¼› ShareåŠŸèƒ½å…¨éƒ¨é‡‡ç”¨ç³»ç»Ÿè‡ªå¸¦ï¼ŒåŸºæœ¬å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚ ButterKnifeæ³¨è§£åº“ Gsonä½œä¸ºjsonæ•°æ®è§£æåº“ ä¾èµ–åº“ Glide RxAndroid RxJava Retrofit okhttp3 Gson ButterKnife BGARefreshLayout-Android FlycoTabLayout MaterialAbout Author CSDN Website æ˜é‡‘ æ•ˆæœå›¾","link":"/2017/04/13/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¹²è´§é›†ä¸­è¥ï½æŠ€æœ¯èˆ¹/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ1ï¼‰","text":"ç®€ä»‹è¯¦æƒ…è¯·çœ‹ç™¾åº¦åœ°å›¾å®˜æ–¹ç½‘ç«™ http://lbsyun.baidu.com/index.php?title=androidsdk/guide/introduction ä½¿ç”¨æ–¹å¼ ç”³è¯·å¯†é’¥ï¼Œé’ˆå¯¹ç§»åŠ¨å¹³å°å’ŒæœåŠ¡å™¨ï¼Œå­˜åœ¨ä¸åŒçš„AKï¼Œé’ˆå¯¹ç§»åŠ¨å¹³å°ï¼Œéœ€è¦å¡«å†™åŒ…åå’ŒSHA1 è·å–SHA1çš„æ–¹æ³•ï¼š æ‰§è¡Œå®Œæˆåå°±ä¼šå‡ºç°å¯¹åº”çš„SHA1å¯†é’¥ é…ç½®ç¯å¢ƒ å‚è€ƒå®˜ç½‘ï¼šhttp://lbsyun.baidu.com/index.php?title=androidsdk/guide/buildproject ###å®˜ç½‘Hello BaiduMapAndroidManifest.xmlå¤„ç† 12345&lt;application&gt; &lt;meta-data android:name=\"com.baidu.lbsapi.API_KEY\" android:value=\"å¼€å‘è€… key\" /&gt; &lt;/application&gt; æ·»åŠ å¯¹åº”æƒé™ 123456789&lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/&gt;&lt;uses-permission android:name=\"android.permission.INTERNET\"/&gt;&lt;uses-permission android:name=\"com.android.launcher.permission.READ_SETTINGS\" /&gt;&lt;uses-permission android:name=\"android.permission.WAKE_LOCK\"/&gt;&lt;uses-permission android:name=\"android.permission.CHANGE_WIFI_STATE\" /&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\" /&gt;&lt;uses-permission android:name=\"android.permission.GET_TASKS\" /&gt;&lt;uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/&gt;&lt;uses-permission android:name=\"android.permission.WRITE_SETTINGS\" /&gt; å¸ƒå±€æ–‡ä»¶ 12345678910111213&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\"mapdemo.example.com.selfbaidumap.MainActivity\"&gt; &lt;!--è¿™å®¶ä¼™å°±æ˜¯ç¥å¥‡æ‰€åœ¨ --&gt; &lt;com.baidu.mapapi.map.MapView android:id=\"@+id/bmapView\" android:layout_width=\"fill_parent\" android:layout_height=\"fill_parent\" android:clickable=\"true\" /&gt;&lt;/FrameLayout&gt; ä»£ç ä¿®æ”¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445package mapdemo.example.com.selfbaidumap;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import com.baidu.mapapi.SDKInitializer;import com.baidu.mapapi.map.MapView;public class MainActivity extends AppCompatActivity { private MapView mMapView = null; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); SDKInitializer.initialize(getApplicationContext()); setContentView(R.layout.activity_main); mMapView = (MapView) findViewById(R.id.bmapView); } @Override protected void onResume() { if (mMapView != null) { mMapView.onResume(); } super.onResume(); } @Override protected void onPause() { if (mMapView != null) { mMapView.onPause(); } super.onPause(); } @Override protected void onDestroy() { if (mMapView != null) { mMapView.onDestroy(); } super.onDestroy(); }} å®˜ç½‘ç¤ºä¾‹æ•ˆæœ å¤‡æ³¨åˆšå¼€å§‹ï¼Œåé¢åº”è¯¥ä¼šæŠŠç™¾åº¦åœ°å›¾çš„ä¸€äº›å†…å®¹æ…¢æ…¢å­¦ä¹ ä¸€ä¸‹ï¼Œæœ€è¿‘å¼€å§‹å­¦ä¹ JSï¼Œå¸Œæœ›è‡ªå·±èƒ½åšæŒå­¦ä¹ ï¼ŒåšæŒåšæ–‡ï¼ŒåšæŒè‡ªå·±çš„äº‹æƒ…ï¼ŒåŠ æ²¹ã€‚","link":"/2016/08/25/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ1ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ2ï¼‰","text":"ç®€ä»‹ä¸Šä¸€ç¯‡åªæ˜¯å¤§è‡´çš„æä¸€ä¸‹ç™¾åº¦åœ°å›¾APIçš„Android SDKçš„åŸºæœ¬å†…å®¹ï¼Œç„¶åæŠ„è¢­ä¸€ä¸ªå®˜ç½‘ä¸Šçš„Demoï¼Œä»Šå¤©çœ‹ä¸€ä¸‹ç™¾åº¦åœ°å›¾çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œåœ°å›¾ç±»å‹å’ŒåŸºæœ¬çš„æ˜¾ç¤ºã€‚ ç®€å•å®æˆ˜ä¸åŒç±»å‹åœ°å›¾çš„æ˜¾ç¤º 123456789//è®¾ç½®åœ°å›¾ç±»å‹//public static final int MAP_TYPE_NORMAL = 1; æ™®é€šåœ°å›¾//public static final int MAP_TYPE_SATELLITE = 2; å«æ˜Ÿåœ°å›¾//public static final int MAP_TYPE_NONE = 3; ç©ºç™½åœ°å›¾private void setMapType(int type) { if (mBaiduMap != null) { mBaiduMap.setMapType(type); }} ç©ºç™½åœ°å›¾ æ­£å¸¸åœ°å›¾ å«æ˜Ÿåœ°å›¾ å®æ—¶äº¤é€šå›¾å’Œç™¾åº¦åŸå¸‚çƒ­åŠ›å›¾ 123456789101112131415161718192021/* å®æ—¶äº¤é€šå›¾ false- &gt; ä¸å¼€å¯ true -&gt; å¼€å¯ */private void setTrafficMap(boolean enabled) { if (mBaiduMap != null) { mBaiduMap.setTrafficEnabled(enabled); }}/* ç™¾åº¦åŸå¸‚çƒ­åŠ›å›¾ false- &gt; ä¸å¼€å¯ true -&gt; å¼€å¯*/private void setHeatMap(boolean enabled) { if (mBaiduMap != null) { mBaiduMap.setBaiduHeatMapEnabled(enabled); }} å®æ—¶äº¤é€šå›¾(æ­¤å›¾æ˜¯åœ¨åœ°å›¾ç±»å‹ä¸ºç©ºç™½åœ°å›¾æ—¶æ˜¾ç¤ºçš„) ç™¾åº¦åŸå¸‚äº¤é€šçƒ­åŠ›å›¾ åœ°å›¾æ§åˆ¶å’Œæ‰‹åŠ¿ åœ°å›¾æ§åˆ¶åœ°å›¾Logoé»˜è®¤åœ¨å·¦ä¸‹è§’æ˜¾ç¤ºï¼Œä¸å¯ä»¥ç§»é™¤ã€‚é€šè¿‡mMapView.setLogoPosition(LogoPosition.logoPostionleftBottom);æ–¹æ³•ï¼Œä½¿ç”¨æšä¸¾ç±»å‹æ§åˆ¶æ˜¾ç¤ºçš„ä½ç½®ï¼Œå…±æ”¯æŒ6ä¸ªæ˜¾ç¤ºä½ç½®(å·¦ä¸‹ï¼Œä¸­ä¸‹ï¼Œå³ä¸‹ï¼Œå·¦ä¸Šï¼Œä¸­ä¸Šï¼Œå³ä¸Š)ã€‚åœ°å›¾Logoä¸å…è®¸é®æŒ¡ï¼Œå¯é€šè¿‡mBaiduMap.setPadding(paddingLeft, paddingTop, paddingRight, paddingBottom);æ–¹æ³•å¯ä»¥è®¾ç½®åœ°å›¾è¾¹ç•ŒåŒºåŸŸï¼Œæ¥é¿å…UIé®æŒ¡ã€‚å…¶ä¸­å‚æ•°paddingLeftã€paddingTopã€paddingRightã€paddingBottomå‚æ•°è¡¨ç¤ºè·ç¦»å±å¹•è¾¹æ¡†çš„å·¦ã€ä¸Šã€å³ã€ä¸‹è¾¹è·çš„è·ç¦»ï¼Œå•ä½ä¸ºå±å¹•åæ ‡çš„åƒç´ å¯†åº¦ã€‚æŒ‡å—é’ˆæŒ‡å—é’ˆé»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¯ä»¥å…³é—­æ˜¾ç¤º ã€‚æ¯”ä¾‹å°ºæ¯”ä¾‹å°ºé»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¯ä»¥å…³é—­æ˜¾ç¤ºã€‚åŒæ—¶æ”¯æŒè®¾ç½®MaxZoomLevelå’ŒminZoomLevelï¼Œå¯é€šè¿‡mMapView.getMapLevelè·å–å½“å‰åœ°å›¾çº§åˆ«ä¸‹æ¯”ä¾‹å°ºæ‰€è¡¨ç¤ºçš„è·ç¦»å¤§å°ã€‚ å…·ä½“çš„æ˜¾ç¤ºä½ç½®å’Œå†…å®¹å¦‚ä¸‹å¤‡æ³¨ï¼šæŒ‡å—é’ˆæ—‹è½¬åœ°å›¾çš„æ—¶å€™æ‰ä¼šå‡ºç°ï¼Œä¸€å¼€å§‹åŠ è½½çš„æ—¶å€™æ˜¯ä¸ä¼šå‡ºç°çš„ åœ°å›¾å¹³ç§»æ§åˆ¶æ˜¯å¦å¯ç”¨æˆ–ç¦ç”¨å¹³ç§»çš„åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯ã€‚å¦‚æœå¯ç”¨ï¼Œåˆ™ç”¨æˆ·å¯ä»¥å¹³ç§»åœ°å›¾åœ°å›¾ç¼©æ”¾æ§åˆ¶æ˜¯å¦å¯ç”¨æˆ–ç¦ç”¨ç¼©æ”¾æ‰‹åŠ¿ï¼Œé»˜è®¤å¼€å¯ã€‚å¦‚æœå¯ç”¨ï¼Œç”¨æˆ·å¯ä»¥åŒæŒ‡ç‚¹å‡»æˆ–ç¼©æ”¾åœ°å›¾è§†å›¾ã€‚åœ°å›¾ä¿¯è§†ï¼ˆ3Dï¼‰æ§åˆ¶æ˜¯å¦å¯ç”¨æˆ–ç¦ç”¨ä¿¯è§†ï¼ˆ3Dï¼‰åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯ã€‚å¦‚æœå¯ç”¨ï¼Œåˆ™ç”¨æˆ·å¯ä½¿ç”¨åŒæŒ‡ å‘ä¸‹æˆ–å‘ä¸Šæ»‘åŠ¨åˆ°ä¿¯è§†å›¾ã€‚åœ°å›¾æ—‹è½¬æ§åˆ¶æ˜¯å¦å¯ç”¨æˆ–ç¦ç”¨åœ°å›¾æ—‹è½¬åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯ã€‚å¦‚æœå¯ç”¨ï¼Œåˆ™ç”¨æˆ·å¯ä½¿ç”¨åŒæŒ‡ æ—‹è½¬æ¥æ—‹è½¬åœ°å›¾ã€‚ç¦æ­¢æ‰€æœ‰æ‰‹åŠ¿æ§åˆ¶æ˜¯å¦ä¸€å¹¶ç¦æ­¢æ‰€æœ‰æ‰‹åŠ¿ï¼Œé»˜è®¤å…³é—­ã€‚å¦‚æœå¯ç”¨ï¼Œæ‰€æœ‰æ‰‹åŠ¿éƒ½å°†è¢«ç¦ç”¨ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566mUiSettings = mBaiduMap.getUiSettings();setSizeByBoolean(fabZoom, mUiSettings.isZoomGesturesEnabled());setSizeByBoolean(fabZoom, mUiSettings.isZoomGesturesEnabled());setSizeByBoolean(fabScroll, mUiSettings.isScrollGesturesEnabled());setSizeByBoolean(fabOverlook, mUiSettings.isOverlookingGesturesEnabled());setSizeByBoolean(fabRotate, mUiSettings.isRotateGesturesEnabled());setSizeByBoolean(fabCompass, mUiSettings.isCompassEnabled());private void setSizeByBoolean(FloatingActionButton fab , boolean bl) { if(bl) { fab.setButtonSize(FloatingActionButton.SIZE_NORMAL); } else { fab.setButtonSize(FloatingActionButton.SIZE_MINI); }}public void onClick(View view) {...case R.id.fab_zoom: if (mUiSettings.isZoomGesturesEnabled()) { mUiSettings.setZoomGesturesEnabled(false); fabZoom.setButtonSize(FloatingActionButton.SIZE_MINI); } else { mUiSettings.setZoomGesturesEnabled(true); fabZoom.setButtonSize(FloatingActionButton.SIZE_NORMAL); } break; case R.id.fab_scroll: if (mUiSettings.isScrollGesturesEnabled()) { mUiSettings.setScrollGesturesEnabled(false); fabScroll.setButtonSize(FloatingActionButton.SIZE_MINI); } else { mUiSettings.setScrollGesturesEnabled(true); fabScroll.setButtonSize(FloatingActionButton.SIZE_NORMAL); } break; case R.id.fab_rotate: if (mUiSettings.isRotateGesturesEnabled()) { mUiSettings.setRotateGesturesEnabled(false); fabRotate.setButtonSize(FloatingActionButton.SIZE_MINI); } else { mUiSettings.setRotateGesturesEnabled(true); fabRotate.setButtonSize(FloatingActionButton.SIZE_NORMAL); } break; case R.id.fab_overlook: if (mUiSettings.isOverlookingGesturesEnabled()) { mUiSettings.setOverlookingGesturesEnabled(false); fabOverlook.setButtonSize(FloatingActionButton.SIZE_MINI); } else { mUiSettings.setOverlookingGesturesEnabled(true); fabOverlook.setButtonSize(FloatingActionButton.SIZE_NORMAL); } break; case R.id.fab_compass: if (mUiSettings.isCompassEnabled()) { mUiSettings.setCompassEnabled(false); fabCompass.setButtonSize(FloatingActionButton.SIZE_MINI); } else { mUiSettings.setCompassEnabled(true); fabCompass.setButtonSize(FloatingActionButton.SIZE_NORMAL); } break;...} å®é™…ç»“æœ(å¥½åƒå¹¶ä¸èƒ½ä»å›¾é‡Œçœ‹å‡ºä»€ä¹ˆå‘µ - - !)","link":"/2016/08/27/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ2ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ3ï¼‰","text":"å‰è¨€ä¸Šä¸€ç¯‡è®²è§£å¹¶å®è·µäº†ç™¾åº¦åœ°å›¾åŸºæœ¬æ˜¾ç¤ºï¼Œåœ°å›¾ç±»å‹ï¼Œå®æ—¶äº¤é€šå›¾ï¼Œçƒ­åŠ›å›¾ï¼Œåœ°å›¾æ§åˆ¶å’Œæ‰‹åŠ¿æ§åˆ¶ï¼Œä»Šå¤©çœ‹ä¸‹åœ¨åœ°å›¾ä¸Šæ·»åŠ viewå’Œè¦†ç›–ç‰©ã€‚ åœ°å›¾Logoä¸å…è®¸é®æŒ¡ï¼Œå¯é€šè¿‡mBaiduMap.setPadding(paddingLeft, paddingTop, paddingRight, paddingBottom);æ–¹æ³•å¯ä»¥è®¾ç½®åœ°å›¾è¾¹ç•ŒåŒºåŸŸï¼Œæ¥é¿å…UIé®æŒ¡ã€‚å…¶ä¸­å‚æ•°paddingLeftã€paddingTopã€paddingRightã€paddingBottomå‚æ•°è¡¨ç¤ºè·ç¦»å±å¹•è¾¹æ¡†çš„å·¦ã€ä¸Šã€å³ã€ä¸‹è¾¹è·çš„è·ç¦»ï¼Œå•ä½ä¸ºå±å¹•åæ ‡çš„åƒç´ å¯†åº¦ã€‚ â€”â€”â€”â€”â€”â€“&gt;åˆ©ç”¨è¿™ä¸ªæ¥æ·»åŠ è‡ªå®šä¹‰çš„å†…å®¹ æ ‡æ³¨è¦†ç›–ç‰© å‡ ä½•å›¾å½¢è¦†ç›–ç‰© æ–‡å­—è¦†ç›–ç‰© å¼¹å‡ºçª—è¦†ç›–ç‰© å†…å®¹åœ°å›¾ä¸Šæ·»åŠ Viewç”±äºåœ°å›¾çš„Logoä¸å…è®¸è¢«é®æŒ¡ï¼Œç™¾åº¦è‡ªç„¶ä¼šæƒ³åŠæ³•é’ˆå¯¹ä¸€äº›å¼€å‘è€…åœºæ™¯ä½œå‡ºè‡ªå·±çš„è°ƒæ•´ï¼Œæ¯”å¦‚ä¸Šé¢æ‰€è¯´çš„setPadding()æˆ–è€…setViewPadding()ä¸€æ ·å¥½ä½¿ï¼Œå…·ä½“çš„ä½¿ç”¨åˆ†ä¸ºä¸¤æ­¥ï¼šç¬¬ä¸€æ­¥ï¼Œ 1mBaiduMap.setPadding(0, 0, 0, 200); ç¬¬äºŒæ­¥ï¼Œ 123456789101112private void addView() { TextView textView = new TextView(this); textView.setText(\"è¿™æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„View,è¿™ä¸ªæ—¶å€™logoå’Œåº•éƒ¨çš„ä¸€äº›å†…å®¹ä¼šå‘ä¸Šç§»åŠ¨ï¼Œå› ä¸ºMapViewè®¾ç½®äº†åº•éƒ¨Padding\"); textView.setBackgroundResource(R.color.colorPrimary); //åˆ›å»ºä¸€ä¸ªTextViewç„¶åå¾€åº•éƒ¨æ”¾ç½®ï¼Œå®˜æ–¹Demoå¦‚æ˜¯æ“ä½œ MapViewLayoutParams.Builder builder = new MapViewLayoutParams.Builder(); builder.layoutMode(MapViewLayoutParams.ELayoutMode.absoluteMode); builder.width(bmapView.getWidth()); builder.height(200); builder.point(new Point(0, bmapView.getHeight())); builder.align(MapViewLayoutParams.ALIGN_LEFT, MapViewLayoutParams.ALIGN_BOTTOM); bmapView.addView(textView, builder.build());} è¿™æ ·å­å°±åœ¨åº•éƒ¨æ·»åŠ äº†ä¸€ä¸ªTextViewï¼Œå½“ç„¶æƒ³æ·»åŠ å…¶ä»–çš„Viewè‡ªç„¶ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œå…·ä½“æ•ˆæœå›¾å¾€ä¸‹çœ‹ã€‚ åœ°ç†ç¼–ç ï¼Œæ ‡æ³¨è¦†ç›–ç‰©å’Œå¼¹å‡ºçª—è¦†ç›–ç‰©åˆ©ç”¨æ ‡æ³¨è¦†ç›–ç‰©åœ¨åœ°å›¾ä¸Šçš„ç‰¹å®šä½ç½®æ·»åŠ æ ‡æ³¨ï¼Œç„¶åç»™æ ‡æ³¨è¦†ç›–ç‰©è®¾ç½®ç‚¹å‡»ç›‘å¬å±•ç¤ºå¼¹å‡ºè¦†ç›–ç‰© 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071//è¿™ä¸ªæ˜¯â€œæ‰“ç‚¹â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»äº‹ä»¶å‘ç”Ÿåï¼Œåœ°ç†ç¼–ç å¯¹è±¡æ‰§è¡ŒAddress-&gt;locationçš„è§£æï¼Œè§£æç»“æœè¿”å›ä¹‹åï¼Œæ‹¿åˆ°å¯¹åº”çš„ç‚¹çš„ç»çº¬åº¦ï¼Œä¹Ÿå°±æ˜¯LatLngå®ä¾‹å’Œå¯¹åº”çš„åœ°å€ä¿¡æ¯ï¼Œç„¶åæ‰§è¡ŒaddMarkeræ“ä½œprivate void addPointByEditText() { String placename = etPoint.getText().toString(); final GeoCoder geo = GeoCoder.newInstance(); geo.setOnGetGeoCodeResultListener(new OnGetGeoCoderResultListener() { @Override public void onGetGeoCodeResult(GeoCodeResult geoCodeResult) { if (geoCodeResult.getLocation() != null) { addMarker(geoCodeResult.getLocation() , geoCodeResult.getAddress()); //addText(geoCodeResult.getLocation(), \"çœ‹è¿‡æ¥ :\" + geoCodeResult.getAddress());//è¿™ä¸ªæ˜¯åé¢æ·»åŠ æ–‡å­—è¦†ç›–ç‰©çš„æ—¶å€™ä½¿ç”¨åˆ°çš„ } else { Toast.makeText(MainActivity.this, \" No Result of GeoCoder! Sorry\", Toast.LENGTH_SHORT).show(); } } @Override public void onGetReverseGeoCodeResult(ReverseGeoCodeResult reverseGeoCodeResult) { } }); geo.geocode(new GeoCodeOption().address(placename).city(placename));}......//æ·»åŠ æ ‡æ³¨ç‰©private void addMarker(LatLng point, String address) { //å®šä¹‰Makeråæ ‡ç‚¹ //LatLng point = new LatLng(39.963175, 116.400244); //æ„å»ºMarkerOptionï¼Œç”¨äºåœ¨åœ°å›¾ä¸Šæ·»åŠ Marker Bundle bundle = new Bundle(); bundle.putParcelable(\"LATLNG\", point);//ä¼ é€’Bundleå¯¹è±¡ï¼Œæ–¹ä¾¿åé¢è¯»å–å¯¹åº”çš„infoæ¥åˆ›å»ºpop window bundle.putString(\"ADDRESS\", address); OverlayOptions option = new MarkerOptions() .position(point) .icon(bitmap).extraInfo(bundle); //åœ¨åœ°å›¾ä¸Šæ·»åŠ Markerï¼Œå¹¶æ˜¾ç¤º mBaiduMap.addOverlay(option);}//è®¾ç½®æ ‡æ³¨è¦†ç›–ç‰©çš„ç‚¹å‡»äº‹ä»¶ç›‘å¬mBaiduMap.setOnMarkerClickListener(new BaiduMap.OnMarkerClickListener() { @Override public boolean onMarkerClick(Marker marker) { //è¿™é‡Œæ˜¯MarkerOptionåˆ›å»ºçš„æ—¶å€™ä¼ å…¥çš„ç‚¹åæ ‡å’Œå¯¹åº”çš„åœ°å€ä¿¡æ¯ if (marker.getExtraInfo() != null) { LatLng point = marker.getExtraInfo().getParcelable(\"LATLNG\"); String address = marker.getExtraInfo().getString(\"ADDRESS\"); addPop(point, address); } return false; }});......//æ·»åŠ å¼¹å‡ºçª—è¦†ç›–ç‰©private void addPop(LatLng point, String message) { //åˆ›å»ºInfoWindowå±•ç¤ºçš„view Button button = new Button(getApplicationContext()); button.setBackgroundResource(R.drawable.marker_info_bg); button.setTextColor(Color.WHITE); button.setText(message); //åˆ›å»ºInfoWindow , ä¼ å…¥ viewï¼Œ åœ°ç†åæ ‡ï¼Œ y è½´åç§»é‡ InfoWindow mInfoWindow = new InfoWindow(button, point, -47); //æ˜¾ç¤ºInfoWindow mBaiduMap.showInfoWindow(mInfoWindow);} å®é™…æ•ˆæœå›¾ï¼š æ–‡å­—è¦†ç›–ç‰©æ–‡å­—è¦†ç›–ç‰©ä¸»è¦å°±æ˜¯åœ¨åœ°å›¾ä¸Šæ·»åŠ ä¸€äº›å­—ä¸²ï¼Œ ç”¨ä¸Šé¢çš„ä»£ç ï¼Œå°†æ ‡æ³¨è¦†ç›–ç‰©æ”¹æˆæ–‡å­—è¦†ç›–ç‰© 1234567891011121314//è®¾ç½®æ–‡å­—è¦†ç›–ç‰©private void addText(LatLng point, String message) { //æ„å»ºæ–‡å­—Optionå¯¹è±¡ï¼Œç”¨äºåœ¨åœ°å›¾ä¸Šæ·»åŠ æ–‡å­— OverlayOptions textOption = new TextOptions() .bgColor(0xAAFFFF00) .fontSize(35) .fontColor(0xFFFF00FF) .text(message) .rotate(-30) .position(point); //åœ¨åœ°å›¾ä¸Šæ·»åŠ è¯¥æ–‡å­—å¯¹è±¡å¹¶æ˜¾ç¤º mBaiduMap.addOverlay(textOption);} å®é™…æ•ˆæœå›¾ï¼š è¡Œæ”¿åŒºè¾¹ç•Œæœç´¢å’Œå¤šè¾¹å½¢è¦†ç›–ç‰©åˆ©ç”¨DistrictSearchå’ŒPolyOverlayï¼Œå®ç°åœˆå‡ºè¡Œæ”¿åŒºåŸŸçš„æ•ˆæœ 12345678910111213141516171819202122232425262728293031323334mDistrictSearch = DistrictSearch.newInstance();//åˆ›å»ºè¡Œæ”¿åŒºåŸŸæŸ¥è¯¢çš„å®ä¾‹......//æ·»åŠ å¤šè¾¹å½¢åŒºåŸŸprivate void addPoly(String cityname) { //å»ºç«‹æœç´¢æ¡ä»¶ DistrictSearchOption option = new DistrictSearchOption().cityName(cityname).districtName(cityname); //è®¾ç½®æœç´¢ç›‘å¬äº‹ä»¶ mDistrictSearch.setOnDistrictSearchListener(new OnGetDistricSearchResultListener() { @Override public void onGetDistrictResult(DistrictResult districtResult) { if (districtResult.error == SearchResult.ERRORNO.NO_ERROR) { List&lt;List&lt;LatLng&gt;&gt; pointsList = districtResult.getPolylines(); if (pointsList == null) return; //åœ°ç†è¾¹ç•Œå¯¹è±¡ LatLngBounds.Builder builder = new LatLngBounds.Builder(); for (List&lt;LatLng&gt; polyline : pointsList) { OverlayOptions ooPolyline11 = new PolylineOptions().width(10) .points(polyline).dottedLine(true).color(Color.RED); mBaiduMap.addOverlay(ooPolyline11);//æ·»åŠ OverLay OverlayOptions ooPolygon = new PolygonOptions().points(polyline) .stroke(new Stroke(5, 0xAA00FF88)).fillColor(0xAAFFFF00); mBaiduMap.addOverlay(ooPolygon);//æ·»åŠ OverLay for (LatLng latLng : polyline) { builder.include(latLng);//åŒ…å«è¿™äº›ç‚¹ } } } } }); mDistrictSearch.searchDistrict(option);//æ‰§è¡Œè¡Œæ”¿åŒºåŸŸçš„æœç´¢} å®é™…æ•ˆæœå›¾ï¼š å¤‡æ³¨ä»Šå¤©å…ˆçœ‹åˆ°è¿™é‡Œï¼Œæœ‰æ—¶é—´æ¥ç€è·Ÿ~","link":"/2016/08/29/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ3ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹å¹²è´§é›†ä¸­è¥ GankIOClient","text":"ç®€ä»‹åˆ©ç”¨å¹²è´§é›†ä¸­è¥ , daimajiaå’Œä»–çš„å°ä¼™ä¼´ç»™æˆ‘ä»¬å¼€å‘è€…å¸¦æ¥çš„ç¦åˆ©å¼€å‘çš„ä¸€ä¸ªå¹²è´§é›†ä¸­è¥å®¢æˆ·ç«¯ï¼Œä¸»è¦åŠŸèƒ½åœ¨é˜…è¯»å¹²è´§ä¸Šã€‚ Githubåœ°å€ï¼šhttps://github.com/onlyloveyd/GankIOClient æ¥å£ åˆ†ç±»æ¥å£&lt;ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹&gt; å¼€æºåº“ä¸»è¦ç”¨åˆ°å¦‚ä¸‹å¼€æºåº“ 1234567891011121314compile 'com.github.bumptech.glide:glide:3.7.0'compile 'io.reactivex:rxandroid:1.2.1'compile 'io.reactivex:rxjava:1.1.6'compile 'com.squareup.retrofit2:retrofit:2.1.0'compile 'com.squareup.retrofit2:converter-gson:2.1.0'compile 'com.squareup.retrofit2:adapter-rxjava:2.1.0'compile 'com.squareup.okhttp3:okhttp:3.5.0'compile 'com.android.support:cardview-v7:25.1.0'compile 'com.google.code.gson:gson:2.8.0'compile 'com.jakewharton:butterknife:8.4.0'annotationProcessor 'com.jakewharton:butterknife-compiler:8.4.0'compile 'com.astuetz:pagerslidingtabstrip:1.0.1'compile 'cn.bingoogolapple:bga-refreshlayout:1.1.7@aar'compile 'cn.bingoogolapple:bga-banner:2.1.4@aar' å¤§éƒ¨åˆ†å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œå€¼å¾—ä¸€æçš„æ˜¯bingoogolappleå¤§ç¥çš„å‡ ä¸ªå¼€æºåº“ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å»ç…ç…ã€‚ å…·ä½“æ•ˆæœ å†™åœ¨æœ€åæœç´¢åŠŸèƒ½æš‚æ—¶è¿˜æœªåŠ ä¸Šï¼Œè¿˜å­˜åœ¨ä¸€äº›bugï¼Œæ…¢æ…¢å®Œå–„ï¼Œå…ˆMarkä¸€ä¸‹~ è™½ç„¶ç½‘ä¸Šå¹²è´§é›†ä¸­è¥çš„åº”ç”¨å·²ç»æœ‰ä¸€ç®©ç­äº†ï¼Œä½†æ˜¯è¿˜æ˜¯å¿ä¸ä½çš„æƒ³ç»ƒä¸‹æ‰‹~","link":"/2016/12/26/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹å¹²è´§é›†ä¸­è¥ GankIOClient/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ä¸€ä¸ªç±»ä¼¼ä»Šæ—¥å¤´æ¡çš„APP","text":"ç®€ä»‹æœ€è¿‘èŠ±äº†ä¸€ä¸¤å¤©çš„æ—¶é—´å®Œæˆä¸€ä¸ªç®€æ˜“çš„æ–°é—»å¤´æ¡å®¢æˆ·ç«¯çš„åº”ç”¨ï¼Œå¼•ç”¨åˆ°äº†SwipeRefreshLayoutï¼ŒCircleImageViewï¼ŒRxAndroidï¼ŒPicassoï¼ŒPhotoPickerç­‰å¼€æºåº“ï¼ŒGsonFormatç­‰æ’ä»¶ï¼Œä¸»è¦æ˜¯ç”¨æ¥é”»ç‚¼è‡ªå·±ç‹¬ç«‹å®ŒæˆAPKçš„èƒ½åŠ›ã€‚ æ•°æ®æ¥å£ä½¿ç”¨çš„æ•°æ®æ¥å£å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œèšåˆæ•°æ®çš„å…è´¹æ¥å£ï¼šæ–°é—»å¤´æ¡ï¼Œç¬‘è¯å¤§å…¨å’Œå†å²ä¸Šçš„ä»Šå¤©ç­‰ç­‰ã€‚è¿™ç§æ–¹å¼å°±é¿å…äº†è‡ªå·±å†™æœåŠ¡å™¨æ¥ä¼ é€’jsonæ•°æ®çš„éº»çƒ¦ï¼Œæ³¨æ„åŠ›å…¨éƒ¨é›†ä¸­åœ¨Androidåº”ç”¨çš„å¼€å‘ä¸Šã€‚ åº”ç”¨åœ°å€https://github.com/onlyloveyd/JuheNews æ•ˆæœå›¾","link":"/2016/12/07/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ä¸€ä¸ªç±»ä¼¼ä»Šæ—¥å¤´æ¡çš„APP/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ èšåˆæ•°æ®SDK","text":"èšåˆæ•°æ®ä»‹ç»èšåˆæ•°æ®æ˜¯ä¸€ä¸ªä¸ºæ™ºèƒ½æ‰‹æœºå¼€å‘è€…ï¼Œç½‘ç«™ç«™é•¿ï¼Œç§»åŠ¨è®¾å¤‡å¼€å‘äººå‘˜åŠå›¾å•†æä¾›åŸå§‹æ•°æ®APIæœåŠ¡çš„ç»¼åˆæ€§äº‘æ•°æ®å¹³å°ã€‚åŒ…å«æ‰‹æœºèšåˆï¼Œç½‘ç«™èšåˆï¼ŒLBSèšåˆä¸‰éƒ¨åˆ†ï¼Œå…¶åŠŸèƒ½ç±»ä¼¼äºGoogle APISã€‚ã€æ¥è‡ªç™¾åº¦ç™¾ç§‘ã€‘ é¦–é¡µï¼šhttps://www.juhe.cn/ èšåˆæ•°æ®SDKè¿™é‡Œæˆ‘ä»¬åªå…³æ³¨Android SDKï¼Œå¦‚æœæœ‰å…¶ä»–çš„å¹³å°éœ€è¦è¯·æŸ¥é˜…å¯¹åº”çš„å†…å®¹https://www.juhe.cn/juhesdk/sdk èšåˆæ•°æ®SDKâ€”â€”Androidå¹³å°https://www.juhe.cn/juhesdk/adocs/v/2 ç½‘é¡µä¸­æœ‰å¯¹åº”çš„ä½¿ç”¨æ–¹æ³•å’Œè¿‡ç¨‹ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šçš„ç´¯è¿°ã€‚ è¿™é‡Œå†™è¿™ç¯‡åšå®¢æ˜¯å› ä¸ºåé¢è‡ªå·±åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¼šä½¿ç”¨åˆ°è¿™ä¸ªæ•°æ®å¹³å°ä¸­çš„æ•°æ®ã€‚å…·ä½“ä½¿ç”¨æ–¹å¼è¯·æµè§ˆèšåˆæ•°æ®å®˜ç½‘æŸ¥çœ‹","link":"/2016/05/06/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ èšåˆæ•°æ®SDK/"},{"title":"ã€ŠAndroid å¼€æºåº“ã€‹ Matisseï¼Œæ¥è‡ªçŸ¥ä¹çš„PhotoPicker","text":"ç®€ä»‹Matisseï¼Œæ˜¯ä¸€æ¬¾ç”±çŸ¥ä¹å¼€æºçš„åª’ä½“é€‰æ‹©å™¨ã€‚ åœ¨Activityå’ŒFragmentä¸­ä½¿ç”¨ æ”¯æŒJPEGï¼ŒPNGï¼ŒGIFçš„å›¾ç‰‡é€‰æ‹©å’ŒMPEGï¼ŒMP4æ ¼å¼çš„è§†é¢‘é€‰æ‹©ã€‚ä¸èƒ½åŒæ—¶é€‰æ‹©å›¾ç‰‡å’Œè§†é¢‘ ä¸¤ç§ä¸»é¢˜å¯ä¾›é€‰æ‹©ï¼Œå› ä¸ºçŸ¥ä¹ä¹Ÿæ˜¯ä¸¤ç§ä¸»é¢˜ å›¾ç‰‡Loader è‡ªå®šä¹‰è¿‡æ»¤æ¡ä»¶ ä½¿ç”¨æ–¹æ³•Gradle1234567repositories { jcenter()}dependencies { compile 'com.zhihu.android:matisse:0.4.3'} ProGuardå¦‚æœä½¿ç”¨Glideä½œä¸ºå›¾ç‰‡åŠ è½½å¼€æºåº“ 12345678-keep public class * implements com.bumptech.glide.module.GlideModule-keep public enum com.bumptech.glide.load.resource.bitmap.ImageHeaderParser$** { **[] $VALUES; public *;}# for DexGuard only-keepresourcexmlelements manifest/application/meta-data@value=GlideModule å¦‚æœä½¿ç”¨Picassoä½œä¸ºå›¾ç‰‡åŠ è½½å¼€æºåº“ 1-dontwarn com.squareup.okhttp.** ä»£ç ä½¿ç”¨çŸ¥ä¹ä¸»é¢˜ 1234567891011Matisse.from(MainActivity.this) .choose(MimeType.ofAll()) .countable(true) .maxSelectable(9) .addFilter(new GifSizeFilter(320, 320, 5 * Filter.K * Filter.K)) .gridExpectedSize( getResources().getDimensionPixelSize(R.dimen.grid_expected_size)) .restrictOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT) .thumbnailScale(0.85f) .imageEngine(new GlideEngine()) .forResult(REQUEST_CODE_CHOOSE); Draculaä¸»é¢˜ 1234567Matisse.from(MainActivity.this) .choose(MimeType.of(MimeType.JPEG, MimeType.PNG)) .theme(R.style.Matisse_Dracula) .countable(false) .maxSelectable(9) .imageEngine(new PicassoEngine()) .forResult(REQUEST_CODE_CHOOSE); ç»“æœå¤„ç† 12345678910List&lt;Uri&gt; mSelected;@Overrideprotected void onActivityResult(int requestCode, int resultCode, Intent data) { super.onActivityResult(requestCode, resultCode, data); if (requestCode == REQUEST_CODE_CHOOSE &amp;&amp; resultCode == RESULT_OK) { mSelected = Matisse.obtainResult(data); Log.d(\"Matisse\", \"mSelected: \" + mSelected); }} æ›´å¤šè¯¦ç»†å†…å®¹è¯·æŸ¥é˜…å®˜æ–¹Wiki. æ•ˆæœå›¾ç‰‡æ¥æºé¡¹ç›®Github Zhihu Style Dracula Style Preview æºç åˆ†æä»£ç ç»“æ„ ç±»åˆ†æ ç±»å æè¿° ImageEngine å›¾ç‰‡åŠ è½½æ¥å£ï¼Œæ–¹ä¾¿åé¢æ ¹æ®Glideå’ŒPicassoåˆ†åˆ«å®ç° GlideEngine Glideå®ç°ImageEngine PicassoEngine Picassoå®ç°ImageEngine Filter è¿‡æ»¤æ¡ä»¶æŠ½è±¡ç±»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é›†æˆFilterå®ç°å¯¹åº”çš„è¿‡æ»¤æ¡ä»¶æ¥å¯¹å›¾ç‰‡è¿›è¡Œç­›é€‰ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªFilter,å…·ä½“å‚è€ƒå®˜æ–¹Demoä¸­çš„GifSizeFilter Album ç›¸å†ŒEntity CaptureStrategy æ‹ç…§ç›¸å…³ï¼Œåª’ä½“å¤„ç†authority IncapableCause ä¿¡æ¯å¤„ç†ï¼Œtoastå’Œdialog Item é€‰æ‹©åª’ä½“ç•Œé¢çš„Item SelectionSpec é€‰æ‹©å‚æ•°ç±» AlbumLoader ç›¸å†ŒCursorLoader AlbumMediaLoader å›¾ç‰‡å’Œè§†é¢‘CursorLoader AlbumCollection AlbumLoaderå›è°ƒ AlbumMediaCollection AlbumMediaLoaderå›è°ƒ SelectedItemCollection è¢«é€‰ä¸­é¡¹é›†åˆ internal/uiåŒ… ç•Œé¢æ˜¾ç¤ºçš„Adapter,è‡ªå®šä¹‰è§†å›¾ï¼ŒFragmentå’ŒActivity internal/utilsåŒ… å·¥å…·ç±» MatisseActivity å…³é”®ç±»ï¼Œæ‰§è¡Œé€‰æ‹©åª’ä½“æ“ä½œçš„æ—¶å€™å±•ç¤ºå‡ºæ¥çš„Activity Matisse å¼€æºåº“çš„å…¥å£å’Œå‡ºå£ï¼Œç”¨æ¥ä¼ é€’Activityå’ŒFragmentï¼Œåˆ›å»ºSelectionSpecBuilderå’Œè¿”å›ç»“æœ MimeType åª’ä½“ç±»å‹ SelectionSpecBuilder Buildæ„é€ ç±»ï¼Œç”¨æ¥ä¼ é€’å‚æ•° è®¾è®¡æ€è·¯ä¸PhotoPickeræ¯”è¾ƒ ä»MatisseActivityæ¥çœ‹çš„è¯ï¼Œå¤§è‡´çš„è®¾è®¡æ€è·¯å’ŒPhotoPickerç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»¥å•ç‹¬çš„Activityä¸ºè½½ä½“ï¼Œä¼ é€’å‚æ•°çš„æ–¹å¼å’ŒPhotoPickerä¸åŒï¼ŒPhotoPickerä½¿ç”¨çš„æ˜¯bundle, è€ŒMatisseä½¿ç”¨çš„æ˜¯SelectionSpecå•ä¾‹ï¼Œå¯åŠ¨åº”ç”¨ä¹‹å‰ï¼Œå‚æ•°å…¨éƒ¨è®¾ç½®å®Œæ¯•ï¼Œç„¶ååœ¨MatisseActivityé€šè¿‡SelectionSpec.getInstance()æ‹¿åˆ°å•ä¾‹ï¼Œè·å–å‚æ•°ã€‚é€‰æ‹©ç»“æœå’ŒPhotoPickeå®ç°æ¯”è¾ƒç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡Bundleä¿å­˜ç»“æœé€šè¿‡setResultè¿”å›ç»™è°ƒç”¨çš„Activityæˆ–è€…Fragment.SelectedPreviewActivityå°±æ˜¯PhotoPickerä¸­çš„é¢„è§ˆActivityï¼Œåªæ˜¯æ²¡æœ‰é€šè¿‡SelectionSpecBuilderå¯¹å¤–æš´éœ²ï¼Œè¦ä½¿ç”¨çš„è¯ï¼Œæˆ‘ä»¬åªèƒ½è‡ªå·±æ˜¾å¼çš„è°ƒç”¨ã€‚ ä¸PhotoPickerä¸€æ ·ï¼Œéƒ½æ˜¯é‡‡ç”¨Android Loaderæœºåˆ¶ä½œä¸ºæ•°æ®åŠ è½½çš„æ–¹å¼ï¼Œå¤§è‡´åŸç†æ¸…æ¥šï¼Œè‡ªå·±åœ¨å¹³æ—¶çš„å¼€å‘ä¸­è¿˜æ²¡æœ‰ç”¨åˆ°è¿‡ï¼Œæ‰¾ä¸ªæœºä¼šå°è¯•ä¸€ä¸‹ã€‚ Buildè®¾è®¡æ¨¡å¼ï¼Œé“¾å¼ä»£ç ç¼–å†™æ–¹å¼ã€‚ PhotoPickerä½¿ç”¨çš„æ˜¯Glideä½œä¸ºå›¾ç‰‡åŠ è½½æ¡†æ¶ï¼Œè€ŒMatisseæ”¯æŒGlideå’ŒPicassoï¼Œä½†æ˜¯Picassoæ”¯æŒçš„åŠŸèƒ½Glideå…¨éƒ½æœ‰ï¼Œé€‰æ‹©ä¸€ä¸ªå³å¯ï¼ˆPicassoä¸æ”¯æŒGifï¼‰ Matisseï¼Œæ”¯æŒè§†é¢‘æ–‡ä»¶çš„é€‰æ‹©ï¼ŒPhotoPickerä»åå­—ä¸Šçœ‹å°±ä¸æ”¯æŒã€‚ PhotoPickeræ”¯æŒè‡ªå®šä¹‰æ ·å¼ï¼Œä¸»è¦æ˜¯é¢œè‰²ï¼›Matisseï¼Œæ”¯æŒä¸¤ç§ä¸»é¢˜æ¨¡å¼ï¼Œä¸çŸ¥ä¹å‘¼åº”ã€‚","link":"/2017/05/04/ã€ŠAndroid å¼€æºåº“ã€‹ Matisseï¼Œæ¥è‡ªçŸ¥ä¹çš„PhotoPicker/"},{"title":"ã€ŠAndroid åº”ç”¨ä¹‹è·¯ã€‹ èšé—»","text":"å‰è¨€èšé—»ï¼Œä½¿ç”¨èšåˆæ–°é—»æ•°æ®è€Œæˆçš„æ–°é—»èµ„è®¯å®¢æˆ·ç«¯ã€‚èšåˆæ•°æ®ç»™ç”¨æˆ·æä¾›äº†éƒ¨åˆ†å…è´¹çš„æ•°æ®æ¥å£ï¼Œå½“ç„¶æ˜¯å­˜åœ¨è¯·æ±‚æ¬¡æ•°é™åˆ¶çš„ã€‚å­¦ä¹ Androidåº”ç”¨å¼€å‘åç¬¬ä¸€ä¸ªå°åº”ç”¨é‡‡ç”¨çš„å°±æ˜¯èšåˆæ•°æ®ã€‚æœ€è¿‘æŠŠä»£ç é‡æ„ï¼ˆä¹Ÿå°±æ˜¯é‡æ–°å†™ï¼Œå› ä¸ºæ²¡æœ‰ç»“æ„ï¼‰äº†ä¸€éã€‚ Githubåœ°å€JuehNews ä¸‹è½½fir.im æ•°æ®æºæ•°æ®æ¥æºäºï¼šèšåˆæ•°æ®ï¼Œæ¥å£æ¯å¤©è¯·æ±‚æ•°é‡å—é™ Appè®¾è®¡é»‘ç™½çº¢ï¼Œçº¢è‰²é‡‡ç”¨çš„æ˜¯ä»Šæ—¥å¤´æ¡çš„çº¢è‰² UIè®¾è®¡ é»‘ç™½çº¢ åœ†è§’ ææ–™è®¾è®¡ â€”â€“ (æˆ‘çš„å®¡ç¾æˆ‘è‡ªå·±æ˜¯æ‹’ç»çš„) ä»£ç è®¾è®¡ Retrofit + RxJava2 çš„ç»„åˆè·å–ç½‘ç»œæ•°æ®; TabHost + Fragment ä½œä¸ºä¸»ç•Œé¢ç»“æ„,å®ç°â€œèµ„è®¯â€ï¼Œâ€œç¬‘è¯â€ï¼Œâ€œè¶£å›¾â€ï¼Œâ€œå†å²ä¸Šçš„ä»Šå¤©â€å››ä¸ªæ¨¡å— BGARefreshLayouté…åˆRecyclerViewå’Œè‡ªå®šä¹‰å¤šç±»å‹Itemç»“æ„å®ç°æ•°æ®çš„å±•ç¤º; Glideä½œä¸ºå›¾ç‰‡åŠ è½½æ¡†æ¶ï¼› ShareåŠŸèƒ½å…¨éƒ¨é‡‡ç”¨ç³»ç»Ÿè‡ªå¸¦ï¼ŒåŸºæœ¬å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚ ButterKnifeæ³¨è§£åº“ Gsonä½œä¸ºjsonæ•°æ®è§£æåº“ Pagerslidingtabstripä¸°å¯Œæ ‡ç­¾é¡µçš„æ˜¾ç¤º ä¾èµ–åº“ Glide RxAndroid RxJava Retrofit okhttp3 Gson ButterKnife BGARefreshLayout-Android PagerSlidingTabStrip æ•ˆæœæˆªå›¾","link":"/2017/06/29/ã€ŠAndroid åº”ç”¨ä¹‹è·¯ã€‹ èšé—»/"},{"title":"ã€ŠAndroid å¼€æºåº“ã€‹Android OpenCSV","text":"OpenCSVhttps://sourceforge.net/projects/opencsv/ ä½¿ç”¨å‚è€ƒhttp://stackoverflow.com/questions/16672074/import-csv-file-to-sqlite-in-android å¯¼å‡º123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172public class ExportDatabaseToCSV extends AsyncTask&lt;Void, Boolean, Boolean&gt; { Context context; ProgressDialog dialog; public ExportDatabaseToCSV(Context context) { this.context = context; } @Override protected void onPreExecute() { dialog = new ProgressDialog(context); dialog.setTitle(\"å¯¼å‡ºCSVæ–‡ä»¶\"); dialog.setMessage(\"è¯·ç¨å...\"); dialog.setCancelable(false); dialog.setIcon(android.R.drawable.ic_dialog_info); dialog.show(); } @Override protected Boolean doInBackground(Void... params) { File exportDir = new File(Environment.getExternalStorageDirectory(), \"\"); if (!exportDir.exists()) { exportDir.mkdirs(); } Date date = new Date(System.currentTimeMillis()); String filename = new SimpleDateFormat(\"yyyy-MM-dd hh:mm:ss\").format(date); File file = new File(exportDir, filename + \".csv\"); try { file.createNewFile(); CSVWriter csvWrite = new CSVWriter(new FileWriter(file)); StringBuffer check = new StringBuffer(); check.append(\"SELECT * FROM NOTE\"); DataBaseHelper db = DataBaseHelper.getInstance(GlobalField.getApplicationContext()); db.openDataBase(); Cursor curCSV = db.queryData(check.toString()); //key -&gt; get the cursor and then using opencsv csvWrite.writeNext(curCSV.getColumnNames()); while (curCSV.moveToNext()) { //Which column you want to export you can add over here... List&lt;String&gt; list = new ArrayList&lt;&gt;(); for (int i = 0, length = curCSV.getColumnCount(); i &lt; length; i++) { list.add(curCSV.getString(i)); } String[] arrStr = list.toArray(new String[list.size()]); csvWrite.writeNext(arrStr); } csvWrite.close(); curCSV.close(); return true; } catch (Exception sqlEx) { System.err.println(sqlEx.getMessage()); } return false; } @Override protected void onPostExecute(Boolean result) { if (dialog.isShowing()) { dialog.dismiss(); } if (result) { Toast.makeText(context, \"SqLite Data has been Exported!\", Toast.LENGTH_LONG).show(); } else { Toast.makeText(context, \"SqLite Data has not Exported\", Toast.LENGTH_LONG).show(); } }} å¯¼å…¥12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273public class ImportCVSToSQLiteDataBase extends AsyncTask&lt;String, String, String&gt; { Activity activity; Context context; File file=null; private ProgressDialog dialog; public ImportCVSToSQLiteDataBase(Context context, Activity activity,File file) { this.context=context; this.activity=activity; this.file=file; } @Override protected void onPreExecute() { dialog=new ProgressDialog(context); dialog.setTitle(\"Importing Data into SecureIt DataBase\"); dialog.setMessage(\"Please wait...\"); dialog.setCancelable(false); dialog.setIcon(android.R.drawable.ic_dialog_info); dialog.show(); }@Overrideprotected String doInBackground(String... params) { String data=\"\"; Log.d(getClass().getName(), file.toString()); try{ CSVReader reader = new CSVReader(new FileReader(file)); String [] nextLine; //here I am just displaying the CSV file contents, and you can store your file content into db from while loop... while ((nextLine = reader.readNext()) != null) { // nextLine[] is an array of values from the line String accId=nextLine[0]; String acc_name=nextLine[1]; data=data+\"AccId:\"+accId +\" Account_name:\"+acc_name+\"\\n\";//change to save to datebase instead of showing } return data; } catch (Exception e) { Log.e(\"Error\", \"Error for importing file\"); } return data=\"\"; }protected void onPostExecute(String data) { if (dialog.isShowing()) { dialog.dismiss(); } if (data.length()!=0) { Toast.makeText(context, \"File is built Successfully!\"+\"\\n\"+data, Toast.LENGTH_LONG).show(); }else{ Toast.makeText(context, \"File fail to build\", Toast.LENGTH_SHORT).show(); } }} é—®é¢˜å¯¼å‡ºçš„CSVæ–‡ä»¶å¦‚æœä½¿ç”¨Excelç›´æ¥æ‰“å¼€ï¼Œå¯èƒ½å‡ºç°ä¸­æ–‡ä¹±ç  è§£å†³åŠæ³•ï¼šä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€CSVæ–‡ä»¶ï¼Œâ€œæ–‡ä»¶â€-&gt;â€œå¦å­˜ä¸ºâ€ï¼Œç¼–ç æ–¹å¼é€‰æ‹©ANSIï¼Œä¿å­˜å®Œæ¯•åï¼Œç”¨EXCELæ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±ä¸ä¼šå‡ºç°ä¹±ç çš„æƒ…å†µã€‚","link":"/2017/04/08/ã€ŠAndroid å¼€æºåº“ã€‹Android OpenCSV/"},{"title":"ã€ŠAndroid æºç åˆ†æï¼ˆ0ï¼‰ã€‹ Android 8.0 æºç ä¸‹è½½ç¼–è¯‘","text":"1. ä»‹ç» æœ€è¿‘æ‰“ç®—åˆ©ç”¨å·¥ä½œä¹‹ä½™ï¼Œå­¦ä¹ Androidæºç ã€‚è‡ªä»å¼€å§‹æ¥è§¦åº”ç”¨å¼€å‘ä¹‹åï¼Œè¿™ä¸€å—å°±ä¸€ç›´è¢«å¿½ç•¥äº†ã€‚ä»Šå¤©ä»Ubuntuç³»ç»Ÿå®‰è£…å¼€å§‹ï¼Œåˆ°Android8.0çš„ä»£ç ç¼–è¯‘å®Œæˆï¼Œå‚ç…§åˆ«äººçš„ç»éªŒï¼Œè¿‡ç¨‹è¿˜ç®—æ¯”è¾ƒé¡ºåˆ©ã€‚ 2. æ­¥éª¤ å‚è€ƒå®˜ç½‘æ–‡æ¡£ï¼š https://source.android.com/source/initializing æˆ–è€…åšæ–‡ï¼š http://www.jianshu.com/p/367f0886e62b åŸºæœ¬ä¸Šä¾ç…§è¿™ç¯‡åšæ–‡ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥åœ¨Ubuntuç¯å¢ƒä¸‹å¿«é€Ÿçš„å®ŒæˆAndroidæºç çš„ä¸‹è½½å’Œç¼–è¯‘ã€‚æ³¨æ„åˆ‡æ¢åˆ†æ”¯åˆ°è‡ªå·±æƒ³è¦çš„branchä¸Šã€‚ 3. ç¼–è¯‘ç»“æœ","link":"/2017/09/23/ã€ŠAndroid æºç åˆ†æï¼ˆ0ï¼‰ã€‹ Android 8.0 æºç ä¸‹è½½ç¼–è¯‘/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆ å…­ï¼‰ã€‹Simple SlideToggleView For Android","text":"SlideToggleView ğŸA simple SlideToggleView for Android. InstallationGradleStep 1. Add it in your root build.gradle at the end of repositories: 123456allprojects { repositories { ... maven { url 'https://jitpack.io' } }} Step 2. Add the dependency 123dependencies { iimplementation 'com.github.onlyloveyd:SlideToggleView:1.0'} Basic UsageStep 1. Add SlideToggleView into your layout 12345678910111213&lt;cn.onlyloveyd.slidetoggleview.SlideToggleView android:id=\"@+id/slideToggleView\" android:layout_width=\"match_parent\" android:layout_height=\"56dp\" android:layout_marginTop=\"40dp\" android:background=\"@drawable/slide_bg\" app:stv_blockBottomMargin=\"2dp\" app:stv_blockLeftMargin=\"2dp\" app:stv_blockRightMargin=\"2dp\" app:stv_blockTopMargin=\"3dp\" app:stv_remain=\"80dp\" app:stv_slideBlock=\"@drawable/slide_block\" app:stv_text=\"Slide To Unlock\" /&gt; Step 2.(optional)add SlideToggleListener for SlideToggleView 123456789101112131415mBinding.slideToggleView.setSlideToggleListener(new SlideToggleView.SlideToggleListener() { @Override public void onBlockPositionChanged(SlideToggleView view, int left, int total, int slide) { String content = String.format(Locale.CHINESE, \"left: %d - total: %d - slide: %d\", left, total, slide); mBinding.shimmerTextView.setText(content); } @Override public void onSlideOpen(SlideToggleView view) { Toast.makeText(MainActivity.this, \"Slide Toggle is Open\", Toast.LENGTH_SHORT).show(); } }); Attributes Attribute Usage stv_text å±…ä¸­æ–‡å­—å†…å®¹ stv_textSize å±…ä¸­æ–‡å­—å¤§å° stv_textColor å±…ä¸­æ–‡å­—é¢œè‰² stv_slideBlock æ»‘å—å›¾ç‰‡ stv_blockLeftMargin æ»‘å—å·¦é—´è· stv_blockRightMargin æ»‘å—å·¦é—´è· stv_blockTopMargin æ»‘å—é¡¶éƒ¨é—´è· stv_blockBottomMargin æ»‘å—åº•éƒ¨é—´è· stv_remain æ»‘å—æ‰“å¼€è¯¯å·®èŒƒå›´å€¼ Basic Result","link":"/2019/01/12/ã€ŠAndroid è¿›é˜¶ï¼ˆ å…­ï¼‰ã€‹Simple SlideToggleView For Android/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆä¸‰ï¼‰ã€‹ è‡ªå®šä¹‰å®‰å…¨é”®ç›˜-LazyKeyboard","text":"LazyKeyboardLazyKeyboardï¼Œåˆ©ç”¨PopupWindowå®ç°ï¼Œå­—æ¯ï¼Œç¬¦å·ï¼Œæ•°å­—è‡ªå®šä¹‰å®‰å…¨é”®ç›˜ ä½¿ç”¨GradleStep 1. é¡¹ç›®æ ¹ç›®å½•ä¸‹ build.gradle 123456allprojects { repositories { ... maven { url 'https://jitpack.io' } }} Step 2. æ¨¡å—ç›®å½•ä¸‹build.gradleæ·»åŠ ä¾èµ– 123dependencies { implementation 'com.github.onlyloveyd:LazyKeyboard:v1.1'} åŸºæœ¬ç”¨æ³•Step 1. æ·»åŠ  SecurityEditText è‡³ç•Œé¢å¸ƒå±€ã€‚ 12345678910111213&lt;LinearLayout android:id=\"@+id/container\" ...\"&gt; &lt;com.gs.keyboard.SecurityEditText android:id=\"@+id/et_security_keyboard\" android:layout_width=\"match_parent\" ... /&gt; &lt;EditText android:id=\"@+id/et_security_keyboard_two\" ... /&gt; &lt;/LinearLayout&gt; Step 2. åˆå§‹åŒ– SecurityKeyboard 123456//é…ç½®éƒ¨åˆ†å±æ€§SecurityConfigure configure = new SecurityConfigure() .setDefaultKeyboardType(KeyboardType.NUMBER) .setLetterEnabled(false);//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºåŒ…å«SecurityEditTextçš„è§†å›¾ï¼Œå®‰å…¨é”®ç›˜çš„æ˜¾ç¤ºä»¥å…¶ä¸ºé”šç‚¹securityKeyboard = new SecurityKeyboard(binding.loginLayout, configure); Step 2. ç›®å‰æ”¯æŒè‡ªå®šä¹‰é€‰é¡¹ è‡ªå®šä¹‰é€‰é¡¹ æ„ä¹‰ selectedColor é€‰ä¸­é”®ç›˜ç±»å‹å‡¸æ˜¾é¢œè‰²ï¼Œé»˜è®¤ä¸º0xff66aeff unSelectedColor æœªé€‰ä¸­é”®ç›˜ç±»å‹å‡¸æ˜¾é¢œè‰²ï¼Œé»˜è®¤ä¸ºColor.BLACK isNumberEnabled æ˜¯å¦æ˜¾ç¤ºæ•°å­—é”®ç›˜ï¼Œé»˜è®¤ä¸ºtrue isLetterEnabled æ˜¯å¦æ˜¾ç¤ºå­—æ¯é”®ç›˜ï¼Œé»˜è®¤ä¸ºtrue isSymbolEnabled æ˜¯å¦æ˜¾ç¤ºç¬¦å·é”®ç›˜ï¼Œé»˜è®¤ä¸ºtrue defaultKeyboardType é»˜è®¤é€‰ä¸­çš„é”®ç›˜ï¼Œé»˜è®¤å€¼ä¸ºKeyboardType.LETTER åŸºç¡€æ•ˆæœ","link":"/2018/06/22/ã€ŠAndroid è¿›é˜¶ï¼ˆä¸‰ï¼‰ã€‹ è‡ªå®šä¹‰å®‰å…¨é”®ç›˜-LazyKeyboard/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆä¸‰ï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹æ”¯æŒGravityçš„ViewGroup","text":"1. å‰è¨€å‰é¢ä¸¤ç¯‡åšå®¢ä¸»è¦æ˜¯ä»‹ç»ç›´æ¥ç»§æ‰¿Viewåå¤å†™onDrawæ–¹æ³•æ¥å®ç°ä¸€äº›ä¸è§„åˆ™å›¾å½¢çš„ç»˜åˆ¶ï¼Œæ¥è¾¾åˆ°æ»¡è¶³ä¸åŒè‡ªå®šä¹‰Viewçš„éœ€æ±‚ï¼Œæ›´æ³¨é‡çš„æ˜¯å›¾å½¢çš„ç»˜åˆ¶å˜æ¢å’Œæ•ˆæœå±•ç¤ºï¼Œå‰ä¸¤å¤©å­¦ä¹ ä¸€äº›è‡ªå®šä¹‰ViewGroupçš„ç›¸å…³å†…å®¹ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚ 2. ç›®æ ‡æ”¯æŒGravityçš„ViewGroupã€‚ æ”¯æŒçš„Gravityçš„ç§ç±»ï¼šå·¦ä¸Šï¼Œå³ä¸Šï¼Œå·¦ä¸‹ï¼Œå³ä¸‹ï¼Œä¸­å¿ƒã€‚ 3. å®ç°æ­¥éª¤ è‡ªå®šä¹‰å±æ€§ï¼šcustom_gravity è‡ªå®šä¹‰å±æ€§çš„å–å€¼èŒƒå›´ï¼š1ï¼5(topleft, topright, bottomleft, bottomright, center) è‡ªå®šä¹‰LayoutParamã€‚å‚è€ƒLinearLayoutï¼ŒRelativeLayoutç­‰ç­‰ å¤å†™onMeasureï¼Œ onLayout å¤å†™LayoutParamç›¸å…³çš„å‡ ä¸ªæ–¹æ³• 4. å‡ ç‚¹æé†’ onMeasureä½¿ç”¨æ¥ç¡®å®šå­viewçš„å¤§å°çš„ï¼Œæ²¡æœ‰é‚£ä¹ˆç¥ç§˜ï¼Œå°±æ˜¯æ ¹æ®ViewGroupçš„å¤§å°å’Œå­Viewçš„LayoutParamæ¥ç¡®å®šå­Viewåº”è¯¥æœ‰çš„å¤§å°ã€‚é€šè¿‡MeasureSpec.makeMeasureSpecçš„æ–¹å¼ç”ŸæˆMeasureSpecï¼Œé€šè¿‡è°ƒç”¨å­Viewçš„measureæ–¹æ³•ï¼ŒæŠŠæ•°æ®ä¼ é€’ç»™å­Viewï¼Œæ–¹ä¾¿ç¡®å®šå¤§å°ã€‚ onLayoutæ–¹æ³•åŒæ¥ç¡®å®šå­Viewçš„ä½ç½®ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯å½“å‰View Groupçš„ä¸Šä¸‹å·¦ä¸Šè§’å’Œå³ä¸‹è§’çš„ä½ç½®ï¼Œé€šè¿‡å­Viewçš„å±æ€§å€¼å’Œä¸€äº›å…¶ä»–åˆ¤æ–­æ¡ä»¶ï¼Œæ¥è®¡ç®—å­Viewåº”è¯¥æ‘†æ”¾åœ¨å“ªä¸ªä½ç½®ï¼Œç„¶åé€šè¿‡è°ƒç”¨å­Viewçš„layoutæ–¹æ³•æ¥æ‘†æ”¾ã€‚ è‡ªå®šä¹‰LayoutParamã€‚éœ€è¦å¤å†™å‡ ä¸ªæ–¹æ³• 5. ä»£ç å®ç°5.1 è‡ªå®šä¹‰å±æ€§1234567891011&lt;declare-styleable name=\"CustomViewGroup\"&gt; &lt;attr name=\"custom_gravity\"/&gt;&lt;/declare-styleable&gt;&lt;attr name=\"custom_gravity\"&gt; &lt;flag name=\"topleft\" value=\"1\"/&gt; &lt;flag name=\"topright\" value=\"2\"/&gt; &lt;flag name=\"bottomleft\" value=\"3\"/&gt; &lt;flag name=\"bottomright\" value=\"4\"/&gt; &lt;flag name=\"center\" value=\"5\"/&gt;&lt;/attr&gt; 5.2 CustomViewGroupä»£ç å†™çš„æ¯”è¾ƒç®€å•ï¼Œæ–¹ä¾¿ç†è§£ï¼ŒæŠŠæ¯ä¸ªå­Viewçš„å¤§å°å…¨éƒ¨è®¾ç½®æˆç›¸åŒçš„å¤§å°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121public class CustomViewGroup extends ViewGroup { public CustomViewGroup(Context context) { super(context); } public CustomViewGroup(Context context, AttributeSet attrs) { super(context, attrs); } public CustomViewGroup(Context context, AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); } @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) { super.onMeasure(widthMeasureSpec, heightMeasureSpec); int widthSize = MeasureSpec.getSize(widthMeasureSpec); int heightSize = MeasureSpec.getSize(heightMeasureSpec); /** * æ¯ä¸ªå­Viewçš„å¤§å°éƒ½è®¾ç½®æˆç›¸åŒå¤§å° */ for (int i = 0; i &lt; getChildCount(); i++) { View child = getChildAt(i); int mode = MeasureSpec.EXACTLY; int childWidth = widthSize / 4; int childHeight = heightSize / 4; child.measure(MeasureSpec.makeMeasureSpec(childWidth, mode), MeasureSpec.makeMeasureSpec(childHeight, mode)); } } @Override protected void onLayout(boolean changed, int l, int t, int r, int b) { for (int i = 0; i &lt; getChildCount(); i++) { View child = getChildAt(i); int width = child.getMeasuredWidth(); int height = child.getMeasuredHeight(); final LayoutParams lp = (LayoutParams) child.getLayoutParams(); int gravity = lp.gravity; switch (gravity) { case LayoutParams.TOPLEFT_GRAVITY: child.layout(l, t, width, height); break; case LayoutParams.TOPRIGHT_GRAVITY: child.layout(r - width, t, r, height); break; case LayoutParams.BOTTOMLEFT_GRAVITY: child.layout(l, b - height, width, b); break; case LayoutParams.BOTTOMRIGHT_GRAVITY: child.layout(r - width, b - height, r, b); break; case LayoutParams.CENTER_GRAVITY: child.layout((r - width) / 2, (b - height) / 2, (r + width) / 2, (b + height) / 2); break; default: break; } } } @Override public ViewGroup.LayoutParams generateLayoutParams(AttributeSet attrs) { return new LayoutParams(getContext(), attrs); } @Override protected ViewGroup.LayoutParams generateLayoutParams(ViewGroup.LayoutParams p) { return new LayoutParams(p); } @Override protected ViewGroup.LayoutParams generateDefaultLayoutParams() { return new LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT, 1); } @Override protected boolean checkLayoutParams(ViewGroup.LayoutParams p) { return p instanceof LayoutParams; } public static class LayoutParams extends ViewGroup.LayoutParams { public static final int UNSPECIFIED_GRAVITY = -1; public static final int TOPLEFT_GRAVITY = 1; public static final int TOPRIGHT_GRAVITY = 2; public static final int BOTTOMLEFT_GRAVITY = 3; public static final int BOTTOMRIGHT_GRAVITY = 4; public static final int CENTER_GRAVITY = 5; public int gravity = UNSPECIFIED_GRAVITY; public LayoutParams(@NonNull Context c, @Nullable AttributeSet attrs) { super(c, attrs); final TypedArray a = c.obtainStyledAttributes(attrs, R.styleable.CustomViewGroup); gravity = a.getInt(R.styleable.CustomViewGroup_custom_gravity, UNSPECIFIED_GRAVITY); a.recycle(); } public LayoutParams(int width, int height, int gravity) { super(width, height); this.gravity = gravity; } public LayoutParams(@NonNull ViewGroup.LayoutParams source) { super(source); this.gravity = TOPLEFT_GRAVITY; } public LayoutParams(@NonNull LayoutParams source) { super(source); this.gravity = source.gravity; } }} 6. æ•ˆæœå›¾ 7. æºä»£ç æºä»£ç è¿˜æ˜¯ä¸Šä¼ åˆ°GithubCustomViewDemo","link":"/2017/10/20/ã€ŠAndroid è¿›é˜¶ï¼ˆä¸‰ï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹æ”¯æŒGravityçš„ViewGroup/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆäº”ï¼‰ã€‹åº”ç”¨åˆ†äº«ç®€å•å®ç°-LazyApkShare","text":"LazyApkShareåˆ†äº«å½“å‰åº”ç”¨çš„ç®€å•å®ç°ã€‚ å¼€æºåœ°å€LazyApkShare æ·»åŠ ä¾èµ–Gradleæ­¥éª¤ä¸€. æ ¹ç›®å½•ä¸‹build.gradle 12345allprojects { repositories { maven { url 'https://jitpack.io' } }} æ­¥éª¤äºŒ. æ·»åŠ ä¾èµ– 1234dependencies { implementation 'com.github.onlyloveyd:LazyApkShare:1.0'} é›†æˆå·¥ä½œ è¿è¡Œæ—¶è¯»å†™å­˜å‚¨æƒé™éœ€è¦å¼€å‘è€…è‡ªè¡Œå¤„ç†.è¯¦ç»†æ“ä½œå¯å‚è€ƒç¤ºä¾‹ä»£ç ã€‚ 12ShareManager shareManager = new ShareManager(this);shareManager.shareApp(getPackageName()); å®é™…æ•ˆæœ å®ç°åŸç†ä»£ç ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œä¸åšèµ˜è¿°ã€‚å…³é”®åœ¨äºAndroidåº”ç”¨ä¿¡æ¯ç±»ApplicationInfoä¸­å­˜åœ¨ä¸€ä¸ªsourceDirï¼Œé€šè¿‡è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°ç”¨æˆ·å®‰è£…è¿‡ç¨‹ä¸­ä½¿ç”¨çš„å®‰è£…åŒ…ã€‚ç„¶åå¯¹å…¶æ‰§è¡Œç³»ç»Ÿåˆ†äº«æ“ä½œå³å¯ã€‚","link":"/2018/10/28/ã€ŠAndroid è¿›é˜¶ï¼ˆäº”ï¼‰ã€‹åº”ç”¨åˆ†äº«ç®€å•å®ç°-LazyApkShare/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆå››ï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹ä»¿Emuiå¼€å…³æ§ä»¶","text":"1. ç®€ä»‹ä½¿ç”¨åä¸ºæ‰‹æœºï¼Œå‘ç°è®¾ç½®åº”ç”¨ä¸­çš„å¼€å…³ç©ºé—´é¢œè‰²å¬æŒºå¥½çœ‹ï¼Œæ‰€ä»¥è‡ªå·±æƒ³å†™ä¸€ä¸ªç±»ä¼¼çš„ï¼Œå½“ç„¶ä¸å¯èƒ½å®Œå…¨ç›¸åŒï¼Œä½†æ˜¯å¤§è‡´çš„æ•ˆæœå·®ä¸å¤šã€‚æ“ä½œæ­¥éª¤ï¼š æˆªå›¾ã€‚PSå–è‰²ï¼› åˆ¤æ–­å·¦å³ä¸¤è¾¹çš„åŠå¾„ï¼› ç»§æ‰¿Viewå¤å†™onDrawæ–¹æ³•ï¼Œæ‰‹åŠ¨ç»˜åˆ¶ã€‚ æ§åˆ¶å¼€å…³çš„çŠ¶æ€ï¼šonï¼off 2. æ•ˆæœ 3. å®ç°3.1 è‡ªå®šä¹‰å±æ€§æ²¡æœ‰å®šä¹‰ï¼Œé¢œè‰²å’ŒåŠå¾„éƒ½æ˜¯æŒ‰ç…§è‡ªå·±çš„æ•ˆæœå†™æˆå›ºå®šçš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å†™æˆè‡ªå®šä¹‰å±æ€§ã€‚ 3.2 è‡ªå®šä¹‰Viewä»£ç æ¶‰åŠåˆ°ä¸€äº›åŠ¨ç”»çš„ä½¿ç”¨å’ŒViewçš„äº‹ä»¶å¤„ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142public class CustomSwitchView extends View { /** * å¼€å…³åœ†ç‚¹é¢œè‰² */ private final int SWITCH_DOT_COLOR = 0xffffffff; /** * å…³é—­çŠ¶æ€ä¸‹çš„èƒŒæ™¯é¢œè‰² */ private final int OFF_BACKGROUND_COLOR = 0xffe2e2e2; /** * æ‰“å¼€çŠ¶æ€ä¸‹çš„èƒŒæ™¯é¢œè‰² */ private final int ON_BACKGROUND_COLOR = 0xff007dff; /** * è¾¹ç•Œå’Œå¼€å…³åœ†ç‚¹çš„é—´è· */ private final int BOUND_DOT_GAP = 8; /** * æ˜¯å¦æ‰“å¼€ */ private boolean isOn = false; /** * åœ†ç‚¹çš„åŠå¾„å’Œåæ ‡ä½ç½® */ private int mRadius; private int startX; private int endX; private float centerX; private float centerY; private RectF mRectF; /** * å¼€å…³çš„ç”»ç¬” */ private Paint mSwitchPaint; public CustomSwitchView(Context context) { this(context, null); } public CustomSwitchView(Context context, @Nullable AttributeSet attrs) { this(context, attrs, 0); } public CustomSwitchView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); init(); } /** * æ‰“å¼€æˆ–è€…å…³é—­ * * @param on true æ‰“å¼€ï¼Œ false å…³é—­ */ public void setOn(boolean on) { isOn = on; ValueAnimator animator; if (on) { animator = ValueAnimator.ofFloat(centerX, endX); } else { animator = ValueAnimator.ofFloat(centerX, startX); } animator.setDuration(200); animator.setRepeatCount(0); animator.setInterpolator(new LinearInterpolator()); animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { @Override public void onAnimationUpdate(ValueAnimator animation) { centerX = (Float) animation.getAnimatedValue(); invalidate(); } }); animator.start(); } private void init() { mSwitchPaint = new Paint(); mSwitchPaint.setColor(OFF_BACKGROUND_COLOR); mSwitchPaint.setStrokeWidth(10f); mSwitchPaint.setStrokeCap(Paint.Cap.ROUND); mSwitchPaint.setAntiAlias(true); } @Override protected void onSizeChanged(int w, int h, int oldw, int oldh) { super.onSizeChanged(w, h, oldw, oldh); mRectF = new RectF(getLeft(), getTop(), getRight(), getBottom()); mRadius = h / 2 - BOUND_DOT_GAP; startX = getLeft() + mRadius + BOUND_DOT_GAP / 2; endX = getRight() - mRadius - BOUND_DOT_GAP / 2; centerX = startX; centerY = (getTop() + getBottom()) / 2.0f; } @Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) { super.onLayout(changed, left, top, right, bottom); } @Override protected void onDraw(Canvas canvas) { super.onDraw(canvas); if (isOn) { mSwitchPaint.setColor(ON_BACKGROUND_COLOR); } else { mSwitchPaint.setColor(OFF_BACKGROUND_COLOR); } canvas.drawRoundRect(mRectF, mRadius, mRadius, mSwitchPaint); mSwitchPaint.setColor(SWITCH_DOT_COLOR); canvas.drawCircle(centerX, centerY, mRadius, mSwitchPaint); } @Override public boolean onTouchEvent(MotionEvent event) { int action = event.getAction(); switch (action) { case MotionEvent.ACTION_DOWN: break; case MotionEvent.ACTION_UP: setOn(!isOn); break; case MotionEvent.ACTION_MOVE: { float x = event.getX(); if (x &lt; endX &amp;&amp; x &gt; startX) { centerX = x; invalidate(); } } break; default: break; } return true; }} 4. æºç æºç ä¾ç„¶æ˜¯ä¸Šä¼ åˆ°GithubCustomViewDemo","link":"/2017/11/09/ã€ŠAndroid è¿›é˜¶ï¼ˆå››ï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹ä»¿Emuiå¼€å…³æ§ä»¶/"},{"title":"ã€ŠAndroidåº”ç”¨ä¹‹è·¯ã€‹ Androidåº”ç”¨å¼€å‘èµ„æºæ±‡æ€»","text":"ç®€ä»‹ä¸ªäººç‹¬ç«‹å¼€å‘Androidåº”ç”¨ï¼Œæ˜¯ä¸€ä»¶æ—¢ç®€å•ä¹Ÿå¤æ‚çš„ä¸€ä»¶äº‹æƒ…ï¼Œä¸ç”¨æµªè´¹æ—¶é—´æ²Ÿé€šäº¤æµï¼Œä¸€å¿ƒç ï¼Œä½†æ˜¯è¿™å°±ä»£è¡¨ç€ä½ éœ€è¦äº†è§£çš„çŸ¥è¯†å¾ˆå…¨é¢ï¼Œä½ éœ€è¦æŒ‡å¯¼çš„å·¥å…·å¾ˆçŠ€åˆ©~ è§†è§‰æ•ˆæœ ####ç•Œé¢è®¾è®¡ https://dribbble.com/ https://www.uplabs.com/ https://material.io/ http://www.ui.cn/ ####é…è‰² https://color.adobe.com/zh/explore/newest/ https://colordrop.io/ https://www.materialpalette.com/indigo/light-green ####å›¾æ ‡åº“ http://typicons.com/ https://icons8.com/web-app/new-icons/all http://www.iconfont.cn/ https://icomoon.io/ https://material.io/icons/ å¼€å‘è€…åŠ©æ‰‹ ####æ•°æ®æº èšåˆæ•°æ® Baidu API Store å’Œé£å¤©æ°” å¹²è´§é›†ä¸­è¥ github API å¤©å¤©æ•°æ® å½“ç„¶å¾ˆå¤šè§†é¢‘ç½‘ç«™å’Œèµ„è®¯ç½‘ç«™éƒ½æœ‰å¼€å‘APIæ¥å£ä¾›å¼€å‘è€…ä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥é€‚å½“çš„æœç´¢ä½¿ç”¨ ####æœåŠ¡ ç™¾åº¦åœ°å›¾ é«˜å¾·åœ°å›¾ è’²å…¬è‹± fir.im Bmobåç«¯äº‘ å‹ç›Ÿ ä¸ƒç‰›äº‘ æå…‰æ¨é€ ####å®Œæ•´å¼€æºåº”ç”¨ç¤ºä¾‹ ä»0å¼€å§‹ ä»å¼€å‘åˆ°ä¸Šçº¿ çŸ¥ä¹æ—¥æŠ¥ æ–°é—»æ®µå­æ‰‹ äº‘é˜… é«˜ä»¿å¾®ä¿¡ LookLook Mmaterial Design æå®¢æ—¥æŠ¥ å¹²è´§IO","link":"/2017/02/06/ã€ŠAndroidåº”ç”¨ä¹‹è·¯ã€‹ Androidåº”ç”¨å¼€å‘èµ„æºæ±‡æ€»/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆå››ï¼‰ã€‹è‡ªå®šä¹‰ç»„ç»‡æœºæ„å›¾-LazyOrgView","text":"LazyOrgView é€šè¿‡è‡ªå®šä¹‰Viewç®€å•å®ç°ç»„ç»‡ç»“æ„å›¾ã€‚åœ¨ç½‘ä¸Šæœç´¢å¹¶æ²¡æœ‰å‘ç°ç±»ä¼¼çš„Viewï¼Œç”±äºé¡¹ç›®éœ€è¦ï¼Œå¿«é€Ÿå®ç°ä¸€ä¸ªæ»¡è¶³é¡¹ç›®éœ€æ±‚ã€‚å¦å¤–ä¸€ç§å®ç°æ–¹å¼ï¼šGoogle OrgChartæˆ–è€…å…¶ä»–OrgChart.jsã€‚ æºç åœ°å€ LazyOrgView æ·»åŠ ä¾èµ–Gradleæ­¥éª¤ 1. å·¥ç¨‹æ ¹ç›®å½•build.gradle æ·»åŠ å¦‚ä¸‹ 12345allprojects { repositories { maven { url 'https://jitpack.io' } }} Step 2. é¡¹ç›®build.gradle æ·»åŠ ä¾èµ– 1234dependencies { implementation 'com.github.onlyloveyd:LazyOrgView:v1.0'} åŸºæœ¬ä½¿ç”¨æ­¥éª¤ 1. æ·»åŠ  LazyOrgView è‡³å¸ƒå±€ã€‚ 12345678910111213&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\".MainActivity\"&gt; &lt;cn.onlyloveyd.lazyorgview.widget.LazyOrgView android:id=\"@+id/rv_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"/&gt;&lt;/FrameLayout&gt; æ­¥éª¤ 2. ä½¿ç”¨TreeNodeæ„å»ºè·ŸèŠ‚ç‚¹ä»¥åŠå…¶ä»–èŠ‚ç‚¹ï¼Œç„¶åä½¿ç”¨addChildNodeç»„ç»‡èŠ‚ç‚¹å…³ç³»ã€‚ 123456789101112131415161718192021222324252627282930TreeNode root = new TreeNode(\"æ€»ç»ç†\");root.isRoot = true;TreeNode A = new TreeNode(\"å‰¯ç»ç†\");TreeNode Aa = new TreeNode(\"è¡Œæ”¿éƒ¨\");TreeNode Ab = new TreeNode(\"è´¢åŠ¡éƒ¨\");TreeNode Ac = new TreeNode(\"é‡‡è´­éƒ¨\");TreeNode B = new TreeNode(\"å‰¯ç»ç†\");TreeNode Ba = new TreeNode(\"å·¥ç¨‹éƒ¨\");TreeNode Bb = new TreeNode(\"ç”Ÿäº§éƒ¨\");TreeNode C = new TreeNode(\"å‰¯ç»ç†\");TreeNode Ca = new TreeNode(\"è¥é”€éƒ¨\");TreeNode Cb = new TreeNode(\"æ–¹æ¡ˆé€ ä»·éƒ¨\");TreeNode Cc = new TreeNode(\"å”®åæœåŠ¡éƒ¨\");root.addChildNode(A);root.addChildNode(B);root.addChildNode(C);A.addChildNode(Aa);A.addChildNode(Ab);A.addChildNode(Ac);B.addChildNode(Ba);B.addChildNode(Bb);C.addChildNode(Ca);C.addChildNode(Cb); æ­¥éª¤ 3. ç»™LazyOrgViewé…ç½® LazyOrgConfig ä»¥åŠ rootNodeã€‚ 1234567lazyOrgView.setRootNode(root);LazyOrgConfig lazyOrgConfig = new LazyOrgConfig();lazyOrgConfig.setLineColor(Color.BLUE).setTextSize(12) .setLineWidth(1) .setTextBgColor(Color.GREEN) .setTextBgRes(R.drawable.rect_shape);lazyOrgView.setLazyOrgConfig(lazyOrgConfig); åŸºæœ¬æ•ˆæœ","link":"/2018/08/12/ã€ŠAndroid è¿›é˜¶ï¼ˆå››ï¼‰ã€‹è‡ªå®šä¹‰ç»„ç»‡æœºæ„å›¾-LazyOrgView/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Essentialä»‹ç»ï¼ˆè¯‘æ–‡ï¼‰","text":"ç®€ä»‹GreenRobot Essentialsä¸ºAndroidå’ŒJavaé¡¹ç›®æä¾›é€šç”¨çš„å®ç”¨å·¥å…·ã€‚ åœ¨Androidå¼€å‘çš„æ—©æœŸï¼Œå®ƒå°±å·²ç»å­˜åœ¨äº†ã€‚æ•´ä¸ªåº“å¾ˆç®€å•ï¼ŒjaråŒ… &lt;100kï¼Œåœ¨æ•ˆç‡å’Œæ€§èƒ½ä¸Šä¹Ÿæ˜¯ç‹¬æ ‘ä¸€å¸œçš„ã€‚ ç‰¹æ€§Essentialsæ˜¯ä¸€ä¸ªé€šç”¨ç±»çš„é›†åˆï¼Œæˆ‘ä»¬å‘ç°åœ¨è®¸å¤šåœºåˆéƒ½å¾ˆæœ‰ç”¨ã€‚ ä½¿ç”¨è¦ç‚¹çš„ä¸»è¦åŸå› ï¼š åœ¨é¡¹ç›®ä¸­ç¼–å†™è¾ƒå°‘çš„ä»£ç  ä¸“é—¨å®ç°ä¸æ ‡å‡†APIç›¸æ¯”æ›´å¥½çš„æ€§èƒ½ è¶…è½»é‡çº§ï¼š&lt;100k å…¼å®¹Androidå’ŒJava ç‰¹å¾ï¼š IO utilities åœ¨IOæµï¼ˆåŸºäºå­—èŠ‚å’Œå­—ç¬¦ï¼‰å’Œdigestsï¼ˆä¾‹å¦‚MD5å’ŒSHA-1ï¼‰ä¸Šèµ·åˆ°å¾ˆå¤§çš„å¸®åŠ©ä½œç”¨ã€‚ File utilities ç®€åŒ–äº†ä»å­—ç¬¦ä¸²/å­—èŠ‚/å¯¹è±¡å†™å…¥æ–‡ä»¶æˆ–å‘æ–‡ä»¶å†™å…¥å­—ç¬¦ä¸²/å­—èŠ‚/å¯¹è±¡ã€‚è¿˜åŒ…æ‹¬ä»æ–‡ä»¶è·å–å“ˆå¸Œå’Œå¤åˆ¶æ–‡ä»¶ã€‚ String utilitieså…è®¸æœ‰æ•ˆåˆ†å‰²å’Œè¿æ¥å­—ç¬¦ä¸²ï¼Œhexå’ŒMD5åˆ›å»ºï¼Œä»¥åŠå…¶ä»–æœ‰ç”¨çš„å­—ç¬¦ä¸²åŠ©æ‰‹ã€‚ Better hash functions: ï¼šæˆ‘ä»¬çš„Murmur3å®ç°æä¾›äº†ä¼˜è¶Šçš„æ•£åˆ—è´¨é‡ï¼Œå¹¶ä¸”èƒœè¿‡æ ‡å‡†çš„Javaæ•£åˆ—å‡½æ•° Specialized Streams: ä¾‹å¦‚ä¼˜åŒ–çš„PipedOutputStreamæ›¿æ¢ï¼ˆåŸºäºå¾ªç¯å­—èŠ‚ç¼“å†²å™¨ï¼‰ Hash set and map for primitive long keys åŸå§‹é•¿é”®çš„å“ˆå¸Œé›†å’Œæ˜ å°„ä¼˜äºJavaé›†åˆAPIçš„é€šç”¨ç‰ˆæœ¬ Multimapså¤šæ˜ å°„æä¾›äº†åˆ—è¡¨æˆ–é›†åˆçš„æ˜ å°„ï¼Œä»¥ç®€åŒ–ä¸ºå•ä¸ªé”®å­˜å‚¨å¤šä¸ªå€¼ Object cache å¯¹è±¡ç¼“å­˜å…·æœ‰å¼ºå¤§çš„é…ç½®é€‰é¡¹ï¼šè½¯/å¼±/å¼ºå¼•ç”¨ï¼Œæœ€å¤§å¤§å°å’ŒåŸºäºæ—¶é—´çš„åˆ°æœŸ Base64å®ç°ï¼ˆä»iharder.netæ†ç»‘ï¼‰ç”¨äºè¾ƒä½ç‰ˆæœ¬çš„Javaå’ŒAndroidï¼ˆåŒ…æ‹¬è¾“å…¥/â€‹â€‹è¾“å‡ºæµï¼‰ é›†æˆ1. æ·»åŠ åˆ°å·¥ç¨‹ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ 1compile 'org.greenrobot:essentials:3.0.0-RC1' æˆ–è€…ä½¿ç”¨è€ç‰ˆæœ¬ 1compile 'de.greenrobot:java-common:2.3.1' é’ˆå¯¹Maven 12345&lt;dependency&gt; &lt;groupId&gt;de.greenrobot&lt;/groupId&gt; &lt;artifactId&gt;java-common&lt;/artifactId&gt; &lt;version&gt;2.3.1&lt;/version&gt;&lt;/dependency&gt; 2. ç¤ºä¾‹ä»£ç 123456789// Get all bytes from stream and close the stream safelybyte[] bytes = IoUtils.readAllBytesAndClose(inputStream);// Read the contents of an file as a string (use readBytes to get byte[])String contents = FileUtils.readUtf8(file);// How many days until new year's eve?long time2 = DateUtils.getTimeForDay(2015, 12, 31);int daysToNewYear = DateUtils.getDayDifference(time, time2); å¤šæ˜ å°„Mapï¼ˆç‰ˆæœ¬v2.2åŠ å…¥ï¼‰ 12345ListMap&lt;String,String&gt; multimap = new ListMap&lt;&gt;();multimap.putElement(\"a\", \"1\");multimap.putElement(\"a\", \"2\");multimap.putElement(\"a\", \"3\");List&lt;String&gt; strings = multimap.get(\"a\"); //Contains \"1\", \"2\", and \"3\" æ•£åˆ—å‡½æ•°å®ç° java.util.zip.Checksumï¼Œæ‰€ä»¥ä¸‹é¢çš„ä»£ç å¯èƒ½çœ‹èµ·æ¥å¾ˆçœ¼ç†Ÿ 123Murmur3A murmur = new Murmur3A();murmur.update(bytes);long hash = murmur.getValue(); æ‰€æœ‰æ•£åˆ—å¯ä»¥é€šè¿‡å¤šæ¬¡è°ƒç”¨updateï¼ˆâ€¦ï¼‰æ¥é€æ­¥è®¡ç®—ã€‚ æˆ‘ä»¬çš„Murmur3Aå®ç°æ›´è¿›ä¸€æ­¥ï¼Œä»¥éå¸¸æœ‰æ•ˆçš„æ–¹å¼æä¾›åŸå§‹æ•°æ®çš„æ›´æ–°ï¼š 123456789101112// reuse the previous instance and start over to calculate a new hashmurmur.reset();murmur.updateLong(42L);// Varargs and arrays are supported natively, too murmur.updateInt(2014, 2015, 2016);murmur.updateUtf8(\"And strings, of course\");// Hash for the previous update calls. No conversion to byte[] necessary.hash = murmur.getValue(); å®ç”¨ç¨‹åºç±»æ˜¯ç›´æ¥çš„ï¼Œæ²¡æœ‰ä¾èµ–æ€§ï¼Œæ‰€ä»¥ä½ åº”è¯¥å¾ˆå¥½åœ°é€šè¿‡çœ‹çœ‹ä»–ä»¬çš„æºä»£ç æ¥æŒæ¡å®ƒä»¬ã€‚ å¤§å¤šæ•°æ–¹æ³•åç§°åº”è¯¥æ˜¯è‡ªè§£é‡Šçš„ï¼Œé€šå¸¸ä½ ä¼šåœ¨éœ€è¦çš„åœ°æ–¹æ‰¾åˆ°JavaDocsã€‚","link":"/2017/02/25/ã€ŠAndroidå¼€æºåº“ã€‹ Essentialä»‹ç»ï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 6","text":"22. ViewPortHandlerViewPortHandlerè´Ÿè´£å¤„ç†å›¾è¡¨çš„è§†çª—ã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒè´Ÿè´£å›¾è¡¨è§†å›¾ä¸­çš„å±•ç¤ºç»™ç”¨æˆ·çš„é‚£éƒ¨åˆ†å†…å®¹ã€‚åŒ…æ‹¬å›¾è¡¨ä½ç§»ï¼Œç¼©æ”¾çº§åˆ«ï¼Œå›¾è¡¨å¤§å°å’Œç»˜åˆ¶åŒºåŸŸä»¥åŠå½“å‰åç§»é‡ã€‚ViewPortHandlerå…è®¸æˆ‘ä»¬è®¿é—®ä»¥ä¸Šæåˆ°çš„æ‰€æœ‰ä¹¦å±æ€§å¹¶ä¿®æ”¹å®ƒã€‚ å’Œé€šè¿‡Chartç±»ä¿®æ”¹è§†çª—ä¸ä¸€æ ·çš„æ˜¯ï¼Œé€šè¿‡ViewPortHandlerç›´æ¥ä¿®æ”¹å¯è§å–æ‚¦å¹¶ä¸æ˜¯å®Œå…¨å®‰å…¨çš„ã€‚å³ä½¿ä½ å¯¹APIæ¯”è¾ƒç†Ÿæ‚‰ä½ ä¹Ÿéœ€è¦å¾ˆå°å¿ƒçš„ä½¿ç”¨å®ƒã€‚ä¸æ°å½“çš„ä½¿ç”¨å¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚ç„¶è€Œï¼ŒViewPortHandleræä¾›äº†å¾ˆå¤šé«˜é˜¶çš„æ–¹æ³•æ¥ä¿®æ”¹è§†çª—ã€‚ 22.1 è·å–å®ä¾‹å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–å®ä¾‹ï¼š 1ViewPortHandler handler = chart.getViewPortHandler(); 22.2 ç¼©æ”¾&amp;ä½ç§» æ–¹æ³• ä½¿ç”¨ getScaleX() è¿”å›Xè½´ä¸Šçš„ç¼©æ”¾çº§åˆ« getScaleY() è¿”å›Yè½´ä¸Šçš„ç¼©æ”¾çº§åˆ« getTransX() è¿”å›Xè½´æ–¹å‘ä¸Šçš„ä½ç§» getTransY() è¿”å›Yè½´æ–¹å‘ä¸Šçš„ä½ç§» **** ### 22.3 å›¾è¡¨å°ºå¯¸&amp;å†…å®¹ æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€” getChartWidth() è¿”å›å›¾è¡¨çš„å®½åº¦ getChartHeight() è¿”å›å›¾è¡¨çš„é«˜åº¦ getContentRect() è¿”å›ä¸€ä¸ªRectFå¯¹è±¡è¡¨ç¤ºå½“å‰çš„å†…å®¹åŒºåŸŸ æ›´å¤šæ–¹æ³•è¯·æŸ¥é˜…JavaDocæˆ–è€…å­¦ä¹ API 23. FillFormatterFillFormatteræ¥å£å…è®¸è‡ªå®šä¹‰LineDataSetçš„å¡«å……è¡Œåº”è¯¥åœ¨å“ªé‡Œç»“æŸã€‚ æ‰€æœ‰éœ€è¦åšçš„éƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ–°ç±»å¹¶å®ç°FillFormatteræ¥å£ã€‚ ä½¿ç”¨ï¼š 1public float getFillLinePosition(LineDataSet dataSet, LineDataProvider provider) ç”¨äºå®ç°è‡ªå®šä¹‰é€»è¾‘çš„æ¥å£çš„æ–¹æ³•ï¼Œè¯¥è‡ªå®šä¹‰é€»è¾‘è®¡ç®—å•ä¸ªLineDataSetçš„å¡«å……è¡Œçš„ç»“æŸç‚¹ã€‚ åˆ›å»ºä¸€ä¸ªç±»å®ç°è¯¥æ¥å£ï¼š 1234567891011public class MyCustomFillFormatter implements FillFormatter { @Override public float getFillLinePosition(LineDataSet dataSet, LineDataProvider dataProvider) { float myDesiredFillPosition = ...; // put your logic here... return myDesiredFillPosition; }} ç„¶åæŠŠè‡ªå®šä¹‰çš„formatterè®¾ç½®åˆ°LineDataSetï¼š 1lineDataSet.setFillFormatter(new MyCustomFillFormatter()); æŸ¥çœ‹DefaultFillFormatterçš„å®ç° 24. ProGuard ä½¿ç”¨Proguard,éœ€è¦æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š 1-keep class com.github.mikephil.charting.** { *; } å¦‚æœä½¿ç”¨proguardä½†æ˜¯ä¸é…ç½®ä»¥ä¸Šè§„åˆ™ï¼ŒåŠ¨ç”»ä¼šå¤±æ•ˆã€‚Realm.ioå¯¹åº”é…ç½®ï¼š 1-dontwarn io.realm.** å…¶ä»–ProGuardä¿¡æ¯ 25. Realm.ioæ•°æ®åº“é›†æˆè¯·ç§»æ­¥å®˜æ–¹MPAndroidChart-Realmæ¥äº†è§£å¦‚ä½•ä»Realm.ioæ•°æ®åº“ä¸­æå–æ•°æ®å¡«å……MPAndroidChartã€‚ å…·ä½“æ“ä½œæŒ‡å—è¯·æŸ¥é˜…æ­¤å¤„ 26. è‡ªå®šä¹‰DataSetsä»ç‰ˆæœ¬v.2.2.0å¼€å§‹ï¼ŒMP AndroidChartå…è®¸ä½ åˆ›å»ºè‡ªå®šä¹‰çš„DataSetså¹¶åœ¨å›¾è¡¨ä¸­ä½¿ç”¨å®ƒä»¬ã€‚ 26.1 å¿…éœ€æ“ä½œ åˆ›å»ºè‡ªå®šä¹‰ç±»ï¼ˆå¦‚ï¼šCustomDataSetï¼‰ ç»§æ‰¿BaseDataSet&lt; ? extends Entry&gt; æ ¹æ®éœ€æ±‚å®ç°å¯¹åº”çš„IDataSetæ¥å£ã€‚å¦‚IBarDataSet å®ç°æ¥å£å¯¹åº”çš„æ–¹æ³•å¹¶è¿”å›ä½ æœŸæœ›çš„ç»“æœ 26.2 ç¤ºä¾‹åˆ›å»ºä¸€ä¸ªBarDataSetä¾›BarChartä½¿ç”¨ï¼š 123public class CustomBarDataSet extends BaseDataSet&lt;BarEntry&gt; implements IBarDataSet { // implement all by the extended class and interface required methods} åˆ›å»ºCustomBarDataSetåå®ç°æ‰€æœ‰æ¥å£éœ€è¦å®ç°çš„æ–¹æ³•ï¼Œç„¶åå®ƒå°±å¯ä»¥åƒBarDataSetä¸€æ ·åœ¨æ‰€æœ‰çš„BarChartä¸­ä½¿ç”¨äº†ã€‚ 27. å…¶ä»–æ–¹æ³•27.1 å›¾è¡¨å†…å®¹ æ–¹æ³• ä½¿ç”¨ clear() æ¸…ç©ºå›¾è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼ˆé€šè¿‡è®¾ç½®æ•°æ®å¯¹è±¡ä¸ºnullå®ç°ï¼‰ã€‚è°ƒç”¨invalidate()åˆ·æ–°æ•°æ® clearValues() æ¸…ç©ºå›¾è¡¨ä¸­çš„æ•°æ®é›†ï¼ŒXè½´ä¸Šæ•°æ®ä¸åšä¿®æ”¹ isEmpty() åˆ¤æ–­å›¾è¡¨ä¸­æ•°æ®æ˜¯å¦ä¸ºç©º ** ### 27.2 å¥½ç”¨çš„Getteræ–¹æ³• æ–¹æ³• ä½¿ç”¨ â€”â€” â€”â€” getData() è¿”å›å›¾è¡¨ä¸­çš„Dataå¯¹è±¡ getViewPortHandler() è¿”å›ViewPortHandlerå¯¹è±¡ getRenderer() è¿”å›è´Ÿè´£ç»˜åˆ¶å›¾è¡¨çš„DataRenderå¯¹è±¡ getCenter() è¿”å›æ•´ä¸ªå›¾è¡¨çš„ä¸­å¿ƒç‚¹. getCenterOffsets() è¿”å›å›¾è¡¨ç»˜åˆ¶åŒºåŸŸçš„ä¸­å¿ƒç‚¹ getPercentOfTotal(float value) è¿”å›æä¾›çš„å€¼æ„æˆå›¾è¡¨å†…æ€»å’Œçš„ç™¾åˆ†æ¯”. getYMin() è¿”å›Yè½´æœ€å°å€¼ getYMax() è¿”å›Yè½´æœ€å¤§å€¼ getLowestVisibleXIndex() è¿”å›Xè½´æ–¹å‘ä¸Šæœ€å°å¯è§ç´¢å¼• getHighestVisibleXIndex() è¿”å›Xè½´æ–¹å‘ä¸Šæœ€å¤§å¯è§ç´¢å¼• ** ### 27.3 æ›´å¤šChartç±»æ–¹æ³• æ–¹æ³• ä½¿ç”¨ â€”â€” â€”â€” saveToGallery(String title) å°†å½“å‰å›¾è¡¨çŠ¶æ€ä»¥å›¾ç‰‡çš„å½¢å¼ä¿å­˜åˆ°å›¾åº“ã€‚è®°å¾—æ·»åŠ â€WRITE_EXTERNAL_STORAGEâ€æƒé™. saveToPath(String title, String pathOnSD) å°†å½“å‰å›¾è¡¨çŠ¶æ€ä»¥å›¾ç‰‡çš„å½¢å¼ä¿å­˜åˆ°æŒ‡å®šè·¯å¾„ã€‚è®°å¾—æ·»åŠ â€WRITE_EXTERNAL_STORAGEâ€æƒé™. getChartBitmap() å°†å½“å‰å›¾è¡¨çŠ¶æ€ä»¥Bitmapçš„å½¢å¼è¿”å›. setHardwareAccelerationEnabled(boolean enabled) å¯ç”¨ï¼ç¦ç”¨å›¾è¡¨ç»˜åˆ¶ç¡¬ä»¶åŠ é€Ÿ, ä»…é’ˆå¯¹APIçº§åˆ«11+çš„è®¾å¤‡.","link":"/2017/06/25/ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 6/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Getting Startedï¼ˆè¯‘æ–‡ï¼‰","text":"å…¥é—¨ä¸‹è½½Realm for Androidæˆ–è€…åœ¨Github realm-javaä¸ŠæŸ¥çœ‹æºä»£ç . åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#getting-started å¼€å‘æ¡ä»¶ æˆ‘ä»¬ç›®å‰ä¸æ”¯æŒAndroidä¹‹å¤–çš„Javaã€‚ Android Studio&gt; = 1.5.1 æœ€è¿‘ç‰ˆæœ¬çš„Android SDKã€‚ JDK version&gt; = 7ã€‚ æˆ‘ä»¬æ”¯æŒæ‰€æœ‰Androidç‰ˆæœ¬è‡ªAPI Level 9ï¼ˆAndroid 2.3 GingerbreadåŠä»¥ä¸Šï¼‰ å®‰è£…Realmå®‰è£…ä¸ºGradleæ’ä»¶ã€‚ å°†Realmå®‰è£…ä¸ºGradleæ’ä»¶éœ€è¦ä¸¤ä¸ªæ­¥éª¤ã€‚ æ­¥éª¤1ï¼šå°†ä»¥ä¸‹ç±»è·¯å¾„ä¾èµ–é¡¹æ·»åŠ åˆ°é¡¹ç›®çº§build.gradleæ–‡ä»¶ã€‚ 12345678buildscript { repositories { jcenter() } dependencies { classpath \"io.realm:realm-gradle-plugin:3.0.0\" }} é¡¹ç›®çº§çš„build.gradleçš„ä½ç½®å¦‚ä¸‹ æ­¥éª¤2ï¼šå°†realm-androidæ’ä»¶åº”ç”¨åˆ°åº”ç”¨ç¨‹åºçº§build.gradleæ–‡ä»¶çš„é¡¶éƒ¨ã€‚åº”ç”¨ç¨‹åºçº§çš„build.gradleçš„ä½ç½®å¦‚ä¸‹ ä¸€æ—¦è¿™ä¸¤ä¸ªæ›´æ”¹å®Œæˆï¼Œåªéœ€åˆ·æ–°ä½ çš„gradleä¾èµ–é¡¹ã€‚ å¦‚æœä½ ä»v0.88ä¹‹å‰çš„ç‰ˆæœ¬å‡çº§ï¼Œä½ å¯èƒ½è¿˜éœ€è¦æ¸…æ´gradleé¡¹ç›®ï¼ˆ./gradlew cleanï¼‰ä»¥åˆ é™¤ä»»ä½•é—ç•™çš„ä»¥å‰çš„å®‰è£…ã€‚ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸¤ä¸ªä¿®æ”¹çš„build.gradleæ–‡ä»¶çš„ç¤ºä¾‹ï¼š é¡¹ç›®çº§build.gradle åº”ç”¨ç¨‹åºçº§build.gradle å…¶ä»–æ„å»ºç³»ç»Ÿä¸æ”¯æŒMavenï¼†Antæ„å»ºç³»ç»Ÿã€‚ å¦‚æœä½ å¸Œæœ›çœ‹åˆ°è¿™äº›æ„å»ºç³»ç»Ÿçš„æ”¯æŒï¼Œè¯·è¡¨è¾¾ä½ å¯¹ä»¥ä¸‹é—®é¢˜çš„å…´è¶£ï¼Œç„¶åæˆ‘ä»¬ä¼šæƒè¡¡æ˜¯å¦éœ€è¦æ·»åŠ è¿™ç§æ”¯æŒã€‚ Mavenæ”¯æŒ Ant æ”¯æŒ ä½ çš„æ„è§å°†å†³å®šæˆ‘ä»¬æ˜¯å¦ä»¥åŠä½•æ—¶å®ç°Antå’ŒMavenæ’ä»¶ã€‚ ä»v1.0.0èµ·ï¼Œä¸æ”¯æŒEclipseã€‚ æˆ‘ä»¬å»ºè®®è¿ç§»åˆ°Android Studioã€‚ ProGuardProGuardé…ç½®ä½œä¸ºRealmåº“çš„ä¸€éƒ¨åˆ†æä¾›ã€‚ è¿™æ„å‘³ç€ä½ ä¸éœ€è¦ä¸ºRealmé…ç½®ä»»ä½•ProGuardè§„åˆ™ã€‚ Realm æµè§ˆå™¨æˆ‘ä»¬æä¾›ç‹¬ç«‹çš„Realmæµè§ˆå™¨ï¼Œç”¨äºè¯»å–å’Œç¼–è¾‘Realmæ•°æ®åº“ ä½ å¯ä»¥ä½¿ç”¨èœå•é¡¹â€œ Tools &gt; Generate demo database â€ç”Ÿæˆå¸¦æœ‰ç¤ºä¾‹æ•°æ®çš„æµ‹è¯•æ•°æ®åº“ã€‚ å¦‚æœä½ åœ¨æŸ¥ä½ çš„åº”ç”¨ç¨‹åºçš„Realmæ–‡ä»¶ä¸Šé‡åˆ°äº†é—®é¢˜ï¼Œå°±å»çœ‹ä¸‹StackOverflowç­”æ¡ˆè¯¦ç»†è¯´æ˜ã€‚ Realmæµè§ˆå™¨å¯ä»¥åœ¨Mac App Storeä¸Šæ‰¾åˆ°ï¼Œä¹Ÿå¯ä»¥ä»æˆ‘ä»¬GitHubé¡µé¢ä¸‹è½½ã€‚ æµè§ˆå™¨ç›®å‰ä¸èƒ½åœ¨Windowsæˆ–Linuxä¸Šè¿è¡Œã€‚ åœ¨è¿™äº›å¹³å°ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨Stetho-Realmã€‚ Stethoæ˜¯ç”±Facebookåˆ›å»ºçš„Chromeæµè§ˆå™¨çš„Androidè°ƒè¯•æ¡¥ã€‚ APIæŒ‡å—æƒ³çŸ¥é“å…³äºç±»ã€æ–¹æ³•å’Œå…¶ä»–å†…å®¹ï¼Œè¯·æŸ¥é˜…APIæŒ‡å— ç¤ºä¾‹çœ‹çœ‹æˆ‘ä»¬çš„ä¾‹å­ï¼Œçœ‹çœ‹Realmåœ¨åº”ç”¨ç¨‹åºä¸­æ˜¯å¦‚ä½•å®è·µã€‚ æœ‰å…³å¦‚ä½•è¿è¡Œç¤ºä¾‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ­¤å¤„ã€‚ introExampleåŒ…å«å¦‚ä½•ä½¿ç”¨å½“å‰APIçš„ç®€å•ç¤ºä¾‹ã€‚ gridViewExampleæ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œæ˜¾ç¤ºå¦‚ä½•ä½¿ç”¨Realmä½œä¸ºGridViewçš„åå°å­˜å‚¨ã€‚ å®ƒè¿˜æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨GSONä½¿ç”¨JSONå¡«å……æ•°æ®åº“ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ABIæ‹†åˆ†å°†æœ€ç»ˆAPKçš„å¤§å°æœ€å°åŒ–ã€‚ threadExampleæ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œæ˜¾ç¤ºå¦‚ä½•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨Realmã€‚ adapterExampleæ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨RealmBaseAdapterå’ŒRealmRecyclerViewAdapteræ¥ä½¿Realmä»¥ä¼˜é›…çš„æ–¹å¼ä¸Android ListViewå’ŒRecyclerViewä¸€èµ·å·¥ä½œã€‚ jsonExampleè¯´æ˜äº†å¦‚ä½•ä½¿ç”¨æ–°çš„Realm JSONåŠŸèƒ½å‘¢ã€‚ encryptionExampleæ˜¾ç¤ºå¦‚ä½•ä½¿ç”¨åŠ å¯†çš„Realmsã€‚ rxJavaExamplesæ˜¾ç¤ºäº†Realmå¦‚ä½•ä¸RxJavaä¸€èµ·å·¥ä½œã€‚ unitTestExampleæ˜¾ç¤ºäº†å¦‚ä½•åœ¨ä½¿ç”¨Realmæ—¶ç¼–å†™å•å…ƒæµ‹è¯•ã€‚","link":"/2017/03/03/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Getting Startedï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Migrations & Encryption & Working With Androidï¼ˆè¯‘æ–‡ï¼‰","text":"è¿ç§»ï¼ˆMigrationsï¼‰æ‰€æœ‰æ•°æ®åº“éƒ½è¦å¤„ç†æ¨¡å‹æ”¹å˜çš„æƒ…å†µã€‚Realm çš„æ•°æ®æ¨¡å‹ç”¨æ ‡å‡† Java å¯¹è±¡æ¥å®šä¹‰ï¼Œæ”¹å˜Schemeå’Œæ”¹å˜æ•°æ®RealmObjectå­ç±»å¯¹åº”çš„æœºæ„ä¸€æ ·å®¹æ˜“ã€‚ å¦‚æœæ²¡æœ‰æ—§ Realm æ•°æ®æ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆä»£ç çš„æ”¹å˜å³ä¼šååº”åˆ°ç›¸åº”çš„ Realm æ•°æ®æ–‡ä»¶æ”¹å˜ã€‚ä½†å¦‚æœå·²ç»æœ‰æ—§ç‰ˆæœ¬çš„ Realm æ•°æ®æ–‡ä»¶å­˜åœ¨ï¼ŒRealm ä¼šæŠ›å‡ºå¼‚å¸¸æç¤ºæ•°æ®åº“æ–‡ä»¶éœ€è¦è¿ç§»ã€‚è¯·åœ¨ç›¸åº”çš„ RealmConfiguration è®¾ç½® schema ç‰ˆæœ¬å’Œ migration ä»£ç æ¥æ­£ç¡®å¤„ç†å¹¶é¿å…è¯¥å¼‚å¸¸æŠ›å‡ºã€‚ 1234RealmConfiguration config = new RealmConfiguration.Builder() .schemaVersion(2) // Must be bumped when the schema changes .migration(new MyMigration()) // Migration to run instead of throwing an exception .build() å¦‚ä¸Šç¤ºä¾‹ä½¿å¾—ç›¸åº”çš„ migration ä»£ç åœ¨è¿ç§»éœ€è¦çš„æ—¶å€™è¢«è‡ªåŠ¨æ‰§è¡Œã€‚æˆ‘ä»¬æä¾›äº†ç›¸å…³ API ç”¨æ¥å‡çº§å·²ä¿å­˜çš„ schema ä»¥åŠå¯¹åº”ä¹‹å‰ schema çš„æ•°æ®ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041// Example migration adding a new classRealmMigration migration = new RealmMigration() { @Override public void migrate(DynamicRealm realm, long oldVersion, long newVersion) { // DynamicRealm exposes an editable schema RealmSchema schema = realm.getSchema(); // Migrate to version 1: Add a new class. // Example: // public Person extends RealmObject { // private String name; // private int age; // // getters and setters left out for brevity // } if (oldVersion == 0) { schema.create(\"Person\") .addField(\"name\", String.class) .addField(\"age\", int.class); oldVersion++; } // Migrate to version 2: Add a primary key + object references // Example: // public Person extends RealmObject { // private String name; // @PrimaryKey // private int age; // private Dog favoriteDog; // private RealmList&lt;Dog&gt; dogs; // // getters and setters left out for brevity // } if (oldVersion == 1) { schema.get(\"Person\") .addField(\"id\", long.class, FieldAttribute.PRIMARY_KEY) .addRealmObjectField(\"favoriteDog\", schema.get(\"Dog\")) .addRealmListField(\"dogs\", schema.get(\"Dog\")); oldVersion++; } }} è¯·æŸ¥é˜…è¿™ä¸ªæ•°æ®è¿ç§»ä¾‹å­æ¥è·å–è¿™æ–¹é¢çš„ç»†èŠ‚ã€‚ å¦‚æœæ²¡æœ‰æ—§ Realm æ•°æ®æ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆè¿ç§»å¹¶ä¸éœ€è¦ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒRealm ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä»¥ .realm ä¸ºåç¼€ï¼ŒåŸºäºæ–°çš„å¯¹è±¡æ¨¡å‹çš„æ•°æ®æ–‡ä»¶ã€‚åœ¨å¼€å‘å’Œè°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå‡å¦‚ä½ éœ€è¦é¢‘ç¹æ”¹å˜æ•°æ®æ¨¡å‹ï¼Œå¹¶ä¸”ä¸ä»‹æ„æŸå¤±æ—§æ•°æ®ï¼Œä½ å¯ä»¥ç›´æ¥åˆ é™¤ .realm æ–‡ä»¶ï¼ˆè¿™é‡ŒåŒ…å«æ‰€æœ‰çš„æ•°æ®ï¼ï¼‰è€Œä¸ç”¨å…³å¿ƒè¿ç§»çš„é—®é¢˜ã€‚è¿™åœ¨ä½ åº”ç”¨çš„å¼€å‘æ—©æœŸé˜¶æ®µéå¸¸æœ‰ç”¨ã€‚ 1234RealmConfiguration config = new RealmConfiguration.Builder() .deleteRealmIfMigrationNeeded() .build() åŠ å¯† è¯·æ³¨æ„æˆ‘ä»¬çš„è®¸å¯è¯çš„å‡ºå£åˆè§„æ€§éƒ¨åˆ†ï¼Œå› ä¸ºå¦‚æœä½ ä½äºä»ç¾å›½å‡ºå£é™åˆ¶æˆ–ç¦è¿çš„å›½å®¶ï¼Œåˆ™ä¼šé™åˆ¶ä½¿ç”¨Realmã€‚ Realm æ–‡ä»¶å¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ª512ä½ï¼ˆ64å­—èŠ‚ï¼‰çš„å¯†é’¥å‚æ•°ç»™ Realm.getInstance().encryptionKey() æ¥åŠ å¯†å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚ 123456byte[] key = new byte[64];new SecureRandom().nextBytes(key);RealmConfiguration config = new RealmConfiguration.Builder() .encryptionKey(key) .build();Realm realm = Realm.getInstance(config); è¿™ä¿è¯äº†æ‰€æœ‰æ°¸ä¹…æ€§å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ•°æ®éƒ½æ˜¯é€šè¿‡æ ‡å‡† AES-256 åŠ å¯†çš„ã€‚æ¯æ¬¡åˆ›å»ºæ–°çš„ Realm å®ä¾‹çš„æ—¶å€™ï¼Œéƒ½éœ€è¦æä¾›ç›¸åŒçš„å¯†é’¥ã€‚ å‚è€ƒ examples/encryptionExampleã€‚è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ Android KeyStore æ¥å®‰å…¨åœ°å­˜å‚¨å¯†é’¥ã€‚ ä¸ Android ç›¸å…³Realm å¯ä»¥æ— ç¼åœ°å¼•å…¥å®‰å“å¼€å‘ã€‚ä½ éœ€è¦è°¨è®° RealmObject çš„çº¿ç¨‹é™åˆ¶ã€‚å½“ä½ éœ€è¦è·¨ activityã€serviceæˆ–è€… broadcast receiver ä¼ é€’ Realm å¯¹è±¡çš„æ—¶å€™ï¼Œè¯·ç‰¢è®°è¿™ä¸€ç‚¹. åŸæ–‡åœ°å€https://realm.io/docs/java/latest/#migrations","link":"/2017/03/16/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Migrations & Encryption & Working With Androidï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠKotlinã€‹ Android Studio3.0 Kotlinå·¥ç¨‹é—®é¢˜é›†","text":"é—®é¢˜1: æ–°å»ºæ”¯æŒKotlinçš„Androidé¡¹ç›®ï¼Œå¡åœ¨â€œResolve dependency :classpathâ€è§£å†³åˆ†æï¼šä¸€èˆ¬ç¢°åˆ°â€œResolve dependency :classpathâ€å¡ç€ä¸€åŠ¨ä¸åŠ¨çš„ï¼Œç­‰ä¸€ä¼šå¦‚æœè¿˜æ˜¯æ²¡ååº”ï¼Œåº”è¯¥å°±æ˜¯æ°¸è¿œæ²¡ååº”ã€‚å…ˆé‡å¯ä¸‹Android Studioæˆ–è€…é‡æ–°gradle syncä¸€ä¸‹ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œçœ‹ä¸‹å·¥ç¨‹ä¸­â€œgradle-wrapper.propertiesâ€ä¸­çš„gradleç‰ˆæœ¬ï¼Œç„¶åå»ç³»ç»Ÿ.gradle ç›®å½•ä¸‹çœ‹ä¸‹å¯¹åº”çš„gradle æ˜¯å¦å·²ç»ä¸‹è½½OK æˆ‘è¿™é‡Œæ˜¯åœ¨å®¶ç›®å½•ä¸‹çš„.gradle/wrapper/distsä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›Gradleç‰ˆæœ¬ï¼Œæ‰¾åˆ°ä½ æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬ã€‚è¿›å…¥åå¯ä»¥çœ‹åˆ°ä¸€ä¸²å¾ˆé•¿çš„æ–‡ä»¶åï¼Œç»§ç»­è¿›å…¥ å¦‚ä¸Šå¯ä»¥çœ‹åˆ°ä¸€äº›æ–‡ä»¶ï¼Œå¦‚æœæœ‰å®Œæ•´çš„.zipåŒ…å’Œ.okæ–‡ä»¶å°±è¯´æ˜å¯¹åº”çš„gradleç‰ˆæœ¬æ˜¯ä¸‹è½½OKçš„ï¼›å¦‚æœæ²¡æœ‰ä¸‹è½½å®Œï¼ŒASä¸­è¿›è¡Œæ„å»ºçš„æ—¶å€™ï¼Œä½ å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°ç›®å½•ä¸‹æœ‰ä¸ªæ–‡ä»¶çš„å¤§å°åœ¨é€æ¸å¢åŠ ï¼Œè¿™å°±è¯´æ˜æ­£åœ¨æ‰§è¡Œgradle ç‰ˆæœ¬çš„ä¸‹è½½ä»»åŠ¡ï¼Œå¯ä»¥è€å¿ƒç­‰å¾…ä¸‹ï¼Œå¦‚æœæ˜¯ä¸‹è½½OKçš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¸€ç›´å¡åœ¨â€œResolve dependency :classpathâ€ï¼Œå°±æ˜¯æˆ‘ä»Šå¤©ç”¨AS3.0 æ„å»ºKotliné¡¹ç›®çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜ï¼Œä½ å°±å¯ä»¥çœ‹çœ‹ä½ çš„build.gradleæ–‡ä»¶ä¸­ï¼Œæ˜¯å¦åˆä¸å¸¸è§çš„dependencyã€‚å°±å¦‚Kotlinå·¥ç¨‹ä¸­å°±æ˜¯ä½¿ç”¨åˆ° 12345repositories { maven { url \"https://maven.google.com\" }} è¿™ä¸ªåœ¨å¢™å†…æ˜¯æ— æ³•è®¿é—®çš„ã€‚æˆ‘çŒœæƒ³å°±æ˜¯è¿™ä¸ªå¯¼è‡´çš„ï¼Œæ¢æˆaliyun mavenæˆ–è€…å…¶ä»–å›½å†…å¯è®¿é—®çš„mavenåï¼Œä¸ä¼šå¡ä½äº†ï¼Œå…³äºAndroid Studioä¸­é…ç½®aliyun Maven ,è¯·å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšæ–‡ã€‚ é—®é¢˜2:â€œUnable to find method â€˜com.android.build.gradle.internal.variant.BaseVariantData.getOutput()Ljava/util/Listâ€™â€è§£å†³åŠæ³•ï¼škotlinç‰ˆæœ¬è°ƒæ•´ï¼Œä¹‹å‰æ˜¯1.1.2-3ï¼Œæ¢æˆ1.1.2-4 1ext.kotlin_version = '1.1.2-4' é—®é¢˜3:â€œDeclaring custom â€˜cleanâ€™ task when using the standard Gralde lifecycle plugins is not allowedâ€è§£å†³æ–¹æ³•ï¼š æŠŠbuild.gradleä¸­çš„clean task æ— æƒ…åœ°æ³¨é‡Šæ‰ã€‚ 123//task clean(type: Delete) {// delete rootProject.buildDir//} é—®é¢˜4: build.gradleæ–‡ä»¶ä¸­â€def outputFile = output.outputFileâ€æŠ¥é”™â€Not validâ€ï¼Œå¦‚å›¾ å‡ºé”™ä»£ç ï¼Œå¦‚ä¸‹ç¬¬39è¡Œ è§£å†³åŠæ³•ï¼šæŸ¥é˜…å®˜ç½‘ï¼šhttps://developer.android.google.cn/studio/preview/features/new-android-plugin-migration.html#variant_api ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹ 1234567891011// If you use each() to iterate through the variant objects,// you need to start using all(). That's because each() iterates// through only the objects that already exist during configuration timeâ€”// but those object don't exist at configuration time with the new model.// However, all() adapts to the new model by picking up object as they are// added during execution.android.applicationVariants.all { variant -&gt; variant.outputs.all { outputFileName = \"${variant.name}-${variant.versionName}.apk\" }} å‚è€ƒï¼šhttps://stackoverflow.com/questions/44239235/android-gradle-3-0-0-alpha2-plugin-cannot-set-the-value-of-read-only-property","link":"/2017/05/21/ã€ŠKotlinã€‹ Android Studio3.0 Kotlinå·¥ç¨‹é—®é¢˜é›†/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Threadingï¼ˆè¯‘æ–‡ï¼‰","text":"çº¿ç¨‹å…¶å®å¯¹äºè·¨çº¿ç¨‹ä½¿ç”¨ Realmï¼Œä½ éœ€è¦çŸ¥é“çš„äº‹æƒ…å¹¶ä¸å¤šã€‚å…³é”®ç‚¹æ˜¯å¾—ç›Šäºå¯¹è±¡å’ŒæŸ¥è¯¢çš„å³æ—¶æ›´æ–°ç‰¹æ€§ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒæ•°æ®åœ¨å¤šçº¿ç¨‹æ—¶çš„ä¸€è‡´æ€§å’Œæ•ˆç‡é—®é¢˜ã€‚ ä½ å¯ä»¥å®æ—¶åœ¨ä¸åŒçº¿ç¨‹ä¸­è¯»å–å’Œå†™å…¥ Realm å¯¹è±¡ï¼Œä¸ç”¨æ‹…å¿ƒå…¶å®ƒçº¿ç¨‹ä¼šå¯¹åŒä¸€å¯¹è±¡è¿›è¡Œæ“ä½œã€‚ä½ éœ€è¦åœ¨æ”¹å˜å¯¹è±¡æ—¶ä½¿ç”¨äº‹åŠ¡ï¼Œåœ¨å¦ä¸€çº¿ç¨‹ä¸­æŒ‡å‘åŒä¸€å¯¹è±¡çš„æ•°æ®ä¼šè¢«å³æ—¶æ›´æ–°ï¼ˆæ›´æ–°ä¼šåœ¨ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯æ—¶è¿›è¡Œï¼‰ã€‚ å”¯ä¸€å±€é™æ˜¯ä½ ä¸èƒ½éšæ„è·¨çº¿ç¨‹ä¼ é€’ Realm å¯¹è±¡ã€‚å¦‚æœä½ åœ¨å¦ä¸€çº¿ç¨‹ä½¿ç”¨åŒä¸€å¯¹è±¡ï¼Œè¯·åœ¨å“ªä¸ªçº¿ç¨‹ä½¿ç”¨æŸ¥è¯¢é‡æ–°è·å¾—è¯¥å¯¹è±¡ã€‚è¯·è°¨è®°æ‰€æœ‰çš„ Realm å¯¹è±¡éƒ½ä¼šåœ¨ä¸åŒçº¿ç¨‹ä¸­ä¿æŒæ›´æ–°â€”â€”Realm ä¼šåœ¨æ•°æ®æ”¹å˜æ—¶é€šçŸ¥ä½ ã€‚ å‚è€ƒå¦‚ä¸‹å®ä¾‹ã€‚ Realmçº¿ç¨‹å®ä¾‹å‡è®¾æˆ‘ä»¬çš„åº”ç”¨è¦å±•ç¤ºä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªåå°çº¿ç¨‹ä¸­ï¼ˆä¸€ä¸ªå®‰å“ IntentServiceï¼‰ä»è¿œç«¯è·å–æ–°ç”¨æˆ·å¹¶å°†å®ƒä»¬å­˜å‚¨åˆ° Realm ä¸­ã€‚ä½†åå°çº¿ç¨‹å­˜å‚¨æ–°ç”¨æˆ·æ—¶ï¼ŒUI çº¿ç¨‹ä¸­çš„æ•°æ®ä¼šè¢«è‡ªåŠ¨æ›´æ–°ã€‚UI çº¿ç¨‹ä¼šé€šè¿‡ RealmChangeListener å¾—åˆ°é€šçŸ¥ï¼Œè¿™æ—¶ UI çº¿ç¨‹åº”åˆ·æ–°ç›¸åº”çš„æ§ä»¶ã€‚å› ä¸º Realm çš„è‡ªåŠ¨æ›´æ–°ç‰¹æ€§ï¼Œæ— éœ€é‡æ–°æŸ¥è¯¢æ•°æ®ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243// in a Fragment or Activity, etc@Overridepublic void onActivityCreated(Bundle savedInstanceState) { // ... boilerplate omitted for brevity realm = Realm.getDefaultInstance(); // get all the customers RealmResults&lt;Customer&gt; customers = realm.where(Customer.class).findAllAsync(); // ... build a list adapter and set it to the ListView/RecyclerView/etc // set up a Realm change listener changeListener = new RealmChangeListener() { @Override public void onChange(RealmResults&lt;Customer&gt; results) { // This is called anytime the Realm database changes on any thread. // Please note, change listeners only work on Looper threads. // For non-looper threads, you manually have to use Realm.waitForChange() instead. listAdapter.notifyDataSetChanged(); // Update the UI } }; // Tell Realm to notify our listener when the customers results // have changed (items added, removed, updated, anything of the sort). customers.addChangeListener(changeListener);}// In a background service, in another threadpublic class PollingService extends IntentService { @Override public void onHandleIntent(Intent intent) { Realm realm = Realm.getDefaultInstance(); try { // go do some network calls/etc and get some data and stuff it into a 'json' var String json = customerApi.getCustomers(); realm.beginTransaction(); realm.createObjectFromJson(Customer.class, json); // Save a bunch of new Customer objects realm.commitTransaction(); // At this point, the data in the UI thread is already up to date. // ... } finally { realm.close(); } } // ...} ä¸€æ—¦åå°æœåŠ¡æ·»åŠ äº†æ–°ç”¨æˆ·ï¼Œcustomer åˆ—è¡¨ä¼šè¢«è‡ªåŠ¨æ›´æ–°ï¼Œä¸éœ€è¦ä½ çš„ä»»ä½•åŠ¨ä½œã€‚å¯¹äºå•ä¸ªçš„ RealmObject ä¹Ÿæ˜¯åŒæ ·ã€‚å‡è®¾ä½ éœ€è¦ç®¡ç†ä¸€ä¸ª Realm å¯¹è±¡ï¼Œåªéœ€è¦åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ›´æ–°å®ƒçš„æ•°æ®ï¼ŒUI çº¿ç¨‹ä¼šè‡ªåŠ¨å¾—åˆ°æ›´æ–°åçš„æ•°æ®ã€‚å¦‚æœä½ éœ€è¦å¯¹æ•°æ®æ›´æ–°ä½œå‡ºå›åº”ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª listenerï¼Œå°±åƒæˆ‘ä»¬åœ¨ä»¥ä¸Šä»£ç ä¸­æ‰€ä½œçš„ä¸€æ ·ã€‚ è¿™å°±æ˜¯æ‰€æœ‰å•¦ã€‚ è·¨çº¿ç¨‹ä½¿ç”¨ Realmè¯·è°¨è®°ï¼šRealmã€RealmObject å’ŒRealmResults å®ä¾‹éƒ½ä¸å¯ä»¥è·¨çº¿ç¨‹ä½¿ç”¨ã€‚ä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨å¼‚æ­¥æŸ¥è¯¢å’Œå¼‚æ­¥äº‹åŠ¡æ¥å°†éƒ¨åˆ†æ“ä½œæ”¾å…¥åå°çº¿ç¨‹è¿›è¡Œï¼Œå¾…å®Œæˆæ—¶è°ƒç”¨çº¿ç¨‹è¢«é€šçŸ¥ä»¥è·å–ç»“æœã€‚ å½“ä½ éœ€è¦è·¨çº¿ç¨‹è®¿é—®åŒä¸€éƒ¨åˆ†æ•°æ®æ—¶ï¼Œåªéœ€ç®€å•åœ°åœ¨è¯¥çº¿ç¨‹é‡æ–°è·å–ä¸€ä¸ª Realm å®ä¾‹ï¼ˆä¾‹å¦‚ï¼šRealm.getInstance(RealmConfiguration config) æˆ–æ˜¯å…¶ä»–ç±»ä¼¼æ–¹æ³•ï¼‰ï¼Œç„¶åé€šè¿‡è¿™ä¸ª Realm å®ä¾‹æ¥æŸ¥è¯¢è·å¾—ä½ éœ€è¦çš„æ•°æ®ã€‚æŸ¥è¯¢è·å¾—çš„å¯¹è±¡ä¼šæ˜ å°„åˆ° Realm ä¸­çš„ç›¸åŒæ•°æ®ï¼Œç”±æ­¤æ–¹æ³•è·å¾—å¯¹è±¡åœ¨å…¶çº¿ç¨‹ä¸­ä»»ä½•åœ°æ–¹éƒ½å¯è¯»å†™ åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#threading","link":"/2017/03/10/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Threadingï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠKotlinã€‹ Kotlin For Gank.io (å¹²è´§é›†ä¸­è¥Kotlinå®ç°)","text":"ä»‹ç»Kotlinï¼Œç°åœ¨å¦‚ç«å¦‚è¼ï¼Œæ‰€ä»¥èŠ±äº†ä¸€ç‚¹æ—¶é—´æŠŠä¹‹å‰çš„é¡¹ç›®ç”¨Kotliné‡æ„ä¸€ä¸‹ åŸé¡¹ç›®åœ°å€ï¼šhttps://github.com/onlyloveyd/GankIOClientå¯¹åº”Kotlinç‰ˆï¼šhttps://github.com/onlyloveyd/GankIOWithKotlin å¹²è´§æ•°æ®æºåº”ç”¨ä¸­çš„æ‰€æœ‰å¹²è´§æ•°æ®å‡æ¥è‡ªå¹²è´§é›†ä¸­è¥ã€‚ Appè®¾è®¡è‰²è°ƒï¼šè¿œå·é¼ ã€è½æ —ã€è‹èŠ³ã€çŸ³ç«¹ã€æ¯è‰ã€æŸ³ç…¤ç«¹èŒ¶ã€é”–é’ç£ã€é¸ ç¾½ç´«å…«ç§æ·¡é›…çš„é¢œè‰²ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„å¹²è´§æ•°æ®ã€‚å¸ƒå±€ï¼šç®€çº¦é£æ ¼ï¼Œæç®€ä¸»ä¹‰ï¼Œå»ç¹å°±ç®€ã€‚æ’ç‰ˆï¼šæœ€ç®€å•çš„Toolbar + RecyclerView UIè®¾è®¡ é»‘ç™½ç° åœ†è§’ ææ–™è®¾è®¡ ä»£ç è®¾è®¡ Retrofit+RxJava çš„ç»„åˆè·å–ç½‘ç»œæ•°æ®; FlycoTabLayoutä½œä¸ºä¸»ç•Œé¢ç»“æ„ï¼Œé…åˆFragmentï¼Œå®ç°â€œæ¯æ—¥å¹²è´§â€ï¼Œâ€œåˆ†ç±»æ•°æ®â€ï¼Œâ€œå¦¹çº¸å›¾ç‰‡â€å’Œå…³äºå››ä¸ªç•Œé¢; BGARefreshLayouté…åˆRecyclerViewå’Œè‡ªå®šä¹‰å¤šç±»å‹Itemç»“æ„å®ç°å¹²è´§æ•°æ®çš„å±•ç¤º MaterialAboutä½œä¸ºâ€œå…³äºâ€ç•Œé¢çš„åŸºç¡€ Glideä½œä¸ºå›¾ç‰‡åŠ è½½æ¡†æ¶ RxJava+Retrofité…åˆfir.imçš„æ¥å£å®ç°ç‰ˆæœ¬æ›´æ–°åŠŸèƒ½ ShareåŠŸèƒ½å…¨éƒ¨é‡‡ç”¨ç³»ç»Ÿè‡ªå¸¦ï¼ŒåŸºæœ¬å¯ä»¥æ»¡è¶³éœ€æ±‚ ButterKnifeæ³¨è§£åº“ Gsonä½œä¸ºjsonæ•°æ®è§£æåº“ ä¾èµ–åº“ Glide RxAndroid RxJava Retrofit okhttp3 Gson ButterKnife BGARefreshLayout-Android FlycoTabLayout MaterialAbout æ•ˆæœ","link":"/2017/05/20/ã€ŠKotlinã€‹ Kotlin For Gank.io (å¹²è´§é›†ä¸­è¥Kotlinå®ç°)/"},{"title":"ã€ŠKotlinã€‹ Getting started with Android and Kotlin (è¯‘æ–‡)","text":"åŸæ–‡é“¾æ¥http://kotlinlang.org/docs/tutorials/kotlin-android.html å†™åœ¨å‰é¢Kotlin æ˜¯ä¸€ä¸ªåŸºäº JVM çš„æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œç”± JetBrains å¼€å‘ã€‚ä»Šå¤©å‡Œæ™¨Google I/O ä¸Šï¼ŒGoogleå®˜æ–¹è¡¨ç¤ºäº†å¯¹Kotlinè¯­è¨€çš„æ”¯æŒã€‚æ‰€ä»¥å†³å®šä»Šå¤©å¼€å§‹å…¥å‘ï¼Œå­¦ä¹ Kotlin. Kotlinåœ¨Androidä¸Šçš„ä½¿ç”¨å…¥é—¨å®‰è£…Kotlinæ’ä»¶Kotlinæ’ä»¶ä»3.0ç‰ˆæœ¬å¼€å§‹å’ŒAndroid Studioç»‘å®šã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä½ å°±éœ€è¦æ‰‹åŠ¨å®‰è£…Kotlinæ’ä»¶ã€‚ç‚¹å‡»â€œFIleâ€-&gt;â€Settingsâ€-&gt;â€Plugins â€œ-&gt;â€Install JetBrains pluginâ€¦â€, ç„¶åæœç´¢Kotlinå¹¶å®‰è£…ã€‚å¦‚æœä½ åœ¨â€œWelcome to Android Studioâ€ç•Œé¢ï¼Œé€‰æ‹© â€œConfigureâ€œ-&gt;â€Pluginsâ€-&gt;â€Install JetBrains pluginâ€¦ â€œ,ç„¶åæœç´¢Kotliniå¹¶å®‰è£…ã€‚å®‰è£…å®Œæˆåéœ€è¦é‡å¯IDEã€‚ åˆ›å»ºé¡¹ç›®å¼€å§‹ä½¿ç”¨Kotlinè¿›è¡ŒAndroidå¼€å‘æ˜¯éå¸¸å®¹æ˜“çš„ã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Android Studioè¿›è¡Œæ“ä½œã€‚ å¦‚æœä½¿ç”¨Intellij IDEAå¼€å‘Androidï¼Œè¿™ä¸ªè¿‡ç¨‹å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚é¦–å…ˆè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ã€‚ é€‰æ‹© â€œStart a new Android Studio projectâ€æˆ–è€…â€œFileâ€-&gt;â€New projectâ€ã€‚ ä»¥ä¸‹å¯¹è¯æ¡†å°†å¼•å¯¼ä½ å®Œæˆæ–°é¡¹ç›®åˆ›å»ºè¿‡ç¨‹ã€‚ ä½ éœ€è¦ä¸ºé¡¹ç›®å‘½åï¼Œå¹¶é€‰æ‹©ä½ å®‰è£…çš„Android SDKç‰ˆæœ¬ã€‚ å¤§å¤šæ•°é€‰é¡¹å¯ä»¥ä¿ç•™å…¶é»˜è®¤å€¼ï¼Œå› æ­¤ä½ åªéœ€è¦æŒ‰å‡ æ¬¡â€œEnterâ€ã€‚ å‘½åé¡¹ç›®:Android Studio 3.0åœ¨ä¸Šé¢è¿™ä¸ªç•Œé¢ä¸Šå›æä¾›ä¸€ä¸ªå¯ç”¨Kotlinæ”¯æŒçš„é€‰é¡¹ã€‚å‹¾é€‰ä¸Šè¿™ä¸ªé€‰é¡¹ä½ å°±å¯ä»¥è·³è¿‡ä¸‹é¢çš„â€œåœ¨é¡¹ç›®ä¸­é…ç½®Kotlinâ€æ­¥éª¤ã€‚ é€‰æ‹©Androidç‰ˆæœ¬: é€‰æ‹©ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„Activity: å‘½åActivity: åœ¨Android Studio3.0ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡èœå•é€‰é¡¹æ–°å»ºKotlin Activity,è¿™æ ·çš„è¯ï¼Œä½ å°±å¯ä»¥è·³è¿‡ä¸‹é¢â€œè½¬æ¢Javaä»£ç ä¸ºKotlinâ€æ­¥éª¤ã€‚ä½äº3.0çš„ç‰ˆæœ¬ï¼Œéœ€è¦ä½¿ç”¨javaåˆ›å»ºactivityï¼Œç„¶åç”¨è‡ªåŠ¨è½¬æ¢å·¥å…·å°†å…¶è½¬æ¢æˆ Kotlinã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¼€å§‹ä½¿ç”¨Kotlinçš„æœ€ç®€å•æ–¹æ³•æ˜¯å°†Java Activityè‡ªåŠ¨è½¬æ¢ä¸ºKotlinã€‚ è¯·æ³¨æ„ï¼Œæ— è®ºä½•æ—¶ï¼Œä¸å…¶é€šè¿‡æŸ¥é˜…æ–‡æ¡£æ¥å¯»æ‰¾ç”¨Kotlinè¡¨å•æ—§çš„è¡¨è¾¾å¼çš„æ–¹å¼ï¼Œä¸å¦‚ç›´æ¥å…ˆä½¿ç”¨Javaç¼–å†™å®ƒï¼Œç„¶åå°†Javaä»£ç å¤åˆ¶ç²˜è´´åˆ°Kotlinæ–‡ä»¶ä¸­ï¼ŒIntelliJ IDEAï¼ˆæˆ–Android Studioï¼‰ä¼šå»ºè®®æˆ‘ä»¬è½¬æ¢ï¼Œç„¶åå°±å¯ä»¥è‡ªåŠ¨è½¬æ¢æˆKotlinã€‚ è½¬æ¢Javaä»£ç ä¸ºKotlinæ‰“å¼€MainActivity.javaæ–‡ä»¶ã€‚ç„¶åè°ƒç”¨åŠ¨ä½œå°†Javaæ–‡ä»¶è½¬æ¢ä¸ºKotlinæ–‡ä»¶ã€‚ ä½ å¯ä»¥é€šè¿‡å‡ ç§æ–¹æ³•æ¥å®ç°ã€‚ æœ€ç®€å•çš„ä¸€ä¸ªæ˜¯è°ƒç”¨Find Actionå¹¶å¼€å§‹è¾“å…¥ä¸€ä¸ªåŠ¨ä½œåç§°ï¼ˆå¦‚ä¸‹é¢çš„æˆªå›¾ï¼‰ã€‚ æˆ–è€…ï¼Œæ‚¨å¯ä»¥é€šè¿‡â€œCodeâ€-&gt;â€Convert Java File to Kotlin Fileâ€èœå•é¡¹æˆ–è€…å¯¹åº”çš„å¿«æ·é”®å°†Javaæ–‡ä»¶è½¬æ¢ä¸ºKotlinã€‚ è½¬æ¢å®Œæˆåï¼Œç”¨Kotlinç¼–å†™çš„Activityå°†å‡ºç°åœ¨ä½ çœ¼å‰ åœ¨é¡¹ç›®ä¸­é…ç½®Kotlinå½“ä½ å¼€å§‹ç¼–è¾‘Kotlinæ–‡ä»¶æ—¶ï¼ŒAndroid Studioä¼šå‘æ˜¾ç¤ºKotlinæœªé…ç½®çš„æç¤ºï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä½ éœ€è¦é…ç½®ä¸€ä¸‹ã€‚ ç„¶åç³»ç»Ÿæç¤ºä½ è¾“å…¥Kotlinç‰ˆæœ¬ã€‚ ä»å®‰è£…ç‰ˆæœ¬åˆ—è¡¨ä¸­é€‰æ‹©æœ€æ–°ç‰ˆæœ¬ã€‚ é…ç½®Kotlinåï¼Œåº”ç”¨ç¨‹åºçš„build.gradleæ–‡ä»¶åº”è¯¥ä¼šè¢«æ›´æ–°ä¸€äº›å†…å®¹ã€‚ ç°åœ¨ä½ å¯ä»¥çœ‹åˆ° â€œapply plugin: â€˜kotlin-androidâ€™â€ä»¥åŠä¸€äº›ä¾èµ–é¡¹ã€‚ æœ€åä¸€ä»¶äº‹ä»¶å°±æ˜¯syncé¡¹ç›®ã€‚ æ„å»ºå¹¶å‘å¸ƒä½¿ç”¨Kotlinç¼–å†™çš„Androidåº”ç”¨ç¨‹åºä½ ç°åœ¨å¯ä»¥æ„å»ºåº”ç”¨ç¨‹åºå¹¶åœ¨æ¨¡æ‹Ÿå™¨æˆ–çœŸæœºä¸Šè¿è¡Œå®ƒã€‚ è¿™ä¸Javaä¸­çš„å·¥ä½œæ–¹å¼å®Œå…¨ç›¸åŒã€‚ ä½ å¯ä»¥å‘å¸ƒåº”ç”¨ç¨‹åºï¼Œå¹¶ä»¥ç±»ä¼¼äºä½¿ç”¨Javaç¼–å†™çš„Androidåº”ç”¨ç¨‹åºçš„æ–¹å¼è¿›è¡Œç­¾åã€‚ Kotlinæœ‰ä¸€ä¸ªç›¸å½“å°çš„è¿è¡Œæ—¶æ–‡ä»¶å¤§å°ï¼šåº“å¤§çº¦æ˜¯859KBï¼ˆä»1.1.2-2å¼€å§‹ï¼‰ã€‚ è¿™æ„å‘³ç€Kotlinå¯¹.apkæ–‡ä»¶å¤§å°å¢åŠ äº†ä¸€ç‚¹ã€‚ Kotlinç¼–è¯‘å™¨ç”Ÿæˆå­—èŠ‚ç ï¼Œå› æ­¤Kotlinåº”ç”¨ç¨‹åºä¸Javaç¼–å†™çš„åº”ç”¨ç¨‹åºçš„å¤–è§‚å’Œæ„Ÿè§‰ç¡®å®æ²¡æœ‰å·®åˆ«ã€‚","link":"/2017/05/18/ã€ŠKotlinã€‹ Getting started with Android and Kotlin (è¯‘æ–‡)/"},{"title":"ã€ŠLeetCode-0002ã€‹ ä¸¤æ•°ç›¸åŠ -Add Two Numbers","text":"https://leetcode-cn.com/problems/add-two-numbers/ é¢˜ç›®ç»™å‡ºä¸¤ä¸ª éç©º çš„é“¾è¡¨ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å…¶ä¸­ï¼Œå®ƒä»¬å„è‡ªçš„ä½æ•°æ˜¯æŒ‰ç…§ é€†åº çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”å®ƒä»¬çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ ä¸€ä½ æ•°å­—ã€‚ å¦‚æœï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ•°ç›¸åŠ èµ·æ¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é“¾è¡¨æ¥è¡¨ç¤ºå®ƒä»¬çš„å’Œã€‚ æ‚¨å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0 å¼€å¤´ã€‚ ç¤ºä¾‹ 123è¾“å…¥ï¼š(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)è¾“å‡ºï¼š7 -&gt; 0 -&gt; 8åŸå› ï¼š342 + 465 = 807 æ€è·¯é¢˜ç›®ä¸­åŠ ç²—å…³é”®å­—æ³¨æ„ä¸‹ï¼š éç©º é€†åº ä¸€ä½ è§£é‡Šï¼šé“¾è¡¨ä»å·¦å¾€å³ä¾æ¬¡æ˜¯æ‰€å¾…å˜æ•°å­—çš„ä½ä½åˆ°é«˜ä½ï¼Œ 2 -&gt; 4 -&gt; 3 ä»£è¡¨342ï¼Œ 5 -&gt; 6 -&gt; 4 ä»£è¡¨465ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦å°†é“¾è¡¨è½¬æˆæ•°å­—å†è¿›è¡Œç›¸åŠ ï¼Œä¹Ÿæ²¡æ³•é‚£æ ·åšï¼Œåº”ä¸ºå¦‚æœé“¾è¡¨ç›¸å½“ä¹‹é•¿ï¼Œä¼šè¶…è¿‡æ•´å½¢çš„èŒƒå›´ï¼Œæ‰€ä»¥å°±ä»ä½ä½å¾€é«˜ä½æŒ¨ä¸ªç®—å°±è¡Œäº†ã€‚ é’ˆå¯¹å•æ¬¡è®¡ç®—x+y=zx+y=zx+y=zï¼Œåªéœ€è¦è€ƒè™‘æ˜¯å¦å‘å‰è¿›ä½çš„é—®é¢˜å³å¯ã€‚ ç¬¬ä¸€æ¬¡æäº¤1234567891011121314151617181920212223242526272829303132333435363738/** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode(int x) { val = x; } * } */class Solution { public ListNode addTwoNumbers(ListNode l1, ListNode l2) { ListNode result = new ListNode(0); ListNode current1 = l1, current2 = l2, currentResult = result; int carry = 0; while (current1 != null &amp;&amp; current2 != null) { int val = (current1.val + current2.val + carry) % 10; currentResult.next = new ListNode(val); carry = (current1.val + current2.val + carry) / 10; current1 = current1.next; current2 = current2.next; currentResult = currentResult.next; } while (current1 != null) { int val = (current1.val + carry) % 10; currentResult.next = new ListNode(val); carry = (current1.val + carry) / 10; current1 = current1.next; currentResult = currentResult.next; } while (current2 != null) { int val = (current2.val + carry) % 10; currentResult.next = new ListNode(val); carry = (current2.val + carry) / 10; current2 = current2.next; currentResult = currentResult.next; } return result.next; }} ç¬¬ä¸€æ¬¡æäº¤æœªé€šè¿‡ æµ‹è¯•ç”¨ä¾‹ æˆ‘çš„ç»“æœ é¢„æœŸç»“æœ ï¼»5ï¼½,ï¼»5ï¼½ ï¼»0ï¼½ ï¼»0ï¼Œ1ï¼½ å¿½ç•¥äº†ä¸Šè¿°è¿™ç§ï¼Œç»“æœä½æ•°æ¯”åŠ æ•°ä½æ•°å¤šä¸”å­˜åœ¨è¿›ä½çš„æƒ…å†µ ç¬¬äºŒæ¬¡æäº¤1234567891011121314151617181920212223242526272829303132333435363738394041/** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode(int x) { val = x; } * } */class Solution { public ListNode addTwoNumbers(ListNode l1, ListNode l2) { ListNode result = new ListNode(0); ListNode current1 = l1, current2 = l2, currentResult = result; int carry = 0; while (current1 != null &amp;&amp; current2 != null) { int val = (current1.val + current2.val + carry) % 10; currentResult.next = new ListNode(val); carry = (current1.val + current2.val + carry) / 10; current1 = current1.next; current2 = current2.next; currentResult = currentResult.next; } while (current1 != null) { int val = (current1.val + carry) % 10; currentResult.next = new ListNode(val); carry = (current1.val + carry) / 10; current1 = current1.next; currentResult = currentResult.next; } while (current2 != null) { int val = (current2.val + carry) % 10; currentResult.next = new ListNode(val); carry = (current2.val + carry) / 10; current2 = current2.next; currentResult = currentResult.next; } if(carry!=0) { currentResult.next = new ListNode(carry); } return result.next; }} æ€»ç»“ å……è¶³çš„æµ‹è¯•ç”¨ä¾‹å¾ˆé‡è¦; ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œè¾¹ç•Œæ¡ä»¶ï¼Œç‰¹æ®Šæƒ…å†µä¸€å®šå¾—è€ƒè™‘å……åˆ†ã€‚","link":"/2019/05/26/ã€ŠLeetCode-0002ã€‹ ä¸¤æ•°ç›¸åŠ -Add Two Numbers/"},{"title":"ã€ŠLeetCode-0001ã€‹ ä¸¤æ•°ä¹‹å’Œ-TwoSum","text":"https://leetcode-cn.com/problems/two-sum/ é¢˜ç›®ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œä½ ä¸èƒ½é‡å¤åˆ©ç”¨è¿™ä¸ªæ•°ç»„ä¸­åŒæ ·çš„å…ƒç´ ã€‚ ç¤ºä¾‹ 1234ç»™å®š nums = [2, 7, 11, 15], target = 9å› ä¸º nums[0] + nums[1] = 2 + 7 = 9æ‰€ä»¥è¿”å› [0, 1] æ€è·¯æš´åŠ›æœ€ç®€å•çš„ä¸€ç§æ€è·¯ï¼Œä¸¤å±‚å¾ªç¯ï¼Œä¸¤ä¸¤ç›¸åŠ åä¸targetæ¯”è¾ƒã€‚ä½†æ˜¯å¾ªç¯çš„èµ·ç‚¹ä¸åŒï¼Œç¬¬ä¸€ä¸ªå…ƒç´ å’Œåé¢çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¹Ÿæ˜¯å’Œå®ƒä¹‹åçš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥å¤–å±‚çš„å¾ªç¯èµ·ç‚¹ä¸º0ï¼Œå†…å±‚çš„å¾ªç¯èµ·ç‚¹åˆ™æ˜¯ç”±å¤–å±‚å†³å®šï¼Œè‹¥å¤–å±‚ä¸ºiï¼Œåˆ™å†…å±‚å¾ªç¯èµ·ç‚¹ä¸ºi+1ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥ä¿è¯ï¼Œä¸é‡å¤åˆ©ç”¨æ•°ç»„ä¸­åŒæ ·çš„å…ƒç´ ã€‚ 1234567891011121314class Solution { public int[] twoSum(int[] nums, int target) { int[] result = new int[2]; for (int i = 0; i &lt; nums.length; i++) { for (int j = i + 1; j &lt; nums.length; j++) { if (nums[i] + nums[j] == target) { result[0] = i; result[1] = j; } } } return result; }} å“ˆå¸Œè¡¨æš´åŠ›æ–¹æ³•ä¹‹æ‰€ä»¥è¦å¾ªç¯ä¸¤æ¬¡ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦æ‰¾ä¸¤ä¸ªæ•°çš„ä¸‹æ ‡ï¼Œé‡‡ç”¨å“ˆå¸Œè¡¨çš„æ–¹æ³•ï¼Œåœ¨å¾ªç¯è¿‡ç¨‹ä¸­å­˜å‚¨ä¸‹æ ‡ï¼Œå¯ä»¥çœå»åµŒå¥—ä¸€æ¬¡å¾ªç¯ï¼Œä½†æ˜¯æ‰¾ç»“æœçš„æ–¹å¼ä¸æš´åŠ›æ–¹å¼ä¸å¤ªä¸€æ ·ã€‚ 12345678910111213class Solution { public int[] twoSum(int[] nums, int target) { Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;(); for (int i = 0; i &lt; nums.length; i++) { int complement = target - nums[i]; if (map.containsKey(complement)) { return new int[] { map.get(complement), i }; } map.put(nums[i], i); } throw new IllegalArgumentException(\"No two sum solution\"); }} ä¸Šé¢çš„æš´åŠ›æ–¹æ³•ï¼Œæ˜¯ä»å‰å¾€åæ‰¾å¦å¤–ä¸€åŠï¼Œæ‰¾åˆ°ç«‹åˆ»è¿”å›ï¼Œæ¯”å¦‚ 1int nums[] = new int[]{2, 7, 11, 15}; è‹¥targetç›®æ ‡å€¼ä¸º17ï¼Œæ‰§è¡Œè¿‡ç¨‹ï¼š i,j è®¡ç®—ç»“æœ æ˜¯å¦åŒ¹é… 0,1 9 NO 0,2 13 NO 0,3 17 YES è‹¥æ˜¯ç”¨å“ˆå¸Œè¡¨çš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£ä¸ºä»å½“å‰å¾ªç¯ç‚¹å¾€å‰æ‰¾å¦å¤–ä¸€åŠï¼Œåˆ©ç”¨çš„æ˜¯2+3=5ï¼Œ3+2=5ï¼ŒåŠ æ³•çš„äº¤æ¢å¾‹ï¼Œä¸ç®¡ä»å‰å¾€åè¿˜æ˜¯ä»åå¾€å‰ï¼Œéƒ½æ˜¯OKçš„ã€‚ æ‰§è¡Œè¿‡ç¨‹ï¼š i æ˜¯å¦åŒ¹é… å•æ¬¡å¾ªç¯ç»“æŸåmap 0 NO (2, 0) 1 NO (2, 0) , (7,1) 2 NO (2,0) , (7,1) , (11,3) 3 YES æ€»ç»“ æŸäº›åœºæ™¯ä¸‹ï¼Œæš´åŠ›æ–¹å¼å¯èƒ½é€Ÿåº¦æ›´å¿«ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹å¼æ•´ä½“æ—¶é—´å¤æ‚åº¦ä½ã€‚ ç¬¬äºŒç§é‡‡ç”¨HashMap çš„æ–¹å¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é‡‡ç”¨å…¶ä»–å­˜å‚¨æ•°å€¼å’Œä¸‹æ ‡çš„å¼ã€‚","link":"/2019/05/26/ã€ŠLeetCode-0001ã€‹ ä¸¤æ•°ä¹‹å’Œ-TwoSum/"},{"title":"ã€ŠLeetCode-0003ã€‹ æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²-Longest Substring Without Repeating Characters","text":"https://leetcode-cn.com/problems/longest-substring-without-repeating-characters/ é¢˜ç›®ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: \"abcabcbb\"è¾“å‡º: 3 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ \"abc\"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ ç¤ºä¾‹ 2: 123è¾“å…¥: \"bbbbb\"è¾“å‡º: 1è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ \"b\"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚ ç¤ºä¾‹ 3: 1234è¾“å…¥: \"pwwkew\"è¾“å‡º: 3è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ \"wke\"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ\"pwke\" æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚ æ€è·¯å…³é”®ç‚¹ï¼š æ— é‡å¤å­—ç¬¦ æœ€é•¿å­ä¸² ä¸ªäººè§£é¢˜æ€è·¯ï¼Œæœ€é•¿æ— é‡å¤å­—ç¬¦å­ä¸²å¿…ç„¶ä¼šæœ‰ä¸€ä¸ªèµ·ç‚¹ï¼Œè¿™ä¸ªèµ·ç‚¹æˆ‘ä»¬é€šè¿‡éå†å­—ç¬¦ä¸²ä¾æ¬¡ä»å­—ä¸²é¦–ä½åˆ°æœ«å°¾ï¼Œç»ˆç‚¹æˆ‘ä»¬é€šè¿‡æ¯”è¾ƒä¾æ¬¡æ·»åŠ ç¬¬iä½åå­—ç¬¦åˆ¤æ–­å½“å‰å­ä¸²æ˜¯å¦å­˜åœ¨é‡å¤å­—ç¬¦æ¥åˆ¤æ–­ã€‚ç”¨ä¸€ä¸ªå®¹å™¨æ¥å­˜å‚¨å½“å‰æ­£åœ¨è€ƒå¯Ÿçš„å­ä¸²ï¼Œä½¿ç”¨TreeSetæ¥å­˜å‚¨åˆ†ææ¥æ¯ä¸ªæ— é‡å¤å­—ç¬¦çš„å­ä¸²é•¿åº¦ï¼Œä¸»è¦æ˜¯TreeSetå¯ä»¥å¸®æˆ‘æ’åºã€‚ è§£é¢˜ç¬¬ä¸€æ¬¡æäº¤123456789101112131415161718class Solution { public int lengthOfLongestSubstring(String s) { TreeSet&lt;Integer&gt; tempRes = new TreeSet&lt;&gt;(); Stack&lt;Character&gt; result = new Stack&lt;&gt;(); char[] inputs = s.toCharArray(); for (int i = 0; i &lt; inputs.length; i++) { char current = inputs[i]; if (result.contains(current)) { tempRes.add(result.size()); result.clear(); } result.push(current); } tempRes.add(result.size()); tempRes.comparator(); return tempRes.last(); }} è§£é¢˜é”™è¯¯ï¼šæµ‹è¯•ç”¨ä¾‹â€dvdfâ€ç¬¬ä¸€æ¬¡æäº¤ï¼Œæˆ‘é‡‡ç”¨å †æ ˆå­˜å‚¨å½“å‰æ­£åœ¨è€ƒå¯Ÿçš„å­ä¸²ï¼Œä¾æ¬¡æ·»åŠ å­—ç¬¦ï¼Œè‹¥å‡ºç°ä¸å †æ ˆç›¸åŒçš„å­—ç¬¦ï¼Œåœæ­¢æ·»åŠ å­—ç¬¦ï¼Œä¿å­˜å½“å‰å †æ ˆé•¿åº¦ï¼Œæ¸…ç©ºå †æ ˆã€‚ç„¶åä»å½“å‰ç»ˆç‚¹å¼€å§‹å¯»æ‰¾ä¸‹ä¸€ä¸ªå­ä¸²ã€‚è¿™ä¸ªæ€è·¯è€ƒè™‘ä¸å‘¨å…¨ï¼Œæ˜¯æœ‰é—®é¢˜çš„ã€‚å‡ºç°é‡å¤å­—ç¬¦æ—¶ï¼Œä¸èƒ½æ¸…ç©ºå †æ ˆå¹¶ä¸”å¾ªç¯çš„ä¸‹ä¸€ä¸ªç‚¹åº”è¯¥ä»å½“å‰èµ·ç‚¹çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¼€å§‹ã€‚ä»¥æµ‹è¯•ç”¨ä¾‹â€œdvdfâ€ä¸ºä¾‹å­ï¼Œçœ‹çœ‹é—®é¢˜å¤„åœ¨å“ªé‡Œ i å †æ ˆ é•¿åº¦ push(â€˜dâ€™) 0 {d} 1 push(â€˜vâ€™) 1 {d, v} 2 push(â€˜dâ€™) å‡ºç°é‡å¤å­—ç¬¦ä¸²ï¼Œä¿å­˜å½“å‰é•¿åº¦2ï¼Œæ¸…ç©ºå †æ ˆ push(â€˜dâ€™) 2 {d} 1 push(â€˜fâ€™) 3 {d,f} 2 å¾ªç¯ç»“æŸï¼Œä¿å­˜å †æ ˆé•¿åº¦ ç¬¬äºŒæ¬¡æäº¤æ€»ç»“ç¬¬ä¸€æ¬¡æäº¤çš„é—®é¢˜ï¼Œé‡æ–°æäº¤ã€‚ 1234567891011121314151617181920class Solution { public int lengthOfLongestSubstring(String s) { TreeSet&lt;Integer&gt; tempRes = new TreeSet&lt;&gt;(); Queue&lt;Character&gt; result = new LinkedList&lt;&gt;(); char[] inputs = s.toCharArray(); for (int i = 0; i &lt; inputs.length; i++) { char current = inputs[i]; if (result.contains(current)) { tempRes.add(result.size()); result.remove(); i--; } else { result.add(current); } } tempRes.add(result.size()); tempRes.comparator(); return tempRes.last(); }} ç¬¬äºŒæ¬¡æäº¤ï¼Œæˆ‘æŠŠå­˜å‚¨å­ä¸²çš„æ•°æ®ç»“æ„æ”¹æˆæ¥é˜Ÿåˆ—ï¼Œè¿™æ ·ï¼Œå½“å‡ºç°é‡å¤å­ä¸²æ—¶ï¼Œå¯ä»¥å¿«é€Ÿçš„ç§»é™¤é˜Ÿå¤´ï¼Œé€šè¿‡ç´¢å¼•å‡1çš„æ–¹å¼ï¼Œæ¥ä¿è¯åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œé˜Ÿåˆ—ä¸­ä¸ä¼šæœ‰é‡å¤å­—ç¬¦ã€‚è¿™é‡Œæœ‰ä¸ªå¯ä¼˜åŒ–çš„ç‚¹ï¼Œç›´æ¥æ‰¾åˆ°å½“å‰é‡å¤çš„å­—ç¬¦åœ¨é˜Ÿåˆ—ä¸­çš„ä½ç½®ï¼Œç„¶åç›´æ¥å¤„ç†ã€‚åŒæ ·æ˜¯ä»¥ç¬¬ä¸€æ¬¡æäº¤æŠ¥é”™çš„æµ‹è¯•ç”¨ä¾‹ï¼Œçœ‹çœ‹æ‰§è¡Œæ­¥éª¤ï¼š i é˜Ÿåˆ— é•¿åº¦ add(â€˜dâ€™) 0 {d} 1 add(â€˜vâ€™) 1 {d, v} 2 add(â€˜dâ€™) å‡ºç°é‡å¤å­—ç¬¦ä¸²ï¼Œä¿å­˜å½“å‰é•¿åº¦2ï¼Œç§»é™¤é˜Ÿå¤´ï¼Œâ€“i add(â€˜dâ€™) 2 {v, d} 2 add(â€˜fâ€™) 3 {v,d,f} 3 å¾ªç¯ç»“æŸï¼Œä¿å­˜å †æ ˆé•¿åº¦ ç¬¬ä¸‰æ¬¡æäº¤ä¼˜åŒ–åçš„ç®—æ³•ï¼Œé‡‡ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹å¼è®¾f(i)æ˜¯ä»å·¦åˆ°å³åœ¨ç¬¬iä¸ªä½ç½®ä¸Šæ—¶ å½“å‰æœ€é•¿ä¸é‡å¤å­ä¸²çš„é•¿åº¦åˆ™åˆ†ä¸¤ç§æƒ…å†µï¼š(1)ç¬¬iä½ä¸Šçš„å­—æ¯åœ¨å·¦ä¾§ä»æœªå‡ºç° f(i)=f(i-1)+1(2)åœ¨å·¦ä¾§å‡ºç°è¿‡ï¼Œæ­¤æ—¶è®¡ç®—ä¸Šä¸€æ¬¡è¯¥å­—æ¯å‡ºç°ä½ç½®å’Œiä¹‹é—´çš„è·ç¦» gapç¬¬ä¸€ç§ï¼šgap&lt;=f(i-1) æ—¶ f(i)=gapï¼Œæ­¤æ—¶ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®åœ¨ä¸Šä¸€ä¸ªæœ€é•¿ä¸é‡å¤å­ä¸²å†…éƒ¨ç¬¬äºŒç§ï¼šgap&gt;f(i-1) æ—¶ f(i)=f(i-1)+1 1234567891011121314151617181920212223242526272829class Solution { public int lengthOfLongestSubstring(String s) { if (s.isEmpty()) { return 0; } int[] position = new int[256]; for (int i = 0; i &lt; position.length; i++) { position[i] = -1; } int max = 0; int cur = 0; for (int i = 0; i &lt; s.length(); i++) { int pos = s.charAt(i); if (position[pos] &lt; 0) { cur += 1; } else { int gap = i - position[pos]; if (cur &gt;= gap) { cur = gap; } else { cur += 1; } } position[pos] = i; max = Math.max(max, cur); } return max; }} ä»¥ â€œpwwkewâ€ ä¸ºä¾‹å­ï¼Œæ‰§è¡Œæ­¥éª¤ï¼š i cur max gap 0 1 1 1 2 2 2 1 2 1 3 2 2 4 3 3 5 3 3 3 æ€»ç»“ åˆé€‚çš„æ•°æ®ç»“æ„äº‹åŠåŠŸå€ é’ˆå¯¹å­—ç¬¦ä¸²æ“ä½œçš„é¢˜ç›®ï¼Œè¾¹ç•Œå’Œç‰¹æ®Šæƒ…å†µä¸€å®šè¦å¤šè€ƒè™‘ã€‚","link":"/2019/06/01/ã€ŠLeetCode-0003ã€‹ æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²-Longest Substring Without Repeating Characters/"},{"title":"ã€ŠKotlinã€‹ Kotlin Android Extensions (è¯‘æ–‡)","text":"åŸæ–‡é“¾æ¥http://kotlinlang.org/docs/tutorials/android-plugin.html Kotlin Android Extensionsæœ¬æ•™ç¨‹ä»‹ç»å¦‚ä½•ä½¿ç”¨Kotlin Android Extensionsæ¥æ”¹è¿›å¯¹Androidå¼€å‘çš„æ”¯æŒã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä½¿ç”¨Kotlin Android Extensionsæ’ä»¶æ‰€éœ€çš„æ­¥éª¤ï¼Œå¢å¼ºAndroidçš„å¼€å‘ä½“éªŒã€‚ èƒŒæ™¯æ¯ä¸ªAndroidå¼€å‘äººå‘˜éƒ½å¾ˆæ¸…æ¥šfindViewById()æ–¹æ³•ã€‚ æ¯«æ— ç–‘é—®ï¼Œè¿™æ˜¯ä¸€ä¸ªéš¾ä»¥é˜…è¯»ä¸ç»´æŠ¤ï¼Œå¹¶ä¸”å­˜åœ¨æ½œåœ¨bugçš„ä¸‘é™‹ä»£ç ã€‚ è™½ç„¶æœ‰å‡ ä¸ªå¯ç”¨çš„åº“å¯ä»¥ä¸ºæ­¤é—®é¢˜æä¾›è§£å†³æ–¹æ¡ˆï¼Œä½†ä¾èµ–äºè¿è¡Œæ—¶çš„åº“ï¼Œæœ€è®©ä½ å¤´ç–¼çš„æ˜¯å®ƒä»¬éœ€è¦ä¸ºæ¯ä¸ªViewæ·»åŠ æ³¨é‡Šå­—æ®µã€‚ Kotlin Android Extensionsæ’ä»¶å…è®¸æˆ‘ä»¬è·å¾—ä¸ä½¿ç”¨è¿™äº›åº“åç›¸åŒçš„ä½“éªŒï¼Œè€Œæ— éœ€æ·»åŠ ä»»ä½•é¢å¤–çš„ä»£ç æˆ–æ¶ˆè€—é¢å¤–çš„è¿è¡Œæ—¶é—´ã€‚ å®è´¨ä¸Šï¼Œä¸‹é¢è¿™æ®µä»£ç æ—¶OKçš„ï¼š 1234567891011// Using R.layout.activity_main from the main source setimport kotlinx.android.synthetic.main.activity_main.*class MyActivity : Activity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_main) textView.setText(\"Hello, world!\") // Instead of findView(R.id.textView) as TextView }} textViewæ˜¯Activityçš„æ‰©å±•å±æ€§ï¼Œå¹¶ä¸”å®ƒçš„ç±»å‹å’Œacitvity_main.xmlæ–‡ä»¶ä¸­ç”³æ˜çš„ä¸€è‡´ã€‚ ä½¿ç”¨Kotlin Android Extensionsé…ç½®ä¾èµ–åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Gradleä½œä¸ºæˆ‘ä»¬çš„æ“ä½œç¯å¢ƒï¼Œåœ¨ IntelliJ IDEA ç¯å¢ƒæˆ–è€…Mavenä¸‹å¤§åŒå°å¼‚ã€‚æ›´å¤šå…³äºKotlinçš„Gradleé…ç½®ï¼Œè¯·æŸ¥é˜…Using Gradle. Android Extensionsæ˜¯Kotlin IDEAæ’ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œä½ ä¸éœ€è¦å†å®‰è£…å…¶ä»–çš„æ’ä»¶ã€‚ä½ éœ€è¦åšçš„å°±æ˜¯ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼åœ¨ä½ çš„é¡¹ç›®åŠbuild.gradleä¸­å¯ç”¨Android Extensions Gradleæ’ä»¶ï¼š 1apply plugin: 'kotlin-android-extensions' å¼•å…¥ç”Ÿæˆçš„å±æ€§ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¸€é”®å¼•å…¥ç‰¹å®šå¸ƒå±€çš„æ‰€æœ‰æ§ä»¶çš„å±æ€§ï¼š 1import kotlinx.android.synthetic.main.&lt;layout&gt;.* æ‰€ä»¥å‘¢ï¼Œå¦‚æœæˆ‘ä»¬çš„å¸ƒå±€æ˜¯activity_main.xmlï¼Œæˆ‘ä»¬å°†å¼•å…¥*kotlinx.android.synthetic.main.activity_main. å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨å£°ç§°çš„Viewçš„å±æ€§ï¼ˆåœ¨é€‚é…å™¨ç±»ä¸­å¾ˆå¥½ç”¨ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥*kotlinx.android.synthetic.main.activity_main.view. ä¸€æ—¦æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤åšï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨ç›¸åº”çš„æ‰©å±•ï¼Œå°±æ˜¯é‚£äº›åœ¨XMLæ–‡ä»¶ä¸­çš„è§†å›¾ä¹‹åå‘½åçš„å±æ€§ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºè¿™ä¸ªè§†å›¾ï¼š 123456&lt;TextView android:id=\"@+id/hello\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:text=\"Hello World, MyActivity\" /&gt; ç„¶åå°±ä¼šå­˜åœ¨ä¸€ä¸ªåä¸ºhello çš„å±æ€§ 1activity.hello.setText(\"Hi!\") Androidç‰ˆæœ¬Android Extensions æ’ä»¶æ”¯æŒAndroid å¤šæ¸ é“ç‰ˆæœ¬ï¼Œå‡å¦‚åœ¨ä½ çš„build.gradleä¸­æœ‰ä¸€ä¸ªåä¸ºfreeçš„ç‰ˆæœ¬ 1234567android { productFlavors { free { versionName \"1.0-free\" } }} ç„¶åä½ å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯¼å…¥é’ˆå¯¹free/res/layout/activity_free.xmlçš„æ‰€æœ‰ç”Ÿæˆçš„å±æ€§ã€‚ 1import kotlinx.android.synthetic.free.activity_free.* å†…éƒ¨åŸç†Kotlin Android Extensions æ˜¯ä¸€ä¸ªKotlinç¼–è¯‘å™¨æ’ä»¶ã€‚å®ƒæ‰§è¡Œä¸‹é¢ä¸¤ä¸ªæ“ä½œï¼š ä¸ºæ¯ä¸€ä¸ªKotlin Activityæ·»åŠ ä¸€ä¸ªéšè—çš„ç¼“å­˜æ–¹æ³•å’Œä¸€ä¸ªåŸŸã€‚è¿™ä¸ªæ–¹æ³•ç›¸å½“ä¹‹å°ï¼ŒåŸºæœ¬ä¸ä¼šå¢åŠ APK çš„å¤§å°ã€‚ ç”¨æ–¹æ³•è°ƒç”¨æ›¿æ¢æ¯ä¸€ä¸ªå±æ€§è°ƒç”¨ã€‚ é‚£ä¹ˆï¼Œè¿™æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿå½“è°ƒç”¨ä¸€ä¸ªç”Ÿæˆçš„å±æ€§æ—¶ï¼Œå¦‚æœæ¥æ”¶æ–¹æ—¶å­˜åœ¨äºæ¨¡å—æºä»£ç ä¸­çš„Kotlin Activityæˆ–è€…Fragmentï¼Œç¼“å­˜çš„æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œæä¾› 1234class MyActivity: Activity()fun MyActivity.a() { this.textView.setText(â€œâ€)} ä¸€ä¸ªç¼“å­˜æ–¹æ³•ä¼šè‡ªåŠ¨åœ¨MyActivityä¸­ç”Ÿæˆï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼“å­˜æœºåˆ¶ã€‚ç„¶è€Œåœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ 123fun Activity.b() { this.textView.setText(â€œâ€)} æˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªæ–¹æ³•æ˜¯å¦ä»…åœ¨æˆ‘ä»¬çš„æºä»£ç çš„Activityæˆ–æ™®é€šJava Activityä¸­è¢«è°ƒç”¨ã€‚ å› æ­¤ï¼Œå³ä½¿ä¸Šä¸€ä¸ªç¤ºä¾‹ä¸­çš„MyActivityå®ä¾‹æ˜¯æ¥æ”¶å™¨ï¼Œæˆ‘ä»¬ä¹Ÿä¸ä½¿ç”¨ç¼“å­˜ã€‚","link":"/2017/05/18/ã€ŠKotlinã€‹ Kotlin Android Extensions (è¯‘æ–‡)/"},{"title":"ã€ŠLeetCode-0004ã€‹ å¯»æ‰¾ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°-Median of Two Sorted Arrays","text":"https://leetcode-cn.com/problems/median-of-two-sorted-arrays/ é¢˜ç›®ç»™å®šä¸¤ä¸ªå¤§å°ä¸º m å’Œ n çš„æœ‰åºæ•°ç»„nums1å’Œ nums2ã€‚ è¯·ä½ æ‰¾å‡ºè¿™ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°ï¼Œå¹¶ä¸”è¦æ±‚ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(log(m + n))ã€‚ ä½ å¯ä»¥å‡è®¾ nums1 å’Œ nums2 ä¸ä¼šåŒæ—¶ä¸ºç©ºã€‚ ç¤ºä¾‹ 1: 1234nums1 = [1, 3]nums2 = [2]åˆ™ä¸­ä½æ•°æ˜¯ 2.0 ç¤ºä¾‹ 2: 1234nums1 = [1, 2]nums2 = [3, 4]åˆ™ä¸­ä½æ•°æ˜¯ (2 + 3)/2 = 2.5 æ¦‚å¿µ ä¸­ä½æ•°çš„æ¦‚å¿µï¼šå¯¹äºæœ‰é™çš„æ•°é›†ï¼Œå¯ä»¥é€šè¿‡æŠŠæ‰€æœ‰è§‚å¯Ÿå€¼é«˜ä½æ’åºåæ‰¾å‡ºæ­£ä¸­é—´çš„ä¸€ä¸ªä½œä¸ºä¸­ä½æ•°ã€‚å¦‚æœè§‚å¯Ÿå€¼æœ‰å¶æ•°ä¸ªï¼Œé€šå¸¸å–æœ€ä¸­é—´çš„ä¸¤ä¸ªæ•°å€¼çš„å¹³å‡æ•°ä½œä¸ºä¸­ä½æ•°ã€‚ å¤æ‚åº¦ log(m+n)ï¼Œå‚è€ƒæ–‡ç« ï¼šhttps://github.com/xitu/gold-miner/blob/master/TODO/what-does-the-time-complexity-o-log-n-actually-mean.md æ€è·¯ ä¸¤ä¸ªæœ‰åºæ•°ç»„ ä¸­ä½æ•° å¤æ‚åº¦O(log(m + n)) è§£é¢˜ç¬¬ä¸€æ¬¡æäº¤è‡­ä¸è¦è„¸çš„æäº¤ã€‚æœ¬ç€è¯•ä¸€è¯•çš„æ€åº¦æäº¤ã€‚è¿™ä¸ªç­”æ¡ˆæ˜¾ç„¶ä¸ç¬¦åˆè´Ÿè´£åº¦çš„è¦æ±‚ã€‚ç«Ÿç„¶æ˜¯é€šè¿‡ã€‚ 123456789101112131415161718192021class Solution { public double findMedianSortedArrays(int[] nums1, int[] nums2) { List&lt;Integer&gt; nums_a = new ArrayList&lt;&gt;(); List&lt;Integer&gt; nums_b = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; nums1.length; i++) { nums_a.add(nums1[i]); } for (int i = 0; i &lt; nums2.length; i++) { nums_b.add(nums2[i]); } nums_a.addAll(nums_b); Collections.sort(nums_a); if (nums_a.size() % 2 == 0) { int mid = nums_a.size() / 2; return (nums_a.get(mid) + nums_a.get(mid - 1)) / 2.0f; } else { int mid = (nums_a.size() - 1) / 2; return nums_a.get(mid); } }} ç¬¬äºŒæ¬¡æäº¤å…³äºè¿™æ®µä»£ç ï¼Œçœ‹è¯¦ç»†é¢˜è§£ï¼Œå¾—å¤šçœ‹å‡ éã€‚https://leetcode-cn.com/problems/median-of-two-sorted-arrays/solution/4-xun-zhao-liang-ge-you-xu-shu-zu-de-zhong-wei-shu/ 12345678910111213141516171819202122232425262728class Solution { public double findMedianSortedArrays(int[] nums1, int[] nums2) { int n = nums1.length; int m = nums2.length; if (n &gt; m) { return findMedianSortedArrays(nums2, nums1); } int L1 = 0, L2 = 0, R1 = 0, R2 = 0, c1, c2, lo = 0, hi = 2 * n; while (lo &lt;= hi) { c1 = (lo + hi) / 2; c2 = m + n - c1; L1 = (c1 == 0) ? Integer.MIN_VALUE : nums1[(c1 - 1) / 2]; //map to original element R1 = (c1 == 2 * n) ? Integer.MAX_VALUE : nums1[c1 / 2]; L2 = (c2 == 0) ? Integer.MIN_VALUE : nums2[(c2 - 1) / 2]; R2 = (c2 == 2 * m) ? Integer.MAX_VALUE : nums2[c2 / 2]; if (L1 &gt; R2) { hi = c1 - 1; } else if (L2 &gt; R1) { lo = c1 + 1; } else { break; } } return (Math.max(L1, L2) + Math.min(R1, R2)) / 2.0; }} æ€»ç»“ æ€è€ƒæœªæœå¯çœ‹é¢˜è§£ï¼Œå‰ææ˜¯å¿…é¡»å…ˆæ€è€ƒ æ¦‚å¿µçš„æ·±å…¥ç†è§£å¾ˆé‡è¦","link":"/2019/06/10/ã€ŠLeetCode-0004ã€‹ å¯»æ‰¾ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°-Median of Two Sorted Arrays/"},{"title":"ã€ŠLeetCode-0005ã€‹ æœ€é•¿å›æ–‡å­ä¸²-Longest Palindromic Substring","text":"https://leetcode-cn.com/problems/longest-palindromic-substring/ é¢˜ç›®ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ° sä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚ä½ å¯ä»¥å‡è®¾sçš„æœ€å¤§é•¿åº¦ä¸º 1000ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: \"babad\"è¾“å‡º: \"bab\"æ³¨æ„: \"aba\" ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆã€‚ ç¤ºä¾‹ 2: 12è¾“å…¥: \"cbbd\"è¾“å‡º: \"bb\" æ¦‚å¿µ å›æ–‡ä¸²ï¼šä¸€ä¸ªæ­£è¯»å’Œåè¯»éƒ½ä¸€æ ·çš„å­—ç¬¦ä¸² æ€è·¯ æš´åŠ›æ³• åŠ¨æ€è§„åˆ’ ä¸­å¿ƒæ‰©æ•£ç®—æ³• Manacher ç®—æ³• è§£é¢˜æš´åŠ›ç®—æ³•æš´åŠ›ç®—æ³•æ¨¡å¼æ— æ³•é€šè¿‡OJã€‚ä¸‹é¢æ˜¯æˆ‘çš„æš´åŠ›è§£æ³•ï¼ˆè¶…å‡ºæ—¶é—´é™åˆ¶ï¼‰ã€‚ 123456789101112131415161718192021222324252627282930class Solution { public String longestPalindrome(String s) { int length = s.length(); if (length &lt;= 1) { return s; } String result = \"\"; for (int i = 0; i &lt; length - 1; i++) { for (int j = i + 1; j &lt;= length; j++) { String cur = s.substring(i, j); if (isPalindrome(cur)) { if (result.length() &lt; cur.length()) { result = cur; } } } } return result; } private boolean isPalindrome(String s) { int length = s.length(); for (int i = 0; i &lt; length / 2; i++) { if (s.charAt(i) != s.charAt(length - i - 1)) { return false; } } return true; }} åŠ¨æ€è§„åˆ’ç®—æ³•å®˜æ–¹è¯¦ç»†åŠ¨æ€è§„åˆ’è§£é¢˜ 12345678910111213141516171819202122232425262728293031class Solution { public String longestPalindrome(String s) { if (s.isEmpty()) { return \"\"; } int length = s.length(); boolean[][] arrays = new boolean[length][length]; int leftIndex = 0, rightIndex = 0; int max = 0; for (int i = length - 1; i &gt;= 0; i--) { for (int j = i + 1; j &lt; length; j++) { if (i == j) { arrays[i][j] = true; } if (s.charAt(i) == s.charAt(j)) { if (j - i == 1 || j - i == 2) { arrays[i][j] = true; } else { arrays[i][j] = arrays[i + 1][j - 1]; } if (arrays[i][j] &amp;&amp; Math.abs(j - i) &gt; max) { max = Math.abs(j - i); leftIndex = i; rightIndex = j; } } } } return s.substring(leftIndex, rightIndex + 1); }} ä¸­å¿ƒæ‰©æ•£ç®—æ³•&amp;Manacher ç®—æ³•ä¸­å¿ƒæ‰©æ•£ + åŠ¨æ€è§„åˆ’ + Manacher ç®—æ³•è¯¦ç»†é¢˜è§£ æ€»ç»“ å¤šçœ‹é¢˜è§£ï¼Œå‘æ•£æ€è·¯","link":"/2019/07/16/ã€ŠLeetCode-0005ã€‹ æœ€é•¿å›æ–‡å­ä¸²-Longest Palindromic Substring/"},{"title":"ã€ŠLinuxã€‹CentOSå¸¸ç”¨å‘½ä»¤","text":"æ·»åŠ ç”¨æˆ·12useradd -d /home/yidong -m yidongpasswd yidong Oracelå¯åŠ¨åœæ­¢æ•°æ®åº“å¯åŠ¨ï¼š 1234su - oracle sqlplus \"/as sysdba\"startupshutdown immediate; å¯åŠ¨ç›‘å¬ ï¼š 123lsnrctl startlsnrctl statuslsnrctl stop æŒ‚è½½1mount -o loop XXXX XXX åå°è¿è¡Œ1./XXX &amp; åå°è¿è¡Œ åˆ é™¤æ“ä½œ12rm -rf XXX åˆ é™¤æ–‡ä»¶å¤¹rm -rf * åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ åŒ…æ‹¬æ–‡ä»¶å¤¹ è¿›ç¨‹æŸ¥è¯¢1ps -ef | grep cp æ‰€æœ‰CPæ“ä½œ ç±»ä¼¼çš„å…¶ä»–å‘½ä»¤ä¹Ÿæ˜¯ä¸€æ · ä¹Ÿå¯ä»¥æŸ¥çœ‹ä½¿ç”¨æŸä¸ªæ–‡ä»¶å¤¹çš„è¿›ç¨‹ ç«¯å£æƒ…å†µæŸ¥çœ‹1netstat -lnp|grep 8080","link":"/2017/09/27/ã€ŠLinuxã€‹CentOSå¸¸ç”¨å‘½ä»¤/"},{"title":"ã€ŠLinuxã€‹CentOS7.3 å®‰è£…MySql","text":"å‰è¨€ æœ€è¿‘ï¼Œè…¾è®¯äº‘ï¼Œåšæ´»åŠ¨ï¼Œè´­ä¹°äº†ä¸€å°ä½é…çš„æœåŠ¡å™¨ä½œä¸ºç©å…·ï¼Œå®‰è£…MySql. æ“ä½œä¸‹è½½mysqlçš„repoæº $ wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm å®‰è£…mysql-community-release-el7-5.noarch.rpmåŒ… $ sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm å®‰è£…mysql $ sudo yum install mysql-server æ ¹æ®æç¤ºå®‰è£…å°±å¯ä»¥äº†,ä¸è¿‡å®‰è£…å®Œæˆåæ²¡æœ‰å¯†ç ,éœ€è¦é‡ç½®å¯†ç  ä¿®æ”¹owner $ sudo chown -R root:root /var/lib/mysql é‡å¯mysqlæœåŠ¡ $ service mysqld restart ç™»å½•é‡ç½®å¯†ç ï¼š $ mysql -u root //ç›´æ¥å›è½¦è¿›å…¥mysqlæ§åˆ¶å°mysql &gt; use mysql;mysql &gt; update user set password=password(â€˜123456â€™) where user=â€™rootâ€™;mysql &gt; exit; é…ç½®äº‘æœåŠ¡å™¨å®‰å…¨ç»„ï¼Œæ‰“å¼€3306ç«¯å£é…ç½®æ•°æ®åº“å¯è¿œç¨‹è¿æ¥æ•°æ®åº“æˆæƒ $ mysql -u root //ç›´æ¥å›è½¦è¿›å…¥mysqlæ§åˆ¶å°mysql &gt; use mysql;mysql&gt;GRANT ALL PRIVILEGES ON . TO â€˜rootâ€™@â€™%â€™ IDENTIFIED BY â€˜123456â€™ WITH GRANT OPTION; è¿œç¨‹è¿æ¥æ•°æ®åº“çš„æ—¶å€™éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç  ç”¨æˆ·åï¼šroot å¯†ç :123456 æŒ‡ç‚¹ip:%ä»£è¡¨æ‰€æœ‰Ip,æ­¤å¤„ä¹Ÿå¯ä»¥è¾“å…¥Ipæ¥æŒ‡å®šIp","link":"/2018/03/07/ã€ŠLinuxã€‹CentOS7.3 å®‰è£…MySql/"},{"title":"å†…ç½‘ç¯å¢ƒä¸‹å®‰è£…éƒ¨ç½²Docker","text":"å‰è¨€å¤§éƒ¨åˆ†å…¬å¸éƒ½æœ‰å±äºè‡ªå·±çš„å†…ç½‘ç¯å¢ƒï¼Œå¤§éƒ¨åˆ†çš„é›†æˆå¼€å‘ç¯å¢ƒä¹Ÿæ˜¯åœ¨å†…ç½‘ä¸‹éƒ¨ç½²ã€‚æœ€è¿‘é¢ä¸´åŒæ ·çš„éœ€æ±‚ï¼Œå†…ç½‘CentOSéƒ¨ç½²GitLab å’Œ Nexusã€‚ æ€è·¯é¦–å…ˆç¡®å®šæ€è·¯ï¼Œæ¯«æ— ç–‘é—®ä½¿ç”¨Dockeræ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œæˆ‘åªç”¨è§£å†³Dockerçš„å®‰è£…é—®é¢˜å³å¯ï¼Œç„¶åä½¿ç”¨Gitlabå’ŒNexusçš„é•œåƒå³å¯è§£å†³é—®é¢˜ï¼ŒåæœŸçš„å»¶å±•æ€§ä¹Ÿæ¯”é€ä¸ªå®‰è£…å¥½ã€‚ é’ˆå¯¹Dockerçš„å®‰è£…ï¼Œæœ‰å¦‚ä¸‹ç­–ç•¥ ç›¸åŒCentOSç‰ˆæœ¬çš„å¤–ç½‘æœåŠ¡å™¨ï¼Œä½¿ç”¨yum â€“downloadonlyå‘½ä»¤ä¸‹è½½create repoå’Œdockerå®‰è£…çš„ä¾èµ–åŒ…ï¼Œç„¶åå»ºç«‹æœ¬åœ°æºï¼Œå®‰è£…Dockerï¼Œä½†æ˜¯å…¬å¸å¹¶æ²¡æœ‰CentOSç‰ˆæœ¬å®Œå…¨ä¸€è‡´çš„å†…å¤–ç½‘æœåŠ¡å™¨ï¼Œæ‰€ä»¥æ­¤æ–¹æ¡ˆæš‚æ—¶ææµ…ï¼› åˆ©ç”¨å·²ç»å®‰è£…å¥½Dockerçš„å¤–ç½‘æœåŠ¡å™¨ï¼Œåˆ¶ä½œé•œåƒæ–‡ä»¶ï¼Œé‡è£…å†…ç½‘ç³»ç»Ÿï¼Œè¿™ä¸ªæ¯”è¾ƒè´¹æ—¶ï¼Œæš‚æ—¶ä¸è€ƒè™‘ï¼› åˆ©ç”¨ä¸€ä¸ªå¯åŒæ—¶è®¿é—®å†…å¤–ç½‘çš„ç”µè„‘åšä»£ç†æœåŠ¡å™¨ï¼Œå®ç°å†…ç½‘æœåŠ¡å™¨çš„æš‚æ—¶å¤–ç½‘è”é€šï¼Œå®‰è£…å®Œæˆåï¼Œå…³é—­ä»£ç†æœåŠ¡å™¨ã€‚ ç»¼ä¸Šï¼Œæˆ‘ä¼˜å…ˆé‡‡ç”¨çš„æ˜¯æ–¹æ¡ˆ3ã€‚å­˜åœ¨ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œä½†æ˜¯åº”è¯¥é—®é¢˜ä¸å¤§ã€‚ éœ€æ±‚ CCProxy ä¸€å°è¿æ¥å†…å¤–ç½‘çš„ç”µè„‘ï¼ˆæˆ‘ä½¿ç”¨ä¸ªäººåŠå…¬ç”µè„‘ï¼‰ æ“ä½œæ–¹æ³•ç®€å•é…ç½®ä¸€ä¸‹CCProxyï¼Œå‚è€ƒå®˜æ–¹æ“ä½œæ‰‹å†Œï¼Œç›¸å¯¹ç®€å•ã€‚CentOSæœåŠ¡å™¨é…ç½®å…¨å±€ä»£ç†é…ç½® ç«¯å£å’ŒIPæ³¨æ„æ›¿æ¢æˆè‡ªå·±ä»£ç†æœåŠ¡å™¨çš„ç«¯å£å’ŒIP 123456vi /etc/profilehttp_proxy=http://yourproxy:808/ftp_proxy=http://yourproxy:808/export http_proxyexport ftp_proxy yumä»£ç†é…ç½®123vi /etc/yum.confproxy=http://yourproxy:808/ è‹¥æœ‰å…¶ä»–é…ç½®ä¹Ÿå¯ä»¥å‚ç…§ä¸Šé¢è¿›è¡Œé…ç½®æµ‹è¯•1curl -k https://www.baidu.com Dockerå®‰è£…å‚è€ƒå‰æ–‡","link":"/2018/06/19/å†…ç½‘ç¯å¢ƒä¸‹å®‰è£…éƒ¨ç½²Docker/"},{"title":"ã€Šå¾®ä¿¡å°ç¨‹åºã€‹å¾®ä¿¡å°ç¨‹åºä¹‹å¤´æ¡æ–°é—»","text":"ç®€ä»‹ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦æ˜¯ä»‹ç»ä¸‹å¾®ä¿¡å°ç¨‹åºçš„å¼€å‘ç¯å¢ƒå®‰è£…å’Œå¾®ä¿¡ç»„ä»¶ä»€ä¹ˆçš„ä¸€äº›åŸºç¡€çš„å¼€å‘å†…å®¹ï¼Œæ‰€ä»¥æœ€è¿‘ä¸€ç›´åœ¨ä¸šä½™æ‰¾ç»ƒæ‰‹çš„æœºä¼šã€‚ç”±äºä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡JSï¼Œè‡ªå·±å­¦ä¹ èµ·æ¥è¿˜ç®—æ˜¯æ¯”è¾ƒçš„åƒåŠ›ï¼Œä¸€ç‚¹ä¸€ç‚¹çš„æ¥å§ï¼è¦æŒä¹…ã€‚ å…ˆçœ‹ä¸‹æ•ˆæœï¼š ä»£ç å·²ç»å¼€æºï¼š ç®€æ˜“æ–°é—» å®ç°æ€è·¯ æ•°æ®å…¨éƒ¨æ˜¯é‡‡ç”¨çš„æœ¬åœ°æ•°æ®ï¼Œå›¾ç‰‡ä¹Ÿæ˜¯æœ¬åœ°å›¾ç‰‡ï¼Œå› ä¸ºè‹¦é€¼çš„ä¸ªäººå¼€å‘è€…ï¼Œæ— æ³•è®¤è¯ï¼› toolbarå››ä¸ªç°è±¡ï¼šæ–°é—»ï¼Œç¬‘è¯ï¼Œå†å²ä¸Šçš„ä»Šå¤©å’Œä¸»é¡µï¼Œé›†ä¸­ä¸»é¡µé‡‡ç”¨çš„æ˜¯é»˜è®¤çš„é¡µé¢ï¼Œæ·»åŠ è‡ªå·±çš„ä¸€äº›å†…å®¹ï¼› æ•°æ®ç»‘å®šï¼Œåˆ—è¡¨æ¸²æŸ“ï¼Œæ¡ä»¶æ¸²æŸ“å’Œäº‹ä»¶çš„ä½¿ç”¨ï¼› ä½¿ç”¨ä¸€äº›åŸºç¡€çš„Viewå’Œtextï¼Œéƒ¨åˆ†APIçš„ä½¿ç”¨ï¼› ä»£ç ç»“æ„ ç›®å½• ç”¨é€” images å­˜æ”¾æœ¬åœ°å›¾ç‰‡ pages å­˜æ”¾é¡µé¢ï¼Œhistoryå†å²ä¸Šçš„ä»Šå¤©ï¼Œindexä¸»é¡µï¼Œjokeè¯ï¼Œnewsæ–°é—» utils å·¥å…·åŒ… app.js å°ç¨‹åºé€»è¾‘ app.json å°ç¨‹åºå…¬å…±è®¾ç½® app.wxss å°ç¨‹åºå…¬å…±æ ·å¼è¡¨ ä»£ç å†…å®¹ï¼Œä¸»è¦çœ‹ä¸‹é…ç½®app.json é…ç½®é¡¹åˆ—è¡¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354{ \"pages\": [ \"pages/news/news\", \"pages/joke/joke\", \"pages/history/history\", \"pages/index/index\" ], \"window\": { \"navigationBarBackgroundColor\": \"#f85959\", \"navigationBarTextStyle\": \"white\", \"navigationBarTitleText\": \"å¾® çœ‹\", \"backgroundColor\": \"#FFFFFF\", \"backgroundTextStyle\": \"dark\", \"enablePullDownRefresh\": true }, \"tabBar\": { \"color\": \"#626567\", \"selectedColor\": \"#f85959\", \"backgroundColor\": \"#FBFBFB\", \"borderStyle\": \"white\", \"position\": \"bottom\", \"list\": [ { \"pagePath\": \"pages/news/news\", \"text\": \"æ–°é—»\", \"iconPath\": \"images/discovery.png\", \"selectedIconPath\": \"images/discovery_focus.png\" }, { \"pagePath\": \"pages/joke/joke\", \"text\": \"ç¬‘è¯\", \"iconPath\": \"images/ring.png\", \"selectedIconPath\": \"images/ring_focus.png\" }, { \"pagePath\": \"pages/history/history\", \"text\": \"å†å²\", \"iconPath\": \"images/chat.png\", \"selectedIconPath\": \"images/chat_focus.png\" }, { \"pagePath\": \"pages/index/index\", \"text\": \"ä¸»é¡µ\", \"iconPath\": \"images/index.png\", \"selectedIconPath\": \"images/index_focus.png\" } ] }, \"networkTimeout\": { \"request\": 10000, \"downloadFile\": 10000 }, \"debug\": true} å±æ€§ ç±»å‹ å¿…å¡« æè¿° pages String Array æ˜¯ è®¾ç½®é¡µé¢è·¯å¾„ window Object å¦ è®¾ç½®é»˜è®¤é¡µé¢çš„çª—å£ç° tabBar Object å¦ è®¾ç½®åº•éƒ¨ tab çš„ç° networkTimeout Object å¦ è®¾ç½®ç½‘ç»œè¶…æ—¶æ—¶é—´ debug Boolean å¦ è®¾ç½®æ˜¯å¦å¼€å¯ debugæ¨¡å¼ å…·ä½“é…ç½®ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒå®˜ç½‘ï¼š https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html?t=201715","link":"/2017/01/05/ã€Šå¾®ä¿¡å°ç¨‹åºã€‹å¾®ä¿¡å°ç¨‹åºä¹‹å¤´æ¡æ–°é—»/"},{"title":"ã€Šå¾®ä¿¡å°ç¨‹åºã€‹Hello å¾®ä¿¡å°ç¨‹åº","text":"ç®€ä»‹å¾®ä¿¡å°ç¨‹åºï¼Œæœ€è¿‘å£°éŸ³æ¯”è¾ƒå¤§ï¼Œå¼€å§‹æ…¢æ…¢å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªå°ä¸œè¥¿ï¼Œä»å®‰è£…å¼€å‘å·¥å…·å¼€å§‹å§ï¼Œä¸ä¼šJSï¼Œå­¦èµ·æ¥ä¼šä¸ä¼šå¾ˆåƒåŠ›å‘¢ï¼Ÿ æ³¨å†Œè´¦å· å‚è€ƒå®˜æ–¹ç½‘ç«™ å¼€å‘å·¥å…· 1.å¾®ä¿¡Webå¼€å‘å·¥å…· 2.å®˜æ–¹ä¸‹è½½åœ°å€,é’ˆå¯¹è‡ªå·±ä¸åŒçš„ç”µè„‘ä¸‹è½½ä¸åŒçš„ç‰ˆæœ¬ä½¿ç”¨å§ 3.æ‰“å¼€IDEï¼ˆä¸çŸ¥é“è¿™ä¸ªè½»é‡çº§çš„ç®—ä¸ç®—IDEï¼‰ï¼Œå¿«é€Ÿå¼€å‘ 4.æ²¡æœ‰AppIDçš„ä¸å¡«å†™ï¼Œå‹¾é€‰â€œåœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºquick starté¡¹ç›®â€ç›´æ¥åˆ›å»ºé¡¹ç›®å°±å¯ä»¥çœ‹åˆ°â€Hello Worldâ€ APPäº† Hello WeChat App 1.åˆå§‹å·¥ç¨‹ä»£ç ç»“æ„ 2.å·¦ä¾§èœå•åˆ†ä¸ºâ€œç¼–è¾‘â€ï¼Œâ€œè°ƒè¯•â€ï¼Œâ€œé¡¹ç›®â€,â€ç¼–è¯‘â€œå’Œâ€œå…³é—­â€â€äº”ä¸ªèœå• 3.ä¸­é—´ä¸»ç•Œé¢åˆ†ä¸ºé¢„è§ˆç•Œé¢ï¼Œæ–‡ä»¶ç»“æ„ç•Œé¢å’Œç¼–è¾‘ç•Œé¢ 4.æ‰§è¡Œç¼–è¯‘åï¼Œå°ç¨‹åºæ–¹å¯è¿è¡Œï¼Œç¼–è¯‘é”™è¯¯ä¼šåœ¨é¡¶éƒ¨æç¤ºå¹¶ä¸”å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°æ˜æ˜¾çš„æŠ¥é”™ä¿¡æ¯ï¼Œåº”è¯¥å’Œç½‘é¡µçš„è°ƒè¯•æ–¹å¼é¡¹ç›®ï¼ˆæœ¬äººæ²¡å¼€å‘è¿‡ç½‘é¡µï¼Œæ±—é¢œï¼‰ å®é™…æ•ˆæœ","link":"/2016/12/12/ã€Šå¾®ä¿¡å°ç¨‹åºã€‹Hello å¾®ä¿¡å°ç¨‹åº/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹ Nç‰ˆæœ¬ Framework Cameraçš„ä¸€äº›æ”¹åŠ¨","text":"å‰è¨€Android Nç‰ˆæœ¬æœ€è¿‘å‘å¸ƒï¼ŒNougatæ˜¯å¦å¥½åƒï¼Œä¸å¾—è€ŒçŸ¥ï¼Œæ…¢æ…¢çœ‹ä¸‹~ æ„Ÿè°¢AndroidXrefè¿™ä¸ªç½‘ç«™ï¼Œç»™å¼€å‘è€…æä¾›äº†å¤§é‡çš„ä¾¿æ·~ä»¥åå­¦ä¹ Androidå°±é å®ƒäº†ã€‚ Nç‰ˆæœ¬ä¸ŠFrameworkå…³äºCameraçš„ä¸€äº›æ”¹åŠ¨CameraServer Nç‰ˆæœ¬ä¹‹å‰ï¼ŒCameraServiceæ˜¯è¿è¡Œåœ¨MediaServerä¸‹çš„ï¼Œè¿™æ ·å­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼Œå› ä¸ºMediaServerä¸‹åŒæ—¶è¿˜è¿è¡Œè¿™å…¶ä»–çš„å¤šåª’ä½“å†…å®¹ Mç‰ˆæœ¬ /frameworks/av/media/mediaserver/main_mediaserver.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100int main(int argc __unused, char** argv){ signal(SIGPIPE, SIG_IGN); char value[PROPERTY_VALUE_MAX]; bool doLog = (property_get(\"ro.test_harness\", value, \"0\") &gt; 0) &amp;&amp; (atoi(value) == 1); pid_t childPid; // FIXME The advantage of making the process containing media.log service the parent process of // the process that contains all the other real services, is that it allows us to collect more // detailed information such as signal numbers, stop and continue, resource usage, etc. // But it is also more complex. Consider replacing this by independent processes, and using // binder on death notification instead. if (doLog &amp;&amp; (childPid = fork()) != 0) { // media.log service //prctl(PR_SET_NAME, (unsigned long) \"media.log\", 0, 0, 0); // unfortunately ps ignores PR_SET_NAME for the main thread, so use this ugly hack strcpy(argv[0], \"media.log\"); sp&lt;ProcessState&gt; proc(ProcessState::self()); MediaLogService::instantiate(); ProcessState::self()-&gt;startThreadPool(); for (;;) { siginfo_t info; int ret = waitid(P_PID, childPid, &amp;info, WEXITED | WSTOPPED | WCONTINUED); if (ret == EINTR) { continue; } if (ret &lt; 0) { break; } char buffer[32]; const char *code; switch (info.si_code) { case CLD_EXITED: code = \"CLD_EXITED\"; break; case CLD_KILLED: code = \"CLD_KILLED\"; break; case CLD_DUMPED: code = \"CLD_DUMPED\"; break; case CLD_STOPPED: code = \"CLD_STOPPED\"; break; case CLD_TRAPPED: code = \"CLD_TRAPPED\"; break; case CLD_CONTINUED: code = \"CLD_CONTINUED\"; break; default: snprintf(buffer, sizeof(buffer), \"unknown (%d)\", info.si_code); code = buffer; break; } struct rusage usage; getrusage(RUSAGE_CHILDREN, &amp;usage); ALOG(LOG_ERROR, \"media.log\", \"pid %d status %d code %s user %ld.%03lds sys %ld.%03lds\", info.si_pid, info.si_status, code, usage.ru_utime.tv_sec, usage.ru_utime.tv_usec / 1000, usage.ru_stime.tv_sec, usage.ru_stime.tv_usec / 1000); sp&lt;IServiceManager&gt; sm = defaultServiceManager(); sp&lt;IBinder&gt; binder = sm-&gt;getService(String16(\"media.log\")); if (binder != 0) { Vector&lt;String16&gt; args; binder-&gt;dump(-1, args); } switch (info.si_code) { case CLD_EXITED: case CLD_KILLED: case CLD_DUMPED: { ALOG(LOG_INFO, \"media.log\", \"exiting\"); _exit(0); // not reached } default: break; } } } else { // all other services if (doLog) { prctl(PR_SET_PDEATHSIG, SIGKILL); // if parent media.log dies before me, kill me also setpgid(0, 0); // but if I die first, don't kill my parent } InitializeIcuOrDie(); sp&lt;ProcessState&gt; proc(ProcessState::self()); sp&lt;IServiceManager&gt; sm = defaultServiceManager(); ALOGI(\"ServiceManager: %p\", sm.get()); AudioFlinger::instantiate(); MediaPlayerService::instantiate(); ResourceManagerService::instantiate(); CameraService::instantiate(); AudioPolicyService::instantiate(); SoundTriggerHwService::instantiate(); RadioService::instantiate(); registerExtensions(); ProcessState::self()-&gt;startThreadPool(); IPCThreadState::self()-&gt;joinThreadPool(); }} å¯ä»¥çœ‹åˆ°AudioFlingerï¼ŒMediaPlayerService, ResourceManagerService,CameraService,AudioPolicyService,SoundTriggerHwService,RadioServiceç­‰éƒ½æ˜¯è¿è¡Œåœ¨è¿™ä¸ªè¿›ç¨‹ä¸‹é¢çš„ï¼Œè¿™æ ·å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå‡å¦‚è¯´å…¶ä»–ä»»ä½•ä¸€ä¸ªæœåŠ¡å› ä¸ºæŸäº›åŸå› æŒ‚æ‰äº†ï¼Œæ•´ä¸ªMediaServerå°†ä¼šé‡å¯ï¼Œè€Œè¿™ä¸ªé‡å¯çš„è¿‡ç¨‹ä¸­ï¼Œå€˜è‹¥ç›¸æœºæ­£åœ¨æ“ä½œï¼Œå°±ä¼šå‡ºç°ç›¸æœºçªç„¶æŒ‚æ‰çš„é—®é¢˜ã€‚ Nç‰ˆæœ¬ /frameworks/av/media/mediaserver/main_mediaserver.cpp 1234567891011121314int main(int argc __unused, char **argv __unused){ signal(SIGPIPE, SIG_IGN); sp&lt;ProcessState&gt; proc(ProcessState::self()); sp&lt;IServiceManager&gt; sm(defaultServiceManager()); ALOGI(\"ServiceManager: %p\", sm.get()); InitializeIcuOrDie(); MediaPlayerService::instantiate(); ResourceManagerService::instantiate(); registerExtensions(); ProcessState::self()-&gt;startThreadPool(); IPCThreadState::self()-&gt;joinThreadPool();} æœ‰æ²¡æœ‰è§‰å¾—å°‘äº†å¾ˆå¤šï¼Œä¸ä»…CameraServiceè¢«æŠ½ç¦»å‡ºå»äº†ï¼Œè¿˜æœ‰ä¸€äº›å†…å®¹å¥½åƒä¹Ÿè¢«æŠ½ç¦»å‡ºå»äº†ã€‚åœ¨Nç‰ˆæœ¬çš„å·¥ç¨‹ä¸­å¤šå‡ºæ¥ä¸€ä¸ªæ–‡ä»¶å¤¹/frameworks/av/camera/cameraserver/è¯´æ˜CameraServeræ˜¯ç‹¬ç«‹äºMediaServerçš„å•ç‹¬çš„è¿›ç¨‹ï¼Œæ‰§è¡ŒPSæ“ä½œä½ è®²çœ‹åˆ°ç‹¬ç«‹çš„Cameraè¿›ç¨‹ã€‚ 12345678910111213141516171819#define LOG_TAG \"cameraserver\"//#define LOG_NDEBUG 0// from LOCAL_C_INCLUDES#include \"CameraService.h\"using namespace android;int main(int argc __unused, char** argv __unused){ signal(SIGPIPE, SIG_IGN); sp&lt;ProcessState&gt; proc(ProcessState::self()); sp&lt;IServiceManager&gt; sm = defaultServiceManager(); ALOGI(\"ServiceManager: %p\", sm.get()); CameraService::instantiate(); ProcessState::self()-&gt;startThreadPool(); IPCThreadState::self()-&gt;joinThreadPool();} åˆå§‹åŒ–çš„è¿‡ç¨‹å¹¶æ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯å•çº¯çš„å°†å®ƒç‹¬ç«‹å‡ºæ¥è€Œå·²ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒCameraServiceä½•æ—¶å¯åŠ¨ï¼Ÿçœ‹åˆ°cameraserver.rcæ–‡ä»¶ï¼Œ 123456service cameraserver /system/bin/cameraserver class main user cameraserver group audio camera drmrpc inet media mediadrm net_bt net_bt_admin net_bw_acct ioprio rt 4 writepid /dev/cpuset/foreground/tasks ä¹Ÿå°±æ˜¯è¯´åªè¦åŠ è½½äº†cameraserver.rcæ–‡ä»¶ï¼ŒæœåŠ¡å°±å¼€å§‹å¯åŠ¨äº†ï¼Œå°±ä¼šå¾€main_cameraserer.cppçš„å…¥å£å‡½æ•°ä¸­æ‰§è¡Œï¼Œå› ä¸ºmkæ–‡ä»¶ä¸­å®šä¹‰äº†è¿™ä¸ªæ¨¡å—ä¸ºcameraserver 12345678910111213141516171819202122LOCAL_PATH:= $(call my-dir)include $(CLEAR_VARS)LOCAL_SRC_FILES:= \\ main_cameraserver.cpp//æºæ–‡ä»¶LOCAL_SHARED_LIBRARIES := \\//ä¾èµ–åº“ libcameraservice \\ libcutils \\ libutils \\ libbinder \\ libcamera_clientLOCAL_MODULE:= cameraserver//æ¨¡å—åLOCAL_32_BIT_ONLY := true//åªæ”¯æŒ32ä½LOCAL_CFLAGS += -Wall -Wextra -Werror -Wno-unused-parameter//ä¸€äº›ç¼–è¯‘æ¡ä»¶ï¼ŒNç‰ˆæœ¬åœ¨ç¼–è¯‘è¿™ä¸€å—ä¹Ÿä½œå‡ºäº†å¾ˆå¤§çš„æ”¹åŠ¨ï¼Œæœ‰æœºä¼šå†ç ”ç©¶ä¸‹LOCAL_INIT_RC := cameraserver.rcinclude $(BUILD_EXECUTABLE)//æ‰§è¡Œæ–‡ä»¶ å¯»æ‰¾ï¼Œè°è°ƒç”¨çš„camearserver.rc ???é¦–å…ˆæˆ‘ä»¬è¦çœ‹è¿™ä¸ªæ–‡ä»¶ç¼–è¯‘å‡ºæ¥ä¹‹åæ”¾åœ¨æ‰‹æœºçš„ä»€ä¹ˆä½ç½®/build/core/base_rules.mk 1234567891011121314151617# Rule to install the module&apos;s companion init.rc.my_init_rc := $(LOCAL_INIT_RC_$(my_32_64_bit_suffix))my_init_rc_src :=my_init_rc_installed :=ifndef my_init_rcmy_init_rc := $(LOCAL_INIT_RC)# Make sure we don&apos;t define the rule twice in multilib module.LOCAL_INIT_RC :=endififdef my_init_rcmy_init_rc_src := $(LOCAL_PATH)/$(my_init_rc)my_init_rc_installed := $(TARGET_OUT$(partition_tag)_ETC)/init/$(notdir $(my_init_rc_src))$(my_init_rc_installed) : $(my_init_rc_src) | $(ACP) @echo &quot;Install: $@&quot; $(copy-file-to-new-target)$(my_register_name) : $(my_init_rc_installed) å¤§è‡´å¯ä»¥çœ‹å‡ºä¸€äº›ç«¯å€ªï¼Œåº”è¯¥æ˜¯æ”¾åœ¨xxx/etc/initç›®å½•ä¸‹ï¼Œè¿™ä¸ªxxxæ ¹æ®ä»€ä¹ˆçœ‹åˆ¤æ–­ï¼Œpartition_tagå˜é‡ 1234567891011121314ifdef LOCAL_IS_HOST_MODULE partition_tag :=elseifeq (true,$(LOCAL_PROPRIETARY_MODULE)) partition_tag := _VENDORelse ifeq (true,$(LOCAL_OEM_MODULE)) partition_tag := _OEMelse ifeq (true,$(LOCAL_ODM_MODULE)) partition_tag := _ODMelse # The definition of should-install-to-system will be different depending # on which goal (e.g., sdk or just droid) is being built. partition_tag := $(if $(call should-install-to-system,$(my_module_tags)),,_DATA)endif cameraserveråº”è¯¥æ˜¯ç³»ç»Ÿæ‰€æœ‰çš„ï¼Œä¸æ˜¯oemæˆ–è€…odmç‰¹æœ‰ï¼Œå­˜æ”¾åœ¨system/etc/initç›®å½•ä¸‹ã€‚æ¥ä¸‹é¢çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶/system/core/init/readme.txt 12345678910111213One may specify paths in the mount_all command line to have it import.rc files at the specified paths instead of the default ones listed above.This is primarily for supporting factory mode and other non-standard bootmodes. The three default paths should be used for the normal boot process.The intention of these directories is as follows 1) /system/etc/init/ is for core system items such as SurfaceFlinger, MediaService, and logcatd. 2) /vendor/etc/init/ is for SoC vendor items such as actions or daemons needed for core SoC functionality. 3) /odm/etc/init/ is for device manufacturer items such as actions or daemons needed for motion sensor or other peripheral functionality. æ˜¾ç„¶æ˜¯åœ¨æ‰§è¡Œâ€œmount_allâ€œçš„æ—¶å€™ï¼ŒCameraServerå¯åŠ¨ ~ ï¼Œæ‰¾åˆ°å¯åŠ¨çš„ä½ç½®ï¼Œè¿™ä¸€ç‚¹å’Œä¹‹å‰çš„ç‰ˆæœ¬æ˜¯æœ‰å¾ˆå¤§å·®åˆ«çš„ã€‚ AIDLNç‰ˆæœ¬ä¸Šå¯¹äºCameraçš„ä¸€äº›æ¥å£é‡‡ç”¨äº†Aidlçš„æ–‡ä»¶æ ¼å¼frameworks/av/camera/aidl/android/hardware/ å…¶ä»–æ¨¡å—æƒ³è¦è®¿é—®è¿™äº›æ¥å£ï¼Œéœ€è¦include libcamera_clientæ¨¡å—æ‰è¡Œ mkæ–‡ä»¶ä¸­æœ‰è¯´æ˜ã€‚","link":"/2016/09/13/ã€ŠAndroid Framework ä¹‹è·¯ã€‹ Nç‰ˆæœ¬ Framework Cameraçš„ä¸€äº›æ”¹åŠ¨/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸€ï¼‰ã€‹ Service","text":"ä»‹ç» Serviceï¼ˆæœåŠ¡ï¼‰æ˜¯ä¸€ä¸ªæ²¡æœ‰ç”¨æˆ·ç•Œé¢çš„åœ¨åå°è¿è¡Œæ‰§è¡Œè€—æ—¶æ“ä½œçš„åº”ç”¨ç»„ä»¶ã€‚å…¶ä»–åº”ç”¨ç»„ä»¶èƒ½å¤Ÿå¯åŠ¨Serviceï¼Œå¹¶ä¸”å½“ç”¨æˆ·åˆ‡æ¢åˆ°å¦å¤–çš„åº”ç”¨åœºæ™¯ï¼ŒServiceå°†æŒç»­åœ¨åå°è¿è¡Œã€‚å¦å¤–ï¼Œä¸€ä¸ªç»„ä»¶èƒ½å¤Ÿç»‘å®šåˆ°ä¸€ä¸ªserviceä¸ä¹‹äº¤äº’ï¼ˆIPCæœºåˆ¶ï¼‰ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªserviceå¯èƒ½ä¼šå¤„ç†ç½‘ç»œæ“ä½œï¼Œæ’­æ”¾éŸ³ä¹ï¼Œæ“ä½œæ–‡ä»¶I/Oæˆ–è€…ä¸å†…å®¹æä¾›è€…ï¼ˆcontent providerï¼‰äº¤äº’ï¼Œæ‰€æœ‰è¿™äº›æ´»åŠ¨éƒ½æ˜¯åœ¨åå°è¿›è¡Œã€‚ Serviceæœ‰ä¸¤ç§çŠ¶æ€ï¼Œâ€œå¯åŠ¨çš„â€å’Œâ€œç»‘å®šâ€ã€‚ ä½¿ç”¨æ–¹æ³• çœ‹ä¸‹å…³äºServiceä¸¤å¼ æ¯”è¾ƒç»å…¸çš„å›¾ ####ç®€å•å®ä¾‹ AndroidManifest.xml 123456789101112131415&lt;application android:label=\"@string/app_name\" android:icon=\"@drawable/ic_launcher\"&gt; &lt;activity android:name=\".MyActivity\" android:label=\"@string/app_name\"&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.MAIN\"/&gt; &lt;category android:name=\"android.intent.category.LAUNCHER\"/&gt; &lt;/intent-filter&gt; &lt;/activity&gt; &lt;service android:name=\".MyService\" android:enabled=\"true\"/&gt; &lt;ï¼--å››å¤§ç»„ä»¶éƒ½è¦åœ¨AndroidManifestä¸­ç”³æ˜ä¸€æŠŠ --&gt; &lt;/application&gt; MyActivity.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public class MyActivity extends Activity implements View.OnClickListener, ServiceConnection { public static String TAG = \"MyActivity\"; Intent intent; /** * Called when the activity is first created. */ @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.main); Log.e(TAG, \"MyActivity OnCreate\"); intent = new Intent(MyActivity.this, MyService.class); findViewById(R.id.bt_startservice).setOnClickListener(this); findViewById(R.id.bt_stopservice).setOnClickListener(this); findViewById(R.id.bt_bindservice).setOnClickListener(this); findViewById(R.id.bt_unbindservice).setOnClickListener(this); } //OnClickäº‹ä»¶ç›‘å¬ public void onClick(View view) { Log.e(TAG,\"OnClick\"); switch (view.getId()) { case R.id.bt_startservice: Log.e(TAG, \"start Service\"); startService(intent); break; case R.id.bt_stopservice: stopService(intent); break; case R.id.bt_bindservice: bindService(intent, this, Context.BIND_AUTO_CREATE); break; case R.id.bt_unbindservice: unbindService(this); break; } } @Override //binderServiceæˆåŠŸåå›è°ƒï¼Œå¸¦è¿‡æ¥çš„IBinderå¯ç”¨äºå’ŒActivityé€šä¿¡ public void onServiceConnected(ComponentName componentName, IBinder iBinder) { Log.e(TAG, \"onServiceConnected\"); } @Override //åœ¨æœåŠ¡å´©æºƒæˆ–è¢«æ€æ­»å¯¼è‡´çš„è¿æ¥ä¸­æ–­æ—¶è¢«è°ƒç”¨ public void onServiceDisconnected(ComponentName componentName) { Log.e(TAG, \"onServiceDisconnected\"); }} MyService.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class MyService extends Service { public static String TAG = \"MyService\"; @Override public void onCreate() { super.onCreate(); Log.e(TAG, \"MyService onCreate\"); } @Override public int onStartCommand(Intent intent, int flags, int startId) { Log.e(TAG, \"onStartCommand\"); //ç”¨æ¥æµ‹è¯•Serviceæ˜¯å¦åœ¨åå°æœ‰è¿è¡Œ /*new Thread(new Runnable() { @Override public void run() { while (true) { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } Log.e(TAG, \"Service is Running ...\"); } } }).start();*/ return super.onStartCommand(intent, flags, startId); } @Override public void onDestroy() { super.onDestroy(); Log.e(TAG, \"onDestroy\"); } @Override public IBinder onBind(Intent intent) { Log.e(TAG, \"onBind\"); return new Binder();//newä¸€ä¸ªbinderå¯¹è±¡é€šè¿‡onServiceConnectedå›è°ƒï¼Œæ–¹ä¾¿é€šä¿¡ } @Override public boolean onUnbind(Intent intent) { Log.e(TAG, \"onUnbind\"); return super.onUnbind(intent); } @Override //onRebindçš„è°ƒç”¨æ—¶æœºå’ŒonUnbindçš„è¿”å›å€¼æœ‰å…³ç³» public void onRebind(Intent intent) { Log.e(TAG, \"onRebind\"); super.onRebind(intent); }} æµ‹è¯•ç»“æœ å¯åŠ¨æœåŠ¡ï¼Œåœæ­¢æœåŠ¡ ç»‘å®šæœåŠ¡ï¼Œè§£ç»‘æœåŠ¡ å¯åŠ¨æœåŠ¡ï¼Œç»‘å®šæœåŠ¡ï¼Œè§£ç»‘æœåŠ¡ æ³¨æ„ï¼šè¿™é‡Œæœ€åServiceæ˜¯æ²¡æœ‰onDestoryçš„ å¯åŠ¨æœåŠ¡ï¼Œç»‘å®šæœåŠ¡ï¼Œè§£ç»‘æœåŠ¡ï¼Œåœæ­¢æœåŠ¡ Binderä½¿ç”¨ï¼Œè¿™ä¸ªå¾ˆå…³é”® MyService.javaä¸­ä¿®æ”¹ 123456789 public IBinder onBind(Intent intent) { Log.e(TAG, \"onBind\"); return new MyBinder(); }class MyBinder extends Binder { public void sayHello() { Log.e(TAG,\"I am a binder, hi\"); } } MyActivity.javaä¸­ä¿®æ”¹ 12345public void onServiceConnected(ComponentName componentName, IBinder iBinder) { Log.e(TAG, \"onServiceConnected\"); MyService.MyBinder binder = (MyService.MyBinder) iBinder; ((MyService.MyBinder) iBinder).sayHello();} ç„¶åæ‰§è¡Œï¼šç»‘å®šæœåŠ¡ï¼Œè§£ç»‘æœåŠ¡ é€šè¿‡è¿™ä¸ªBinderï¼Œå†åŠ ä¸ŠCallbackï¼Œå¯ä»¥å®ç°å¯¹Serviceå†…éƒ¨çŠ¶æ€çš„ç›‘å¬ å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç„¶ååˆ›å»ºgetä¸setï¼Œåœ¨onBinderæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªçº¿ç¨‹ä¸åœçš„å‘é€æ•°æ® 123456789101112public interface Callback() { public void onDateChanged(String data) { }}public void setCallback(Callback callback) { this.callback = callback;}public Callback getCallback() { return callback;} 12345678910111213141516171819202122public IBinder onBind(Intent intent) { Log.e(TAG, \"onBind\"); running = true;//runningé€šè¿‡serviceçš„ç”Ÿå‘½å‘¨æœŸæ§åˆ¶ new Thread(new Runnable() { @Override public void run() { while (running) { try { Thread.sleep(1000); i++; String str = \"send: \" + i ; callback.onDateChanged(str); } catch (InterruptedException e) { e.printStackTrace(); } Log.e(TAG, \"Service is Running ... \"); } } }).start(); return new MyBinder();} ç„¶ååœ¨MyBinderç±»ä¸­å®šä¹‰ä¸€ä¸ªgetServiceæ–¹æ³• 123public MyService getSetvice() { return MyService.this;} ç„¶ååœ¨onServiceConnectedä¸­ 12345678910111213141516public void onServiceConnected(ComponentName componentName, IBinder iBinder) { Log.e(TAG, \"onServiceConnected\"); MyService.MyBinder binder = (MyService.MyBinder) iBinder; MyService myservice = binder.getService(); myservice.setCallback(new MyService.Callback() { @Override public void onDateChanged(String str) {//éUIçº¿ç¨‹æ— æ³•ç›´æ¥æ›´æ–°UIï¼Œéœ€è¦é€šè¿‡handleræœºåˆ¶ Message msg = new Message(); msg.arg1 = 1; Bundle bundle = new Bundle(); bundle.putString(\"data\", str); msg.setData(bundle); handler.sendMessage(msg); } }); } é€šè¿‡è¿™ç§æ–¹å¼å°±å¯ä»¥å®ç°Serviceå’ŒActivityçš„é€šä¿¡å·¥ä½œï¼Œä¸éš¾çœ‹å‡ºï¼ŒBinderåœ¨å…¶ä¸­èµ·ç€éå¸¸é‡è¦çš„è§’è‰²ã€‚Androidä¸­è¿›ç¨‹é—´é€šä¿¡ï¼Œä»JAVAåˆ°C++åŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨Binderæ¥å®ç°çš„ï¼Œä¸Šå±‚ä½¿ç”¨çš„AIDLä¸‹ä¸€ç¯‡ä»‹ç»ä¸€ä¸‹ï¼Œ","link":"/2016/05/22/ã€ŠAndroid åŸºç¡€ï¼ˆä¸€ï¼‰ã€‹ Service/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸ƒï¼‰ã€‹ DrawerLayout and NavigationView","text":"ä»‹ç» DrawerLayoutæ˜¯Support LibraryåŒ…ä¸­å®ç°äº†ä¾§æ»‘èœå•æ•ˆæœçš„æ§ä»¶android.support.v4.widget.DrawerLayoutNavigationViewæ˜¯ä¸€ä¸ªå¯¼èˆªèœå•æ¡†æ¶ï¼Œä½¿ç”¨menuèµ„æºå¡«å……æ•°æ®å¸¸ç”¨æ¥é…åˆDrawerLayoutä½¿ç”¨ åŸºæœ¬ä½¿ç”¨DrawerLayoutå¸ƒå±€æ–‡ä»¶1234567&lt;android.support.v4.widget.DrawerLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:id=\"@+id/drawerlayout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; â€¦â€¦&lt;/android.support.v4.widget.DrawerLayout&gt; ä½¿ç”¨DrawerLayoutçš„æ—¶å€™éœ€è¦å°†è¯¥å¸ƒå±€ä½œä¸ºæ ¹å¸ƒå±€ï¼Œç„¶ååœ¨DrawerLayoutä¸­æ·»åŠ å…¶ä»–å¸ƒå±€ä½œä¸ºæ˜¾ç¤ºç•Œé¢ã€‚ ä»£ç 123456789101112131415161718192021222324drawerLayout = (DrawerLayout) findViewById(R.id.drawerlayout);è·å–DrawerLayoutå¯¹è±¡//è®¾ç½®ç›‘å¬äº‹ä»¶ï¼Œç›‘å¬DrawerLayoutçš„çŠ¶æ€ï¼Œæ‰“å¼€ï¼Œå…³é—­ï¼Œæ»‘åŠ¨è·ç¦»ï¼ŒçŠ¶æ€æ”¹å˜ï¼Œå¯ä»¥å®ç°è‡ªå·±çš„å®šåˆ¶drawerLayout.addDrawerListener(new DrawerLayout.DrawerListener() { @Override public void onDrawerSlide(View drawerView, float slideOffset) { Log.e(TAG , \" onDrawerSlide slideOffset = \" + slideOffset); } @Override public void onDrawerOpened(View drawerView) { Log.e(TAG , \" onDrawerOpened \"); } @Override public void onDrawerClosed(View drawerView) { Log.e(TAG , \" onDrawerClosed \"); } @Override public void onDrawerStateChanged(int newState) { Log.e(TAG , \" onDrawerStateChanged \"); }}); DrawerLayoutçš„çŠ¶æ€ç›‘å¬ï¼Œlistenerçš„å›è°ƒæä¾›ç»™å¼€å‘è€…ä½¿ç”¨ã€‚ NavigationViewå¸ƒå±€æ–‡ä»¶header.xml 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"240dp\" android:background=\"@color/colorPrimaryDark\" android:orientation=\"vertical\"&gt; //å¼•ç”¨GitHubä¸Šçš„å¼€æºåº“ &lt;de.hdodenhof.circleimageview.CircleImageView android:id=\"@+id/civ_profile\" android:layout_width=\"150dp\" android:layout_height=\"150dp\" android:layout_alignParentLeft=\"true\" android:layout_marginLeft=\"24dp\" android:layout_marginStart=\"24dp\" android:layout_marginTop=\"20dp\" android:src=\"@drawable/logo\" /&gt; &lt;TextView android:id=\"@+id/tv_name\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_alignLeft=\"@+id/civ_profile\" android:layout_below=\"@+id/civ_profile\" android:layout_marginTop=\"10dp\" android:text=\"Askmak Sharon\" android:textColor=\"#FFFFFF\" android:textSize=\"8pt\" android:textStyle=\"bold\" /&gt; &lt;TextView android:id=\"@+id/tv_email\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_alignLeft=\"@+id/civ_profile\" android:layout_below=\"@+id/tv_name\" android:layout_marginTop=\"10dp\" android:text=\"onlyloveyd@gmail.com\" android:textColor=\"#FFFFFF\" android:textSize=\"8pt\" android:textStyle=\"italic\" /&gt;&lt;/RelativeLayout&gt; è¿™é‡Œä½¿ç”¨äº†Githubä¸Šçš„å¼€å…³åº“de.hdodenhof.circleimageview.CircleImageViewï¼Œå…¶ä¸­å¯ä»¥è®¾ç½®ä¸€äº›å±æ€§ï¼Œè¿™é‡Œæ²¡æœ‰è®¾ç½®ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘ä½¿ç”¨çš„å›¾ç‰‡é£æ ¼çš„åŸå› ï¼Œå°†å¤´åƒçš„è¾¹æ¡†åŠ ä¸Šå»åçœ‹ä¸Šå»ä¸æ˜¯é‚£ä¹ˆåè°ƒ å±æ€§ æ„ä¹‰ app:civ_border_color=â€â€ è¾¹æ¡†é¢œè‰² app:civ_border_width=â€â€ è¾¹æ¡†å®½åº¦ app:civ_fill_color=â€â€ å¡«å……é¢œè‰² second_menu.xmlè¿™é‡Œåªæ˜¯åå­—å«åšsecond_menuè€Œå·²ï¼Œæ²¡æœ‰å…¶ä»–çš„æ„æ€ï¼Œåªæ˜¯ä¸€ä¸ªæ™®é€šçš„menuèµ„æºæ–‡ä»¶ 123456789101112131415161718192021&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;menu xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;item android:id=\"@+id/nv_profile\" android:icon=\"@drawable/profile\" android:orderInCategory=\"80\" android:title=\"Profile\" /&gt; &lt;item android:id=\"@+id/nv_video\" android:icon=\"@drawable/video\" android:orderInCategory=\"90\" android:title=\"Video\" /&gt; &lt;item android:id=\"@+id/nv_help\" android:icon=\"@drawable/help\" android:orderInCategory=\"100\" android:title=\"Help\" /&gt;&lt;/menu&gt; è¿™ä¸ªmenuèµ„æºæ˜¯ç”¨æ¥åœ¨NavigationViewä¸­ä½¿ç”¨çš„å¯¼èˆªèœå• activity_main.xml 123456789101112131415161718192021222324252627282930313233343536373839&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.v4.widget.DrawerLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:id=\"@+id/drawerlayout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;LinearLayout android:orientation=\"vertical\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;include layout=\"@layout/toolbar\"&gt;&lt;/include&gt; &lt;FrameLayout android:id=\"@+id/frame\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;ImageView android:id=\"@+id/content_iv\" android:layout_gravity=\"center\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:src=\"@mipmap/ic_launcher\"/&gt; &lt;/FrameLayout&gt; &lt;/LinearLayout&gt; &lt;android.support.design.widget.NavigationView android:id=\"@+id/nv_left\" android:layout_width=\"240dp\" android:layout_height=\"match_parent\" android:layout_gravity=\"start\" app:headerLayout=\"@layout/header\" app:menu=\"@menu/second_menu\"&gt; &lt;/android.support.design.widget.NavigationView&gt;&lt;/android.support.v4.widget.DrawerLayout&gt; æ¯”è¾ƒå…³é”®çš„å‡ ä¸ªç‚¹android:layout_gravity=â€œstartâ€app:headerLayout=â€@layout/headerâ€//å¤´å¸ƒå±€app:menu=â€@menu/second_menuâ€//èœå•èµ„æº ä»£ç MainActivity.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485package mraz.com.actionbardemo;import android.os.Bundle;import android.support.design.widget.NavigationView;import android.support.design.widget.Snackbar;import android.support.v4.view.MenuItemCompat;import android.support.v4.widget.DrawerLayout;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.SearchView;import android.support.v7.widget.Toolbar;import android.util.Log;import android.view.Gravity;import android.view.Menu;import android.view.MenuItem;import android.view.View;import android.widget.ImageView;public class MainActivity extends AppCompatActivity { public static String TAG = \"yidong\"; DrawerLayout drawerLayout; NavigationView navigationView; Toolbar toolbar; ImageView imageView; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); drawerLayout = (DrawerLayout) findViewById(R.id.drawerlayout); toolbar = (Toolbar) findViewById(R.id.toolbar); navigationView = (NavigationView) findViewById(R.id.nv_left); imageView = (ImageView) findViewById(R.id.content_iv); setSupportActionBar(toolbar); toolbar.setNavigationIcon(R.drawable.ic_menu_black_24dp); drawerLayout.addDrawerListener(new DrawerLayout.DrawerListener() { @Override public void onDrawerSlide(View drawerView, float slideOffset) { Log.e(TAG , \" onDrawerSlide slideOffset = \" + slideOffset); } @Override public void onDrawerOpened(View drawerView) { Log.e(TAG , \" onDrawerOpened \"); } @Override public void onDrawerClosed(View drawerView) { Log.e(TAG , \" onDrawerClosed \"); } @Override public void onDrawerStateChanged(int newState) { Log.e(TAG , \" onDrawerStateChanged \"); } }); navigationView.setNavigationItemSelectedListener(new NavigationView.OnNavigationItemSelectedListener() { @Override public boolean onNavigationItemSelected(MenuItem item) { if(drawerLayout.isDrawerOpen(Gravity.LEFT)) drawerLayout.closeDrawer(Gravity.LEFT); switch(item.getItemId()) { case R.id.nv_profile: imageView.setImageResource(R.drawable.profile); break; case R.id.nv_video: imageView.setImageResource(R.drawable.video); break; case R.id.nv_help: imageView.setImageResource(R.drawable.help); break; } return true; } }); } â€¦â€¦} é’ˆå¯¹NavigationViewä¸­çš„Menuè®¾ç½®å“åº”äº‹ä»¶ï¼Œä½¿ç”¨çš„æ–¹å¼å’Œä¸Šä¸€ç¯‡ä¸­ActionBarä¸­çš„èœå•èµ„æºä½¿ç”¨æ–¹å¼ç›¸ä¼¼ï¼Œéƒ½æ˜¯ç”¨è¿‡getItemIdè·å–èµ„æºçš„idï¼Œç„¶åä»¥æ­¤ä½œä¸ºä¾æ®è¿›è¡Œå¯¹åº”çš„å“åº”æ“ä½œ ActionBarå’ŒDrawerLayouté…åˆ ä¸€èˆ¬ç”¨æˆ·çš„æ“ä½œå°±æ˜¯å³æ»‘æˆ–è€…ç‚¹å‡»ActionBarå·¦ä¸Šè§’çš„Iconå‡ºç°å·¦ä¾§æŠ½å±‰èœå• å·¦ä¾§æ»‘åŠ¨ä¸Šé¢çš„å†…å®¹å·²ç»å®ç°äº†ï¼Œç‚¹å‡»ActionBarå®ç°æŠ½å±‰èœå•çš„å¼€å…³åªéœ€è¦é’ˆå¯¹å·¦ä¸Šè§’çš„ActionBarçš„å›¾æ ‡åšå¯¹åº”çš„äº‹ä»¶å¤„ç†å³å¯ã€‚ 12setSupportActionBar(toolbar);toolbar.setNavigationIcon(R.drawable.ic_menu_black_24dp); ç„¶ååœ¨onOptionsItemSelectedä¸­ 12345case android.R.id.home: if(!drawerLayout.isDrawerOpen(Gravity.LEFT)) { drawerLayout.openDrawer(Gravity.LEFT, true); } break; å› ä¸ºActionBarçš„NavigationIconå¯¹åº”çš„èµ„æºIDå°±æ˜¯ android.R.id.home æ ¹æ®è¿™ä¸ªèµ„æºIDå®šåˆ¶å¯¹åº”çš„äº‹ä»¶å“åº”ï¼Œä¸Šé¢å°±æ˜¯ç®€å•çš„æ‰“å¼€å·¦ä¾§çš„æŠ½å±‰èœå• æ•ˆæœå›¾NavigationViewèœå•å“åº” ActionBarå·¦ä¸Šè§’å›¾æ ‡å“åº” ####æºä»£ç  ###ç‚¹å‡»ä¸‹è½½æºä»£ç ###","link":"/2016/06/24/ã€ŠAndroid åŸºç¡€ï¼ˆä¸ƒï¼‰ã€‹ DrawerLayout and NavigationView/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¸€ï¼‰ã€‹ ObjectAnimator","text":"ç®€ä»‹ ObjectAnimatorï¼Œæ˜¯ValueAnimatorçš„å­ç±»ï¼Œæ”¯æŒåˆ©ç”¨ç›®æ ‡è§†å›¾çš„å±æ€§æ¥å®ç°åŠ¨ç”»æ•ˆæœã€‚æ„é€ ObjectAnimatorçš„æ—¶å€™ï¼Œå°†ä¼šæå–å¯¹åº”çš„å‚æ•°æ¥å®šä¹‰åŠ¨ç”»å¯¹è±¡å’Œå¯¹è±¡å±æ€§ã€‚åˆé€‚çš„get/setæ–¹æ³•æ˜¯è§†å›¾å®ç°å±æ€§åŠ¨ç”»çš„å†…éƒ¨æœºç†ï¼ŒåŠ¨ç”»è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿå°†é€šè¿‡get/setæ–¹æ³•æ¥å®ç°æ•ˆæœï¼Œä¹Ÿå°±æ˜¯æ ¹æ®ä¸€å®šçš„è§„å¾‹æ¥ä¸ºViewè®¾ç½®å±æ€§ã€‚Animatorså¯ä»¥ç”¨è¿‡èµ„æºæ–‡ä»¶æˆ–è€…æ˜¯ä»£ç å®šä¹‰ï¼Œå½“ä½¿ç”¨èµ„æºæ–‡ä»¶åˆ›å»ºçš„æ—¶å€™ï¼Œè‹¥ä½¿ç”¨PropertyValuesHolderå’ŒKeyframeå¯ä»¥åˆ›å»ºå‡ºæ›´åŠ å¤æ‚çš„åŠ¨ç”»ï¼Œä½¿ç”¨PropertyValuesHolderå¯ä»¥å®ç°å‡ ä¸ªå±æ€§çš„å¹¶è¡Œå˜åŒ–ã€‚ä½¿ç”¨Keyframesï¼Œå¯ä»¥å®ç°æ›´å¤æ‚çš„åŠ¨ç”»è¿‡ç¨‹ä¸­çš„å±æ€§å˜åŒ–æ–¹å¼ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸€ä¸ªKeyframesæ˜ç¡®ä¸€ä¸ªfractional valueï¼ˆå› å­ï¼Œ0-1ï¼‰æ¥å†³å®šåœ¨æ•´ä¸ªåŠ¨ç”»è¿‡ç¨‹ä¸­ä»€ä¹ˆæ—¶å€™åˆ°è¾¾è¿™ä¸ªå±æ€§å€¼ã€‚ä¸è®¾ç½®fractionsçš„æ—¶å€™ï¼Œè¿™äº›å…³é”®å¸§å°†ä¼šå‡åŒ€çš„åˆ†å¸ƒåœ¨æ•´ä¸ªåŠ¨ç”»è¿‡ç¨‹ä¸­ã€‚è‡³äºé‚£äº›æ²¡æœ‰æŒ‡å®švalueå€¼çš„å…³é”®å¸§ï¼Œå°†ä¼šåœ¨åŠ¨ç”»å¼€å§‹çš„æ—¶å€™æ¨å¯¼å‡ºä»–ä»¬çš„ valueã€‚åˆæ¬¡ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å…³é”®å¸§æ·»åŠ æ’å€¼å™¨ï¼Œæ•´ä¸ªæ’å€¼å™¨å°†ä¼šåœ¨è¢«è®¾ç½®çš„è¿™ä¸€å¸§å’Œå‰ä¸€å¸§åŠ¨ç”»ä¹‹é—´ã€‚å¯¹äºæ²¡æœ‰è®¾ç½®æ’å€¼å™¨çš„å…³é”®å¸§ï¼Œå°†ä¼šç»™ä»–ä»¬æä¾›ä¸€ä¸ªé»˜è®¤çš„æ’å€¼å™¨AccelerateDecelerateInterpolator XMLå®ç°123456789101112131415161718192021222324252627282930&lt;objectAnimator xmlns:android=\"http://schemas.android.com/apk/res/android\" android:duration=\"1000\" android:repeatCount=\"1\" android:repeatMode=\"reverse\"&gt; &lt;!-- BEGIN_INCLUDE(KeyframeResources) --&gt; &lt;propertyValuesHolder android:propertyName=\"x\"&gt; &lt;keyframe android:fraction=\"0\" android:value=\"800\" /&gt; &lt;keyframe android:fraction=\".2\" android:interpolator=\"@android:anim/accelerate_interpolator\" android:value=\"1000\" /&gt; &lt;keyframe android:fraction=\"1\" android:interpolator=\"@android:anim/accelerate_interpolator\" android:value=\"400\" /&gt; &lt;/propertyValuesHolder&gt; &lt;propertyValuesHolder android:propertyName=\"y\"&gt; &lt;keyframe /&gt; &lt;keyframe android:fraction=\".2\" android:interpolator=\"@android:anim/accelerate_interpolator\" android:value=\"300\" /&gt; &lt;keyframe android:interpolator=\"@android:anim/accelerate_interpolator\" android:value=\"1000\" /&gt; &lt;/propertyValuesHolder&gt; &lt;!-- END_INCLUDE(KeyframeResources) --&gt;&lt;/objectAnimator&gt; objectAnimatorå±æ€§å€¼ å«ä¹‰ android:propertyName å±æ€§åç§° android:valueTo åŠ¨ç”»ç»“æŸæ—¶å±æ€§çš„å€¼ android:valueFrom android:duration åŠ¨ç”»æ—¶é•¿ android:startOffset åŠ¨ç”»å»¶è¿Ÿå‡ ç§’æ’­æ”¾ï¼Œè°ƒç”¨start()æ–¹æ³•åå»¶è¿Ÿ android:repeatCount åŠ¨ç”»é‡å¤æ¬¡æ•° android:repeatMode åŠ¨ç”»é‡å¤çš„æ–¹å¼ï¼Œrestart/reverse android:valueType å±æ€§å€¼ç±»å‹ï¼ŒintType,floatType,colorType,pathType propertyValuesHolderå±æ€§å€¼å’ŒobjectAnimatoråŸºæœ¬ç›¸åŒkeyframeå±æ€§å€¼ | å«ä¹‰â€”â€”â€”â€”â€”â€”â€“ | â€”â€”â€”â€”â€”android:fraction | æ’å€¼å› å­android:interpolator | æ’å€¼å™¨ï¼Œç”¨åœ¨å½“å‰å¸§å’Œå‰ä¸€å¸§ä¹‹é—´android:value | éœ€è¦è®¾ç½®çš„å±æ€§å€¼ ä»£ç å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120public class MainActivity extends AppCompatActivity { private int width; private int height; private ImageView imageView = null; private ImageView loveImageView = null; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); toolbar.setNavigationIcon(R.drawable.left); setSupportActionBar(toolbar);//è®¾ç½®ActionBar getWidthAndHeight();//è·å–å±å¹•å¤§å° imageView = (ImageView) findViewById(R.id.ball); loveImageView = (ImageView) findViewById(R.id.love); } /* å¿ƒè·³ */ public void doAnimation(final View view) { PropertyValuesHolder pvhX = PropertyValuesHolder.ofFloat(\"alpha\", 1f, 0.8f, 1f, 0.8f, 1.0f); PropertyValuesHolder pvhY = PropertyValuesHolder.ofFloat(\"scaleX\", 0.6f, 0.8f, 1f, 0.8f, 1.0f); PropertyValuesHolder pvhZ = PropertyValuesHolder.ofFloat(\"scaleY\", 0.6f, 0.8f, 1f, 0.8f, 1.0f); ObjectAnimator.ofPropertyValuesHolder(loveImageView, pvhX, pvhY, pvhZ).setDuration(1000).start();//åˆ›å»ºå±æ€§åŠ¨ç”»å¹¶å¼€å§‹ } /* æŠ›ç‰©çº¿ */ public void doGtAnimation(final View view) { ObjectAnimator anim = ObjectAnimator.ofFloat(imageView, \"yidong\", 0, 1, 0).setDuration(3000); /*è®¾ç½®åŠ¨ç”»æ›´æ–°ç›‘å¬å™¨ï¼Œé€šè¿‡æ‰‹åŠ¨è®¾ç½®å±æ€§æ¥å®ç°viewå±æ€§çš„æ”¹å˜è¾¾åˆ°åŠ¨ç”»çš„æ•ˆæœ*/ anim.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { @Override public void onAnimationUpdate(ValueAnimator animation) { float cVal = (Float) animation.getAnimatedValue(); imageView.setX(5 * cVal * 100); imageView.setY(5 * cVal * 3 * cVal * 3 * 100); } }); /*è®¾ç½®åŠ¨ç”»è¿‡ç¨‹ç›‘å¬å™¨ï¼Œç›‘å¬å¼€å§‹ç»“æŸå–æ¶ˆç­‰åŠ¨ä½œ*/ anim.addListener(new Animator.AnimatorListener() { @Override public void onAnimationStart(Animator animation) { System.err.println(\"yidong -- onAnimationStart\"); } @Override public void onAnimationEnd(Animator animation) { System.err.println(\"yidong -- onAnimationEnd\"); } @Override public void onAnimationCancel(Animator animation) { System.err.println(\"yidong -- onAnimationCancel\"); } @Override public void onAnimationRepeat(Animator animation) { System.err.println(\"yidong -- onAnimationRepeat\"); } }); /*é‡å¤é­”çŸ³*/ anim.setRepeatMode(ValueAnimator.RESTART); /*é‡å¤æ¬¡æ•°*/ anim.setRepeatCount(2); anim.start(); } /* è½¬åœˆåœˆ */ public void doCircleAnimation(View view) { ObjectAnimator anim = ObjectAnimator.ofFloat(imageView, \"yidong\", 0, 2 * (float) Math.PI).setDuration(1000); anim.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { @Override public void onAnimationUpdate(ValueAnimator animation) { System.err.println(\"yidong -- value = \" + animation.getAnimatedValue()); float cVal = (Float) animation.getAnimatedValue(); imageView.setX((float) Math.sin(cVal) * 200 + width / 2); imageView.setY((float) Math.cos(cVal) * 200 + height / 2); } }); anim.setRepeatMode(ValueAnimator.REVERSE); anim.setRepeatCount(-1);//æ— é™é‡å¤ anim.start(); } /* ä»xmlæ–‡ä»¶ä¸­æå–åŠ¨ç”» */ public void doXmlAnimation(View view) { Animator animator = AnimatorInflater.loadAnimator(this, R.animator.one);//ä»xmlæ–‡ä»¶ä¸­æ·»åŠ åŠ¨ç”» animator.setTarget(loveImageView); animator.start(); } /* è·å–å±å¹•çš„å®½é«˜ */ private void getWidthAndHeight() { WindowManager wm = (WindowManager) getSystemService(WINDOW_SERVICE); DisplayMetrics dm = new DisplayMetrics(); wm.getDefaultDisplay().getMetrics(dm); width = dm.widthPixels; height = dm.heightPixels; System.err.println(\"yidong -- width = \" + width); System.err.println(\"yidong -- height = \" + height); }} å®é™…æ•ˆæœ æ€»ç»“å±æ€§åŠ¨ç”»çš„å†…å®¹å¾ˆä¸°å¯Œï¼Œè¿™é‡Œåªæ˜¯æåˆ°äº†ObjectAnimatorçš„ä¸€äº›ç®€å•å®ç°ï¼Œå¾ˆæ·±å…¥å’Œå…¨é¢çš„ä¸œè¥¿ï¼Œéœ€è¦è‡ªå·±çœ‹æºç ï¼Œç†Ÿæ‚‰å¯¹åº”çš„APIã€‚","link":"/2016/11/23/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¸€ï¼‰ã€‹ ObjectAnimator/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¸‰ï¼‰ã€‹ TabHost ~ ä»¿å¾®ä¿¡åº•éƒ¨èœå•","text":"ç®€ä»‹ Container for a tabbed window view. This object holds two children: a set of tab labels that theuser clicks to select a specific tab, and a FrameLayout object that displays the contents of thatpage. The individual elements are typically controlled using this container object, rather thansetting values on the child elements themselves.TabHost ï¼Œæ ‡ç­¾è§†å›¾çš„å®¹å™¨ã€‚å®¹å™¨åŒ…å«ä¸¤ä¸ªå­©å­èŠ‚ç‚¹ï¼Œä¸€ä¸ªç”¨æ¥å­˜æ”¾ä¸€ç³»åˆ—çš„æ ‡ç­¾ï¼Œç‚¹å‡»æ¥é€‰æ‹©å¯¹åº”çš„çª—å£ï¼›ä¸€ä¸ªæ˜¯FrameLayoutç”¨æ¥å­˜æ”¾é¡µé¢å…·ä½“å†…å®¹ã€‚è¿™äº›ç‹¬ç«‹çš„å…ƒç´ é€šå¸¸ç”¨TabHostæ¥æ§åˆ¶ï¼Œè€Œä¸æ˜¯åœ¨è§†å›¾å†…éƒ¨é€šè¿‡è®¾ç½®å€¼æ¥å®ç° ç±»ç»“æ„ æ–¹æ³• æ„ä¹‰ addTab æ·»åŠ ä¸€ä¸ªtab clearAllTabs ç§»é™¤æ‰€æœ‰çš„tab dispatchKeyEvent ä¸‹å‘keyevent dispatchWindowFocusChanged ä¸‹å‘windowsfocusChangedäº‹ä»¶ newTabSpec åˆ›å»ºä¸€ä¸ªæ–°çš„TabSpecï¼Œå…³è”åˆ°å…·ä½“å†…å®¹ onTouchModeChanged NA setupï¼ˆï¼‰ ä¸å’ŒTabActivityå…³è”ï¼Œé€šè¿‡findViewByIdè·å–çš„TabHostéœ€è¦è°ƒç”¨setup(),å¦‚æœæ˜¯åœ¨TabActivityä¸­é€šè¿‡getTabHost()çš„æ–¹å¼è·å–çš„ä¸éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³• setup(LocalActivityManager activityGroup) setContentä¸­ä¼ å…¥intentçš„æ—¶å€™æ‰å…³æ³¨ä¸‹è¿™ä¸ªæ–¹æ³• getCurrentTab()/setCurrentTab() è·å–/è®¾ç½®å½“å‰éœ€è¦æ˜¾ç¤ºçš„tabï¼Œé€šè¿‡index setCurrentTabByTag/getCurrentTabTag é€šè¿‡tagè®¾ç½®å½“å‰éœ€è¦æ˜¾ç¤ºçš„Tab,tagå°±æ˜¯åˆ›å»ºTabSpecçš„æ—¶å€™ä¼ å…¥çš„å­—ç¬¦ä¸² getCurrentTabView è®¾ç½®/è·å–å½“å‰åœ¨TabWidgetä¸­æ˜¾ç¤ºçš„View,ä¹Ÿå°±æ˜¯ä½œä¸ºæ ‡ç­¾çš„Viewè€Œéå†…å®¹ getCurrentView è·å–å½“å‰æ˜¾ç¤ºçš„å†…å®¹ setOnTabChangedListener è®¾ç½®æ ‡ç­¾é¡µåˆ‡æ¢äº‹ä»¶ç›‘å¬ getTabContentView è·å–å†…å®¹é¡µé¢çš„å®¹å™¨FrameLayout getTabWidget è·å–TabWidget åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶(content_fragment.xml)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" android:background=\"@color/colorTopBackGround\"&gt;&lt;/android.support.v7.widget.Toolbar&gt; &lt;TabHost android:id=\"@+id/tabhost\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;!-- è®¾ç½®çš„idå¿…é¡»æ˜¯ \"@android:id/tabcontent\"--&gt; &lt;FrameLayout android:id=\"@android:id/tabcontent\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"9\"&gt; &lt;TextView android:id=\"@+id/tv_one\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"This is one\" android:textColor=\"@color/colorAccent\" android:textSize=\"20sp\" /&gt; &lt;TextView android:id=\"@+id/tv_two\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"This is two\" android:textColor=\"@color/colorPrimary\" android:textSize=\"25sp\" /&gt; &lt;TextView android:id=\"@+id/tv_three\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"This is three\" android:textColor=\"@color/colorPrimaryDark\" android:textSize=\"30sp\" /&gt; &lt;TextView android:id=\"@+id/tv_four\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"This is Four\" android:textColor=\"@color/colorBlack\" android:textSize=\"35sp\" /&gt; &lt;/FrameLayout&gt; &lt;!-- è®¾ç½®çš„idå¿…é¡»æ˜¯android:id=\"@android:id/tabs\" --&gt; &lt;TabWidget android:id=\"@android:id/tabs\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"1\" android:background=\"@color/colorWhite\" android:padding=\"5dp\" android:showDividers=\"none\"&gt;&lt;/TabWidget&gt; &lt;/LinearLayout&gt; &lt;/TabHost&gt;&lt;/LinearLayout&gt; è‡ªå®šä¹‰åº•éƒ¨æ ‡ç­¾å¸ƒå±€(myindicator.xml)12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;ImageView android:id=\"@+id/iv_indicator\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"5\"&gt;&lt;/ImageView&gt; &lt;TextView android:id=\"@+id/tv_indicator\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"2.5\" android:gravity=\"center\" android:textSize=\"5pt\" /&gt;&lt;/LinearLayout&gt; åº•éƒ¨ä¸€ä¸ªå›¾æ ‡ä¸‹é¢ä¸€æ®µæ–‡å­—ä»£ç ä½¿ç”¨(MainActivity.java)ï¼Œä¸ä½¿ç”¨TabActivity123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293public class MainActivity extends AppCompatActivity { float initx = 0.0f, currentx = 0.0f; TabHost tabHost = null; Toolbar toolbar = null; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.content_fragment); toolbar = (Toolbar) findViewById(R.id.toolbar); setSupportActionBar(toolbar);//è®¾ç½®ActionBar toolbar.setTitleTextColor(getResources().getColor(R.color.colorWhite));//è®¾ç½®èƒŒæ™¯è‰² tabHost = (TabHost) findViewById(R.id.tabhost); tabHost.setup();//åˆå§‹åŒ–TabHost /*æ·»åŠ tab*/ for (int i = 0; i &lt; 4; i++) { View view = LayoutInflater.from(this).inflate(R.layout.myindicator, null, false); TextView textView = (TextView) view.findViewById(R.id.tv_indicator); ImageView imageView = (ImageView) view.findViewById(R.id.iv_indicator); switch (i) { case 0: textView.setText(\"å¾®ä¿¡\"); imageView.setImageResource(R.drawable.weixin); tabHost.addTab(tabHost.newTabSpec(\"1\").setIndicator(view).setContent(R.id.tv_one)); break; case 1: textView.setText(\"é€šè®¯å½•\"); imageView.setImageResource(R.drawable.contact); tabHost.addTab(tabHost.newTabSpec(\"2\").setIndicator(view).setContent(R.id.tv_two)); break; case 2: textView.setText(\"å‘ç°\"); imageView.setImageResource(R.drawable.find); tabHost.addTab(tabHost.newTabSpec(\"3\").setIndicator(view).setContent(R.id.tv_three)); break; case 3: textView.setText(\"æˆ‘\"); imageView.setImageResource(R.drawable.profile); tabHost.addTab(tabHost.newTabSpec(\"4\").setIndicator(view).setContent(R.id.tv_four)); break; } } /*è®¾ç½®æ ‡ç­¾åˆ‡æ¢ç›‘å¬å™¨*/ tabHost.setOnTabChangedListener(new TabHost.OnTabChangeListener() { @Override public void onTabChanged(String tabId) { for (int i = 0; i &lt; 4; i++) {//é¢œè‰²å…¨éƒ¨é‡ç½® ((TextView) tabHost.getTabWidget().getChildTabViewAt(i).findViewById(R.id.tv_indicator)).setTextColor(getResources().getColor(R.color.colorBlack)); } if (tabHost.getCurrentTabTag() == tabId) { ((TextView) tabHost.getCurrentTabView().findViewById(R.id.tv_indicator)).setTextColor(getResources().getColor(R.color.colorSelected)); }//é€‰ä¸­çš„é‚£ä¸ªTabæ–‡å­—é¢œè‰²ä¿®æ”¹ } }); ((TextView) tabHost.getCurrentTabView().findViewById(R.id.tv_indicator)).setTextColor(getResources().getColor(R.color.colorSelected));//ç¬¬ä¸€æ¬¡è¿›å…¥çš„æ—¶å€™è®²é€‰ä¸­çš„Tabä¿®æ”¹æ–‡å­—é¢œè‰² } @Override public boolean onTouchEvent(MotionEvent event) { switch (event.getAction()) { case MotionEvent.ACTION_DOWN: initx = event.getX(); break; case MotionEvent.ACTION_MOVE: currentx = event.getX(); break; case MotionEvent.ACTION_UP: /*å·¦å³æ»‘åŠ¨äº‹ä»¶å¤„ç†*/ if ((currentx - initx) &gt; 25) { if (tabHost.getCurrentTab() != 0) { tabHost.setCurrentTab(tabHost.getCurrentTab() - 1); } } else if ((currentx - initx) &lt; -25) { if (tabHost.getCurrentTab() != tabHost.getTabContentView().getChildCount()) { tabHost.setCurrentTab(tabHost.getCurrentTab() + 1); } } break; } return true; } /*èœå•åˆ›å»º*/ @Override public boolean onCreateOptionsMenu(Menu menu) { getMenuInflater().inflate(R.menu.toolbar, menu); return true; }} ä»£ç ä½¿ç”¨(MainActivity.java)ï¼Œç»§æ‰¿TabActivityTabActivityå·²ç»è¢«åºŸå¼ƒå¾ˆä¹…äº†ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ï¼Œåœ¨å¸ƒå±€ä¸­å°†TabHostçš„idæ”¹æˆandroid:id=â€@android:id/tabhostâ€ï¼Œç„¶ååœ¨ç»§æ‰¿äº†TabActivityçš„MainActivity.javaä¸­ä½¿ç”¨tabHost = getTabHost();ç„¶ååŸºæœ¬ä½¿ç”¨æ–¹æ³•å°±å’Œä¸Šé¢ä¸€æ ·äº† å®é™…æ•ˆæœ æ€»ç»“TabHoståœ¨TabActivityä¸­çš„ä½¿ç”¨ç°åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸å¤šï¼Œæ¨èä½¿ç”¨ViewPagerå’ŒFragmentçš„æ–¹å¼ã€‚","link":"/2016/11/30/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¸‰ï¼‰ã€‹ TabHost ~ ä»¿å¾®ä¿¡åº•éƒ¨èœå•/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¹ï¼‰ã€‹ SpannableString","text":"ç®€ä»‹çœ‹ä¸‹ç±»çš„è‹±æ–‡è¯´æ˜ï¼š This is the class for text whose content is immutable but to whichmarkup objects can be attached and detached.For mutable text, see {@link SpannableStringBuilder}. è£…é¥°ç‰©å¯ä»¥æ·»åŠ å’Œåˆ é™¤çš„å®šé•¿æ–‡æœ¬ã€‚é’ˆå¯¹ä¸å®šé•¿æ–‡æœ¬ï¼Œè¯·ä½¿ç”¨SpannableStringBuilderã€‚ ç±»æºç 12345678910111213141516171819202122232425262728293031323334353637383940public class SpannableStringextends SpannableStringInternalimplements CharSequence, GetChars, Spannable{ public SpannableString(CharSequence source) { super(source, 0, source.length()); } private SpannableString(CharSequence source, int start, int end) { super(source, start, end); } public static SpannableString valueOf(CharSequence source) { if (source instanceof SpannableString) { return (SpannableString) source; } else { return new SpannableString(source); } } /* whatä»£è¡¨span,startå’Œendåˆ†åˆ«ä»£è¡¨æ–‡æœ¬æ•ˆæœè¦†ç›–çš„èµ·ç‚¹indexå’Œç»ˆç‚¹index flag: SPAN_INCLUSIVE_INCLUSIVE:åŒ…å«èµ·ç‚¹ç»ˆç‚¹ SPAN_EXCLUSIVE_EXCLUSIVE:ä¸åŒ…å«èµ·ç‚¹ç»ˆç‚¹ SPAN_INCLUSIVE_EXCLUSIVE:åŒ…å«èµ·ç‚¹ä¸åŒ…å«ç»ˆç‚¹ SPAN_EXCLUSIVE_INCLUSIVE:ä¸åŒ…å«èµ·æ¥åŒ…å«ç»ˆç‚¹ */ public void setSpan(Object what, int start, int end, int flags) { super.setSpan(what, start, end, flags); } public void removeSpan(Object what) { super.removeSpan(what); } public final CharSequence subSequence(int start, int end) { return new SpannableString(this, start, end); }} è¿™ä¸ªç±»æœ¬èº«æ˜¯æ²¡æœ‰å¤šå°‘å†…å®¹çš„ï¼Œä½†æ˜¯å¦‚æœæ·±ç©¶åˆ°å…¶çˆ¶ç±»ï¼Œå¯èƒ½è¿˜æ˜¯æœ‰ä¸€äº›ä¸œè¥¿å¯ä»¥çœ‹åˆ°ã€‚æ•´ä½“æ¥è¯´ï¼Œä½ å¯ä»¥æŠŠä»–ç†è§£æˆä¸€ä¸ªé«˜é˜¶çš„Stringã€‚SpannableStringBuilderå°±æ˜¯é«˜é˜¶çš„StringBuilder. åŸºæœ¬ä½¿ç”¨çœ‹ä¸‹frameworks/base/core/java/android/text/style/ç›®å½•ä¸‹çš„æ–‡ä»¶å†…å®¹ï¼Œå¤§éƒ¨åˆ†æ˜¯æ”¯æŒçš„Spanç§ç±»ã€‚ AbsoluteSizeSpan å•ä½ä¸ºç‰©ç†åƒç´  12345//pixel sizeSpannableString spanString = new SpannableString(\"AbsoluteSizeSpan\");AbsoluteSizeSpan absoluteSizeSpan = new AbsoluteSizeSpan(100);spanString.setSpan(absoluteSizeSpan, 2, 5, Spannable.SPAN_INCLUSIVE_INCLUSIVE);mAbsoluteSizeSpanTextView.setText(spanString); AlignmentSpanæ”¯æŒALIGN_NORMALï¼ŒALIGN_OPPOSITEï¼ŒALIGN_CENTERï¼Œæ•ˆæœè‡ªè¡Œæ›¿æ¢å°è¯• 1234567//æ–‡æœ¬å¯¹é½æ–¹å¼SpannableString spannableString2 = new SpannableString( \"AlignmentSpanasdfasdfasdfasdfasdfasdasdfasdfasdasdagsdfsdfasdfsdfasdfasdafsdfsdfsdfsdf\");AlignmentSpan alignmentSpan = new AlignmentSpan.Standard(Layout.Alignment.ALIGN_CENTER);spannableString2.setSpan(alignmentSpan, 0, spannableString2.length(), Spannable.SPAN_INCLUSIVE_INCLUSIVE);mAlignmentSpanTextView.setText(spannableString2); BackgroundColorSpan æ–‡å­—èƒŒæ™¯è‰²æ”¹å˜ 123456//èƒŒæ™¯è‰²æ”¹å˜SpannableString spannableString3 = new SpannableString(\"BackgroundColorSpan\");BackgroundColorSpan backgroundColorSpan = new BackgroundColorSpan( Color.parseColor(\"#FFAACC\"));spannableString3.setSpan(backgroundColorSpan, 2, 5, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mBackgroundColorSpanTextView.setText(spannableString3); BulletSpan12345//å°å­å¼¹ï¼Œç±»ä¼¼äºåˆ—è¡¨å‰é¢çš„å°åœ†åœˆSpannableString spannableString4 = new SpannableString(\"BulletSpan\");spannableString4.setSpan(new BulletSpan(66, 0xff303F9F), 0, spannableString4.length(), Spannable.SPAN_INCLUSIVE_INCLUSIVE);mBulletSpanTextView.setText(spannableString4); ClickableSpan12345678910//å¯ç‚¹å‡»SpannableString spannableString5 = new SpannableString(\"ClickableSpan\");spannableString5.setSpan(new ClickableSpan() { @Override public void onClick(View view) { Toast.makeText(MainActivity.this, \"Click\", Toast.LENGTH_SHORT).show(); }}, 0, 5, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mClickableSpanTextView.setText(spannableString5);mClickableSpanTextView.setMovementMethod(LinkMovementMethod.getInstance()); DrawableMarginSpan123456//Drawableï¼Œä¸å ä½SpannableString spannableString6 = new SpannableString(\"DrawableMarginSpan\");DrawableMarginSpan drawableMarginSpan = new DrawableMarginSpan( getResources().getDrawable(R.drawable.android), 10);spannableString6.setSpan(drawableMarginSpan, 0, 0, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mDrawableMarginSpanTextView.setText(spannableString6); DynamicDrawableSpan123456789101112//DynamicDrawable,å ä½SpannableString spannableString7 = new SpannableString(\"DynamicDrawableSpan\");DynamicDrawableSpan dynamicDrawableSpan = new DynamicDrawableSpan() { @Override public Drawable getDrawable() { Drawable drawable = getResources().getDrawable(R.drawable.android); drawable.setBounds(0, 0, 100, 100); return drawable; }};spannableString7.setSpan(dynamicDrawableSpan, 0, 4, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mDynamicDrawableSpanTextView.setText(spannableString7); ForegroundColorSpan1234567//å‰æ™¯è‰²SpannableString spannableString9 = new SpannableString(\"ForegroundColorSpan\");ForegroundColorSpan foregroundColorSpan = new ForegroundColorSpan( Color.parseColor(\"#AABBCC\"));spannableString9.setSpan(foregroundColorSpan, 1, spannableString9.length() - 1, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mForegroundColorSpanTextView.setText(spannableString9); IconMarginSpan12345678//å›¾æ ‡marginï¼Œä¸å ä½SpannableString spannableString10 = new SpannableString( \"IconMarginSpan------------------------\");IconMarginSpan iconMarginSpan = new IconMarginSpan( BitmapFactory.decodeResource(getResources(), R.mipmap.ic_launcher));spannableString10.setSpan(iconMarginSpan, 0, spannableString10.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);mIconMarginSpanTextView.setText(spannableString10); ImageSpan1234567//å›¾ç‰‡ï¼Œå ä½SpannableString spannableString11 = new SpannableString( \"ImageSpan------------------------\");ImageSpan imageSpan = new ImageSpan(this, BitmapFactory.decodeResource(getResources(), R.mipmap.ic_launcher));spannableString11.setSpan(imageSpan, 0, 1, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mImageSpanTextView.setText(spannableString11); LeadingMarginSpan123456//æ§åˆ¶è¡Œå‰ç©ºéš™SpannableString spannableString12 = new SpannableString( \"LeadingMarginSpan.Standard--------------------------------------------------\");spannableString12.setSpan(new LeadingMarginSpan.Standard(96, 36), 0, spannableString12.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);mLeadingMarginSpanTextView.setText(spannableString12); QuoteSpan12345//å·¦ä¾§å‡ºç°å¼•ç”¨ç¬¦å· ç«–çº¿SpannableString spannableString15 = new SpannableString(\"QuoteSpan\");QuoteSpan quoteSpan = new QuoteSpan(Color.BLACK);spannableString15.setSpan(quoteSpan, 0, 5, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mQuoteSpanTextView.setText(spannableString15); RelativeSizeSpan12345//å­—ä½“æ”¾å¤§SpannableString spannableString17 = new SpannableString(&quot;RelativeSizeSpan&quot;);RelativeSizeSpan relativeSizeSpan = new RelativeSizeSpan(2.5F);spannableString17.setSpan(relativeSizeSpan, 0, 4, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mRelativeSizeSpanTextView.setText(spannableString17); ScaleXSpan12345//å­—ä½“å®½åº¦æ”¾å¤§SpannableString spannableString18 = new SpannableString(\"ScaleXSpan\");ScaleXSpan scaleXSpan = new ScaleXSpan(5);spannableString18.setSpan(scaleXSpan, 0, 4, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mScaleXSpanTextView.setText(spannableString18); StrikethroughSpan12345//åˆ é™¤çº¿SpannableString spannableString19 = new SpannableString(\"StrikethroughSpan\");StrikethroughSpan strikethroughSpan = new StrikethroughSpan();spannableString19.setSpan(strikethroughSpan, 0, 4, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mStrikethroughSpanTextView.setText(spannableString19); StyleSpan123456789//ä¸»è¦ç”±æ­£å¸¸ã€ç²—ä½“ã€æ–œä½“å’ŒåŒæ—¶åŠ ç²—å€¾æ–œå››ç§æ ·å¼ï¼Œå¸¸é‡å€¼å®šä¹‰åœ¨Typefaceç±»ä¸­ã€‚æ„é€ å‡½æ•°ï¼šSpannableString spannableString20 = new SpannableString(\"StyleSpan\");Parcel parcel = Parcel.obtain();parcel.writeInt(Typeface.BOLD_ITALIC);parcel.setDataPosition(0);StyleSpan styleSpan = new StyleSpan(parcel);spannableString20.setSpan(styleSpan, 0, spannableString20.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);mStyleSpanTextView.setText(spannableString20); SubscriptSpan12345//ä¸‹æ ‡SpannableString spannableString21 = new SpannableString(\"SubscriptSpan9\");SubscriptSpan subscriptSpan = new SubscriptSpan();spannableString21.setSpan(subscriptSpan, 0, spannableString21.length()-7, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mSubscriptSpanTextView.setText(spannableString21); SuperscriptSpan12345//ä¸Šæ ‡SpannableString spannableString23 = new SpannableString(\"SuperscriptSpan\");SuperscriptSpan superscriptSpan = new SuperscriptSpan();spannableString23.setSpan(superscriptSpan, 0, spannableString21.length()-7, Spanned.SPAN_INCLUSIVE_INCLUSIVE);mSuperscriptSpanTextView.setText(spannableString23); TextAppearanceSpan12345//Sets the text color, size, style, and typeface to match a TextAppearanceSpannableString spannableString24 = new SpannableString(\"TextAppearanceSpan\");TextAppearanceSpan textAppearanceSpan = new TextAppearanceSpan(this, R.style.StyleSpanDemo);spannableString24.setSpan(textAppearanceSpan, 0, spannableString24.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);mTextAppearanceSpanTextView.setText(spannableString24); TypefaceSpan12345//å­—ä½“è®¾ç½®SpannableString spannableString25 = new SpannableString(\"TypefaceSpan\");TypefaceSpan typefaceSpan= new TypefaceSpan(\"monospace\");spannableString25.setSpan(typefaceSpan, 0, spannableString25.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);mTypefaceSpanTextView.setText(spannableString25); UnderlineSpan12345//ä¸‹åˆ’çº¿SpannableString spannableString26 = new SpannableString(\"UnderlineSpan\");UnderlineSpan underlineSpan= new UnderlineSpan();spannableString26.setSpan(underlineSpan, 0, spannableString25.length() - 4 , Spanned.SPAN_INCLUSIVE_INCLUSIVE);mUnderlineSpanTextView.setText(spannableString26); URLSpan12345//URLSpannableString spannableString27 = new SpannableString(\"URLSpan------------------------------\");URLSpan urlSpan = new URLSpan(\"https://www/baidu.com\");spannableString27.setSpan(urlSpan, 0, spannableString26.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);mURLSpanTextView.setText(spannableString27); å¤‡æ³¨ç¤ºä¾‹å®Œæ•´Github:https://github.com/onlyloveyd/SpannableDemo","link":"/2017/08/11/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åä¹ï¼‰ã€‹ SpannableString/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åäº”)ã€‹ RecyclerViewå¤šç±»å‹Itemçš„æ­£ç¡®å®ç°å§¿åŠ¿","text":"ç®€ä»‹RecyclerViewæ˜¯æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„ä¸€ä¸ªå…ƒç´ ï¼ŒåŸç”Ÿçš„RecyclerView.AdapteråŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³ä¸€èˆ¬çš„éœ€æ±‚ï¼Œå…³äºRecyclerViewçš„åŸºç¡€ä»‹ç»è¯·ç§»æ­¥ï¼š RecyclerViewåŸºç¡€ä½¿ç”¨ å…³äºå¤šç±»å‹çš„Item,åŸç”Ÿçš„Adapterå¯ä»¥é€šè¿‡getItemViewTypeè¿”å›å¯¹åº”çš„ViewHolderç±»å‹ï¼Œç„¶ååœ¨onCreateViewHolderä¼ å…¥çš„typeå‚æ•°ï¼Œç”Ÿæˆä¸åŒçš„ViewHolderï¼Œæ›´è¦å‘½çš„æ˜¯æ•°æ®ç»‘å®šè¿‡ç¨‹ä¸­onBindViewHolderåªä¼ å…¥ViewHolderå¯¹è±¡å’Œpositionï¼Œé’ˆå¯¹ä¸åŒçš„ViewHolderï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡instanceofå’Œå¼ºåˆ¶ç±»å‹è£…æ¢æ¥å¯¹ä¸åŒçš„ViewHolderè¿›è¡Œä¸åŒçš„æ•°æ®æ“ä½œã€‚ è¿™æ ·åšçš„å¼Šç«¯å°±æ˜¯ï¼Œåç»­å¦‚æœéœ€è¦æ·»åŠ ä¸€ä¸ªç±»å‹ï¼Œå‡ ä¹éœ€è¦ä¿®æ”¹Adapterç±»ä¸­çš„æ¯ä¸€ä¸ªæ–¹æ³•ï¼Œä¸åˆ©äºç»´æŠ¤ã€‚ ç±»ç»“æ„ ç›®çš„ ä¾¿äºç»´æŠ¤ã€‚å¢åˆ Itemçš„ç±»å‹ä¸éœ€è¦ä¿®æ”¹Adapterçš„ä»£ç ï¼› æ¡ä¾‹æ¸…æ™°ã€‚ä¸åŒç±»å‹çš„Itemå¯¹åº”ä¸åŒçš„Beanç±»ï¼Œå¯¹åº”ä¸ç”¨çš„ViewHolder,å¯¹åº”ä¸åŒçš„layout, item type &lt;-&gt; layout &lt;â€”&gt; ViewHolder &lt;-&gt; java bean å·¥å‚æ¥å£ã€‚æŠ½è±¡å‡ºTypeFactoryæ¥å£ï¼Œé’ˆå¯¹åŒä¸€ä¸ªBean,å¯ä»¥ä½¿ç”¨ä¸åŒçš„layoutå’Œä¸åŒçš„ViewHolderã€‚ æ€è·¯ æ‰€æœ‰Beanç±»å®ç°ç»Ÿä¸€Visitableæ¥å£ï¼Œå®ç°typeæ–¹æ³•ï¼Œè¿”å›å¯¹åº”çš„layout id; åˆ›å»ºBaseViewHolderä½¿ç”¨æ³›å‹ï¼ŒTä¸ºBeanç±»ã€‚ä½¿ç”¨SparseArrayå­˜å‚¨View,Viewçš„idä½œä¸ºå”¯ä¸€æ ‡è¯†ã€‚ å…·ä½“çš„ViewHolderç±»ï¼Œç»§æ‰¿BaseViewHolder,ä¼ å…¥ä¸åŒçš„Beanç±»ï¼Œæ–¹ä¾¿ä¸åŒçš„ViewHolderä¸­ç»‘å®šä¸åŒçš„æ•°æ®ã€‚ Adapterå®ç°ä¸­ä½¿ç”¨Visitable ListåŒä¸€å¤„ç†åˆ—è¡¨æ•°æ®ï¼Œä½¿ç”¨äº‹é¡¹TypeFactoryæ¥å£çš„å®ä¾‹è¿”å›ItemTypeï¼ŒviewHolderç­‰ ä»£ç ç»“æ„ ä»£ç å†…å®¹Visitableæ¥å£123public interface Visitable { int type(TypeFactory typeFactory);} TypeFactoryæ¥å£1234567public interface TypeFactory { int type(BannerBean bannerBean); int type(ContentBean contentBean); int type(SearchBean searchBean); int type(DividerBean dividerBean); BaseViewHolder createViewHolder(int type, View itemView);} BaseViewHolderæŠ½è±¡ç±»12345678910111213141516171819202122public abstract class BaseViewHolder&lt;T&gt; extends RecyclerView.ViewHolder{ SparseArray&lt;View&gt; mViews; View mItemView; public BaseViewHolder(View itemView) { super(itemView); mItemView = itemView; mViews = new SparseArray&lt;&gt;(); } public View getView(int resId) { View view = mViews.get(resId); if(view== null) { view = mItemView.findViewById(resId); mViews.put(resId, view); } return view; } public abstract void bindViewData(T data);} TypeFactoryå®ç°ç±»: ItemTypeFactory123456789101112131415161718192021222324252627282930313233343536373839404142public class ItemTypeFactory implements TypeFactory { public static final int BANNER_ITEM_LAYOUT = R.layout.rv_item_banner; public static final int CONTENT_ITEM_LAYOUT = R.layout.rv_item_content; public static final int SEARCH_ITEM_LAYOUT = R.layout.rv_item_search; public static final int DIVIDER_ITEM_LAYOUT = R.layout.rv_item_divider; @Override public int type(BannerBean bannerBean) { return BANNER_ITEM_LAYOUT; } @Override public int type(ContentBean contentBean) { return CONTENT_ITEM_LAYOUT; } @Override public int type(DividerBean dividerBean){ return DIVIDER_ITEM_LAYOUT; } @Override public int type(SearchBean dividerBean){ return SEARCH_ITEM_LAYOUT; } @Override public BaseViewHolder createViewHolder(int type, View itemView) { switch (type) { case BANNER_ITEM_LAYOUT: return new BannerViewHolder(itemView); case SEARCH_ITEM_LAYOUT: return new SearchViewHolder(itemView); case CONTENT_ITEM_LAYOUT: return new ContentViewHolder(itemView); case DIVIDER_ITEM_LAYOUT: return new DividerViewHolder(itemView); default: return null; } }} å„ç§Java Beanç±»BannerBean1234567891011121314151617181920public class BannerBean implements Visitable { int[] mResIds; public BannerBean(int[] mResIds) { this.mResIds = mResIds; } public int[] getmResIds() { return mResIds; } public void setmResIds(int[] mResIds) { this.mResIds = mResIds; } @Override public int type(TypeFactory typeFactory) { return typeFactory.type(this); }} 123456789101112&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=\"match_parent\" android:layout_height=\"200dp\"&gt; &lt;cn.bingoogolapple.bgabanner.BGABanner android:id=\"@+id/bgabanner_header\" android:layout_width=\"match_parent\" android:layout_height=\"200dp\"&gt; &lt;/cn.bingoogolapple.bgabanner.BGABanner&gt;&lt;/LinearLayout&gt; ContentBean123456789101112131415161718192021public class ContentBean implements Visitable{ String content; public String getContent() { return content; } public void setContent(String content) { this.content = content; } public ContentBean(String content) { this.content = content; } @Override public int type(TypeFactory typeFactory) { return typeFactory.type(this); }} 12345678910111213&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\"&gt; &lt;TextView android:id=\"@+id/tv_content\" android:textStyle=\"italic\" android:fontFamily=\"sans-serif-condensed\" android:textSize=\"16sp\" android:gravity=\"center_horizontal\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" /&gt;&lt;/LinearLayout&gt; DividerBean1234567public class DividerBean implements Visitable{ @Override public int type(TypeFactory typeFactory) { return typeFactory.type(this); }} 1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"@drawable/divider\"&gt;&lt;/LinearLayout&gt; SearchBean123456public class SearchBean implements Visitable { @Override public int type(TypeFactory typeFactory) { return typeFactory.type(this); }} 1234567891011121314151617181920212223242526&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"horizontal\" android:layout_width=\"match_parent\" android:layout_height=\"50dp\" android:padding=\"6dp\"&gt; &lt;EditText android:layout_marginLeft=\"30dp\" android:id=\"@+id/et_search\" android:layout_width=\"0dp\" android:layout_weight=\"9\" android:maxLines=\"1\" android:textSize=\"10sp\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:hint=\"è¾“å…¥æ–‡å­—æœç´¢...\" android:background=\"@drawable/bg_search\" android:layout_height=\"match_parent\" /&gt; &lt;ImageView android:id=\"@+id/bt_search\" android:layout_width=\"0dp\" android:layout_weight=\"2\" android:src=\"@drawable/search\" android:layout_height=\"match_parent\" /&gt;&lt;/LinearLayout&gt; MultiRecyclerAdapter123456789101112131415161718192021222324252627282930public class MultiRecyclerAdapter extends RecyclerView.Adapter&lt;BaseViewHolder&gt; { List&lt;Visitable&gt; mData; TypeFactory typeFactory; public MultiRecyclerAdapter(List&lt;Visitable&gt; mData) { this.mData = mData; this.typeFactory = new ItemTypeFactory(); } @Override public BaseViewHolder onCreateViewHolder(ViewGroup parent, int viewType) { View view = LayoutInflater.from(parent.getContext()).inflate(viewType, parent, false); return typeFactory.createViewHolder(viewType, view); } @Override public void onBindViewHolder(BaseViewHolder holder, int position) { holder.bindViewData(mData.get(position)); } @Override public int getItemViewType(int position) { return mData.get(position).type(typeFactory); } @Override public int getItemCount() { return (mData != null ? mData.size() : 0); }} ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243public class MultiActivity extends AppCompatActivity { @BindView(R.id.rv_content) RecyclerView rvContent; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_weather); ButterKnife.bind(this); List&lt;Visitable&gt; beans = new ArrayList&lt;&gt;(); int[] resIds = {R.mipmap.banner_one, R.mipmap.banner_two, R.mipmap.banner_three, R.mipmap.banner_four, R.mipmap.banner_five}; beans.add(new BannerBean(resIds)); beans.add(new SearchBean()); beans.add(new DividerBean()); beans.add(new ContentBean(\"one\")); beans.add(new ContentBean(\"one\")); beans.add(new ContentBean(\"one\")); beans.add(new DividerBean()); beans.add(new ContentBean(\"two\")); beans.add(new ContentBean(\"two\")); beans.add(new ContentBean(\"two\")); beans.add(new DividerBean()); beans.add(new ContentBean(\"three\")); beans.add(new ContentBean(\"three\")); beans.add(new ContentBean(\"three\")); beans.add(new DividerBean()); beans.add(new ContentBean(\"four\")); beans.add(new ContentBean(\"four\")); beans.add(new ContentBean(\"four\")); beans.add(new DividerBean()); MultiRecyclerAdapter multiRecyclerAdapter = new MultiRecyclerAdapter(beans); LinearLayoutManager linearLayoutManager = new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false); rvContent.setAdapter(multiRecyclerAdapter); rvContent.setLayoutManager(linearLayoutManager); }} æ•ˆæœ å†™åœ¨æœ€å æ€è·¯æ¥æºï¼š https://medium.com/@dpreussler/writing-better-adapters-1b09758407d2 githubä¸Šä¹Ÿæœ‰å¾ˆå¤šå¼€æºçš„ä¸‡èƒ½Adapterï¼Œä½†æ˜¯ä¸ªäººæ„Ÿè§‰è¿™ä¸ªæ€è·¯è™½ç„¶å®ç°ä¸Šä»£ç ä¼šç›¸å¯¹è¾ƒå¤šï¼Œä½†æ˜¯å±‚æ¬¡åˆ†æï¼Œä¾¿äºç»´æŠ¤ï¼Œæ‰©å±•æ€§è¾ƒå¥½ã€‚æƒ³è¦æ·»åŠ ä¸€ä¸ªæ–°ç±»å‹çš„ItemTypeï¼Œåªéœ€è¦ç¨ä½œä¿®æ”¹å³å¯å¿«é€Ÿå®Œæˆï¼Œä¸ç”¨ä¿®æ”¹Adapterçš„ä»£ç ã€‚","link":"/2017/01/13/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åäº”)ã€‹ RecyclerViewå¤šç±»å‹Itemçš„æ­£ç¡®å®ç°å§¿åŠ¿/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åå…«ï¼‰ã€‹ FragmentTabHost","text":"ç®€ä»‹ FragmentTabHostæ˜¯ä¸€ç§ç‰¹æ®Šçš„TabHostï¼Œå…è®¸æˆ‘ä»¬åœ¨Tabå†…å®¹åŒºåŸŸå†…ä½¿ç”¨Fragmentã€‚å½“æˆ‘ä»¬å¾—åˆ°FragmentTabHostå¯¹è±¡åï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡è°ƒç”¨setup(Context, FragmentManager, int)æ–¹æ³•æ¥å®Œæˆå¯¹tabhostçš„åˆå§‹åŒ–ã€‚FragmentTabHostæ˜¯Android4.0ç‰ˆæœ¬çš„æ§ä»¶, ä¹‹å‰è¢«å¹¿æ³›çš„ä½¿ç”¨ï¼Œä½†æ˜¯æˆ‘å°½ç„¶æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œå› ä¸ºæˆ‘å¼€å§‹å­¦ä¹ Androidçš„æ—¶å€™ç‰ˆæœ¬å·²ç»æ¥åˆ°äº†5.0ç‰ˆæœ¬ï¼Œä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯TabLayout+ViewPagerè¿™ç§æ–¹å¼ã€‚ä½†æ˜¯ä½œä¸ºåŸºç¡€çŸ¥è¯†ï¼ŒFragmentTabHostä¹Ÿæ˜¯éœ€è¦å­¦ä¹ ä¸€ä¸‹çš„ã€‚ ç±»ç»“æ„ FragmentTabHostç»§æ‰¿TabHostã€‚å…ˆçœ‹ä¸€ä¸‹publicæ–¹æ³• æ–¹æ³• æè¿° public FragmentTabHost(Context context) æ„é€ æ–¹æ³• public FragmentTabHost(Context context, AttributeSet attrs) æ„é€ æ–¹æ³• public void setup(Context context, FragmentManager manager)/public void setup(Context context, FragmentManager manager, int containerId) FragmentTabHoståˆå§‹åŒ–æ–¹æ³•ï¼Œå¿…é¡»è°ƒç”¨æ­¤æ–¹æ³•å®Œæˆåˆå§‹åŒ– public void setOnTabChangedListener(OnTabChangeListener l) è®¾ç½®é¡µé¢åˆ‡æ¢ç›‘å¬å™¨ public void addTab(@NonNull TabHost.TabSpec tabSpec, @NonNull Class&lt;?&gt; clss,@Nullable Bundle args) æ·»åŠ æ ‡ç­¾ public void onTabChanged(String tabId) FragmentTabHostå®ç°TabHost.OnTabChangeListener åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶ activity_main.xml æ³¨æ„ï¼š android:id=â€@android:id/tabhostâ€ android:id=â€@android:id/tabcontentâ€ android:id=â€@android:id/tabsâ€ 123456789101112131415161718192021222324&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.v4.app.FragmentTabHost android:id=\"@android:id/tabhost\" xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;FrameLayout android:id=\"@android:id/tabcontent\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"1\"/&gt; &lt;TabWidget android:id=\"@android:id/tabs\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" android:layout_gravity=\"bottom\"/&gt; &lt;/LinearLayout&gt;&lt;/android.support.v4.app.FragmentTabHost&gt; fragment_content.xml 12345678910111213141516&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;TextView android:id=\"@+id/tab_tv_text\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:gravity=\"center\" android:textSize=\"40sp\" tools:text=\"Test\"/&gt;&lt;/LinearLayout&gt; indicator.xml 12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;ImageView android:id=\"@+id/iv_indicator\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"5\"/&gt; &lt;TextView android:id=\"@+id/tv_indicator\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"2.5\" android:gravity=\"center\" android:textSize=\"5pt\" /&gt;&lt;/LinearLayout&gt; ä»£ç  MainActivity.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public class MainActivity extends AppCompatActivity { // å›¾ç‰‡ @DrawableRes private int mImages[] = { R.drawable.tab_daily, R.drawable.tab_sort, R.drawable.tab_bonus, R.drawable.tab_about }; // æ ‡é¢˜ private String mFragmentTags[] = { \"æ¯æ—¥å¹²è´§\", \"åˆ†ç±»é˜…è¯»\", \"ç¦åˆ©ç¤¾åŒº\", \"å…³äºä½œè€…\" }; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); FragmentTabHost fragmentTabHost = (FragmentTabHost) this.findViewById(android.R.id.tabhost); fragmentTabHost.setup(this,getSupportFragmentManager(), android.R.id.tabcontent); for (int i = 0; i &lt; mImages.length; i++) { TabHost.TabSpec tabSpec = fragmentTabHost.newTabSpec(mFragmentTags[i]).setIndicator(getImageView(i)); fragmentTabHost.addTab(tabSpec, YFragment.class, null); fragmentTabHost.getTabWidget().getChildAt(i).setBackgroundResource(R.color.colorWhite); } fragmentTabHost.setOnTabChangedListener(new TabHost.OnTabChangeListener() { @Override public void onTabChanged(String s) { Toast.makeText(MainActivity.this, \"OnTabChanged To : \" + s, Toast.LENGTH_SHORT).show(); } }); } // è·å¾—å›¾ç‰‡èµ„æº private View getImageView(int index) { @SuppressLint(\"InflateParams\") View view = getLayoutInflater().inflate(R.layout.indicator, null); ImageView imageView = view.findViewById(R.id.iv_indicator); TextView textView = view.findViewById(R.id.tv_indicator); imageView.setImageResource(mImages[index]); textView.setText(mFragmentTags[index]); return view; }} YFragment.java 1234567891011121314151617181920public class YFragment extends Fragment { TextView mTvText; @Nullable @Override public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) { View view = inflater.inflate(R.layout.fragment_content, container, false); mTvText = view.findViewById(R.id.tab_tv_text); return view; } @Override public void onViewCreated(View view, @Nullable Bundle savedInstanceState) { super.onViewCreated(view, savedInstanceState); mTvText.setText(String.valueOf(getTag())); }} å›¾ç‰‡èµ„æºtab_daily.xml 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;selector xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;item android:state_selected=\"true\" android:drawable=\"@drawable/tab_daily_select\"/&gt; &lt;item android:drawable=\"@drawable/tab_daily_unselect\"/&gt;&lt;/selector&gt; å…¶ä½™å‡ ä¸ªtabæ ‡ç­¾çš„å†…å®¹å‚ç…§å¦‚ä¸Š æ•ˆæœ å…¶ä»–æµ‹è¯•æ“ä½œä¸€ï¼šæ³¨é‡Šæ‰ TabWidget activity_main.xml 123456789101112131415161718192021222324&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.v4.app.FragmentTabHost android:id=\"@android:id/tabhost\" xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;FrameLayout android:id=\"@android:id/tabcontent\" android:layout_width=\"match_parent\" android:layout_height=\"0dp\" android:layout_weight=\"1\"/&gt; &lt;!--&lt;TabWidget--&gt; &lt;!--android:id=\"@android:id/tabs\"--&gt; &lt;!--android:layout_width=\"match_parent\"--&gt; &lt;!--android:layout_height=\"?attr/actionBarSize\"--&gt; &lt;!--android:layout_gravity=\"bottom\"/&gt;--&gt; &lt;/LinearLayout&gt;&lt;/android.support.v4.app.FragmentTabHost&gt; æ“ä½œä¸€ï¼šæ³¨é‡Šæ‰Idä¸º@android:id/tabcontentçš„å†…å®¹123456789101112131415161718192021222324&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.v4.app.FragmentTabHost android:id=\"@android:id/tabhost\" xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;!--&lt;FrameLayout--&gt; &lt;!--android:id=\"@android:id/tabcontent\"--&gt; &lt;!--android:layout_width=\"match_parent\"--&gt; &lt;!--android:layout_height=\"0dp\"--&gt; &lt;!--android:layout_weight=\"1\"/&gt;--&gt; &lt;!--&lt;TabWidget--&gt; &lt;!--android:id=\"@android:id/tabs\"--&gt; &lt;!--android:layout_width=\"match_parent\"--&gt; &lt;!--android:layout_height=\"?attr/actionBarSize\"--&gt; &lt;!--android:layout_gravity=\"bottom\"/&gt;--&gt; &lt;/LinearLayout&gt;&lt;/android.support.v4.app.FragmentTabHost&gt; å¤‡æ³¨ç¬¬äº”éƒ¨åˆ†çš„è§£é‡Šå¯ä»¥ä»FragmentTabHostçš„æºç ä¸­åˆ†æå¾—åˆ°ã€‚","link":"/2017/08/08/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åå…«ï¼‰ã€‹ FragmentTabHost/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åå››ï¼‰ã€‹ TabLayout ä»å¤´åˆ°è„š","text":"ç®€ä»‹ 1.TabLayoutç»™æˆ‘ä»¬æä¾›çš„æ˜¯ä¸€æ’æ¨ªå‘çš„æ ‡ç­¾é¡µ 2.#newTab()è¿™ä¸ªæ–¹æ³•æ¥åˆ›å»ºæ–°çš„æ ‡ç­¾é¡µï¼Œç„¶åç”¨è¿‡#setText()å’Œ#setIconæ–¹æ³•åˆ†åˆ«ä¿®æ”¹æ ‡ç­¾é¡µçš„æ–‡æœ¬å’Œå›¾æ ‡ï¼Œåˆ›å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨#addtab()æ–¹æ³•æŠŠä»–åŠ åˆ°TabLayoutä¸­æ˜¾ç¤ºå‡ºæ¥ 3.ç¬¬äºŒç§æ·»åŠ æ ‡ç­¾çš„æ–¹å¼å°±æ˜¯ç›´æ¥åœ¨TabLayoutå¸ƒå±€ä¸‹æ·»åŠ #TabItemæ§ä»¶ 4.å¯¹äºTabLayoutåœ¨æ ‡ç­¾ä¹‹å‰çš„åˆ‡æ¢äº‹ä»¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨æ¥å¤„ç†ï¼Œ#setOnTabSelectedListener(OnTabSelectedListener) 5.TabLayoutå¯ä»¥å’ŒViewPagerä¸€èµ·ä½¿ç”¨ è‡ªå®šä¹‰å±æ€§å€¼TabLayoutå±æ€§ å±æ€§ æ„ä¹‰ tabGravity fillï¼Œå¡«æ»¡TabLayoutï¼›center,å±…ä¸­æ˜¾ç¤º tabMode fixed, å›ºå®šæ ‡ç­¾ï¼›scrollableï¼Œå¯æ»šåŠ¨æ ‡ç­¾ï¼Œä¸ªæ•°è¾ƒå°‘çš„æ—¶å€™å¯ä»¥ä½¿ç”¨fixed,å¦‚æœæ ‡ç­¾è¶…å‡ºäº†å±å¹•èŒƒå›´ï¼Œè®¾ç½®ä¸ºscrollableæ¯”è¾ƒå¥½ tabMaxWidth Tabçš„æœ€å¤§å®½åº¦ tabIndicatorColor åº•éƒ¨æ»‘åŠ¨çš„çº¿æ¡çš„é¢œè‰²ï¼Œé»˜è®¤æ˜¯colorAccent tabIndicatorHeight åº•éƒ¨æ»‘åŠ¨çº¿æ¡çš„é«˜åº¦ tabPadding* æ ‡ç­¾é¡µçš„padding tabBackground æ ‡ç­¾é¡µçš„èƒŒæ™¯ tabTextAppearance æ–‡æœ¬è®¾ç½® tabSelectedTextColor é€‰ä¸­å­—ä½“é¢œè‰² TabItemå±æ€§ å±æ€§ æ„ä¹‰ text æ ‡ç­¾æ–‡å­— icon å›¾æ ‡ layout è‡ªå®šä¹‰å¸ƒå±€ æºç åˆ†æ ä¸€ç‚¹ä¸€ç‚¹çš„çœ‹ ç±»æˆå‘˜ ç¨å¾®è§£é‡Šä¸€ä¸‹ Mode MODE_SCROLLABLE, MODE_FIXEDä¸¤ç§æ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯å›ºå®šï¼Œä¸€ä¸ªæ˜¯å¯æ»šåŠ¨ TabGravity GRAVITY_FILLï¼Œ GRAVITY_CENTER,ä¸¤ç§æ‘†æ”¾æ–¹å¼ï¼Œé“ºæ»¡å’Œå±…ä¸­ OnTabSelectedListener Tabåˆ‡æ¢äº‹ä»¶çš„å›è°ƒæ¥å£ Tabç±» å¯¹TabViewè¿›è¡Œçš„å°è£…ï¼Œç»™å®ƒåŠ äº†ä¸€äº›å±æ€§ï¼Œå› ä¸ºTabViewæ— æ³•å¯¹å¤–æš´éœ²ï¼Œç›¸å½“äºç»™å¤–éƒ¨æä¾›ä¸€ä¸ªè°ƒç”¨çš„ç±»ï¼Œå€¼å¾—ä¸€æçš„æ˜¯è¿™ä¸ªtagæ˜¯ä¸€ä¸ªobject,æ‰€ä»¥å¯ä»¥å¾€é‡Œé¢å­˜æ”¾å„ç§å†…å®¹ï¼Œä¼ é€’æ•°æ®çš„æ—¶å€™å¯èƒ½ä¼šæœ‰ç”¨ TabLayoutOnPageChangeListener ç»§æ‰¿ ViewPager.OnPageChangeListenerç”¨äºä¸ViewPagerè”åŠ¨ï¼Œä¸»è¦æ˜¯indicatorçš„åŠ¨ä½œå’Œtabé¡µçš„é€‰ä¸­ ViewPagerOnTabSelectedListener ç»§æ‰¿TabLayout.OnTabSelectedListenerï¼Œviewpagerç”¨æ¥é…åˆtablayoutçš„é¡µé¢åˆ‡æ¢äº‹ä»¶ æ–¹æ³• ç¨å¾®è§£é‡Šä¸€ä¸‹ æ„é€ æ–¹æ³• ä¸æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œåˆ›å»ºæ ‡ç­¾æ¡å°±æ˜¯ä¸‹é¢æ»šæ¥æ»šå»çš„é‚£ä¸ªä¸œä¸œï¼Œè·å–è‡ªå®šä¹‰å±æ€§å€¼ addTab æ‰‹åŠ¨æ·»åŠ Tabé¡µ addOnTabSelectedListener/removeOnTabSelectedListenerã€clearOnTabSelectedListeners æ·»åŠ /ç§»é™¤/æ¸…ç©ºTabé€‰æ‹©äº‹ä»¶ç›‘å¬å™¨ newTab åˆ›å»ºTabé¡µ getTabAt é€šè¿‡indexè·å–Tab removeTab é€šè¿‡tabå®ä¾‹ç§»é™¤tab removeTabAt ç§»é™¤ç‰¹å®šä½ç½®çš„tab removeAllTabs æ¸…ç©ºtabs setTabTextColors è®¾ç½®tabçš„æ­£å¸¸æ˜¾ç¤ºé¢œè‰²å’Œé€‰ä¸­åé¢œè‰² setupWithViewPager é€šè¿‡ViewPageråˆå§‹åŒ–TabLayout shouldDelayChildPressedState åˆ¤æ–­æ˜¯å¦éœ€è¦delayè§†å›¾çš„pressçŠ¶æ€ï¼Œä¸€èˆ¬æ— æ³•æ»šåŠ¨çš„è§†å›¾ç›´æ¥è¿”å›false,å¯ä»¥æ»šåŠ¨çš„è§†å›¾çœ‹æƒ…å†µè¿”å›trueæˆ–è€…false addView æ·»åŠ TabItem,å¦‚æœå‚æ•°ç±»å‹ä¸æ˜¯TabItemä¼šæŠ¥å¼‚å¸¸ generateLayoutParams é»˜è®¤ç”Ÿæˆå±æ€§å€¼ï¼Œé˜²æ­¢TabItemæ²¡æœ‰å®šä¹‰android:layout_*è€ŒæŠ¥å¼‚å¸¸ ç»“åˆä¸Šé¢çš„ä»‹ç»ï¼Œè¿™äº›å†…å®¹å«ä¹‰åº”è¯¥æ¯”è¾ƒæ¸…æ™°äº† åŸºæœ¬ä½¿ç”¨ä¸ä½¿ç”¨setupWithViewPager,ä¸ViewPagerè”åŠ¨å¸ƒå±€æ–‡ä»¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/activity_main\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" tools:context=\"onlyloveyd.com.indicatordemo.MainActivity\"&gt; &lt;android.support.design.widget.TabLayout android:id=\"@+id/tb_title\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"@color/colorWhite\" app:tabGravity=\"fill\" app:tabIndicatorColor=\"@color/colorAccent\" app:tabIndicatorHeight=\"4dp\" app:tabMode=\"fixed\" app:tabSelectedTextColor=\"@color/colorAccent\" app:tabTextColor=\"@color/colorBlack\"&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:icon=\"@drawable/one\" android:text=\"ç¤¾ä¼š\"/&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:icon=\"@drawable/two\" android:text=\"å¨±ä¹\"/&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:icon=\"@drawable/three\" android:text=\"ä½“è‚²\"/&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:icon=\"@drawable/four\" android:text=\"å†›äº‹\"/&gt; &lt;/android.support.design.widget.TabLayout&gt; &lt;android.support.v4.view.ViewPager android:id=\"@+id/vp_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"/&gt;&lt;/LinearLayout&gt; MainActivity123456789101112131415161718192021public class MainActivity extends AppCompatActivity { @BindView(R.id.activity_main) LinearLayout activityMain; @BindView(R.id.vp_content) ViewPager vpContent; @BindView(R.id.tb_title) TabLayout tbTitle; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); MainPagerAdapter mainPagerAdapter = new MainPagerAdapter(getSupportFragmentManager()); vpContent.setAdapter(mainPagerAdapter); tbTitle.addOnTabSelectedListener(new TabLayout.ViewPagerOnTabSelectedListener(vpContent)); vpContent.addOnPageChangeListener(new TabLayout.TabLayoutOnPageChangeListener(tbTitle)); }} å…³é”®ç‚¹åœ¨æœ€åä¸¤è¡Œä»£ç  12tbTitle.addOnTabSelectedListener(new TabLayout.ViewPagerOnTabSelectedListener(vpContent));vpContent.addOnPageChangeListener(new TabLayout.TabLayoutOnPageChangeListener(tbTitle)); è¿™ä¸¤è¡Œä»£ç æ¥æºäºTabLayoutçš„setupWithViewPageræ–¹æ³•ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†å®ç°ViewPagerå’ŒTabLayoutçš„è”åŠ¨ï¼Œä½†æ˜¯ä¹Ÿä¸ç”¨removeAllTabsï¼Œçœ‹è¿‡è¿™éƒ¨åˆ†æºç çš„æœ‹å‹åº”è¯¥éƒ½çŸ¥é“ï¼ŒsetupWithViewPageræ–¹æ³•ä¸­å…ˆæ¸…é™¤tab,ç„¶åæ ¹æ®ViewPagerçš„getPagerTitleè¿”å›çš„å­—ç¬¦ä¸²åˆ›å»ºæ–‡å­—Tabå¹¶ä¸”æ·»åŠ åˆ°TabLayoutä¸­ç”¨äºä¸ViewPagerè”åŠ¨ï¼Œè¿™å°±æ˜¯ä¸ºå•¥å¾ˆå¤šåˆå­¦è€…åœ¨ä½¿ç”¨setupWithViewPagerçš„æ—¶å€™å‡ºç°tabé¡µæ— æ³•æ˜¾ç¤ºçš„é—®é¢˜ä¸€èˆ¬åŸå› éƒ½æ˜¯è‡ªå·±æ·»åŠ äº†tabæˆ–è€…æ˜¯åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰äº†TabItemä½†æ˜¯ä½¿ç”¨çš„æ—¶å€™è°ƒç”¨äº†setupWithViewPageræ–¹æ³•ï¼Œä½†æ˜¯ViewPagerçš„Adapteråˆæ²¡æœ‰å¤å†™getPagerTitleæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•åœ¨PagerAdapterä¸­å®é»˜è®¤è¿”å›nullçš„ã€‚åŒæ—¶è¿˜æœ‰ä¸€ä¸ªå¼Šç«¯å°±æ˜¯setupWithViewPagerå¹¶ä¸æ”¯æŒå›¾æ ‡æ˜¾ç¤ºã€‚ï¼ŒåŸå› å°±æ˜¯ï¼š è€Œåœ¨populateFromPagerAdapterçš„å®ç°ä¸­ 123456789101112131415161718void populateFromPagerAdapter() { removeAllTabs();//ä¸€å¼€å§‹å°±æŠŠå…¨éƒ¨çš„tabç»™å¹²æ‰ if (mPagerAdapter != null) { final int adapterCount = mPagerAdapter.getCount();//è·å–ViewPagerçš„æ•°é‡ for (int i = 0; i &lt; adapterCount; i++) { addTab(newTab().setText(mPagerAdapter.getPageTitle(i)), false);//åªæ‹¿title,æ²¡æœ‰è®¾ç½®icon } // Make sure we reflect the currently set ViewPager item if (mViewPager != null &amp;&amp; adapterCount &gt; 0) { final int curItem = mViewPager.getCurrentItem(); if (curItem != getSelectedTabPosition() &amp;&amp; curItem &lt; getTabCount()) { selectTab(getTabAt(curItem)); } } }} å®é™…æ•ˆæœ ä½¿ç”¨setupWithViewPager,ä¸ViewPagerè”åŠ¨ æ—¢ç„¶setupWithViewPagerä¼šæ¸…é™¤TabItem,é‚£ä¹ˆæˆ‘ä»¬å°±ä¸æ·»åŠ TabItemï¼Œè®©å®ƒè‡ªå·±å¤„ç†å§ å¸ƒå±€æ–‡ä»¶å»æ‰ä¸Šä¸ªä¾‹å­ä¸­çš„å››ä¸ªTabItemMainActivityä¸­å»æ‰åé¢ä¸¤è¡Œï¼Œæ¢æˆå¦‚ä¸‹ä¸€è¡Œä»£ç 1tbTitle.setupWithViewPager(vpContent); å®é™…æ•ˆæœ è™½è¯´setupWithViewPageræœ¬èº«çš„å®ç°è¿‡ç¨‹æ˜¯ä¸æ”¯æŒIconçš„æ˜¾ç¤ºçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±åŠ¨æ‰‹ï¼Œä¸€ä¸ªç®€å•çš„å¾ªç¯è§£å†³é—®é¢˜ï¼Œå®ç°çš„æ•ˆæœä¸ä¸Šé¢4.1èŠ‚ç›¸åŒ 1234for(int index = 0 ; index&lt; tbTitle.getTabCount(); index++) { TabLayout.Tab tab = tbTitle.getTabAt(index); tab.setIcon(MainPagerAdapter.mIcons[index]);} è‡ªå®šä¹‰Layoutçš„TabItemå›¾æ ‡+æ–‡å­—å¸ƒå±€æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/activity_main\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" tools:context=\"onlyloveyd.com.indicatordemo.MainActivity\"&gt; &lt;android.support.design.widget.TabLayout android:id=\"@+id/tb_title\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"@color/colorWhite\" app:tabGravity=\"fill\" app:tabIndicatorColor=\"@color/colorAccent\" app:tabIndicatorHeight=\"4dp\" app:tabMode=\"fixed\" app:tabSelectedTextColor=\"@color/colorAccent\" app:tabTextColor=\"@color/colorBlack\"&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:icon=\"@drawable/one\" android:layout=\"@layout/custom_indicator\" android:text=\"ç¤¾ä¼š\"/&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:layout=\"@layout/custom_indicator2\" android:icon=\"@drawable/two\" android:text=\"å¨±ä¹\"/&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:layout=\"@layout/custom_indicator3\" android:icon=\"@drawable/three\" android:text=\"ä½“è‚²\"/&gt; &lt;android.support.design.widget.TabItem android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:icon=\"@drawable/four\" android:text=\"å†›äº‹\"/&gt; &lt;/android.support.design.widget.TabLayout&gt; &lt;android.support.v4.view.ViewPager android:id=\"@+id/vp_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"/&gt;&lt;/LinearLayout&gt; ä½¿ç”¨è‡ªå®šä¹‰å¸ƒå±€android:layout=â€@layout/custom_indicatorâ€android:layout=â€@layout/custom_indicator2â€android:layout=â€@layout/custom_indicator3â€ custom_indicator.xmlæ–‡ä»¶å†…å®¹ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œçš„TextViewçš„idå¿…é¡»æ˜¯â€@android:id/text1â€,ImageViewçš„idå¿…é¡»æ˜¯â€@android:id/iconâ€ï¼ŒåŸå› æ¥è‡ªäºä¸TabLayoutçš„æºç ä¸­TabViewçš„updateæ–¹æ³•ã€‚ custom_indicator.xml 12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\"&gt; &lt;TextView android:id=\"@android:id/text1\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:gravity=\"center\" /&gt; &lt;ImageView android:id=\"@android:id/icon\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"center\" /&gt;&lt;/LinearLayout&gt; å…¶ä»–çš„ä¸¤ä¸ªæ–‡ä»¶å’Œè¿™ä¸ªç±»ä¼¼ï¼Œåªæ˜¯ä½ç½®è°ƒæ•´ä¸€ä¸‹ã€‚ å®é™…æ•ˆæœ","link":"/2017/01/02/ã€ŠAndroid åŸºç¡€ï¼ˆä¸‰åå››ï¼‰ã€‹ TabLayout ä»å¤´åˆ°è„š/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå…­ï¼‰ã€‹ ActionBar","text":"ä»‹ç» Action Baræ˜¯ä¸€ç§æ–°å¢—çš„å¯¼èˆªæ åŠŸèƒ½ï¼Œåœ¨Android 3.0ä¹‹ååŠ å…¥åˆ°ç³»ç»Ÿçš„APIå½“ä¸­ï¼Œå®ƒæ ‡è¯†äº†ç”¨æˆ·å½“å‰æ“ä½œç•Œé¢çš„ä½ç½®ï¼Œå¹¶æä¾›äº†é¢å¤–çš„ç”¨æˆ·åŠ¨ä½œã€ç•Œé¢å¯¼èˆªç­‰åŠŸèƒ½ã€‚ä½¿ç”¨ActionBarçš„å¥½å¤„æ˜¯ï¼Œå®ƒå¯ä»¥ç»™æä¾›ä¸€ç§å…¨å±€ç»Ÿä¸€çš„UIç•Œé¢ï¼Œä½¿å¾—ç”¨æˆ·åœ¨ä½¿ç”¨ä»»ä½•ä¸€æ¬¾è½¯ä»¶æ—¶éƒ½æ‡‚å¾—è¯¥å¦‚ä½•æ“ä½œï¼Œå¹¶ä¸”ActionBarè¿˜å¯ä»¥è‡ªåŠ¨é€‚åº”å„ç§ä¸åŒå¤§å°çš„å±å¹•ã€‚ä¸‹é¢æ˜¯ä¸€å¼ ä½¿ç”¨ActionBarçš„ç•Œé¢æˆªå›¾ï¼š å…¶ä¸­ï¼Œ[1]æ˜¯ActionBarçš„å›¾æ ‡ï¼Œ[2]æ˜¯ä¸¤ä¸ªactionæŒ‰é’®ï¼Œ[3]æ˜¯overflowæŒ‰é’®ã€‚ åŸºæœ¬ä½¿ç”¨æ·»åŠ ActionBarå¸ƒå±€æ–‡ä»¶AndroidStudioè‡ªåŠ¨åˆ›å»ºçš„MainActivityç»§æ‰¿è‡ªAppCompatActivityæœ¬èº«æºå¸¦æœ‰ActionBarï¼Œè¿™é‡Œæƒ³è¦ä½¿ç”¨ToolBaræ¥å®ç°ActionBarçš„åŠŸèƒ½ï¼Œéœ€è¦å…ˆä¿®æ”¹ä¸‹theme 1234567&lt;!-- Base application theme. --&gt;&lt;style name=\"AppTheme\" parent=\"Theme.AppCompat.Light.NoActionBar\"&gt; &lt;!-- Customize your theme here. --&gt; &lt;item name=\"colorPrimary\"&gt;@color/colorPrimary&lt;/item&gt; &lt;item name=\"colorPrimaryDark\"&gt;@color/colorPrimaryDark&lt;/item&gt; &lt;item name=\"colorAccent\"&gt;@color/colorAccent&lt;/item&gt;&lt;/style&gt; ä½¿ç”¨Theme.AppCompat.Light.NoActionBarä½œä¸ºactivityçš„é£æ ¼ï¼Œè¿™é‡Œæ’è¿°ä¸€ä¸‹ç›¸å…³å±æ€§ä»£è¡¨çš„ç•Œé¢ä½ç½® åˆ›å»ºToolBarå¯¹åº”çš„xmlæ–‡ä»¶ toolbar.xml 123456789101112&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"?attr/colorPrimary\" android:minHeight=\"?attr/actionBarSize\" app:popupTheme=\"@style/ThemeOverlay.AppCompat.Light\" app:theme=\"@style/ThemeOverlay.AppCompat.ActionBar\" xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt;&lt;/android.support.v7.widget.Toolbar&gt; è¿™é‡ŒæŠŠè¿™ä¸ªæ–‡ä»¶å•ç‹¬ä½œä¸ºä¸€ä¸ªxmlæ–¹ä¾¿å¤šä¸ªlayoutä¸­åŒ…å« activity_main.xml 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:id=\"@+id/rootlayout\" tools:context=\"mraz.com.actionbardemo.MainActivity\" android:orientation=\"vertical\"&gt; &lt;include layout=\"@layout/toolbar\"/&gt; &lt;TextView android:id=\"@+id/tv_hello\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:text=\"Hello World!\" /&gt;&lt;/LinearLayout&gt; ä¸»ç•Œé¢å¯¹åº”çš„layoutä¸­includeåˆšæ‰åˆ›å»ºçš„toolbar.xmlæ–‡ä»¶ main_menu.xml 1234567891011121314151617181920212223242526&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;menu xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;item android:id=\"@+id/action_search\" android:icon=\"@drawable/ic_search_black_24dp\" app:actionViewClass=\"android.support.v7.widget.SearchView\" android:title=\"Search\" android:inputType=\"textCapWords\" android:imeOptions=\"actionSearch\" android:orderInCategory=\"80\" app:showAsAction=\"ifRoom|collapseActionView\"/&gt; &lt;item android:id=\"@+id/action_settings\" android:icon=\"@drawable/ic_apps_black_24dp\" android:title=\"Settings\" android:orderInCategory=\"100\" app:showAsAction=\"always\"/&gt; &lt;item android:id=\"@+id/action_info\" android:title=\"Details\" android:icon=\"@drawable/ic_report_black_24dp\" android:orderInCategory=\"90\" app:showAsAction=\"ifRoom\"/&gt;&lt;/menu&gt; menu å¯¹åº”çš„å±æ€§è§£é‡Šä¸€ä¸‹ å±æ€§å€¼ æ„ä¹‰ id æ§ä»¶id title æ ‡é¢˜ï¼ˆå¿…éœ€ï¼‰ icon å›¾æ ‡ showAsAction æ§åˆ¶æ˜¾ç¤ºåˆ°actionbarè¿˜æ˜¯overflow actionViewClass æ„å»ºè§†å›¾æ‰€ä½¿ç”¨çš„View actionProviderClass åŸºæœ¬åŒä¸Š menuCategory åŒç§èœå•é¡¹çš„ç§ç±»ã€‚è¯¥å±æ€§å¯å–4ä¸ªå€¼ï¼šcontainersystemã€secondaryå’Œalternativeã€‚é€šè¿‡menuCategroyå±æ€§å¯ä»¥æ§åˆ¶èœå•é¡¹çš„ç½®ã€‚ä¾‹å¦‚å°†å±æ€§è®¾ä¸ºsystemï¼Œè¡¨ç¤ºè¯¥èœå•é¡¹æ˜¯ç³»ç»Ÿèœå•ï¼Œåº”æ”¾åœ¨å…¶ä»–ç§ç±»èœå•é¡¹çš„åé¢ã€‚ orderInCategory åŒç§ç±»èœå•çš„æ’åˆ—é¡ºåºã€‚è¯¥å±æ€§éœ€è¦è®¾ç½®ä¸€ä¸ªæ•´æ•°å€¼,è¶Šè¶Šé å·¦ showAsAction çš„å‡ ä¸ªå±æ€§ï¼Œè§£é‡Šä¸€ä¸‹ å±æ€§ æ„ä¹‰ ifRoom æ ¹æ®å½“å‰çš„ç©ºé—´å¤§å°è°ƒæ•´ never æ°¸è¿œä¸ä¼šæ˜¾ç¤ºã€‚åªä¼šåœ¨æº¢å‡ºåˆ—è¡¨ä¸­æ˜¾ç¤ºï¼Œè€Œä¸”åªæ˜¾ç¤ºæ ‡é¢˜ï¼Œä»¥åœ¨å®šä¹‰itemçš„æ—¶å€™ï¼Œæœ€å¥½æŠŠæ ‡é¢˜éƒ½å¸¦ä¸Š always æ— è®ºæ˜¯å¦æº¢å‡ºï¼Œéƒ½ä¼šæ˜¾ç¤º withText withTextå€¼ç¤ºæ„Action barè¦æ˜¾ç¤ºæ–‡æœ¬æ ‡é¢˜ã€‚Actionbarä¼šå°½å¯èƒ½çš„æ˜¾ç¤ºè¿™ä¸ªæ ‡é¢˜ï¼Œä½†æ˜¯ï¼Œå¦‚æœå›¾æ ‡æœ‰æ•ˆå¹¶ä¸”å—åˆ°Action barç©ºé—´çš„é™åˆ¶æ–‡æœ¬æ ‡é¢˜æœ‰å¯èƒ½æ˜¾ç¤ºä¸å…¨ã€‚ collapseActionView å£°æ˜äº†è¿™ä¸ªæ“ä½œè§†çª—åº”è¯¥è¢«æŠ˜å åˆ°ä¸€ä¸ªæŒ‰é’®ä¸­ï¼Œå½“ç”¨æˆ·é€‰æ‹©ä¸ªæŒ‰é’®æ—¶ï¼Œè¿™ä¸ªæ“ä½œè§†çª—å±•å¼€ã€‚å¦åˆ™ï¼Œè¿™ä¸ªæ“ä½œè§†çª—åœ¨é»˜è®¤çš„æƒ…å†µä¸‹æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”å³åœ¨ç”¨äºä¸é€‚ç”¨çš„æ—¶å€™ï¼Œä¹Ÿè¦å æ®æ“ä½œæ çš„æœ‰æ•ˆç©ºé—´ã€‚ä¸€èˆ¬è¦é…åˆifRoomä¸€èµ·ä½¿ç”¨æ‰ä¼šæœ‰æœã€‚ ä»£ç ä½¿ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package mraz.com.actionbardemo;import android.os.Bundle;import android.support.design.widget.Snackbar;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.Toolbar;import android.view.Menu;import android.view.MenuItem;import android.widget.LinearLayout;public class MainActivity extends AppCompatActivity { LinearLayout rootlayout; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); rootlayout = (LinearLayout) findViewById(R.id.rootlayout); Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); setSupportActionBar(toolbar); toolbar.setNavigationIcon(R.drawable.ic_menu_black_24dp); } @Override public boolean onCreateOptionsMenu(Menu menu) { getMenuInflater().inflate(R.menu.main_menu, menu); return true; } @Override public boolean onOptionsItemSelected(MenuItem item) { switch (item.getItemId()) { case R.id.action_info: Snackbar.make(rootlayout, \" Info \", Snackbar.LENGTH_SHORT).show(); break; case R.id.action_search: Snackbar.make(rootlayout, \" Search \", Snackbar.LENGTH_SHORT).show(); break; case R.id.action_settings: Snackbar.make(rootlayout, \" Settings \", Snackbar.LENGTH_SHORT).show(); break; } return super.onOptionsItemSelected(item); }} æ¯”è¾ƒå…³é”®çš„åªæœ‰3è¡Œä»£ç  Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); //è·å–toolbarsetSupportActionBar(toolbar); //è®¾ç½®æˆActionBargetMenuInflater().inflate(R.menu.main_menu, menu); //åˆ›å»ºactionbarçš„å•é¡¹ æœ‰äº†è¿™äº›ä»£ç åŸºæœ¬ä¸Šå°±å¯ä»¥æ˜¾ç¤ºActionBarï¼Œå½“ç„¶è¦å®ç°ä¸ç”¨æˆ·çš„äº¤äº’ï¼Œå°±éœ€è¦å¯¹æ¯ä¸€ä¸ªiteåšå¯¹åº”çš„å“åº”å¤„ç†ï¼Œè¿™é‡Œæ ¹æ®èœå•çš„idï¼Œåšäº†ç®€å•çš„Snackbarçš„å±•ç¤ºï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦å®ç°æ›´å¤æ‚çš„é€»è¾‘ 1234567public boolean onOptionsItemSelected(MenuItem item) { switch (item.getItemId()) { case R.id.action_info: Snackbar.make(rootlayout, \" Info \", Snackbar.LENGTH_SHORT).show(); break; â€¦â€¦} æ•ˆæœå›¾ ä½¿ç”¨Action Viewä¸Šé¢çš„ä¾‹å­ä¸­æœ‰ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„Menu Item 12345678&lt;item android:id=\"@+id/action_search\" android:icon=\"@drawable/ic_search_black_24dp\" app:actionViewClass=\"android.support.v7.widget.SearchView\" android:title=\"Search\" android:inputType=\"textCapWords\" android:imeOptions=\"actionSearch\" android:orderInCategory=\"80\" app:showAsAction=\"ifRoom|collapseActionView\"/&gt; è¿™é‡Œä½¿ç”¨äº†actionViewClassï¼Œè¿™ä¸ªè¦è®¾ç½®shwoAsActionä¸º ifRoom|collapseActionViewä½¿ç”¨æ‰è¡Œ,å…¶å®åˆ é™¤collapseActionViewï¼Œä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œåªæ˜¯ä½“ç°çš„æ–¹å¼ä¸ä¸€æ ·ã€‚è·å–SearchViewçš„æ–¹å¼ 12MenuItem item = menu.findItem(R.id.action_search);SearchView searchView = (SearchView) item.getActionView(); SerachView å¯¹è±¡æ‹¿åˆ°ä¹‹åå¯ä»¥å¯¹å…¶å±æ€§è¿›è¡Œæ“ä½œã€‚ç»™Action Viewæ·»åŠ å±•å¼€å’Œæ”¶èµ·çš„äº‹ä»¶ç›‘å¬ï¼Œå®ç°æ–¹å¼ 12345678910111213141516171819public boolean onCreateOptionsMenu(Menu menu) { getMenuInflater().inflate(R.menu.main_menu, menu); MenuItem searchitem = menu.findItem(R.id.action_search); SearchView searchView = (SearchView) searchitem.getActionView(); MenuItemCompat.setOnActionExpandListener(searchitem, new MenuItemCompat.OnActionExpandListener() { @Override public boolean onMenuItemActionExpand(MenuItem item) { Snackbar.make(rootlayout, \" onMenuItemActionExpand \", Snackbar.LENGTH_SHORT).show(); return true; } @Override public boolean onMenuItemActionCollapse(MenuItem item) { Snackbar.make(rootlayout, \" onMenuItemActionCollapse \", Snackbar.LENGTH_SHORT).show(); return true; } }); return true;} æ‹¿åˆ°searchItemä¹‹åï¼Œæ‰§è¡ŒMenuItemCompat.setOnActionExpandListener(searchitem, new MenuItemCompat.OnActionExpandListener() )ï¼› æ•ˆæœå›¾ ä½¿ç”¨ActionProviderClassmenuæ–‡ä»¶ä¸­ä½¿ç”¨ 12345&lt;item android:title=\"Share\" android:actionProviderClass=\"android.widget.ShareActionProvider\" android:orderInCategory=\"100\" app:showAsAction=\"always\" /&gt; ç±»ä¼¼çš„æ–¹å¼è·å–ActionProvider 1234MenuItem shareItem = menu.findItem(R.id.action_share);ShareActionProvider mShareActionProvider = (ShareActionProvider) MenuItemCompat.getActionProvider(shareItem);mShareActionProvider.setShareIntent(â€¦â€¦); é’ˆå¯¹ActionProviderå¯ä»¥å®ç°è‡ªå®šä¹‰çš„ActionProviderï¼Œç»§æ‰¿åŸºç¡€ç±»ActionProvider ActionBarå¯¼èˆªå¯ç”¨ActionBarå›¾æ ‡å¯¼èˆªçš„åŠŸèƒ½ï¼Œå¯ä»¥å…è®¸ç”¨æˆ·æ ¹æ®å½“å‰åº”ç”¨çš„ä½ç½®æ¥åœ¨ä¸åŒç•Œé¢ä¹‹é—´åˆ‡æ¢ã€‚æ¯”å¦‚ï¼ŒAç•Œé¢å±•ç¤ºäº†ä¸€ä¸ªåˆ—è¡¨ï¼Œç‚¹å‡»æŸä¸€é¡¹ä¹‹åè¿›å…¥äº†Bç•Œé¢ï¼Œè¿™æ—¶Bç•Œé¢å°±åº”è¯¥å¯ç”¨ActionBarå›¾æ ‡å¯¼èˆªåŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥å›åˆ°Aç•Œé¢ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨setDisplayHomeAsUpEnabled()æ–¹æ³•æ¥å¯ç”¨ActionBarå›¾æ ‡å¯¼èˆªåŠŸèƒ½ 123Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);setSupportActionBar(toolbar);getSupportActionBar().setDisplayHomeAsUpEnabled(true); æ­¤æ—¶ActionBarå·¦ä¾§ä¼šå‡ºç°ä¸€ä¸ªè¿”å›çš„æŒ‰é’® é’ˆå¯¹è¿™è¿”å›æŒ‰é’®çš„äº‹ä»¶å“åº”è¿˜æ˜¯åœ¨public boolean onOptionsItemSelected(MenuItem item) æ–¹æ³•ä¸­å®ç°ï¼Œå®ƒæœ‰ä¸€ä¸ªå›ºå®šçš„èµ„æºIdâ€”- android.R.id.home 123case android.R.id.home: finish(); break; ç®€å•çš„æ‰§è¡Œä¸‹å’Œè¿”å›é”®ç›¸åŒçš„æ“ä½œã€‚ç»“æŸå½“å‰activity å®ç°Activityä¹‹é—´çš„å¿«é€Ÿåˆ‡æ¢æ–°å»ºä¸€ä¸ªParentActivity.java 12345678910111213141516171819202122232425262728package mraz.com.actionbardemo;import android.content.Context;import android.content.Intent;import android.support.v7.app.AppCompatActivity;import android.os.Bundle;import android.view.View;import android.widget.TextView;public class ParentActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_parent); final Context mContext = this; TextView textView = (TextView) findViewById(R.id.tv_parent); textView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { Intent intent = new Intent(); intent.setClass(mContext , MainActivity.class); startActivity(intent); } }); }} AndroidManifest.xmlæ–‡ä»¶ä¸­åšå¦‚ä¸‹ä¿®æ”¹ 1234567891011121314151617&lt;application â€¦â€¦&gt; &lt;activity android:name=\".ParentActivity\"&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.MAIN\" /&gt; &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt; &lt;/intent-filter&gt; &lt;/activity&gt; &lt;activity android:name=\".MainActivity\" android:parentActivityName=\"mraz.com.actionbardemo.ParentActivity\"&gt; &lt;/activity&gt;&lt;/application&gt; è¿™ä¸€å¥å¾ˆå…³é”®android:parentActivityName=â€œmraz.com.actionbardemo.ParentActivityâ€&gt;è®¾ç½®çˆ¶Activityçš„åç§°ï¼ŒParentActivityä¸ºå¯åŠ¨ActivityåŒæ—¶æ˜¯MainActivityçš„çˆ¶Activityç„¶ååœ¨MainActivityä¸­é’ˆå¯¹è¿™ä¸ªè¿”å›æŒ‰é’®åšä¸€ä¸‹å¤„ç†ï¼Œä¸å†æ˜¯ç®€å•çš„ç»“æŸæ‰å½“å‰çš„è¿™ä¸ªActivityäº†ï¼Œéœ€è¦åšå‡ºå¯¹åº”çš„å¯¼èˆªçš„å¤„ç†é€»è¾‘ 1234567891011case android.R.id.home: Intent upIntent = NavUtils.getParentActivityIntent(this); if (NavUtils.shouldUpRecreateTask(this, upIntent)) { TaskStackBuilder.create(this) .addNextIntentWithParentStack(upIntent) .startActivities(); } else { upIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); NavUtils.navigateUpTo(this, upIntent); } break; å…¶ä¸­ï¼Œè°ƒç”¨NavUtils.getParentActivityIntent()æ–¹æ³•å¯ä»¥è·å–åˆ°è·³è½¬è‡³çˆ¶Activityçš„Intentï¼Œç„¶åå¦‚æœçˆ¶Activityå’Œå½“å‰Activityæ˜¯åœ¨åŒä¸€ä¸ªTaskä¸­çš„ï¼Œåˆ™ç›´æ¥è°ƒç”¨navigateUpTo()æ–¹æ³•è¿›è¡Œè·³è½¬ï¼Œå¦‚æœä¸æ˜¯åœ¨åŒä¸€ä¸ªTaskä¸­çš„ï¼Œåˆ™éœ€è¦å€ŸåŠ©TaskStackBuilderæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„Taskã€‚è¿™æ ·ï¼Œå°±æŒ‰ç…§æ ‡å‡†çš„è§„èŒƒæˆåŠŸå®ç°ActionBarå¯¼èˆªçš„åŠŸèƒ½äº†ã€‚ æ•ˆæœå›¾","link":"/2016/06/23/ã€ŠAndroid åŸºç¡€ï¼ˆå…­ï¼‰ã€‹ ActionBar/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåä¸ƒï¼‰ã€‹ ViewPager","text":"ç®€ä»‹ Layout manager that allows the user to flip left and rightthrough pages of data. You supply an implementation of a{@link PagerAdapter} to generate the pages that the view shows. ViewPager is most often used in conjunction with {@link android.app.Fragment},which is a convenient way to supply and manage the lifecycle of each page.There are standard adapters implemented for using fragments with the ViewPager,which cover the most common use cases. These are{@link android.support.v4.app.FragmentPagerAdapter} and{@link android.support.v4.app.FragmentStatePagerAdapter}; each of theseclasses have simple code showing how to build a full user interfacewith them. Views which are annotated with the {@link DecorView} annotation are treated aspart of the view pagers â€˜decorâ€™. Each decor viewâ€™s position can be controlled viaits {@code android:layout_gravity} attribute. For example: 12345678&lt;android.support.v4.view.ViewPager android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;android.support.v4.view.PagerTitleStrip android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_gravity=\"top\" /&gt; &lt;/android.support.v4.view.ViewPager&gt; ç¿»è¯‘ï¼šViewPagerå…è®¸ç”¨æˆ·é€šè¿‡è½½æœ‰æ•°æ®çš„é¡µé¢å®ç°å·¦å³æ»‘åŠ¨ã€‚å¼€å‘è€…éœ€è¦è‡ªå·±å®ç°PagerAdapteræ¥ç”Ÿæˆéœ€è¦æ˜¾ç¤ºçš„é¡µé¢ã€‚ViewPageré€šå¸¸å›åˆFragmentç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œè¿™æ ·å®ç°èµ·æ¥æ¯”è¾ƒç®€å•åŒæ—¶ä¹Ÿä¾¿äºç®¡ç†æ¯ä¸ªé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸã€‚Androidå­˜åœ¨æ ‡å‡†çš„é€‚é…å™¨æ¨¡æ¿é’ˆå¯¹Fragmentå’ŒViewPagerç»“åˆä½¿ç”¨çš„æ–¹å¼ï¼šandroid.support.v4.app.FragmentPagerAdapterandroid.support.v4.app.FragmentStatePagerAdapteræ¯ä¸ªç±»éƒ½æœ‰ç®€å•çš„è¯´æ˜ï¼Œå‘Šè¯‰å¼€å‘è€…å¦‚ä½•é€šè¿‡ä»–ä»¬æ¥å®ç°ä¸ç”¨æˆ·çš„äº¤äº’ã€‚ è¢«æ³¨é‡ŠæˆDecorViewçš„è§†å›¾å‡å¯å½“åšViewPagerçš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªDecorViewçš„ä½ç½®å¯ä»¥é€šè¿‡ android:layout_gravityå±æ€§æ¥æ§åˆ¶ï¼Œä¾‹å¦‚ï¼š 12345678&lt;android.support.v4.view.ViewPager android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;android.support.v4.view.PagerTitleStrip android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_gravity=\"top\" /&gt; &lt;/android.support.v4.view.ViewPager&gt; ç±»ç»“æ„ å¸¸ç”¨æˆå‘˜çš„åŠŸèƒ½ä»‹ç» æˆå‘˜ åŠŸèƒ½ ViewPager() æ„é€ æ–¹æ³• addOnAdapterChangeListener æ·»åŠ ä¸€ä¸ªOnAdapterChangeListener removeOnAdapterChangeListener ç§»é™¤ä¸€ä¸ªOnAdapterChangeListener setCurrentItem è®¾ç½®å½“å‰Pagerçš„index addOnePageChangeListener è®¾ç½®ä¸€ä¸ªé¡µé¢æ”¹å˜ç›‘å¬å™¨ addOnePageChangeListener ç§»é™¤ä¸€ä¸ªé¡µé¢æ”¹å˜ç›‘å¬å™¨ clearOnPageChangeListener ç§»é™¤æ‰€æœ‰çš„é¡µé¢æ”¹å˜ç›‘å¬å™¨ setPageTransformer è®¾ç½®é¡µé¢ä¹‹é—´åˆ‡æ¢çš„è¿‡ç¨‹ä¸­PageTransformer å…¶ä»–çš„ä¸€äº›æ–¹æ³•ä»ä½¿ç”¨ç¨‹åº¦ä¸Šæ¥çœ‹æ¯”è¾ƒçš„å°‘è§ï¼Œæºç å†…å®¹å¤§å®¶é€šè¿‡ASéƒ½æ˜¯å¯ä»¥æŸ¥çœ‹åˆ°çš„ã€‚ åŸºæœ¬ä½¿ç”¨ç®€å•æ˜¾ç¤ºå¸ƒå±€æ–‡ä»¶ 1234567891011121314&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\"mraz.com.opensourcedemo.MainActivity\"&gt; &lt;android.support.v4.view.ViewPager android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:id=\"@+id/viewpager\" &gt; &lt;/android.support.v4.view.ViewPager&gt;&lt;/RelativeLayout&gt; ä»£ç å†…å®¹MainActivity.java 1234567891011121314151617181920212223242526272829package mraz.com.opensourcedemo;import android.support.v4.view.ViewPager;import android.support.v4.widget.ViewDragHelper;import android.support.v7.app.AppCompatActivity;import android.os.Bundle;import android.util.Log;import android.view.View;import android.view.Window;import java.util.ArrayList;public class MainActivity extends AppCompatActivity { ArrayList&lt;String&gt; sourceList; private static final float MIN_SCALE = 0.5f; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ViewPager viewPager = (ViewPager) findViewById(R.id.viewpager); MyPagerAdapter myPagerAdapter = new MyPagerAdapter(getSupportFragmentManager()); viewPager.setAdapter(myPagerAdapter); }} Adapterç±» 1234567891011121314151617181920212223242526272829303132333435package mraz.com.opensourcedemo;import android.support.v4.app.Fragment;import android.support.v4.app.FragmentManager;import android.support.v4.app.FragmentPagerAdapter;/** * Created by Mraz on 2016/7/8. */public class MyPagerAdapter extends FragmentPagerAdapter { public static final String[] titles = {\"Android\",\" Pet\",\"Gift\"}; public MyPagerAdapter(FragmentManager fm) { super(fm); } @Override public Fragment getItem(int position) { switch (position) { case 0: return new FirstFragment(); case 1: return new SecondFragment(); case 2: return new ThreeFragment(); } return null; } @Override public int getCount() { return 3; }} MyPagerAdapter ç»§æ‰¿FragmentPagerAdapterï¼Œå½“åˆ›å»ºè¿™ä¸ªç±»å¹¶ç»§æ‰¿FragmentPagerAdapterçš„æ—¶å€™ï¼ŒASä¼šæç¤ºå¼€å‘è€…éœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”è¦æ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ŒgetItemå°±æ˜¯æ ¹æ®ä½ç½®è¿”å›å¯¹åº”çš„Fragmentï¼ŒgetCountå°±æ˜¯è¿”å›é¡µé¢æ•°ï¼Œè¿™é‡Œæˆ‘æ˜¯ç›´æ¥è¿”å›çš„å¯¹åº”çš„å†…å®¹ï¼Œæ•°ç›®ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ArrayListç­‰æ•°æ®ç»“æ„æ¥ä¼ é€’åˆé€‚çš„å‚æ•°ï¼Œå¯ä»¥æ›´çµæ´»çš„è®¾ç½®Adapterçš„å†…å®¹ï¼Œä½¿ViewPagerçš„å†…å®¹æ›´ä¸°å¯Œã€‚è¿™é‡Œçš„ FirstFragmentï¼ŒSecondFragmentï¼ŒThreeFragmentå†…å®¹åªæ˜¯ä¸€ä¸ªç®€å•çš„å›¾ç‰‡èµ„æºï¼Œå¯¹åº”çš„å¸ƒå±€æ–‡ä»¶ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¸è´´ä»£ç äº†ã€‚ å®é™…æ•ˆæœ æ·»åŠ PageTransformerä»£ç å†…å®¹ 1234567891011121314151617181920212223242526272829303132333435363738394041private static final float MIN_SCALE = 0.5f;...viewPager.setPageTransformer(true, new ViewPager.PageTransformer() { @Override public void transformPage(View view, float position) { int pageWidth = view.getWidth(); if (position &lt; -1) { // [-Infinity,-1) // This page is way off-screen to the left. view.setAlpha(0); } else if (position &lt;= 0) { // [-1,0] // Use the default slide transition when moving to the left page view.setAlpha(1 + position); view.setTranslationX(0); float scaleFactor = MIN_SCALE + (1 - MIN_SCALE) * (1 - Math.abs(position)); view.setScaleX(scaleFactor); view.setScaleY(scaleFactor); } else if (position &lt;= 1) { // (0,1] // Fade the page out. view.setAlpha(1 - position); // Counteract the default slide transition view.setTranslationX(pageWidth * -position); // Scale the page down (between MIN_SCALE and 1) float scaleFactor = MIN_SCALE + (1 - MIN_SCALE) * (1 - Math.abs(position)); view.setScaleX(scaleFactor); view.setScaleY(scaleFactor); } else { // (1,+Infinity] // This page is way off-screen to the right. view.setAlpha(0); } }}); ä¸Šé¢æ˜¯å‚ç…§ä¾‹å­å†™çš„ä¸€ä¸ªé¡µé¢åˆ‡æ¢æ•ˆæœï¼Œä¸»è¦å…³æ³¨çš„æ˜¯é€æ˜åº¦å’Œå¤§å°çš„æ”¹å˜ï¼Œåœ¨é¡µé¢åˆ‡æ¢çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹äºç¦»å¼€çš„é¡µé¢å˜é€æ˜ï¼Œå˜å°ï¼Œè¿›å…¥çš„é¡µé¢å˜æ˜æ˜¾ï¼Œå˜å¤§ã€‚çœ‹ä¸‹ViewPager.PageTransformerè¿™ä¸ªæ¥å£ 1234567891011121314151617181920/** * A PageTransformer is invoked whenever a visible/attached page is scrolled. * This offers an opportunity for the application to apply a custom transformation * to the page views using animation properties. * * &lt;p&gt;As property animation is only supported as of Android 3.0 and forward, * setting a PageTransformer on a ViewPager on earlier platform versions will * be ignored.&lt;/p&gt; */public interface PageTransformer { /** * Apply a property transformation to the given page. * * @param page Apply the transformation to this page * @param position Position of page relative to the current front-and-center * position of the pager. 0 is front and center. 1 is one full * page position to the right, and -1 is one page position to the left. */ public void transformPage(View page, float position);} åªéœ€è¦å®ç°ä¸€ä¸ªæ–¹æ³•transformPageï¼Œä¼ å…¥çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é¡µé¢è§†å›¾ï¼Œç¬¬äºŒä¸ªå‚æ•°å¾ˆé‡è¦ï¼ŒæŒ‡çš„æ˜¯å½“å‰é¡µé¢æ‰€å¤„çš„ä¸€ç§çŠ¶æ€ï¼Œæ ¹æ®positionæ¥åˆ¤æ–­ï¼Œæˆ‘ä»¬æ·»åŠ çš„æ‰€æœ‰æ•ˆæœï¼Œéƒ½æ˜¯è¦ä¾æ®è¿™ä¸ªå€¼æ¥åšå¤„ç†ï¼Œå½“æˆ‘ä»¬æ»‘åŠ¨é¡µé¢çš„æ—¶å€™ï¼Œè¿™ä¸ªå€¼åœ¨ä¸åœçš„å˜åŒ–ï¼Œå¹¶ä¸”ä¸åŒçš„pageçš„å€¼ä¸ç›¸åŒã€‚ å–å€¼ å«ä¹‰ [-Infinity,-1) è¿™ä¸ªèŒƒå›´çš„è§†å›¾å·²ç»çœ‹ä¸è§äº† [-1,0] å³å°†é€€å‡ºç•Œé¢çš„pageçš„å˜åŒ–èŒƒå›´ï¼Œä»0æ…¢æ…¢å˜æˆ-1 [0,1] å³å°†è¿›å…¥ç•Œé¢çš„pageçš„å˜åŒ–èŒƒå›´ï¼Œä»1æ…¢æ…¢å˜æˆ0 (1,+Infinity] è¿™ä¸ªèŒƒå›´çš„è§†å›¾å·²ç»çœ‹ä¸è§äº† å¯ä»¥æŠŠè¿™ä¸ªå–å€¼èŒƒå›´å’Œæ•°æ®æ¦‚å¿µâ€”â€”æ•°è½´â€”â€”è”ç³»èµ·æ¥ï¼Œå°±æ¯”è¾ƒå®¹æ˜“ç†è§£äº†ï¼Œé€šè¿‡ä¸Šé¢è¿™ä¸ªè¿‡åœºå’Œä¸‹é¢çš„å®é™…æ•ˆæœå›¾ï¼Œåº”è¯¥å¯ä»¥çœ‹å‡ºä¸€äºŒï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä¹Ÿå¯ä»¥å°è¯•ç€å®ç°è‡ªå®šä¹‰çš„è¿‡åœºæ•ˆæœ å®é™…æ•ˆæœ æ·»åŠ OnPageChangeListenerä»£ç å†…å®¹ 12345678910111213141516viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() { @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { Log.e(TAG, \"onPageScrolled position = \" + position + \" positionOffset = \" + positionOffset + \" positionOffsetPixels = \" + positionOffsetPixels); } @Override public void onPageSelected(int position) { Log.e(TAG, \"onPageSelected position = \" + position); } @Override public void onPageScrollStateChanged(int state) { Log.e(TAG, \"onPageScrollStateChanged state = \" + state); }}); å¯ä»¥çœ‹åˆ°å½“æ»‘åŠ¨é¡µé¢çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€å¤§ä¸²çš„Logæ‰“å°å‡ºæ¥ çœ‹ä¸‹OnPagerChangeListenerè¿™ä¸ªæ¥å£çš„å®šä¹‰ 123456789101112131415161718192021222324252627282930313233343536/** * Callback interface for responding to changing state of the selected page. */public interface OnPageChangeListener { /** * This method will be invoked when the current page is scrolled, either as part * of a programmatically initiated smooth scroll or a user initiated touch scroll. * * @param position Position index of the first page currently being displayed. * Page position+1 will be visible if positionOffset is nonzero. * @param positionOffset Value from [0, 1) indicating the offset from the page at position. * @param positionOffsetPixels Value in pixels indicating the offset from position. */ public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels); /** * This method will be invoked when a new page becomes selected. Animation is not * necessarily complete. * * @param position Position index of the new selected page. */ public void onPageSelected(int position); /** * Called when the scroll state changes. Useful for discovering when the user * begins dragging, when the pager is automatically settling to the current page, * or when it is fully stopped/idle. * * @param state The new scroll state. * @see ViewPager#SCROLL_STATE_IDLE * @see ViewPager#SCROLL_STATE_DRAGGING * @see ViewPager#SCROLL_STATE_SETTLING */ public void onPageScrollStateChanged(int state);} å€¼å¾—çš„ä¸€æçš„æ˜¯ positionOffset è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨onPageScrolledå›è°ƒä¸­æ‹¿åˆ°ï¼Œè€Œè¿™ä¸ªæ•°å€¼å‘¢ å°±æ˜¯å’Œæˆ‘ä»¬ä¸Šé¢è‡ªå®šä¹‰è¿‡åœºçš„æ—¶å€™ç”¨åˆ°çš„ transformPageæ–¹æ³•ä¸­ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°position æœ‰è”ç³»ï¼Œåªæ˜¯è¿™é‡Œçš„positionOffsetå–å€¼èŒƒå›´ä¸º[0, 1)ï¼Œä¸Šé¢çš„positionä¸­å–å€¼èŒƒå›´æ›´å¹¿ï¼Œä½†æ˜¯ä»å®é™…ä¸Šæ¥çœ‹ï¼Œå¯¹æˆ‘ä»¬å½±å“æ¯”è¾ƒå¤§çš„å°±æ˜¯å½“å‰åˆ‡æ¢çš„ä¸¤ä¸ªPageï¼Œä¹Ÿå°±æ˜¯[-1,1]è¿™ä¸ªå–å€¼èŒƒå›´ï¼Œæ‰€è°“çš„è´Ÿå€¼å¯ä»¥ç†è§£æˆæ˜¯ç›¸å¯¹æ¦‚å¿µï¼Œæ‰€ä»¥ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¹‹é—´æ˜¯å­˜åœ¨å…³ç³»çš„ï¼Œå¦‚æœä¸ç†è§£ä¸Šé¢PageTransformerï¼Œ å¯ä»¥ç»“åˆè¿™ä¸ªpositionOffsetå˜é‡çš„æ‰“å°å€¼åŠ ä»¥ç†è§£ã€‚","link":"/2016/07/09/ã€ŠAndroid åŸºç¡€ï¼ˆåä¸ƒï¼‰ã€‹ ViewPager/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåä¸‰ï¼‰ã€‹ shape","text":"ä»‹ç» ç®€å•æ¥è¯´ï¼Œshapeå°±æ˜¯ç”¨æ¥åœ¨xmlæ–‡ä»¶ä¸­å®šä¹‰å½¢çŠ¶ï¼Œä»£ç è§£æä¹‹åå°±å¯ä»¥å½“åšDrawableä¸€æ ·ä½¿ç”¨ å®˜æ–¹è¯´æ˜ å…³äºshapeå®šä¹‰çš„drawable æ–‡ä»¶ä½ç½®ï¼šres/drawable/filename.xml ç¼–è¯‘èµ„æºç±»å‹ï¼š*GradientDrawable* æ–‡ä»¶å¼•ç”¨ï¼š In Java: R.drawable.filename In XML: @[package:]drawable/filename è¯­æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=[\"rectangle\" | \"oval\" | \"line\" | \"ring\"] &gt; &lt;corners android:radius=\"integer\" android:topLeftRadius=\"integer\" android:topRightRadius=\"integer\" android:bottomLeftRadius=\"integer\" android:bottomRightRadius=\"integer\" /&gt; &lt;gradient android:angle=\"integer\" android:centerX=\"integer\" android:centerY=\"integer\" android:centerColor=\"integer\" android:endColor=\"color\" android:gradientRadius=\"integer\" android:startColor=\"color\" android:type=[\"linear\" | \"radial\" | \"sweep\"] android:useLevel=[\"true\" | \"false\"] /&gt; &lt;padding android:left=\"integer\" android:top=\"integer\" android:right=\"integer\" android:bottom=\"integer\" /&gt; &lt;size android:width=\"integer\" android:height=\"integer\" /&gt; &lt;solid android:color=\"color\" /&gt; &lt;stroke android:width=\"integer\" android:color=\"color\" android:dashWidth=\"integer\" android:dashGap=\"integer\" /&gt;&lt;/shape&gt; è¿™é‡Œåªåšç®€å•çš„æè¿°ï¼Œä¸»è¦çœ‹çœ‹ä½¿ç”¨æ–¹å¼ã€‚å…³äºå…ƒç´ çš„è¯¦ç»†è¯´æ˜ï¼Œè¯·çœ‹ shapeè¯´æ˜ åŸºæœ¬ä½¿ç”¨çŸ©å½¢å¡«å……ï¼ˆsolidï¼‰123456&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\"&gt; &lt;!--å¡«å……é¢œè‰² --&gt; &lt;solid android:color=\"@color/colorAccent\" /&gt;&lt;/shape&gt; æè¾¹ï¼ˆstrokeï¼‰12345678910111213141516&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\"&gt; &lt;!--å¡«å……é¢œè‰² --&gt; &lt;solid android:color=\"@color/colorAccent\" /&gt; &lt;!--æè¾¹é¢œè‰²--&gt; &lt;!--android:dashGap è™šçº¿é—´è·ï¼Œè¿™é‡Œè®¾ç½®ä¸º0åˆ™æ˜¾ç¤ºçš„ä¸ºå®çº¿--&gt; &lt;!--android:dashWidth è™šçº¿å®½åº¦--&gt; &lt;stroke android:width=\"3dp\" android:color=\"@color/colorPrimaryDark\" android:dashGap=\"0dp\" android:dashWidth=\"10dp\" /&gt;&lt;/shape&gt; åœ†è§’ï¼ˆcornerï¼‰1234567891011121314151617181920212223242526&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\"&gt; &lt;!--å¡«å……é¢œè‰² --&gt; &lt;solid android:color=\"@color/colorAccent\" /&gt; &lt;!--æè¾¹é¢œè‰²--&gt; &lt;!--android:dashGap è™šçº¿é—´è·ï¼Œè¿™é‡Œè®¾ç½®ä¸º0åˆ™æ˜¾ç¤ºçš„ä¸ºå®çº¿--&gt; &lt;!--android:dashWidth è™šçº¿å®½åº¦--&gt; &lt;stroke android:width=\"3dp\" android:color=\"@color/colorPrimaryDark\" android:dashGap=\"4dp\" android:dashWidth=\"10dp\" /&gt; &lt;!--åœ†è§’--&gt; &lt;!--android:randius è®¾ç½®4ä¸ªå«çš„åœ†è§’åŠå¾„,ä¼šè¢«ç‰¹å®šçš„åœ†è§’è®¾å®šè¦†ç›–--&gt; &lt;!--android:bottomLeftRadius å·¦ä¸‹è§’çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:bottomRightRadius å³ä¸‹è§’çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:topLeftRandius å·¦ä¸Šè§’çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:topRightRadius å³ä¸Šè§’çš„åœ†è§’åŠå¾„--&gt; &lt;corners android:bottomLeftRadius=\"60dp\" android:radius=\"30dp\" android:topRightRadius=\"120dp\" /&gt;&lt;/shape&gt; æ¸å˜ï¼ˆgradientï¼‰ï¼šlinear123456789101112131415161718192021222324252627282930&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\"&gt; &lt;!--æè¾¹é¢œè‰²--&gt; &lt;!--android:dashGap è™šçº¿é—´è·ï¼Œè¿™é‡Œè®¾ç½®ä¸º0åˆ™æ˜¾ç¤ºçš„ä¸ºå®çº¿--&gt; &lt;!--android:dashWidth è™šçº¿å®½åº¦--&gt; &lt;stroke android:width=\"3dp\" android:color=\"@color/colorPrimaryDark\" android:dashGap=\"4dp\" android:dashWidth=\"10dp\" /&gt; &lt;!--åœ†è§’--&gt; &lt;!--android:randius è®¾ç½®4ä¸ªå«çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:bottomLeftRadius å·¦ä¸‹è§’çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:bottomRightRadius å³ä¸‹è§’çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:topLeftRandius å·¦ä¸Šè§’çš„åœ†è§’åŠå¾„--&gt; &lt;!--android:topRightRadius å³ä¸Šè§’çš„åœ†è§’åŠå¾„--&gt; &lt;corners android:bottomLeftRadius=\"60dp\" android:radius=\"30dp\" android:topRightRadius=\"120dp\" /&gt; &lt;!--æ¸å˜--&gt; &lt;gradient android:angle=\"45\" android:centerColor=\"@color/stone\" android:endColor=\"@color/pink\" android:startColor=\"@color/yellow\" /&gt;&lt;/shape&gt; æ¸å˜ï¼ˆgradientï¼‰ï¼šradial1234567&lt;gradient android:angle=\"90\" android:startColor=\"@color/colorPrimary\" android:centerColor=\"@color/pink\" android:endColor=\"@color/yellow\" android:gradientRadius=\"400dp\" android:type=\"radial\"/&gt; æ¸å˜ï¼ˆgradientï¼‰ï¼šsweep123456&lt;gradient android:startColor=\"@color/colorPrimary\" android:centerColor=\"@color/pink\" android:endColor=\"@color/yellow\" android:gradientRadius=\"400dp\" android:type=\"sweep\"/&gt; åœ†å½¢æ­£åœ†1234567891011&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\"android:shape=\"oval\"&gt;&lt;gradient android:centerColor=\"@color/pink\" android:endColor=\"@color/yellow\" android:startColor=\"@color/colorPrimary\" /&gt;&lt;size android:width=\"400dp\" android:height=\"400dp\" /&gt;&lt;/shape&gt; æ¤­åœ†123456789&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\"android:shape=\"oval\"&gt;&lt;gradient android:angle=\"90\" android:centerColor=\"@color/pink\" android:endColor=\"@color/yellow\" android:startColor=\"@color/colorPrimary\" /&gt;&lt;/shape&gt; çº¿æ¡1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"line\"&gt; &lt;stroke android:width=\"9dp\" android:color=\"@color/pink\" /&gt;&lt;/shape&gt; ç¯å½¢1234567891011&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"ring\" android:innerRadius=\"100dp\" android:thickness=\"50dp\" android:useLevel=\"false\" &gt; &lt;gradient android:startColor=\"@color/colorAccent\" android:endColor=\"@color/yellow\" android:centerColor=\"@color/pink\"/&gt;&lt;/shape&gt; android:useLevel=â€falseâ€è¿™ä¸ªå±æ€§å€¼ä¸€å®šè¦è®¾ç½®æˆfalseï¼Œæ ¹æ®googleå®˜ç½‘ä¸Šçš„è§£é‡Šï¼š ä»¥ä¸‹å±æ€§åªèƒ½åœ¨ android:shape=&quot;ring&quot; çš„æ—¶å€™ä½¿ç”¨ï¼š å±æ€§ æ„ä¹‰ android:innerRadius å°ºå¯¸ï¼Œå†…ç¯çš„åŠå¾„ android:thickness å°ºå¯¸ï¼Œç¯çš„åšåº¦ android:innerRadiusRatio æµ®ç‚¹å‹ï¼Œä»¥ç¯çš„å®½åº¦æ¯”ç‡æ¥è¡¨ç¤ºå†…ç¯çš„å¾„ï¼Œ ä¾‹å¦‚ï¼Œå¦‚æœandroid:innerRadiusRatio=5ï¼Œè¡¨ç¤ºå†…ç¯åŠå¾„ç­‰äºçš„å®½åº¦é™¤ä»¥5ï¼Œè¿™ä¸ªå€¼æ˜¯å¯ä»¥è¢«android:innerRadiusçš„å€¼è¦†ç›–ï¼Œé»˜è®¤9. android:thicknessRatio æµ®ç‚¹å‹ï¼Œä»¥ç¯çš„å®½åº¦æ¯”ç‡æ¥è¡¨ç¤ºç¯çš„åº¦ï¼Œä¾‹å¦‚ï¼Œå¦‚æœandroid:thicknessRatio=2ï¼Œ é‚£ä¹ˆç¯çš„åšåº¦å°±ç­‰äºçš„å®½åº¦é™¤ä»¥2ã€‚è¿™ä¸ªå€¼æ˜¯å¯ä»¥è¢«android:thicknessè¦†ç›–çš„ï¼Œé»˜è®¤å€¼æ˜¯3. android:useLevel booleanå€¼ï¼Œå¦‚æœå½“åšLevelListDrawableä½¿ç”¨æ—¶å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse.è¿™ä¸ªå€¼ä¸€èˆ¬false,å¦åˆ™ä½ çš„ç¯å¯èƒ½ä¸ä¼šå‡ºç° å…¶ä»–è¯´æ˜è¿™äº›è‡ªå·±å®šä¹‰çš„shapeä¸ºæ ¹èŠ‚ç‚¹çš„drawable xmlæ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ¥å½“æˆèƒŒæ™¯ä½¿ç”¨åœ¨Button,TextViewç­‰è§†å›¾ä¸Šï¼ŒåŒæ—¶ç”±äºå¯ä»¥è®¾ç½®sizeå¤§å°ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åˆ¶ä½œç®€å•çš„å›¾æ ‡ç­‰ã€‚æ€»è€Œè¨€ä¹‹ï¼Œæ¯ä¸ªç»†å°çš„ä¸œè¥¿ï¼Œéƒ½æœ‰æŒ–æ˜çš„ä»·å€¼ï¼Œæ„Ÿè§‰è¿™é‡Œé¢è¿˜æœ‰ä¸€äº›ä¸œè¥¿æˆ‘æ²¡æœ‰æ³¨æ„åˆ°ï¼Œè¿˜è¦å¥½å¥½çš„çœ‹ä¸€ä¸‹æ–‡æ¡£ã€‚ æœ€åï¼Œgoogleé•œåƒç½‘ç«™ï¼Œxsoftlabï¼Œå½“ç„¶æœ‰æ¡ä»¶çš„å»ºè®®ä½¿ç”¨Googleå®˜ç½‘ã€‚","link":"/2016/07/04/ã€ŠAndroid åŸºç¡€ï¼ˆåä¸‰ï¼‰ã€‹ shape/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå…«ï¼‰ã€‹ Palette","text":"ä»‹ç» Paletteï¼Œ è‹±æ–‡ç¿»è¯‘ï¼Œè°ƒè‰²æ¿ï¼Œæ„æ€æ¯”è¾ƒæ¥è¿‘ï¼ŒGoogleç»™å®ƒçš„å®šä½åº”è¯¥æ˜¯é¢œè‰²èƒå–å™¨ã€‚çœ‹ä¸‹Source CodePalette , A helper class to extract prominent colors from an image.A number of colors with different profiles are extracted from the image æ”¯æŒçš„é¢œè‰²ç±»å‹ é¢œè‰² ç±»å‹ Vibrant æœ‰æ´»åŠ› Vibrant Dark æœ‰æ´»åŠ› æš—è‰² Vibrant Light æœ‰æ´»åŠ› äº®è‰² Muted æŸ”å’Œ Muted Dark æŸ”å’Œ æš—è‰² Muted Light æŸ”å’Œ äº®è‰² ä½¿ç”¨æ–¹æ³•ï¼š123456789// Synchronous åŒæ­¥Palette p = Palette.from(bitmap).generate();&gt;// Asynchronous å¼‚æ­¥&gt;Palette.from(bitmap).generate(new PaletteAsyncListener() { public void onGenerated(Palette p) { // Use generated instance } }); ä¸¾ä¾‹è¯´æ˜å¸ƒå±€è®¾ç½®activity_main.xml 12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" tools:context=\"mraz.com.palettedemo.MainActivity\"&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" android:background=\"@color/colorPrimaryDark\"&gt;&lt;/android.support.v7.widget.Toolbar&gt; &lt;android.support.v7.widget.RecyclerView android:id=\"@+id/rv_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt;&lt;/android.support.v7.widget.RecyclerView&gt;&lt;/LinearLayout&gt; RecyclerViewä¸­ä½¿ç”¨Itemçš„å¸ƒå±€è®¾ç½®ï¼šcard_item.xml 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" android:padding=\"6dp\"&gt; &lt;com.makeramen.roundedimageview.RoundedImageView android:id=\"@+id/riv_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:riv_border_color=\"@color/colorAccent\" app:riv_border_width=\"1dp\" app:riv_corner_radius=\"20dp\" /&gt;&lt;/LinearLayout&gt; ActionBarä¸Šä½¿ç”¨çš„menuèµ„æºï¼šmain_menu.xml 12345678910111213141516&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;menu xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;item android:id=\"@+id/action_add\" android:icon=\"@drawable/ic_add_black_24dp\" android:title=\"@string/add\" app:showAsAction=\"ifRoom\" /&gt; &lt;item android:id=\"@+id/action_del\" android:icon=\"@drawable/ic_remove_black_24dp\" android:title=\"@string/del\" app:showAsAction=\"ifRoom\" /&gt;&lt;/menu&gt; ä»£ç ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105package mraz.com.palettedemo;import android.graphics.Bitmap;import android.graphics.BitmapFactory;import android.graphics.Color;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.support.v7.graphics.Palette;import android.support.v7.widget.DefaultItemAnimator;import android.support.v7.widget.LinearLayoutManager;import android.support.v7.widget.RecyclerView;import android.support.v7.widget.Toolbar;import android.util.Log;import android.view.Menu;import android.view.MenuItem;import java.util.ArrayList;public class MainActivity extends AppCompatActivity { private final int[] resIds = {R.drawable.p_1, R.drawable.p_2, R.drawable.p_3, R.drawable.p_4, R.drawable.p_5, R.drawable.p_6, R.drawable.p_7};//èµ„æºå›¾ç‰‡Id private final String[] titles = {\"Vibrant\", \"DarkVibrant\", \"LightVibrant\", \"Muted\", \"DarkMuted\", \"LightMuted\"};//6ç§èƒå–å‡ºæ¥çš„é¢œè‰²å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘ private Toolbar toolbar;//toolbar private ArrayList&lt;Integer&gt; colorList;//å­˜å‚¨ä»Paletteä¸­èƒå–å‡ºæ¥çš„6ä¸­é¢œè‰² private int clickCount = 0;//ç‚¹å‡»æ•° @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); colorList = new ArrayList&lt;&gt;(); toolbar = (Toolbar) findViewById(R.id.toolbar); setSupportActionBar(toolbar);//è®¾ç½®ActionBar RecyclerView recyclerView = (RecyclerView) findViewById(R.id.rv_content); RecyclerView.LayoutManager layoutManager = new LinearLayoutManager(this, LinearLayoutManager.HORIZONTAL, false); MyRecyclerAdapter myRecyclerAdapter = new MyRecyclerAdapter();//åˆå§‹åŒ–RecyclerView recyclerView.setAdapter(myRecyclerAdapter); recyclerView.setLayoutManager(layoutManager); recyclerView.setOnScrollListener(new RecyclerView.OnScrollListener() { @Override public void onScrolled(RecyclerView recyclerView, int dx, int dy) { int offset = recyclerView.computeHorizontalScrollOffset(); int width = recyclerView.getChildAt(0).getWidth(); int current = offset / width; int secondoffset = offset % width; if (secondoffset &gt;= width / 2) { current = current + 1; } setActionBarColor(current); clickCount = 0; super.onScrolled(recyclerView, dx, dy); } });//è®¾ç½®recyclerViewçš„æ»šåŠ¨äº‹ä»¶ç›‘å¬ï¼Œä»¥æ­¤æ¥æ”¹å˜actionbaræ”¯æŒçš„é¢œè‰² setActionBarColor(0);//é¦–æ¬¡ä½¿ç”¨åˆå§‹åŒ– } @Override public boolean onCreateOptionsMenu(Menu menu) { getMenuInflater().inflate(R.menu.main_menu, menu);//åˆå§‹åŒ–èœå•èµ„æº return super.onCreateOptionsMenu(menu); } private void setActionBarColor(int position) { Bitmap bitmap = BitmapFactory.decodeResource(getResources(), resIds[position]); Palette.PaletteAsyncListener paletteAsyncListener = new Palette.PaletteAsyncListener() { @Override public void onGenerated(Palette palette) { colorList.clear(); colorList.add(palette.getVibrantColor(Color.WHITE)); colorList.add(palette.getDarkVibrantColor(Color.WHITE)); colorList.add(palette.getLightVibrantColor(Color.WHITE)); colorList.add(palette.getMutedColor(Color.WHITE)); colorList.add(palette.getDarkMutedColor(Color.WHITE)); colorList.add(palette.getLightMutedColor(Color.WHITE));//èƒå–å‡ºå…­ç§é¢œè‰² toolbar.setBackgroundColor(colorList.get(0)); toolbar.setTitle(titles[0]); } }; Palette.from(bitmap).generate(paletteAsyncListener); } @Override public boolean onOptionsItemSelected(MenuItem item) { switch (item.getItemId()) { case R.id.action_add: { clickCount++; int index = clickCount % (colorList.size()); toolbar.setBackgroundColor(colorList.get(index)); //é€šè¿‡ç‚¹å‡»äº‹ä»¶åˆ‡æ¢ActionBarçš„èƒŒæ™¯è‰²å’Œæ ‡é¢˜ toolbar.setTitle(titles[index]); break; } case R.id.action_del: { if (clickCount &gt; 0) clickCount--; int index = clickCount % (colorList.size()); toolbar.setBackgroundColor(colorList.get(index)); toolbar.setTitle(titles[index]); break; } } return super.onOptionsItemSelected(item); }} å…³äºPaletteçš„ä½¿ç”¨åˆ†ä¸ºä¸¤ç§ï¼š1.åŒæ­¥ä½¿ç”¨Palette p = Palette.from(bitmap).generate();2.å¼‚æ­¥ä½¿ç”¨ 12345Palette.from(bitmap).generate(new PaletteAsyncListener() { public void onGenerated(Palette p) { // Use generated instance }}); æ•ˆæœ æ“ä½œ æ•ˆæœå›¾ å·¦å³æ»‘åŠ¨ActionBarèƒŒæ™¯è‰²æ”¹å˜ åˆ‡æ¢ActionBarèƒŒæ™¯è‰² APIç®€ä»‹ Paletteç›¸å…³API ç›´æ¥è·å–é¢œè‰²çš„æ–¹æ³• é€šè¿‡åˆ›å»ºçš„Paletteç›´æ¥è·å–å…¶ä¸­çš„é¢œè‰²ï¼Œç”¨æ¥è®¾ç½®UIç•Œé¢ä¸­çš„ä¸€äº›å…ƒç´  è·å–Swatchçš„æ–¹æ³• è¿™é‡Œè·å–çš„Swatchä¸­çš„å†…å®¹æ›´ä¸°å¯Œé€šè¿‡Swatchå¯ä»¥è·å–æ›´ä¸°å¯Œçš„é¢œè‰²å†…å®¹ï¼Œå¦‚ :getTitleTextColor()getBodyTextColor()getRgb()getHsl()ç¤ºä¾‹ä¸­åªæ˜¯ä½¿ç”¨äº†ä¸€éƒ¨åˆ†çš„æ–¹æ³•ï¼Œå…·ä½“çš„å…¶ä»–æ–¹æ³•ä½¿ç”¨æƒ…å†µç±»ä¼¼ï¼Œæ ¹æ®Bitmapçš„é¢œè‰²æ ¼ï¼Œè®¾ç½®å¯¹åº”çš„å­—ä½“é¢œè‰²ï¼ŒUIèµ„æºé¢œè‰²ï¼Œå¯ä»¥ä½¿ç•Œé¢çœ‹ä¸Šå»æ›´åŠ çš„å’Œè°å’Œç¾å¥½ã€‚","link":"/2016/06/26/ã€ŠAndroid åŸºç¡€ï¼ˆå…«ï¼‰ã€‹ Palette/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåä¹ï¼‰ã€‹ CoordinatorLayout","text":"ä»‹ç»CoordinatorLayoutï¼Œä¸­æ–‡ç¿»è¯‘ï¼Œåè°ƒå¸ƒå±€ï¼Œé¡¾åæ€ä¹‰ï¼Œæ­¤å¸ƒå±€ä¸­çš„å­Viewä¹‹é—´ï¼Œå­Viewä¸çˆ¶å¸ƒå±€ä¹‹é—´åº”è¯¥æ˜¯å¯ä»¥åè°ƒå·¥ä½œçš„ï¼Œå¦‚ä½•åè°ƒï¼ŒBehaviorã€‚ ä»Šå¤©çœ‹ä¸‹Android Studioç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªæ¨¡æ¿Activity Android Studioåˆ›å»ºScrolling ActivityFile - &gt; New - &gt; Activity -&gt; Scrolling Activity æˆ–è€…åœ¨New Projectçš„æ—¶å€™é€‰æ‹©åˆå§‹åŒ–Activityä¸º Scrolling Activity Sampleæ•ˆæœå…¶å®ä»ä¸Šé¢çš„å›¾å·²ç»å¯ä»¥çœ‹å‡ºä¸€ç‚¹æ•ˆæœæ¥ Sampleä»£ç ASæä¾›çš„è¿™ä¸ªSampleçš„å…³é”®é™¤äº†å¸ƒå±€ï¼Œè¿˜æ˜¯å¸ƒå±€ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå¸ƒå±€activity_scrolling.xml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.design.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"true\" tools:context=\"mraz.com.coordinatorlayoutdemo.ScrollingActivity\"&gt; &lt;android.support.design.widget.AppBarLayout android:id=\"@+id/app_bar\" android:layout_width=\"match_parent\" android:layout_height=\"@dimen/app_bar_height\" android:fitsSystemWindows=\"true\" android:theme=\"@style/AppTheme.AppBarOverlay\"&gt; &lt;android.support.design.widget.CollapsingToolbarLayout android:id=\"@+id/toolbar_layout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"true\" app:contentScrim=\"?attr/colorPrimary\" app:layout_scrollFlags=\"scroll|exitUntilCollapsed\"&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" app:layout_collapseMode=\"pin\" app:popupTheme=\"@style/AppTheme.PopupOverlay\" /&gt; &lt;/android.support.design.widget.CollapsingToolbarLayout&gt; &lt;/android.support.design.widget.AppBarLayout&gt; &lt;include layout=\"@layout/content_scrolling\" /&gt; &lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"@dimen/fab_margin\" android:src=\"@android:drawable/ic_dialog_email\" app:layout_anchor=\"@id/app_bar\" app:layout_anchorGravity=\"bottom|end\" /&gt;&lt;/android.support.design.widget.CoordinatorLayout&gt; è¿™ä¸ªå¸ƒå±€ä¸­åˆåŒ…å«äº†å¦å¤–ä¸€ä¸ªå¸ƒå±€content_scrolling.xml 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.v4.widget.NestedScrollView xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:layout_behavior=\"@string/appbar_scrolling_view_behavior\" tools:context=\"mraz.com.coordinatorlayoutdemo.ScrollingActivity\" tools:showIn=\"@layout/activity_scrolling\"&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"@dimen/text_margin\" android:text=\"@string/large_text\" /&gt;&lt;/android.support.v4.widget.NestedScrollView&gt; ä¸€èˆ¬éƒ½æ˜¯è¿™æ ·çš„ä½¿ç”¨æ–¹å¼ï¼Œè€ƒè™‘åˆ°å®ƒä¹‹æ‰€ä»¥è¿™æ ·å­å°†ä¸¤ä¸ªå¸ƒå±€åˆ†å¼€ï¼Œä¸»è¦æ˜¯æ–¹ä¾¿å¼€å‘è€…æ›¿æ¢è‡ªå·±çš„å®ç°å†…å®¹ï¼Œä¹Ÿå°±æ˜¯content_scrolling.xmlä¸­çš„å†…å®¹ï¼Œè€Œactivity_scrolling.xmlæ–‡ä»¶ä¸­å®šä¹‰çš„ä¸€äº›å†…å®¹å¯ä»¥ç†è§£æˆä½¿ç”¨çš„æ¡†æ¶ï¼Œè¿™æ ·å­å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆASåœ¨æä¾›Sampleçš„æ—¶å€™ä¼šä½¿ç”¨ä¸¤ä¸ªå¸ƒå±€ã€‚android.support.design.widget.CoordinatorLayout |â€”â€”â€”-&gt;AppBarLayout |â€”â€”â€”â€”â€”&gt;CollapsingToolbarLayout |â€”â€”â€”â€”â€”â€”â€”&gt;ToolBar |â€”â€”â€”-&gt;NestedScrollView |â€”â€”â€”-&gt;FloatingActionButton å…³äºè¿™å‡ ä¸ªLayoutAppBarLayoutAppBarLayoutæ˜¯ä¸€ä¸ªå‚ç›´æ–¹å‘ä¸Šçš„LinearLayoutï¼Œå®ƒå®ç°äº†å¦‚æ»šåŠ¨æ‰‹åŠ¿ç­‰ææ–™è®¾è®¡app barçš„ç‰¹æ€§ã€‚AppBarLayoutçš„å­Viewå¿…é¡»é€šè¿‡LayoutParams#setScrollFlags(int)æˆ–è€…xmlä¸­çš„å±æ€§å€¼app:layout_scrollFlags æä¾›ä»–ä»¬æƒ³è¦çš„æ»šåŠ¨è¡Œä¸ºã€‚è¿™ä¸ªLayoutåŸºæœ¬ä¸Šåªèƒ½åœ¨CoordinatorLayoutä¸‹ä½¿ç”¨ï¼Œå¦‚æœåœ¨å…¶ä»–çš„ViewGroupä¸‹ä½¿ç”¨çš„è¯ï¼Œå¾ˆå¤šåŠŸèƒ½éƒ½ä¸èƒ½ä½¿ç”¨ã€‚AppBarLaytouåŒæ—¶éœ€è¦ä¸€ä¸ªå’Œä»–é…åˆçš„å¯ä»¥æ»šåŠ¨çš„è§†å›¾ï¼Œé€šè¿‡ScrollingViewBehavioræ¥äº’ç›¸ç»‘å®šï¼Œå¦‚Sampleä¸­çš„ app:layout_behavior=â€@string/appbar_scrolling_view_behaviorâ€ æŒ‡ä»£çš„å°±æ˜¯ android.support.design.widget.AppBarLayout$ScrollingViewBehavior æˆ–è€…æŒ‡å®šä¸€ä¸ªå…¶ä»–çš„Behaviorï¼Œä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²è¦æ˜¯è¿™ä¸ªç±»çš„å…¨ç±»åã€‚è¿™é‡Œçš„è¿™ä¸ªScrollingViewBehavioråœ¨AppBarLayout.javaä¸­å®šä¹‰ï¼Œç»§æ‰¿HeaderScrollingViewBehaviorï¼Œè€Œå®ƒå°±ç»§æ‰¿ViewOffsetBehavior&lt; View&gt;ï¼Œè€Œå®ƒåˆç»§æ‰¿è‡ªCoordinatorLayout.Behavior&lt; V&gt;ï¼Œæ‰€ä»¥æœ€åçš„çˆ¶ç±»è¿˜æ˜¯è¿™ä¸ªBehaviorã€‚è¿™é‡Œæš‚æ—¶å…ˆä¸çœ‹ï¼Œåé¢æˆ‘è‡ªå·±å­¦ä¹ ä¹‹åå†æ¥å¦å†™ä¸€ç¯‡ï¼Œåº”è¯¥æœ‰ç‚¹æå¤´ã€‚ layout_scrollFlagsæœ‰å‡ ä¸ªå¯¹åº”çš„å±æ€§ å±æ€§å æ„ä¹‰ scroll è¦æ»šåŠ¨å‡ºå±å¹•çš„viewéƒ½éœ€è¦è®¾ç½®è¿™ä¸ªflag-æ²¡æœ‰è®¾ç½®è¿™ä¸ªflagçš„viewå°†è¢«å›ºå®šåœ¨å±å¹•é¡¶éƒ¨ enterAlways æ‰€æœ‰çš„ä¸‹æ»‘åŠ¨ä½œéƒ½ä¼šå¯¼è‡´è¯¥è§†å›¾çš„å‡ºç°ï¼Œå¯â€œå¿«é€Ÿè¿”å›â€æ¨¡å¼ enterAlwaysCollapsed å®šä¹‰äº†ä¸€ä¸ªæœ€å°é«˜åº¦ï¼ˆminHeightï¼‰åŒenterAlwaysä¹Ÿå®šä¹‰äº†ï¼Œé‚£ä¹ˆviewå°†åœ¨åˆ°è¾¾è¿™ä¸ªæœ€å°é«˜åº¦çš„æ—¶å€™å¼€å§‹ç¤ºï¼Œå¹¶ä¸”ä»è¿™ä¸ªæ—¶å€™å¼€å§‹æ…¢æ…¢å±•å¼€ï¼Œå½“æ»šåŠ¨åˆ°é¡¶éƒ¨çš„æ—¶å€™å±•å¼€å®Œ exitUntilCollapsed å½“ä½ å®šä¹‰äº†ä¸€ä¸ªminHeightï¼Œè¿™ä¸ªviewå°†åœ¨åŠ¨åˆ°è¾¾è¿™ä¸ªæœ€å°é«˜åº¦çš„æ—¶å€™æ¶ˆå¤± CollapsingToolbarLayoutCollapsingToolbarLayoutæ˜¯ToolBarçš„å°è£…ç±»ï¼Œå®ç°å¯ä¼¸ç¼©çš„Toolbarï¼Œå®ƒè¢«è®¾è®¡ç”¨æ¥å½“åšAppBarLayoutçš„ç›´æ¥å­å¸ƒå±€ï¼ŒCollapsingToolbarLayout åŒ…å«å¦‚ä¸‹ç‰¹æ€§ï¼š Collapsing titleå½“toolbarä¼¸å±•å¼€æ—¶æ˜¾ç¤ºçš„ç›¸å¯¹è¾ƒå¤§ï¼Œå½“ç§»é™¤å±å¹•çš„æ—¶å€™ä¼šæ…¢æ…¢å˜å°ï¼Œè¿‡setTitle(CharSequence)è®¾ç½®ï¼Œtitleçš„å¤–è§‚å¯ä»¥ç”¨collapsedTextAppearanceå’ŒexpandedTextAppearanceåˆ†åˆ«è®¾ç½® Content Scrimå½“æ»šåŠ¨ä½ç½®è¾¾åˆ°ä¸€ä¸ªå›ºå®šå€¼çš„æ—¶å€™å‡ºç°æˆ–è€…æ¶ˆå¤±çš„å†…å®¹ï¼ŒsetContentScrim(Drawable)æˆ–è€…å±æ€§å€¼app:contentScrimè®¾ç½® Status bar scrimå½“æ»šåŠ¨å€¼è¾¾åˆ°ä¸€ä¸ªå›ºå®šå€¼çš„æ—¶å€™å‡ºç°åœ¨çŠ¶æ€æ åé¢çš„å†…å®¹ï¼Œé€šsetStatusBarScrim(Drawable)ï¼Œè¿™ä¸ªç‰¹æ€§åªèƒ½åœ¨Lç‰ˆæœ¬ä¸Šå®ç°ï¼Œå¹¶ä¸”è¦è®¾ç½®android:fitsSystemWindows=â€œtrueâ€ Parallax scrolling childrenè§†å·®æ»šåŠ¨å­å¸ƒå±€ï¼Œå½“å†…å®¹æ»šåŠ¨çš„æ—¶å€™ï¼Œå­å¸ƒå±€ä¸­çš„å†…å®¹å¯ä»¥è·Ÿç€ä¸€èµ·åŠ¨æ»šåŠ¨è§†å·®å› å­å¯ä»¥é€šè¿‡setParallaxMultiplier(float)æˆ–layout_collapseParallaxMultiplierè®¾ç½®ï¼Œä¸æ­¤å¯¹åº”çš„æŠ˜å æ¨¡å¼è¦æˆlayout_collapseMode=â€œparallaxâ€ã€‚Sampleä¸­è®¾ç½®çš„Toolbarlayout_collapseModeä¸ºâ€pinâ€ å±æ€§ ç”¨æ³• pin CollapsingToolbarLayoutå®Œå…¨æ”¶ç¼©åï¼ŒToolbarè¿˜å¯ä»¥ä¿ç•™åœ¨å¹•ä¸Š parallax åœ¨å†…å®¹æ»šåŠ¨æ—¶ï¼ŒCollapsingToolbarLayoutä¸­çš„Viewï¼ˆæ¯”ImageView)ä¹Ÿå¯ä»¥åŒæ—¶æ»šåŠ¨ï¼Œå®ç°è§†å·®æ»šåŠ¨æ•ˆæœï¼Œé€šå¸¸layout_collapseParallaxMultiplier(è®¾ç½®è§†å·®å› å­)æ­é…ä½¿ç”¨ ä¸€èˆ¬Toolbarè®¾ç½®ä¸ºpinï¼ŒCollapsingToolbarLayoutä¸­çš„å…¶ä»–è§†å›¾å¯å°è¯•ä½¿ç”¨parallaxå±æ€§ Pinned position childrenä¸Šé¢å·²ç»è®²è§£äº†ï¼Œå¦‚Sampleä¸­çš„Toolbar Sampleä»£ç ä¿®æ”¹å®æˆ˜CollapsingToolbarLayoutä¸­åŠ ä¸ªå›¾ç‰‡çœ‹çœ‹1234567891011121314151617181920212223&lt;android.support.design.widget.CollapsingToolbarLayout android:id=\"@+id/toolbar_layout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"true\" app:contentScrim=\"?attr/colorPrimary\" app:layout_scrollFlags=\"scroll|enterAlways\"&gt; &lt;ImageView android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:scaleType=\"centerCrop\" android:src=\"@mipmap/bg\" app:layout_collapseMode=\"parallax\" app:layout_collapseParallaxMultiplier=\"0.7\" /&gt; &lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar\" android:layout_width=\"match_parent\" android:layout_height=\"?attr/actionBarSize\" app:layout_collapseMode=\"pin\" app:popupTheme=\"@style/AppTheme.PopupOverlay\" /&gt; &lt;/android.support.design.widget.CollapsingToolbarLayout&gt; æ•ˆæœï¼š CollapsingToolbarLayoutçš„æ ‡é¢˜é¢œè‰²å˜å˜12345678910&lt;android.support.design.widget.CollapsingToolbarLayout android:id=\"@+id/toolbar_layout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"true\" app:title=\"Beautiful Title\" app:expandedTitleTextAppearance=\"@style/MyExpandedText\"//åªå®šä¹‰ä¸€ä¸ªå­—ä½“é¢œè‰² app:collapsedTitleTextAppearance=\"@style/MyCollapsedText\"//åŒä¸Š app:contentScrim=\"?attr/colorPrimaryDark\" app:layout_scrollFlags=\"scroll|exitUntilCollapsed\"&gt; æ•ˆæœï¼š å¤‡æ³¨ï¼šå½“æˆ‘ç›´æ¥åœ¨xmlæ–‡ä»¶ä¸­ç›´æ¥åœ¨app:expandedTitleTextAppearanceåé¢è®¾ç½®colorçš„æ—¶å€™ï¼Œå¾—åˆ°çš„ç»“æœä¸æ˜¯æ”¹å˜å­—ä½“é¢œè‰²ï¼Œè€Œæ˜¯æ”¹å˜äº†æ•´ä¸ªèƒŒæ™¯çš„é¢œè‰²ï¼Œä½ ä»¬å¯ä»¥è¯•è¯• FloatingActionButtonçš„ä½ç½®æ”¹æ”¹12345678&lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"@dimen/fab_margin\" android:src=\"@android:drawable/ic_dialog_email\" app:layout_anchor=\"@id/toolbar\" app:layout_anchorGravity=\"bottom|center\" /&gt; æ¢ä¸ªåæ ‡ç³»ï¼Œä¹Ÿå°±æ˜¯layout_anchorå°±æ˜¯åŸºå‡†ç‚¹ï¼Œç›¸å¯¹äºå®ƒåœ¨bottomå’Œcenteræ˜¯ç›¸å¯¹äºè¿™ä¸ªåŸºå‡†ç‚¹çš„ä½ç½®æ•ˆæœï¼š","link":"/2016/08/13/ã€ŠAndroid åŸºç¡€ï¼ˆåä¹ï¼‰ã€‹ CoordinatorLayout/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆåäº”ï¼‰ã€‹ Alert Dialog","text":"ç®€ä»‹ The AlertDialog class allows you to build a variety of dialog designs and is often the only dialog class youâ€™ll need. there are three regions of an alert dialog: 1.TitleThis is optional and should be used only when the content area is occupied by a detailed message, a list, or custom layout. If you need to state a simple message or question (such as the dialog in figure 1), you donâ€™t need a title. 2.Content areaThis can display a message, a list, or other custom layout. 3.Action buttonsThere should be no more than three action buttons in a dialog. ä¸€èˆ¬çš„AlertDialogåˆ†ä¸º2ä¸ªéƒ¨åˆ†ï¼Œå¤´éƒ¨ï¼Œå†…å®¹å’ŒAction Buttonï¼Œå¤´éƒ¨åŒ…å«å›¾æ ‡å’Œæ–‡å­—ï¼Œå†…å®¹éƒ¨åˆ†å¯ä»¥è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›å¸¸è§çš„åˆ—è¡¨ï¼Œå•é€‰é¡¹ï¼Œå¤šé€‰é¡¹ç­‰å†…å®¹ï¼ŒAction Buttonå°±æ˜¯å¸¸è§çš„OKå•Šï¼Œ Cancelå•Šç­‰ç­‰ã€‚ ç±»ç»“æ„AlertDialog é‡ç‚¹å…³æ³¨ä¸€ä¸‹Builderç±»çš„ç»“æ„ å…³äºè¿™äº›æ–¹æ³•çš„ä½¿ç”¨è¯´æ˜ï¼Œè¿™é‡Œä¸åšä¸€ä¸€ä»‹ç»ï¼Œåé¢é€šè¿‡å®ä¾‹å¯ä»¥çœ‹å‡ºç«¯å€ªï¼Œä¸è¿‡å¯ä»¥é€šè¿‡æŸ¥é˜…APIæ–‡æ¡£ç†Ÿæ‚‰ä¸€ä¸‹ï¼ŒAlertDialog.Builder åŸºæœ¬ä½¿ç”¨Simple AlertDialogä»£ç 12345678910111213141516171819202122232425262728293031private void showSimpleAlertDialog() { //åˆ›å»ºalertdialog builder AlertDialog.Builder builder = new AlertDialog.Builder(mContext); //è®¾ç½®å›¾æ ‡ï¼Œæ ‡é¢˜ï¼Œæ¶ˆæ¯å†…å®¹ builder.setIcon(getResources().getDrawable(R.drawable.ic_adb_black_24dp)) .setTitle(R.string.title) .setMessage(R.string.content); //è®¾ç½®Acton Buttons builder.setNegativeButton(R.string.cancel, new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialogInterface, int i) { Toast.makeText(mContext, \"Cancal is clicked\", Toast.LENGTH_SHORT).show(); } }); builder.setPositiveButton(R.string.ok, new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialogInterface, int i) { Toast.makeText(mContext, \"OK is clicked\", Toast.LENGTH_SHORT).show(); } }); builder.setNeutralButton(R.string.reminder, new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialogInterface, int i) { Toast.makeText(mContext, \"Remind me later is clicked\", Toast.LENGTH_SHORT).show(); } }); //æ˜¾ç¤ºalert dialog è¿™ä¸ªæ˜¯AlertDialogçš„show()æ–¹æ³•æ˜¯ç­‰ä»·çš„ builder.show();} æ•ˆæœ å¤‡æ³¨_ Action Button æ„ä¹‰ setNegativeButton åšå–æ¶ˆã€è¿”å›ç­‰æ“ä½œï¼Œå¦‚Cancel setPositiveButton åšç¡®è®¤ã€æäº¤ç­‰æ“ä½œï¼Œå¦‚OK setNeutralButton åšä¸­æ€§æ“ä½œï¼Œå¦‚Update Later AlertDialog.Builderä¸­çš„show()æ–¹æ³•å’ŒAlertDialogçš„show()æ–¹æ³•æ˜¯ç­‰ä»·çš„ AlertDialog With Arrayä»£ç 12345678910111213141516171819202122public void showAlertDialogWithArray() { AlertDialog.Builder builder = new AlertDialog.Builder(mContext); builder.setIcon(getResources().getDrawable(R.drawable.ic_assessment_black_24dp)) .setTitle(R.string.title) .setItems(R.array.dialoglist, new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialogInterface, int i) { switch (i) { case 0: showTwo.setBackgroundResource(R.color.pink); break; case 1: showTwo.setBackgroundResource(R.color.stone); break; case 2: showTwo.setBackgroundResource(R.color.yellow); break; } } }); builder.create().show();} æ•ˆæœ å¤‡æ³¨ æ–¹æ³• å«ä¹‰ setItems é€šè¿‡arrayæ¥è®¾ç½®dialogçš„å†…å®¹ setAdapter é€šè¿‡ListAdapteræ¥è®¾ç½®dialogçš„å†…å®¹ ListAdapterå¯ä»¥æ˜¾ç¤ºçš„å†…å®¹åº”è¯¥æ¯”Arrayè¦ä¸°å¯Œï¼Œä½†æ˜¯ç°åœ¨å¼€æºåº“å¾ˆå¤šï¼Œé’ˆå¯¹Dialogçš„ç¾è§‚çš„å¼€æºåº“ä¹Ÿä¸å°‘ï¼Œä¸€èˆ¬å¼€å‘è¿‡ç¨‹ä¸­ä¼šä½¿ç”¨ç°æˆçš„ã€‚ AlertDialog With MultiChoiceä»£ç 1234567891011121314151617181920212223public void showAlertDialogWithMutiChoice() { final ArrayList&lt;String&gt; selecteditems = new ArrayList&lt;&gt;(); AlertDialog.Builder builder = new AlertDialog.Builder(mContext); builder.setIcon(R.drawable.ic_event_seat_black_24dp) .setTitle(R.string.title) .setMultiChoiceItems(R.array.fruits, null, new DialogInterface.OnMultiChoiceClickListener() { @Override public void onClick(DialogInterface dialogInterface, int which, boolean isChecked) { if (isChecked) { selecteditems.add(getResources() .getStringArray(R.array.fruits)[which]); Toast.makeText(mContext, selecteditems.toString(), Toast.LENGTH_SHORT).show(); } else { selecteditems.remove(getResources() .getStringArray(R.array.fruits)[which]); Toast.makeText(mContext, selecteditems.toString(), Toast.LENGTH_SHORT).show(); } } }); builder.create().show();} æ•ˆæœ AlertDialog With Single Choiceä»£ç 123456789101112131415public void showAlertDialogWithSingleChoice() { AlertDialog.Builder builder = new AlertDialog.Builder(mContext); builder.setIcon(R.drawable.ic_build_black_24dp) .setTitle(R.string.title); builder.setSingleChoiceItems(R.array.places, -1, new DialogInterface.OnClickListener() { @Override public void onClick(DialogInterface dialogInterface, int i) { Toast.makeText(mContext, getResources().getStringArray(R.array.places)[i] + \" is selected\", Toast.LENGTH_SHORT).show(); } }); builder.create().show();} æ•ˆæœ Custom Alert Dialogä»£ç 1234567public void showCustomAlertDialog() { AlertDialog.Builder builder = new AlertDialog.Builder(mContext); builder.setIcon(R.drawable.ic_assessment_black_24dp).setTitle(R.string.login); builder.setView(R.layout.custom_alert); builder.setCustomTitle(LayoutInflater.from(mContext).inflate(R.layout.custom_title , null )); builder.create().show();} è‡ªå®šä¹‰å¸ƒå±€æ–‡ä»¶Titleè‡ªå®šä¹‰ 12345678910111213141516171819202122&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"60dp\" android:background=\"@drawable/shape_title\" android:orientation=\"horizontal\"&gt; &lt;ImageView android:layout_width=\"60dp\" android:layout_height=\"60dp\" android:paddingLeft=\"20dp\" android:src=\"@drawable/ic_adb_black_24dp\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"center_vertical\" android:layout_marginLeft=\"40dp\" android:text=\"Custom Title\" android:textSize=\"15pt\" android:textStyle=\"bold\" /&gt;&lt;/LinearLayout&gt; Content Areaè‡ªå®šä¹‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:layout_margin=\"@dimen/activity_horizontal_margin\" android:orientation=\"vertical\"&gt; &lt;android.support.design.widget.TextInputLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_marginTop=\"10dp\"&gt; &lt;EditText android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:hint=\"UserName\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;android.support.design.widget.TextInputLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" app:counterEnabled=\"true\" app:counterMaxLength=\"40\"&gt; &lt;EditText android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:fontFamily=\"sans-serif\" android:hint=\"Password\" android:inputType=\"textPassword\" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_margin=\"@dimen/activity_vertical_margin\" android:orientation=\"horizontal\"&gt; &lt;Button android:layout_width=\"wrap_content\" android:layout_height=\"match_parent\" android:layout_weight=\"1\" android:background=\"@drawable/shaperect\" android:text=\"Submit\" /&gt; &lt;Button android:layout_width=\"wrap_content\" android:layout_height=\"match_parent\" android:layout_weight=\"1\" android:background=\"@drawable/shape_two\" android:text=\"Reset\" /&gt; &lt;/LinearLayout&gt;&lt;/LinearLayout&gt; æ•ˆæœ å¤‡æ³¨è‡ªå®šä¹‰æ ‡é¢˜æ å’Œæ˜¾ç¤ºçš„å†…å®¹ï¼ŒAction Buttonå¯ä»¥é€šè¿‡åœ¨Contentä¸­æ·»åŠ Buttonçš„æ–¹å¼æ¥å®ç°ï¼Œä¸°å¯Œäº†Alert Dialogçš„æ˜¾ç¤ºå†…å®¹ï¼ŒAlert Dialogä¸­åº”è¯¥è¿˜æœ‰å¾ˆå¤šä¸œè¥¿å¾…æŒ–æ˜ï¼Œé”„å¤´éœ€è¦æŒ¥èµ·æ¥~","link":"/2016/07/06/ã€ŠAndroid åŸºç¡€ï¼ˆåäº”ï¼‰ã€‹ Alert Dialog/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åä¸€ï¼‰ã€‹ ExpandableListView","text":"1. ç®€ä»‹çœ‹ä¸‹æºç ä¸­çš„è‹±æ–‡ä»‹ç» 123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * A view that shows items in a vertically scrolling two-level list. This * differs from the {@link ListView} by allowing two levels: groups which can * individually be expanded to show its children. The items come from the * {@link ExpandableListAdapter} associated with this view. * &lt;p&gt; * Expandable lists are able to show an indicator beside each item to display * the item's current state (the states are usually one of expanded group, * collapsed group, child, or last child). Use * {@link #setChildIndicator(Drawable)} or {@link #setGroupIndicator(Drawable)} * (or the corresponding XML attributes) to set these indicators (see the docs * for each method to see additional state that each Drawable can have). The * default style for an {@link ExpandableListView} provides indicators which * will be shown next to Views given to the {@link ExpandableListView}. The * layouts android.R.layout.simple_expandable_list_item_1 and * android.R.layout.simple_expandable_list_item_2 (which should be used with * {@link SimpleCursorTreeAdapter}) contain the preferred position information * for indicators. * &lt;p&gt; * The context menu information set by an {@link ExpandableListView} will be a * {@link ExpandableListContextMenuInfo} object with * {@link ExpandableListContextMenuInfo#packedPosition} being a packed position * that can be used with {@link #getPackedPositionType(long)} and the other * similar methods. * &lt;p&gt; * &lt;em&gt;&lt;b&gt;Note:&lt;/b&gt;&lt;/em&gt; You cannot use the value &lt;code&gt;wrap_content&lt;/code&gt; * for the &lt;code&gt;android:layout_height&lt;/code&gt; attribute of a * ExpandableListView in XML if the parent's size is also not strictly specified * (for example, if the parent were ScrollView you could not specify * wrap_content since it also can be any length. However, you can use * wrap_content if the ExpandableListView parent has a specific size, such as * 100 pixels. * * @attr ref android.R.styleable#ExpandableListView_groupIndicator * @attr ref android.R.styleable#ExpandableListView_indicatorLeft * @attr ref android.R.styleable#ExpandableListView_indicatorRight * @attr ref android.R.styleable#ExpandableListView_childIndicator * @attr ref android.R.styleable#ExpandableListView_childIndicatorLeft * @attr ref android.R.styleable#ExpandableListView_childIndicatorRight * @attr ref android.R.styleable#ExpandableListView_childDivider * @attr ref android.R.styleable#ExpandableListView_indicatorStart * @attr ref android.R.styleable#ExpandableListView_indicatorEnd * @attr ref android.R.styleable#ExpandableListView_childIndicatorStart * @attr ref android.R.styleable#ExpandableListView_childIndicatorEnd */ ExpandableListViewæ˜¯ä¸åŒäºListViewçš„ä¸¤çº§åˆ—è¡¨Viewï¼Œå¯ä»¥æ”¶èµ·å¯ä»¥å±•å¼€ã€‚é€šè¿‡ExpandableListAdapteræ¥é…ç½®éœ€è¦ç°å®çš„itemsã€‚ 2. åŸºæœ¬ä½¿ç”¨2.1 å¸ƒå±€æ–‡ä»¶group.xml(ä¸€çº§èŠ‚ç‚¹itemå¸ƒå±€) 123456789101112131415&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:paddingLeft=\"30dp\" android:orientation=\"vertical\" &gt; &lt;TextView android:id=\"@+id/group_text\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:paddingTop=\"10dip\" android:paddingBottom=\"10dip\" android:text=\"\" /&gt;&lt;/LinearLayout&gt; child.xml(äºŒçº§èŠ‚ç‚¹item) 12345678910111213&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"horizontal\" android:paddingLeft=\"40dp\"&gt; &lt;TextView android:id=\"@+id/textOne\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:text=\"\" /&gt;&lt;/LinearLayout&gt; actiivty_main.xml(ä¸»ç•Œé¢å¸ƒå±€) 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\"cn.onlyloveyd.expandablelistviewdemo.MainActivity\"&gt; &lt;ExpandableListView android:id=\"@+id/expandable_list\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:groupIndicator=\"@drawable/expand\" android:childIndicator=\"@drawable/collapse\" /&gt;&lt;/LinearLayout&gt; 2.2 ä»£ç YEAdapter.java(å¯ä¼¸å±•åˆ—è¡¨å¯¹åº”çš„Adapter) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157public class YEAdapter extends BaseExpandableListAdapter { //ä¸€çº§èŠ‚ç‚¹æ•°æ® private List&lt;GroupItem&gt; mGroupItems; private Context mContext; public YEAdapter(Context context, List&lt;GroupItem&gt; mData) { mGroupItems = mData; mContext = context; } /** * ä¸€çº§èŠ‚ç‚¹æ•°é‡ * @return */ @Override public int getGroupCount() { return mGroupItems.size(); } /** * æŒ‡å®šä½ç½®ä¸€çº§èŠ‚ç‚¹ä¸‹äºŒçº§èŠ‚ç‚¹æ•°é‡ * @param groupPosition * @return */ @Override public int getChildrenCount(int groupPosition) { return mGroupItems.get(groupPosition).mChildList.size(); } /** * è·å–ä¸€çº§èŠ‚ç‚¹å¯¹è±¡ * @param groupPosition * @return */ @Override public Object getGroup(int groupPosition) { return mGroupItems.get(groupPosition); } /** * è·å–äºŒçº§èŠ‚ç‚¹å¯¹è±¡ * @param groupPosition * @param childPosition * @return */ @Override public Object getChild(int groupPosition, int childPosition) { return mGroupItems.get(groupPosition).mChildList.get(childPosition); } /** * è·å–ä¸€çº§èŠ‚ç‚¹IDï¼Œè¿™é‡Œç”¨ä½ç½®å€¼è¡¨ç¤º * @param groupPosition * @return */ @Override public long getGroupId(int groupPosition) { return groupPosition; } /** * è·å–äºŒçº§èŠ‚ç‚¹IDï¼Œè¿™é‡Œç”¨ä½ç½®å€¼è¡¨ç¤º * @param groupPosition * @param childPosition * @return */ @Override public long getChildId(int groupPosition, int childPosition) { return childPosition; } /** * IDæ˜¯å¦ç¨³å®š * @return */ @Override public boolean hasStableIds() { return true; } /** * è·å–ä¸€çº§èŠ‚ç‚¹view * @param groupPosition * @param isExpanded * @param convertView * @param parent * @return */ @Override public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) { View view=null; TextView mTv; if(convertView!=null){ view = convertView; mTv = (TextView) view.getTag(); }else{ view = View.inflate(mContext,R.layout.group, null); mTv = (TextView) view.findViewById(R.id.group_text); view.setTag(mTv); } mTv.setText(mGroupItems.get(groupPosition).title); return view; } /** * è·å–äºŒçº§èŠ‚ç‚¹View * @param groupPosition * @param childPosition * @param isLastChild * @param convertView * @param parent * @return */ @Override public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) { View view=null; TextView mTextView; if(convertView!=null){ view = convertView; mTextView = (TextView) view.getTag(); }else{ view = View.inflate(mContext,R.layout.child, null); mTextView = (TextView) view.findViewById(R.id.textOne); view.setTag(mTextView); } mTextView.setText(mGroupItems.get(groupPosition).mChildList.get(childPosition).message); return view; } /** * äºŒçº§èœå•æ˜¯å¦å¯é€‰ï¼ˆtrueä¸ºå¯é€‰ï¼Œfalseä¸ºä¸å¯é€‰ï¼Œä¹Ÿå°±æ˜¯å“åº”å’Œä¸å“åº”ç‚¹å‡»äº‹ä»¶ï¼‰ * @param groupPosition * @param childPosition * @return */ @Override public boolean isChildSelectable(int groupPosition, int childPosition) { return true; } /** * ä¸€çº§èŠ‚ç‚¹å¯¹è±¡ */ public static class GroupItem { String title; List&lt;ChildItem&gt; mChildList; } /** * äºŒçº§èŠ‚ç‚¹å¯¹è±¡ */ public static class ChildItem { String message; }} å…·ä½“è§£é‡Šè¯·æŸ¥é˜…æ³¨é‡Šä¿¡æ¯ MainActivity.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960public class MainActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); List&lt;YEAdapter.GroupItem&gt; mGroupItems = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 5; i++) { YEAdapter.GroupItem item = new YEAdapter.GroupItem(); item.title = \"this is \" + i + \"nd group item\"; List&lt;YEAdapter.ChildItem&gt; mChildItems = new ArrayList&lt;&gt;(); for (int j = 0; j &lt; 4; j++) { YEAdapter.ChildItem item1 = new YEAdapter.ChildItem(); item1.message = \"this is \" + i + \"nd group item's \" + j + \"nd child\"; mChildItems.add(item1); } item.mChildList = mChildItems; mGroupItems.add(item); } ExpandableListView expandableListView = (ExpandableListView) this.findViewById(R.id.expandable_list); YEAdapter yeAdapter = new YEAdapter(this, mGroupItems); expandableListView.setAdapter(yeAdapter); expandableListView.setOnChildClickListener(new ExpandableListView.OnChildClickListener() { @Override public boolean onChildClick(ExpandableListView parent, View v, int groupPosition, int childPosition, long id) { Toast.makeText(MainActivity.this, groupPosition + \"nd group's \" + childPosition + \"nd Item is clicked!\", Toast.LENGTH_SHORT).show(); return false; } }); expandableListView.setOnGroupClickListener(new ExpandableListView.OnGroupClickListener() { @Override public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id) { Toast.makeText(MainActivity.this, groupPosition + \"nd group is clicked\", Toast.LENGTH_SHORT).show(); return false; } }); expandableListView.setOnGroupCollapseListener(new ExpandableListView.OnGroupCollapseListener() { @Override public void onGroupCollapse(int groupPosition) { Toast.makeText(MainActivity.this, \"the \" + groupPosition + \"nd group is collapsed\", Toast.LENGTH_SHORT).show(); } }); expandableListView.setOnGroupExpandListener(new ExpandableListView.OnGroupExpandListener() { @Override public void onGroupExpand(int groupPosition) { Toast.makeText(MainActivity.this, \"the \" + groupPosition + \"nd group is expanded\", Toast.LENGTH_SHORT).show(); } }); }} 2.3 å®é™…æ•ˆæœ 3. ç±»ç»“æ„3.1 å±æ€§å€¼ å±æ€§å€¼ å«ä¹‰ groupIndicator ä¸€çº§èŠ‚ç‚¹æŒ‡ç¤ºå™¨ indicatorLeft ä¸€çº§èŠ‚ç‚¹æŒ‡ç¤ºå™¨è·ç¦»å·¦è¾¹ç•Œè·ç¦» indicatorRight ä¸€çº§èŠ‚ç‚¹æŒ‡ç¤ºå™¨è·ç¦»å³è¾¹ç•Œè·ç¦» childIndicator æ„ä¹‰åŒgroupä¸­ç›¸åŒ childIndicatorLeft æ„ä¹‰åŒgroupä¸­ç›¸åŒ childIndicatorRight æ„ä¹‰åŒgroupä¸­ç›¸åŒ childDivider è®¾ç½®äºŒçº§èŠ‚ç‚¹çš„åˆ†å‰²æƒ³ï¼Œé¢œè‰²æˆ–è€…drawable indicatorStart åŒindicatorLeft indicatorEnd åŒindicatorRight childIndiatorStart åŒchildIndicatorLeft childIndicatorEnd åŒchildIndicatorRight ä¸»è¦çœ‹çœ‹åˆ†å‰²çº¿æ•ˆæœè®¾ç½®å›¾ç‰‡divider.xml 1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;solid android:color=\"@color/colorAccent\"/&gt; &lt;corners android:radius=\"3dp\"/&gt;&lt;/shape&gt; è®¾ç½®é¢œè‰²android:childDivider=â€@color/colorPrimaryâ€ é‚£ä¹ˆä¸€çº§èŠ‚ç‚¹å¦‚ä½•è®¾ç½®åˆ†å‰²çº¿?çœ‹è¿™ä¸ªä¾‹å­ 123android:childDivider=\"@color/colorPrimary\"android:divider=\"@drawable/divider\"android:dividerHeight=\"2dp\" ç»™ä¸€çº§èœå•å’ŒäºŒçº§èœå•è®¾ç½®ä¸åŒçš„åˆ†å‰²çº¿ï¼Œçœ‹ä¸‹æ•ˆæœ äºŒçº§èŠ‚ç‚¹ä¾ç„¶æ˜¾ç¤ºçš„æ—¶æˆ‘ä»¬è®¾ç½®çš„åˆ†å‰²çº¿ï¼Œä½†æ˜¯å½“ä¸€çº§èŠ‚ç‚¹å±•å¼€æ—¶ï¼Œå±•å¼€çš„èŠ‚ç‚¹çš„ä¸€çº§åˆ†å‰²çº¿å˜æˆäº†äºŒçº§èŠ‚ç‚¹çš„åˆ†å‰²çº¿æ ·å¼ï¼Œæ”¶èµ·åæ¢å¤æˆä¸€çº§èŠ‚ç‚¹çš„åˆ†å‰²çº¿æ ·å¼ã€‚ 3.2 å¸¸ç”¨æ–¹æ³• å…·ä½“å†…å®¹è¯·æŸ¥é˜…æºç ã€‚ 4. è®¾ç½®ä¸Šä¸‹æ–‡èœå•4.1 expandable_menu.xml123456789101112&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;menu xmlns:android=\"http://schemas.android.com/apk/res/android\" &gt; &lt;item android:id=\"@+id/menu_item1\" android:title=\"èœå•é¡¹1\"&gt; &lt;/item&gt; &lt;item android:id=\"@+id/menu_item2\" android:title=\"èœå•é¡¹2\"&gt; &lt;/item&gt;&lt;/menu&gt; 4.2 onCreateContextMenu123456@Overridepublic void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) { super.onCreateContextMenu(menu, v, menuInfo); menu.setHeaderTitle(\"expandable menu\"); getMenuInflater().inflate(R.menu.expandable_menu, menu);} 4.3 onContextItemSelected12345678910111213141516@Overridepublic boolean onContextItemSelected(MenuItem item) { // TODO Auto-generated method stub super.onContextItemSelected(item); switch (item.getItemId()) { case R.id.menu_item1: Toast.makeText(this, \"this is first menu item\", Toast.LENGTH_SHORT).show(); break; case R.id.menu_item2: Toast.makeText(this, \"this is second menu item\", Toast.LENGTH_SHORT).show(); break; default: break; } return super.onContextItemSelected(item);} 4.4 itemé•¿æŒ‰äº‹ä»¶æ˜¾ç¤ºèœå•å¹¶æ³¨å†Œä¸Šä¸‹æ–‡èœå•123456789101112expandableListView.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener() { @Override public boolean onItemLongClick(AdapterView&lt;?&gt; parent, View view, int position, long id) { if (ExpandableListView.getPackedPositionType(id) == ExpandableListView.PACKED_POSITION_TYPE_CHILD) { expandableListView.showContextMenu(); return true; } return false; }});registerForContextMenu(expandableListView); 5. å¤‡æ³¨ç¨‹åºæºç ","link":"/2017/08/27/ã€ŠAndroid åŸºç¡€ï¼ˆå››åä¸€ï¼‰ã€‹ ExpandableListView/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åä¸ƒï¼‰ã€‹FileProvider","text":"ç®€ä»‹FileProviderï¼Œæ˜¯ContentProviderçš„å­ç±»ï¼Œé€šè¿‡æ„å»ºä»¥â€content://â€œå¼€å¤´çš„Uriå–ä»£ä¹‹å‰ä»¥â€file://â€œå¼€å¤´çš„Uriï¼Œä»¥æ­¤å®ç°åº”ç”¨é—´çš„æ–‡ä»¶å…±äº«ã€‚ ç”±æ¥å®˜æ–‡Android7.0è¡Œä¸ºå˜æ›´è¯´æ˜ï¼š å¯¹äºé¢å‘ Android 7.0 çš„åº”ç”¨ï¼ŒAndroid æ¡†æ¶æ‰§è¡Œçš„ StrictMode API æ”¿ç­–ç¦æ­¢åœ¨åº”ç”¨å¤–éƒ¨å…¬å¼€ file:// URIã€‚å¦‚æœä¸€é¡¹åŒ…å«æ–‡ä»¶ URI çš„ intent ç¦»å¼€æ‚¨çš„åº”ç”¨ï¼Œåˆ™åº”ç”¨å‡ºç°æ•…éšœï¼Œå¹¶å‡ºç° FileUriExposedException å¼‚å¸¸ã€‚ è¦åœ¨åº”ç”¨é—´å…±äº«æ–‡ä»¶ï¼Œéœ€è¦æ”¹ç”¨content:// æ ¼å¼çš„URIï¼Œå¹¶æˆäºˆ URI ä¸´æ—¶è®¿é—®æƒé™ã€‚å®ç°æ­¤ç±»æ“ä½œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨FileProviderã€‚ ä½¿ç”¨æ–¹å¼å®šä¹‰FileProviderFileProvideræœ¬èº«å°±èƒ½æ ¹æ®fileç”Ÿæˆcontent:// Uriï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶æ²¡æœ‰å¿…è¦å»å†™ä¸€ä¸ªå•ç‹¬çš„FileProviderå­ç±»ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„ç»§æ‰¿FileProviderï¼Œä¿®æ”¹ç±»åæ¥å®ç°ä¸FileProvideråœ¨åå­—ä¸Šçš„åŒºåˆ†ï¼Œæ¯•ç«Ÿåœ¨AndroidManifest.xmlä¸­ï¼Œåå­—ç›¸åŒçš„provideræ˜¯ä¸è¢«å…è®¸çš„ã€‚ AndroidManifest.xmlä¸­ç”³æ˜FileProvider 12345678910111213141516&lt;manifest&gt; ... &lt;application&gt; ... &lt;provider android:name=\"android.support.v4.content.FileProvider\" android:authorities=\"${applicationId}.fileprovider\" android:exported=\"false\" android:grantUriPermissions=\"true\"&gt; &lt;meta-data android:name=\"android.support.FILE_PROVIDER_PATHS\" android:resource=\"@xml/file_paths\" /&gt; &lt;/provider&gt; ... &lt;/application&gt;&lt;/manifest&gt; æ˜ç¡®å¯ç”¨æ–‡ä»¶ä¸Šé¢æ˜ç¡®æ¥resourceæ–‡ä»¶ä¸ºâ€@xml/file_pathsâ€ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±åœ¨file_pathsä¸­æ˜ç¡®æˆ‘ä»¬çš„å¯ç”¨ä½ç½®ã€‚ FileProvideråªèƒ½ä¸ºä½ äº‹å…ˆæŒ‡å®šçš„ç›®å½•ä¸­çš„æ–‡ä»¶ç”Ÿæˆå†…å®¹URIã€‚ è¦æŒ‡å®šç›®å½•ï¼Œè¯·ä½¿ç”¨&lt; paths &gt;å…ƒç´ çš„å­å…ƒç´ æŒ‡å®šå…¶å­˜å‚¨åŒºåŸŸå’ŒXMLè·¯å¾„ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹è·¯å¾„å…ƒç´ å‘Šè¯‰FileProviderä½ æ‰“ç®—è¯·æ±‚ç§æœ‰æ–‡ä»¶ç›®å½•ä¸‹çš„images /å­ç›®å½•çš„å†…å®¹URI 1234&lt;paths xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;files-path name=\"my_images\" path=\"images/\"/&gt; ...&lt;/paths&gt; pathså…ƒç´  å¯¹åº”ç›®å½• &lt; root-path/&gt; â€œ/â€œ &lt; files-path name=â€nameâ€ path=â€pathâ€ /&gt; Context.getFilesDir() &lt; cache-path name=â€nameâ€ path=â€pathâ€ /&gt; Context.getCacheDir() &lt; external-path name=â€nameâ€ path=â€pathâ€ /&gt; Environment.getExternalStorageDirectory() &lt; external-files-path name=â€nameâ€ path=â€pathâ€ /&gt; Context#getExternalFilesDir(String) Context.getExternalFilesDir(null) &lt; external-cache-path name=â€nameâ€ path=â€pathâ€ /&gt; Context.getExternalCacheDir() &lt; external-media-path name=â€nameâ€ path=â€pathâ€ /&gt; Context.getExternalMediaDirs()(API21+) è¿™æ ·çœ‹å¯èƒ½ä¸å¤ªæ˜æ˜¾ï¼Œéšæ„æ–°å»ºä¸€ä¸ªAndroidå·¥ç¨‹ï¼Œæ‰“å°å¦‚ä¸Šå†…å®¹ï¼Œç¤ºä¾‹å·¥ç¨‹åŒ…åä¸ºcn.onlyloveyd.lazyshare ä¸ºFileç”ŸæˆContent Uri åˆ›å»ºéœ€è¦ç”¨Uriè¡¨ç¤ºçš„æ–‡ä»¶File ä½¿ç”¨getUriForFile()æ–¹æ³•è·å–å¯¹åº”çš„Uri. å®˜æ–¹ç¤ºä¾‹: 123File imagePath = new File(Context.getFilesDir(), \"images\");File newFile = new File(imagePath, \"default_image.jpg\");Uri contentUri = getUriForFile(getContext(), \"com.mydomain.fileprovider\", newFile); ç”Ÿæˆçš„Uriå°±æ˜¯ 1content://com.mydomain.fileprovider/my_images/default_image.jpg. ä¸´æ—¶æˆæƒUriç»™é€šè¿‡getUriForFile()æ–¹æ³•è¿”å›çš„Uriæˆæƒçš„æ­¥éª¤ï¼š è°ƒç”¨Context.grantUriPermission(package, Uri, mode_flags)ã€‚packageä¸ºåŒ…åï¼ŒUriä¸ºéœ€è¦ä¸´æ—¶æˆæƒçš„content Uriã€‚mode_flagså¯ä»¥ä¸ºFLAG_GRANT_READ_URI_PERMISSION, FLAG_GRANT_WRITE_URI_PERMISSIONï¼Œæ ¹æ®éœ€æ±‚è€Œå®šã€‚é€šè¿‡revokeUriPermission() æˆ–è€…é‡å¯å–æ¶ˆæˆæƒã€‚ Intentä¸­setDataæ–¹æ³•è®¾ç½®Uri Intent setFlagsæ–¹æ³•è®¾ç½®FLAG_GRANT_READ_URI_PERMISSION æˆ–è€…FLAG_GRANT_WRITE_URI_PERMISSIONã€‚ å‘é€Intentåˆ°å¦ä¸€ä¸ªApp ä¼ é€’Uriåˆ°å¦ä¸€ä¸ªåº”ç”¨å°†content:\\ Uriæä¾›ç»™å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„æ–¹å¼å¾ˆå¤šã€‚ ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨startActivityResult()æ¥å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œå‘é€ä¸€ä¸ªIntentä»¥å¯åŠ¨ä¸€ä¸ªActivityï¼Œç„¶åé€šè¿‡setResult() çš„æ–¹å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ å¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡è°ƒç”¨Intent.setClipData()æ–¹æ³•å°†content:\\ Uriæ”¾å…¥ClipDataå¯¹è±¡ä¸­ï¼Œç„¶åå°†è¯¥å¯¹è±¡æ·»åŠ åˆ°å‘é€ç»™å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„Intentä¸­å³å¯ã€‚ æºç çœ‹çœ‹ç±»ç»“æ„ SimplePathStrategy123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100static class SimplePathStrategy implements PathStrategy { private final String mAuthority; private final HashMap&lt;String, File&gt; mRoots = new HashMap&lt;String, File&gt;(); SimplePathStrategy(String authority) { mAuthority = authority; } /** * Add a mapping from a name to a filesystem root. The provider only offers * access to files that live under configured roots. */ //è¯»å–xmlé…ç½®æ–‡ä»¶ï¼Œå»ºç«‹åç§°å’Œç›®å½•çš„æ˜ å°„è¡¨ void addRoot(String name, File root) { //åå­—ä¸èƒ½ä¸ºç©º if (TextUtils.isEmpty(name)) { throw new IllegalArgumentException(\"Name must not be empty\"); } try { // Resolve to canonical path to keep path checking fast root = root.getCanonicalFile(); } catch (IOException e) { throw new IllegalArgumentException( \"Failed to resolve canonical path for \" + root, e); } mRoots.put(name, root); } @Override public Uri getUriForFile(File file) { String path; try { //è·å–è·¯å¾„ path = file.getCanonicalPath(); } catch (IOException e) { throw new IllegalArgumentException(\"Failed to resolve canonical path for \" + file); } // Find the most-specific root path Map.Entry&lt;String, File&gt; mostSpecific = null; //éå†æŸ¥æ‰¾æ–‡ä»¶è·¯å¾„å¯¹åº”çš„åç§° for (Map.Entry&lt;String, File&gt; root : mRoots.entrySet()) { final String rootPath = root.getValue().getPath(); if (path.startsWith(rootPath) &amp;&amp; (mostSpecific == null || rootPath.length() &gt; mostSpecific.getValue().getPath().length())) { mostSpecific = root; } } //æŸ¥è¯¢æœªæœï¼Œè¯´æ˜åœ¨xmlä¸­æœªå®šä¹‰ if (mostSpecific == null) { throw new IllegalArgumentException( \"Failed to find configured root that contains \" + path); } // Start at first char of path under root final String rootPath = mostSpecific.getValue().getPath(); if (rootPath.endsWith(\"/\")) { path = path.substring(rootPath.length()); } else { path = path.substring(rootPath.length() + 1); } // Encode the tag and path separately path = Uri.encode(mostSpecific.getKey()) + '/' + Uri.encode(path, \"/\"); //æ„å»ºcontent Uri,è¿™å°±æ˜¯æœ€åæˆ‘ä»¬æ‹¿åˆ°çš„å†…å®¹ return new Uri.Builder().scheme(\"content\") .authority(mAuthority).encodedPath(path).build(); } @Override public File getFileForUri(Uri uri) { String path = uri.getEncodedPath(); //é€šè¿‡uriåå‘å¯»æ‰¾ï¼Œå’Œä¸Šé¢çš„åŸç†å·®ä¸å¤šï¼Œä¸èµ˜è¿° final int splitIndex = path.indexOf('/', 1); final String tag = Uri.decode(path.substring(1, splitIndex)); path = Uri.decode(path.substring(splitIndex + 1)); final File root = mRoots.get(tag); if (root == null) { throw new IllegalArgumentException(\"Unable to find configured root for \" + uri); } File file = new File(root, path); try { file = file.getCanonicalFile(); } catch (IOException e) { throw new IllegalArgumentException(\"Failed to resolve canonical path for \" + file); } if (!file.getPath().startsWith(root.getPath())) { throw new SecurityException(\"Resolved path jumped beyond configured root\"); } return file; }} parsePathStrategy1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465private static PathStrategy parsePathStrategy(Context context, String authority) throws IOException, XmlPullParserException { final SimplePathStrategy strat = new SimplePathStrategy(authority); //è·å–Providerä¿¡æ¯ final ProviderInfo info = context.getPackageManager() .resolveContentProvider(authority, PackageManager.GET_META_DATA); // è·å–\"android.support.FILE_PROVIDER_PATHS\"å¯¹åº”çš„xmlæ–‡ä»¶è§£æå¯¹å¸çº³ä¸ª; final XmlResourceParser in = info.loadXmlMetaData( context.getPackageManager(), META_DATA_FILE_PROVIDER_PATHS); if (in == null) { throw new IllegalArgumentException( \"Missing \" + META_DATA_FILE_PROVIDER_PATHS + \" meta-data\"); } int type; while ((type = in.next()) != END_DOCUMENT) { if (type == START_TAG) { final String tag = in.getName(); final String name = in.getAttributeValue(null, ATTR_NAME); String path = in.getAttributeValue(null, ATTR_PATH); File target = null; //\"root-path\" if (TAG_ROOT_PATH.equals(tag)) { target = DEVICE_ROOT; //\"files-path\" } else if (TAG_FILES_PATH.equals(tag)) { target = context.getFilesDir(); //\"cache-path\" } else if (TAG_CACHE_PATH.equals(tag)) { target = context.getCacheDir(); //\"external-path\" } else if (TAG_EXTERNAL.equals(tag)) { target = Environment.getExternalStorageDirectory(); //\"external-files-path\" } else if (TAG_EXTERNAL_FILES.equals(tag)) { File[] externalFilesDirs = ContextCompat.getExternalFilesDirs(context, null); if (externalFilesDirs.length &gt; 0) { //å–æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ª target = externalFilesDirs[0]; } // \"external-cache-path\" } else if (TAG_EXTERNAL_CACHE.equals(tag)) { File[] externalCacheDirs = ContextCompat.getExternalCacheDirs(context); if (externalCacheDirs.length &gt; 0) { target = externalCacheDirs[0]; } // \"external-media-path\" Lç‰ˆæœ¬ä»¥ä¸Šæ‰æœ‰ } else if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP &amp;&amp; TAG_EXTERNAL_MEDIA.equals(tag)) { File[] externalMediaDirs = context.getExternalMediaDirs(); if (externalMediaDirs.length &gt; 0) { target = externalMediaDirs[0]; } } if (target != null) { strat.addRoot(name, buildPath(target, path)); } } } return strat; } ä»ä¸Šé¢è¿™ä¸ªæ–¹æ³•å¯ä»¥å¾ˆç›´è§‚çš„äº†è§£åˆ°åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­å®šä¹‰providerä»¥åŠå¯¹åº”çš„å…±äº«æ–‡ä»¶è·¯å¾„å®šä¹‰xmlçš„è§£æè¿‡ç¨‹ã€‚ä»¥åŠxmlä¸­tagä¸çœŸå®æ–‡ä»¶è·¯å¾„çš„å¯¹åº”å…³ç³»ã€‚ ä½¿ç”¨åœºæ™¯æ‹ç…§12345678910111213141516171819202122232425262728Intent takePictureIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE); if (takePictureIntent.resolveActivity(getPackageManager()) != null) { String filename = new SimpleDateFormat(\"yyyyMMdd-HHmmss\", Locale.CHINA) .format(new Date()) + \".png\"; File file = new File(Environment.getExternalStorageDirectory(), filename); mCurrentPhotoPath = file.getAbsolutePath(); Uri fileUri; if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) { fileUri = getUriForFile(context, context.getPackageName() +\".fileprovider\", file); } else { fileUri = Uri.fromFile(file); } takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri); startActivityForResult(takePictureIntent, REQUEST_CODE_TAKE_PHOTO); }â€¦â€¦@Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { super.onActivityResult(requestCode, resultCode, data); if (resultCode == RESULT_OK &amp;&amp; requestCode == REQUEST_CODE_TAKE_PHOTO) { mIvPhoto.setImageBitmap(BitmapFactory.decodeFile(mCurrentPhotoPath)); } // else tip? } åº”ç”¨å®‰è£…1234567891011121314// éœ€è¦è‡ªå·±ä¿®æ”¹å®‰è£…åŒ…è·¯å¾„File file = new File(Environment.getExternalStorageDirectory(), \"/onlyloveyd/base.apk\");Intent intent = new Intent(Intent.ACTION_VIEW);intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) { intent.setDataAndType(getUriForFile(context, file), \"application/vnd.android.package-archive\"); intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); intent.addFlags(Intent.FLAG_GRANT_WRITE_URI_PERMISSION);} else { intent.setDataAndType(Uri.fromFile(file), \"application/vnd.android.package-archive\");}startActivity(intent);","link":"/2018/06/30/ã€ŠAndroid åŸºç¡€ï¼ˆå››åä¸ƒï¼‰ã€‹FileProvider/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åäº”ï¼‰ã€‹ RecyclerView.ItemDecorationæºç æµ…æ","text":"å‰è¨€RecyclerViewç›®å‰æ¥è¯´ï¼Œæ˜¯æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨æœ€å¤šçš„æ§ä»¶ï¼ŒåŠŸèƒ½å¼ºå¤§è€Œä¸”å¤æ‚ã€‚è€ŒItem Decorationä½œä¸ºRecyclerViewå¼€å‘è¿‡ç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ï¼Œéœ€è¦æ·±å…¥çš„äº†è§£ä¸€ä¸‹ã€‚ æºç åˆ†æ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/** * An ItemDecoration allows the application to add a special drawing and layout offset * to specific item views from the adapter's data set. This can be useful for drawing dividers * between items, highlights, visual grouping boundaries and more. * * &lt;p&gt;All ItemDecorations are drawn in the order they were added, before the item * views (in {@link ItemDecoration#onDraw(Canvas, RecyclerView, RecyclerView.State) onDraw()} * and after the items (in {@link ItemDecoration#onDrawOver(Canvas, RecyclerView, * RecyclerView.State)}.&lt;/p&gt; */public abstract static class ItemDecoration { /** * Draw any appropriate decorations into the Canvas supplied to the RecyclerView. * Any content drawn by this method will be drawn before the item views are drawn, * and will thus appear underneath the views. * * @param c Canvas to draw into * @param parent RecyclerView this ItemDecoration is drawing into * @param state The current state of RecyclerView */ public void onDraw(Canvas c, RecyclerView parent, State state) { onDraw(c, parent); } /** * @deprecated * Override {@link #onDraw(Canvas, RecyclerView, RecyclerView.State)} */ @Deprecated public void onDraw(Canvas c, RecyclerView parent) { } /** * Draw any appropriate decorations into the Canvas supplied to the RecyclerView. * Any content drawn by this method will be drawn after the item views are drawn * and will thus appear over the views. * * @param c Canvas to draw into * @param parent RecyclerView this ItemDecoration is drawing into * @param state The current state of RecyclerView. */ public void onDrawOver(Canvas c, RecyclerView parent, State state) { onDrawOver(c, parent); } /** * @deprecated * Override {@link #onDrawOver(Canvas, RecyclerView, RecyclerView.State)} */ @Deprecated public void onDrawOver(Canvas c, RecyclerView parent) { } /** * @deprecated * Use {@link #getItemOffsets(Rect, View, RecyclerView, State)} */ @Deprecated public void getItemOffsets(Rect outRect, int itemPosition, RecyclerView parent) { outRect.set(0, 0, 0, 0); } /** * Retrieve any offsets for the given item. Each field of &lt;code&gt;outRect&lt;/code&gt; specifies * the number of pixels that the item view should be inset by, similar to padding or margin. * The default implementation sets the bounds of outRect to 0 and returns. * * &lt;p&gt; * If this ItemDecoration does not affect the positioning of item views, it should set * all four fields of &lt;code&gt;outRect&lt;/code&gt; (left, top, right, bottom) to zero * before returning. * * &lt;p&gt; * If you need to access Adapter for additional data, you can call * {@link RecyclerView#getChildAdapterPosition(View)} to get the adapter position of the * View. * * @param outRect Rect to receive the output. * @param view The child view to decorate * @param parent RecyclerView this ItemDecoration is decorating * @param state The current state of RecyclerView. */ public void getItemOffsets(Rect outRect, View view, RecyclerView parent, State state) { getItemOffsets(outRect, ((LayoutParams) view.getLayoutParams()).getViewLayoutPosition(), parent); }} æ³¨æ„çœ‹è‹±æ–‡æ³¨é‡Šï¼ŒItemDecorationæ˜¯ç”¨äºè£…é¥°RecyclerViewçš„Itemçš„ï¼Œä¸»è¦å…³æ³¨å¦‚ä¸‹ä¸‰ä¸ªæ–¹æ³• getItemOffsets å‚æ•° æ„ä¹‰ outRect ItemViewçš„å¤–å›´çŸ©å½¢ view ItemView parent RecyclerView,ItemViewçš„Parent state RecyclerViewçš„çŠ¶æ€ ç›´æ¥è¿™æ ·å­è¯´çœ‹ä¸å‡ºæ•ˆæœï¼Œä¸Šå‡ å¼ å›¾åŒºåˆ†ä¸€ä¸‹ 12345outRect.top =20;outRect.bottom =20;outRect.left=60;outRect.right =60; 12345outRect.top =20;outRect.bottom =20;outRect.left=60;outRect.right =0; 12345outRect.top =60;outRect.bottom =60;outRect.left=20;outRect.right =20; çœ‹ä¸Šå»è®¾ç½®outRectè®¾ç½®top,left,right,bottomæœ‰ä¸€ç§paddingçš„æ•ˆæœï¼Œä½†æ˜¯å®é™…ä¸Šåªæ˜¯å®ƒæ˜¯ItemViewå¤–å›´çš„ç©ºé—´ï¼Œä½ å¯ä»¥å°†å…¶ç†è§£æˆRecyclerViewé’ˆå¯¹æ¯ä¸ªItemViewè®¾ç½®çš„Paddingï¼Œè€Œä¸æ˜¯ItemViewè‡ªèº«çš„paddingã€‚ onDraw å‚æ•° æ„ä¹‰ c RecyclerViewçš„Canvas parent RecyclerView,ItemViewçš„Parent state RecyclerViewçš„çŠ¶æ€ onDrawæ“ä½œæ˜¯åœ¨RecyclerViewæ‰€åœ¨çš„ç”»å¸ƒä¸Šç»˜åˆ¶å†…å®¹ï¼Œä¹Ÿå°±æ˜¯åœ¨ItemViewçš„èƒŒåç»˜åˆ¶å†…å®¹ï¼Œé‡å éƒ¨åˆ†ä¼šè¢«ItemViewé®æŒ¡ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨Item Viewçš„èƒŒåç”»ä¸€ä¸ªåœ†åœˆåœˆã€‚ 12345678910111213141516171819public YdDividerItemDecoration(){ mPaint = new Paint(); mPaint.setColor(Color.GREEN); mPaint.setAntiAlias(true);}@Overridepublic void onDraw(Canvas c, RecyclerView parent, RecyclerView.State state) { super.onDraw(c, parent, state); Logger.d(\"yidong -- onDraw\"); int width = parent.getWidth(); int height = parent.getHeight(); int radius = Math.min(width, height)/2; c.drawCircle(width/2, height/2, radius, mPaint);} è¿™ä¸ªæ˜¯ä¸ºäº†è¯´æ˜ï¼Œæˆ‘ä»¬æ“ä½œçš„ç”»å¸ƒæ˜¯RecyclerViewçš„ç”»å¸ƒï¼Œè€Œä¸æ˜¯é’ˆå¯¹ItemViewï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æ¯ä¸ªItemViewåšæ“ä½œï¼Œæ¯”å¦‚ç”»åˆ†å‰²çº¿ï¼Œå®˜æ–¹ç»™å‡ºçš„DividerItemDecorationçš„onDrawæ–¹æ³• 123456789101112@Overridepublic void onDraw(Canvas c, RecyclerView parent, RecyclerView.State state) { if (parent.getLayoutManager() == null || mDivider == null) { return; } if (mOrientation == VERTICAL) { drawVertical(c, parent); } else { drawHorizontal(c, parent); }} 1234567891011121314151617181920212223242526private void drawVertical(Canvas canvas, RecyclerView parent) { canvas.save(); final int left; final int right; //noinspection AndroidLintNewApi - NewApi lint fails to handle overrides. if (parent.getClipToPadding()) { left = parent.getPaddingLeft(); right = parent.getWidth() - parent.getPaddingRight(); canvas.clipRect(left, parent.getPaddingTop(), right, parent.getHeight() - parent.getPaddingBottom()); } else { left = 0; right = parent.getWidth(); } final int childCount = parent.getChildCount(); for (int i = 0; i &lt; childCount; i++) { final View child = parent.getChildAt(i); parent.getDecoratedBoundsWithMargins(child, mBounds); final int bottom = mBounds.bottom + Math.round(child.getTranslationY()); final int top = bottom - mDivider.getIntrinsicHeight(); mDivider.setBounds(left, top, right, bottom); mDivider.draw(canvas); } canvas.restore(); } å¯ä»¥çœ‹å‡ºéƒ½æ˜¯ä¾¿åˆ©RecyclerViewçš„Itemæ¥åšæ“ä½œçš„ã€‚ onDrawOver å‚æ•° æ„ä¹‰ c RecyclerViewçš„Canvas parent RecyclerView,ItemViewçš„Parent state RecyclerViewçš„çŠ¶æ€ å‚æ•°ç±»å‹å’Œæ„ä¹‰å’ŒonDrawä¸€æ¨¡ä¸€æ ·ï¼Œä½†æ˜¯æ•ˆæœç¡®å®åœ¨RecyclerViewçš„ItemViewä¹‹ä¸Šã€‚ è¿˜æ˜¯æ¢ä¸ªåœ†åœˆåœˆï¼Œä»£ç å’Œä¸Šé¢ä¸€æ ·ï¼Œåªæ˜¯ç§»åŠ¨åˆ°onDrawOveræ–¹æ³•ä¸‹æ‰§è¡Œã€‚ å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„åœ†åœˆåœˆè¦†ç›–äº†ItemViewã€‚è‡³äºè°è¦†ç›–è°ï¼Œæ˜¾ç„¶æ˜¯ç»˜åˆ¶é¡ºåºçš„é—®é¢˜ã€‚ å¯ä»¥çœ‹åˆ°æ‰§è¡Œé¡ºåºï¼ŒonDrawOveræ˜¯åœ¨onDrawä¹‹åçš„ï¼Œä½†æ˜¯ItemViewçš„ç»˜åˆ¶æ˜¯å¦åœ¨è¿™ä¸ªä¸¤ä¸ªæ“ä½œä¹‹å‰ï¼Œä»æœ€åçš„æ•ˆæœæ¥çœ‹ï¼Œæ˜¯çš„ï¼Œä½†æ˜¯éœ€è¦ä»£ç è¯å®ã€‚ç›´æ¥çœ‹RecyclerViewç»˜åˆ¶ç›¸å…³çš„æ–¹æ³•å³å¯ã€‚ 12345678910111213@Overridepublic void draw(Canvas c) { //è¿™é‡Œæ˜¯RecyclerViewçš„ç»˜åˆ¶è¿‡ç¨‹ï¼Œå’ŒViewçš„ç»˜åˆ¶è¿‡ç¨‹ç±»ä¼¼ï¼Œå…ˆæ˜¯èƒŒæ™¯ï¼Œç„¶åæ˜¯è°ƒç”¨ //recyclerviewçš„onDrawæ–¹æ³•ç»˜åˆ¶è‡ªèº«ï¼Œç„¶åé€šè¿‡dispatchDrawæ¥ç»˜åˆ¶å­View // è€ŒonDraw(ä¸‹é¢)æ‰§è¡Œçš„å°±æ˜¯ItemDecorationçš„onDrawæ–¹æ³•ï¼Œæ‰€ä»¥é¡ºåºå¾ˆæ˜æ˜¾äº†ã€‚ //ItemDecorationï¼&gt; ItemView -&gt; ItemDecoration.onDrawOver super.draw(c); // æ‰§è¡ŒItemDecoration onDrawOveræ–¹æ³•ï¼Œæœ€é¡¶å±‚ final int count = mItemDecorations.size(); for (int i = 0; i &lt; count; i++) { mItemDecorations.get(i).onDrawOver(c, this, mState); } â€¦â€¦ 12345678910@Overridepublic void onDraw(Canvas c) { super.onDraw(c); // æ‰§è¡ŒItemDecorationçš„onDrawæ–¹æ³•ï¼Œæœ€åº•å±‚ final int count = mItemDecorations.size(); for (int i = 0; i &lt; count; i++) { mItemDecorations.get(i).onDraw(c, this, mState); }} æ€»ç»“çœ‹æ¸…æ¥šäº†ItemDecorationçš„å®ç°åŸç†ï¼Œå…·ä½“é€šè¿‡ä»€ä¹ˆæ–¹å¼ç»˜åˆ¶å‡ºä»€ä¹ˆæ ·çš„å›¾å½¢ï¼Œè¯¥åªæ˜¯è®¾è®¡å’Œæ—¶é—´çš„é—®é¢˜ï¼ŒGithubä¸Šæœ‰ä¸é”™çš„ä¸€äº›å®ç°ï¼Œå¤§å®¶æœ‰ç©ºå¯ä»¥å»å­¦ä¹ å€Ÿé‰´ä¸‹ã€‚","link":"/2018/04/09/ã€ŠAndroid åŸºç¡€ï¼ˆå››åäº”ï¼‰ã€‹ RecyclerView.ItemDecorationæºç æµ…æ/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åä¸‰ï¼‰ã€‹ SnapHelper","text":"1. ç®€ä»‹å…ˆçœ‹çœ‹è‹±æ–‡ä»‹ç» 1234567/** * Class intended to support snapping for a {@link RecyclerView}. * &lt;p&gt; * SnapHelper tries to handle fling as well but for this to work properly, the * {@link RecyclerView.LayoutManager} must implement the {@link ScrollVectorProvider} interface or * you should override {@link #onFling(int, int)} and handle fling manually. */ å¯ä»¥çœ‹å‡ºSnapHelperæ˜¯å¯¹RecyclerViewçš„ä¸€ç§æ‹“å±•åŠŸèƒ½ï¼Œæ”¯æŒsnappingã€‚SnapHelperé€šè¿‡å¤„ç†RecyclerViewçš„flingï¼Œæ¥è¾¾åˆ°è¦å±•ç¤ºçš„æ•ˆæœï¼Œä½†æ˜¯è¿™éœ€è¦ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯RecyclerViewçš„LayoutManagerå¿…é¡»å®ç°ScrollVectorProvideræ¥å£æˆ–è€…æ‰‹åŠ¨å®ç°onFlingæ¥å£ï¼Œè‡ªå·±å®ç°flingå¤„ç†ã€‚ SnapHelperçš„å®ç°åŸç†æ˜¯ç›‘å¬RecyclerView.OnFlingListenerä¸­çš„onFlingæ¥å£ã€‚LinearSnapHelper&amp;PagerSnapHelperæ˜¯æŠ½è±¡ç±»SnapHelperçš„å…·ä½“å®ç°ã€‚åŒºåˆ«åœ¨äºï¼šLinerSnapHelperï¼Œå¯æ»‘åŠ¨å¤šé¡µï¼Œå±…ä¸­æ˜¾ç¤ºï¼›PagerSnapHelperï¼Œæ¯æ¬¡åªèƒ½æ»‘åŠ¨ä¸€é¡µï¼Œå±…ä¸­æ˜¾ç¤ºï¼› 2. åŸºæœ¬å®ç°2.1 æ¨ªå‘LinearSnapHelper1234567LinearLayoutManager llm = new LinearLayoutManager(this, LinearLayoutManager.HORIZONTAL, false);CardAdapter cardAdapter = new CardAdapter(this);LinearSnapHelper linearSnapHelper = new LinearSnapHelper();mRvContent.setLayoutManager(llm);mRvContent.setAdapter(cardAdapter);linearSnapHelper.attachToRecyclerView(mRvContent); 2.2 çºµå‘LinearSnapHelper1234567LinearLayoutManager llm = new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false);CardAdapter cardAdapter = new CardAdapter(this);LinearSnapHelper linearSnapHelper = new LinearSnapHelper();mRvContent.setLayoutManager(llm);mRvContent.setAdapter(cardAdapter);linearSnapHelper.attachToRecyclerView(mRvContent); 2.3 PagerSnapHelper(ä»¥æ¨ªå‘ä¸ºä¾‹)1234567LinearLayoutManager llm = new LinearLayoutManager(this, LinearLayoutManager.HORIZONTAL, false);CardAdapter cardAdapter = new CardAdapter(this);PagerSnapHelper pagerSnapHelper = new PagerSnapHelper();mRvContent.setLayoutManager(llm);mRvContent.setAdapter(cardAdapter);pagerSnapHelper.attachToRecyclerView(mRvContent); ä¸€èˆ¬æ­¥éª¤ï¼š åˆ›å»ºSnapHelperï¼› attachToRecyclerViewã€‚ 3. æºç åˆ†æSnapHelperæºç ç»“æ„ï¼š SnapHelperæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ— æ„é€ æ–¹æ³•ã€‚å…¶ä¸­æœ‰ä¸‰ä¸ªæŠ½è±¡æ–¹æ³•æ˜¯éœ€è¦å­ç±»å»å®ç°çš„ æ–¹æ³•å æè¿° calculateDistanceToFinalSnap è®¡ç®—ç¬¬äºŒä¸ªå‚æ•°å¯¹åº”çš„ItemViewå½“å‰çš„åæ ‡ä¸éœ€è¦å¯¹é½çš„åæ ‡ä¹‹é—´çš„è·ç¦»ã€‚è¿”å›ä¸€ä¸ªint[2]æ•°ç»„ï¼Œåˆ†åˆ«å¯¹åº”xè½´å’Œyè½´æ–¹å‘ä¸Šçš„è·ç¦» findSnapView æ‰¾åˆ°æœ€æ¥è¿‘å¯¹é½ä½ç½®çš„viewï¼Œè¯¥viewç§°ä¸ºSanpViewï¼Œå¯¹åº”çš„positionç§°ä¸ºSnapPositionã€‚å¦‚æœè¿”å›nullï¼Œå°±è¡¨ç¤ºæ²¡æœ‰éœ€è¦å¯¹é½çš„Viewï¼Œä¹Ÿå°±ä¸ä¼šåšæ»šåŠ¨å¯¹é½è°ƒæ•´ findTargetSnapPosition æ ¹æ®Flingæ“ä½œçš„é€Ÿç‡ï¼ˆå‚æ•°velocityXå’Œå‚æ•°velocityYï¼‰æ‰¾åˆ°éœ€è¦æ»šåŠ¨åˆ°çš„targetSnapPositionï¼Œè¯¥ä½ç½®å¯¹åº”çš„Viewå°±æ˜¯targetSnapViewã€‚å¦‚æœæ‰¾ä¸åˆ°targetSnapPositionï¼Œå°±è¿”å›RecyclerView.NO_POSITION 3.1 attachToRecyclerView12345678910111213141516public void attachToRecyclerView(@Nullable RecyclerView recyclerView) throws IllegalStateException { if (mRecyclerView == recyclerView) { return; // nothing to do } if (mRecyclerView != null) { destroyCallbacks(); } mRecyclerView = recyclerView; if (mRecyclerView != null) { setupCallbacks(); mGravityScroller = new Scroller(mRecyclerView.getContext(), new DecelerateInterpolator()); snapToTargetExistingView(); }} 1.åˆ¤æ–­ç»‘å®šçš„RecyclerView å’Œä¹‹å‰çš„æ˜¯å¦ç›¸åŒï¼Œä¸é‡å¤ç»‘å®šï¼› 2.å¦‚æœä¼ å…¥çš„RecyclerViewä¸ä¸ºç©ºï¼Œåˆ™æ‰§è¡ŒdestoryCallbacks(), ç§»é™¤æ»šåŠ¨ç›‘å¬å’ŒonFlingListener 1234private void destroyCallbacks() { mRecyclerView.removeOnScrollListener(mScrollListener); mRecyclerView.setOnFlingListener(null); } 3.èµ‹å€¼æˆå‘˜å˜é‡mRecyclerView 4.setupCallbacks()å’ŒdestoryCallbacks()å¯¹åº” 12345678private void setupCallbacks() throws IllegalStateException { //å¦‚æœonFlingListenerå·²ç»è®¾ç½®è¿‡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ if (mRecyclerView.getOnFlingListener() != null) { throw new IllegalStateException(\"An instance of OnFlingListener already set.\"); } mRecyclerView.addOnScrollListener(mScrollListener); mRecyclerView.setOnFlingListener(this); } 5.åˆ›å»ºmGravityScroller 6.snapToTargetExistingView() è¿™ä¸ªæ–¹æ³•åœ¨è¿™é‡Œè°ƒç”¨ä¸€æ¬¡ï¼Œå…¶å®æ›´å…³é”®çš„è°ƒç”¨åœ°æ–¹æ˜¯åœ¨OnScrollListenerä¸­ 12345678910111213141516171819202122// Handles the snap on scroll case.private final RecyclerView.OnScrollListener mScrollListener = new RecyclerView.OnScrollListener() { boolean mScrolled = false; @Override public void onScrollStateChanged(RecyclerView recyclerView, int newState) { super.onScrollStateChanged(recyclerView, newState); if (newState == RecyclerView.SCROLL_STATE_IDLE &amp;&amp; mScrolled) { mScrolled = false; //å½“æ»‘åŠ¨çŠ¶æ€ä¸ºidleçŠ¶æ€æ—¶å¹¶ä¸”åˆšç»“æŸæ»šåŠ¨ snapToTargetExistingView(); } } @Override public void onScrolled(RecyclerView recyclerView, int dx, int dy) { if (dx != 0 || dy != 0) { mScrolled = true; } } }; 12345678910111213141516171819void snapToTargetExistingView() { if (mRecyclerView == null) { return; } LayoutManager layoutManager = mRecyclerView.getLayoutManager(); if (layoutManager == null) { return; } //æ‰¾åˆ°SnapView View snapView = findSnapView(layoutManager); if (snapView == null) { return; } //è®¡ç®—åç§»é‡ç„¶åå¹³æ»‘çš„æ»‘åŠ¨è¿‡å» int[] snapDistance = calculateDistanceToFinalSnap(layoutManager, snapView); if (snapDistance[0] != 0 || snapDistance[1] != 0) { mRecyclerView.smoothScrollBy(snapDistance[0], snapDistance[1]); }} 3.2 onFlingFlingæ“ä½œï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨RecyclerViewåæ¾æ‰‹ï¼ŒRecyclerViewä¸­çš„å†…å®¹ä¼šé ç€æƒ¯æ€§ç»§ç»­å¾€ä¹‹å‰æ»‘åŠ¨çš„æ–¹å‘ç»§ç»­æ»šåŠ¨ç›´åˆ°åœæ­¢ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšFlingã€‚Flingæ“ä½œä»æ‰‹æŒ‡ç¦»å¼€å±å¹•ç¬é—´è¢«è§¦å‘ï¼Œåœ¨æ»šåŠ¨åœæ­¢æ—¶ç»“æŸã€‚ åˆšæ‰åœ¨setupCallbacks()ä¸­è®¾ç½®çš„onFlingerListener 123456789101112131415public boolean onFling(int velocityX, int velocityY) { LayoutManager layoutManager = mRecyclerView.getLayoutManager(); if (layoutManager == null) { return false; } RecyclerView.Adapter adapter = mRecyclerView.getAdapter(); if (adapter == null) { return false; } //è·å–è§¦å‘flingçš„æœ€å°é€Ÿåº¦ int minFlingVelocity = mRecyclerView.getMinFlingVelocity(); //æ¨ªå‘æˆ–è€…çºµå‘å¿…é¡»æœ‰ä¸€ä¸ªæ»‘åŠ¨é€Ÿåº¦å¯ä»¥è§¦å‘flingï¼ŒsnapFromFlingå’Œä¸Šé¢æ»šåŠ¨ç›‘å¬å™¨ä¸­çš„å®ç°æ€è·¯ç±»ä¼¼ return (Math.abs(velocityY) &gt; minFlingVelocity || Math.abs(velocityX) &gt; minFlingVelocity) &amp;&amp; snapFromFling(layoutManager, velocityX, velocityY);} 123456789101112131415161718192021222324private boolean snapFromFling(@NonNull LayoutManager layoutManager, int velocityX, int velocityY) { //è¿™å°±æ˜¯ä¸ºä½•å‰æ–‡ä¸­æåˆ°éœ€è¦å®ç°ScrollVectorProviderå¦åˆ™æ—§å¾—è‡ªå·±å®ç°onFlingæ¥å£ if (!(layoutManager instanceof ScrollVectorProvider)) { return false; } //åˆ›å»ºscroller RecyclerView.SmoothScroller smoothScroller = createSnapScroller(layoutManager); if (smoothScroller == null) { return false; } //æ‰¾åˆ°ç›®æ ‡snapä½ç½® int targetPosition = findTargetSnapPosition(layoutManager, velocityX, velocityY); if (targetPosition == RecyclerView.NO_POSITION) { return false; } //å¹³æ»‘çš„æ»šåŠ¨è¿‡å» smoothScroller.setTargetPosition(targetPosition); layoutManager.startSmoothScroll(smoothScroller); return true;} æœ‰å…´è¶£çš„ç›†å‹å¯ä»¥å»æŸ¥é˜…ä¸‹LinearSnapHelperå’ŒPagerSnapHelperçš„æºç ã€‚æ¨èæºç é˜…è¯»ç½‘ç«™androidxref.com 4. æºç RecyclerViewGallery 5. æ¨èå¼€æºåº“RecyclerViewSnap","link":"/2017/09/16/ã€ŠAndroid åŸºç¡€ï¼ˆå››åä¸‰ï¼‰ã€‹ SnapHelper/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åå››ï¼‰ã€‹ Viewäº‹ä»¶åˆ†å‘æœºåˆ¶","text":"1. å‰è¨€Viewçš„äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼ŒæŒ‡çš„æ—¶å½“ä¸€ä¸ªç‚¹å‡»äº‹ä»¶æˆ–è€…ä¸€ä¸ªè§¦æ‘¸äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒAndroidç³»ç»Ÿå¦‚ä½•è®²è¿™ä¸ªäº‹ä»¶è¿›è¡Œå¤„ç†ï¼Œâ€œåˆ†å‘â€œè¡¨ç¤ºè¿™é‡Œå­˜åœ¨ä¸Šä¸‹çº§å…³ç³»ï¼Œå°±å¦‚åŒéƒ¨é—¨ç»ç†åˆ†å‘ä»»åŠ¡ä¸€æ ·ï¼Œè¿™å°±æ¶‰åŠåˆ°ä»»åŠ¡ä»ä½•è€Œæ¥ï¼Œåˆ†å‘åˆ°è°æ‰‹ä¸Šï¼Œæ˜¯å¦ç»§ç»­åˆ†å‘æˆ–è€…è¿”å›ä¸Šçº§ï¼Œç›´åˆ°æœ€ç»ˆç¡®å®šä»»åŠ¡è°æ¥å¤„ç†ï¼Œå¦‚ä½•å¤„ç†ã€‚ 2. å°æµ‹è¯•å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•Demoï¼Œçœ‹çœ‹è¿è¡Œè¿‡ç¨‹ 2.1 ChildViewChildViewç»§æ‰¿AppCompatButton,ç„¶åæ·»åŠ ä¸€äº›log 1234567891011121314151617181920212223242526public class ChildView extends android.support.v7.widget.AppCompatButton { public ChildView(Context context) { super(context); } public ChildView(Context context, @Nullable AttributeSet attrs) { super(context, attrs); } public ChildView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); } @Override public boolean onTouchEvent(MotionEvent event) { System.err.println(\"yidong -- ChildView onTouchEvent event = \" + event.getAction()); return super.onTouchEvent(event); } @Override public boolean dispatchTouchEvent(MotionEvent event) { System.err.println(\"yidong -- ChildView dispatchTouchEvent event = \" + event.getAction()); return super.dispatchTouchEvent(event); }} 2.2 ParentLayoutParentLayoutç»§æ‰¿LinearLayoutï¼Œè€ŒLinearLayoutæ—¶ç»§æ‰¿ViewGroupçš„æ·»åŠ ä¸€äº›log 1234567891011121314151617181920212223242526272829303132public class ParentLayout extends LinearLayout { public ParentLayout(Context context) { super(context); } public ParentLayout(Context context, @Nullable AttributeSet attrs) { super(context, attrs); } public ParentLayout(Context context, @Nullable AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); } @Override public boolean onTouchEvent(MotionEvent event) { System.err.println(\"yidong -- ParentLayout onTouchEvent event = \" + event.getAction()); return super.onTouchEvent(event); } @Override public boolean onInterceptTouchEvent(MotionEvent ev) { System.err.println(\"yidong -- ParentLayout onInterceptTouchEvent event = \" + ev.getAction()); //return super.onInterceptTouchEvent(ev); return false; } @Override public boolean dispatchTouchEvent(MotionEvent ev) { System.err.println(\"yidong -- ParentLayout dispatchTouchEvent event = \" + ev.getAction()); return super.dispatchTouchEvent(ev); }} 2.3 å¸ƒå±€æ–‡ä»¶123456789101112131415&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;cn.onlyloveyd.androideventdispatchdemo.ParentLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:id=\"@+id/parentLayout\" tools:context=\"cn.onlyloveyd.androideventdispatchdemo.MainActivity\"&gt; &lt;cn.onlyloveyd.androideventdispatchdemo.ChildView android:id=\"@+id/childview\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:text=\"ChildView\"/&gt;&lt;/cn.onlyloveyd.androideventdispatchdemo.ParentLayout&gt; 2.4 MainActivityæµ‹è¯•ä¸€ä¸‹äº‹ä»¶çš„ä¼ é€’è¿‡ç¨‹ 123456789101112131415161718192021222324252627282930313233343536373839public class MainActivity extends AppCompatActivity { private ParentLayout parentLayout; private ChildView childView; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); parentLayout = (ParentLayout) findViewById(R.id.parentLayout); childView = (ChildView) findViewById(R.id.childview); parentLayout.setOnTouchListener(new View.OnTouchListener() { @Override public boolean onTouch(View view, MotionEvent motionEvent) { System.err.println(\"yidong -- ParentLayout onTouch event = \" + motionEvent.getAction()); return false; } }); childView.setOnTouchListener(new View.OnTouchListener() { @Override public boolean onTouch(View view, MotionEvent motionEvent) { System.err.println(\"yidong -- ChildView onTouch event = \" + motionEvent.getAction()); return false; } }); childView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { System.err.println(\"yidong -- ChildView onClick\"); } }); }} 2.4.1 ParentLayoutä¸æ‹¦æˆªäº‹ä»¶ParentLayoutçš„onInterceptTouchEventæ–¹æ³•ç›´æ¥return falseï¼›è™½ç„¶ä½¿ç”¨superæ–¹æ³•ä¹Ÿæ˜¯è¿”å›falseï¼Œå› ä¸ºViewGroupä¸­å°±æ˜¯ç›´æ¥è¿”å›çš„falseã€‚ 12345@Overridepublic boolean onInterceptTouchEvent(MotionEvent ev) { System.err.println(\"yidong -- ParentLayout onInterceptTouchEvent event = \" + ev.getAction()); return false;} ç‚¹å‡»Buttonè§£é‡Šï¼šACTION_DOWNäº‹ä»¶ç”±ParentLayoutå¼€å§‹åˆ†å‘ï¼ˆæš‚æ—¶ä¸è€ƒè™‘ä»Activityå¼€å§‹ï¼Œåªè€ƒè™‘Viewå’ŒViewGroupï¼‰ï¼Œç»è¿‡dispatchTouchEventæ–¹æ³•ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦æ‹¦æˆªè¯¥äº‹ä»¶ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®æ‹¦æˆªï¼Œäº‹ä»¶ç»§ç»­ä¼ é€’åˆ°ChildViewï¼ŒChildViewæ‹¿åˆ°äº‹ä»¶ä¹‹åï¼Œä¹Ÿæ˜¯é€šè¿‡dispatchTouchEventæ¥è¿›è¡Œåˆ†å‘ï¼Œç”±äºæ²¡æœ‰å­Viewï¼Œå¼€å§‹æ‰§è¡Œè®¾ç½®çš„onTouchæ–¹æ³•ï¼Œç”±äºæˆ‘ä»¬onTouchè¿”å›çš„æ˜¯falseï¼Œè¡¨ç¤ºæ²¡æœ‰æ¶ˆè€—äº‹ä»¶ï¼Œç»§ç»­äº¤ç»™ChildViewçš„onTouchEventå¤„ç†ï¼Œè€ŒChildViewç»§æ‰¿çš„æ—¶AppCompatButtonï¼Œåœ¨onTouchEventä¸­ä¼šæ¶ˆè€—æ‰äº‹ä»¶ï¼Œè¿™æ ·åç»­çš„ACTION_UPäº‹ä»¶æ‰ä¼šç»§ç»­è¢«å¤„ç†ï¼Œæœ€åä¼šACTION_DOWNå’ŒACTION_UPä¸€èµ·å½¢æˆonClickäº‹ä»¶ã€‚è¿™é‡Œå‡è®¾åœ¨ChildViewçš„onTouchEventè¿”å›çš„æ—¶falseï¼Œæˆ‘ä»¬å°†ä¼šçœ‹åˆ°å¦å¤–ä¸€ç§logã€‚è§£é‡Šï¼šç”±äºChildViewåœ¨onTouchå’ŒonTouchEventä¸­éƒ½æ²¡æœ‰æ¶ˆè€—æ‰ACTION_DOWNäº‹ä»¶ï¼Œäº‹ä»¶è¢«è¿”å›ç»™ParentLayoutï¼Œè€ŒParentLayoutçš„onTouchå’ŒonTouchEventä¸­ä¹Ÿéƒ½æ˜¯è¿”å›çš„falseï¼Œè¡¨ç¤ºæ²¡æœ‰æ¶ˆè€—äº‹ä»¶ï¼Œå› æ­¤ï¼Œè¿™ä¸ªäº‹ä»¶ä¸€ç›´éƒ½æ²¡æœ‰è¢«å¤„ç†ã€‚å°±å¥½åƒé¢†å¯¼ç»™ä½ ä¸€ä¸ªä»»åŠ¡ï¼Œä½ ç«Ÿç„¶è¯´ä½ å®Œæˆä¸äº†ï¼Œåç»­çš„ä»»åŠ¡ï¼Œä½ è§‰å¾—ä¼šç»™ä½ å˜›ï¼Ÿæ‰€ä»¥åé¢çš„ACTION_UPçš„å½±å­éƒ½çœ‹ä¸åˆ°ã€‚å‡å¦‚æˆ‘ä»¬åœ¨ParentLayoutçš„onTouchæˆ–è€…onTouchEventä¸­è¿”å›trueã€‚ è‹¥ParentLayout.onTouchè¿”å›true å¯ä»¥çœ‹åˆ°å¯¹äºACTION_DOWNäº‹ä»¶åœ¨ParentLayout.onTouchç»“æŸï¼Œæ²¡æœ‰æ‰§è¡ŒParentLayout.onTouchEventæ–¹æ³•ã€‚è€ŒACTION_UPåœ¨æ²¡æœ‰æ‰§è¡Œæ‹¦æˆªåˆ¤æ–­çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æŠŠäº‹ä»¶äº¤ç»™ParentLayoutçš„onTouchå¤„ç†ã€‚å°±å¥½åƒä¸€ä¸ªé¡¹ç›®ä¸­çš„åŒä¸€ä¸ªæ¨¡å—çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œä½ å¾ˆå¥½çš„å®Œæˆæ¥ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªä»»åŠ¡ï¼Œè‡ªç„¶å°±æ˜¯ä½ çš„ã€‚å› ä¸ºä½ æœ‰èƒ½åŠ›å®Œæˆï¼Œå¹¶ä¸”ä¸¤ä¸ªä»»åŠ¡ä¹Ÿæ˜¯åŒä¸€ä¸ªæ¨¡å—ã€‚ è‹¥ParentLayout.onTouchEvetnè¿”å›true å‰ææ—¶ParentLayout.onTouchæ–¹æ³•return falseç»“æœå’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œåªæ˜¯ç»ˆç‚¹æ¢æ¥ä¸€ä¸ªä½ç½®è€Œå·²ã€‚ ç‚¹å‡»Buttonå¤–ç©ºç™½åŒºåŸŸè§£é‡Šï¼šç”±äºParentLayoutçš„onTouchå’ŒonTouchEventéƒ½æ˜¯è¿”å›çš„falseï¼ŒACTION_DOWN äº‹ä»¶å¹¶æ²¡æœ‰è¢«æ¶ˆè€—ï¼Œæ‰€ä»¥åç»­çš„ACTION_UPäº‹ä»¶è‡ªç„¶æ˜¯æ²¡æœ‰çš„ï¼Œå‡å¦‚æˆ‘ä»¬åœ¨onTouchæˆ–è€…onTouchEventä¸­return trueã€‚ è‹¥ParentLayout.onTouchè¿”å›true è‹¥PatentLayout.onTouchEventè¿”å›true è§£é‡ŠåŸºæœ¬å’Œä¸Šé¢çš„ä¸€æ¯›ä¸€æ ·ï¼Œä¸åšèµ˜è¿°ã€‚ 2.4.2 ParentLayoutæ‹¦æˆªäº‹ä»¶123456@Overridepublic boolean onInterceptTouchEvent(MotionEvent ev) { System.err.println(\"yidong -- ParentLayout onInterceptTouchEvent event = \" + ev.getAction()); //return super.onInterceptTouchEvent(ev); return true;} ç»“æœå¯æƒ³è€ŒçŸ¥ï¼Œä½ çš„ç»„é•¿æŠŠæ´»éƒ½è‡ªå·±åšæ¥ï¼Œä½œä¸ºç»„å‘˜çš„ä½ ï¼Œè‡ªç„¶æ—¶çœ‹ä¸åˆ°ä»»åŠ¡çš„ã€‚è¿è¡Œç»“æœå’Œä¸Šé¢ä¸æ‹¦æˆªçš„æƒ…å†µä¸‹ç‚¹å‡»Buttonå¤–éƒ¨ç›¸åŒã€‚å…·ä½“çš„logè¦çœ‹ParentLayoutçš„onTouchå’ŒonTouchEventçš„æ‰§è¡Œç»“æœã€‚ 2.5 æ€»ç»“ 2.6 æµ‹è¯•ä»£ç AndroidEventDispatchDemo","link":"/2017/09/20/ã€ŠAndroid åŸºç¡€ï¼ˆå››åå››ï¼‰ã€‹ Viewäº‹ä»¶åˆ†å‘æœºåˆ¶/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››ï¼‰ã€‹ RecyclerView","text":"ä»‹ç» RecyclerViewæ˜¯ListViewçš„è±ªåå¢å¼ºç‰ˆã€‚å®ƒä¸»è¦åŒ…å«ä»¥ä¸‹å‡ å¤„æ–°çš„ç‰¹æ€§ï¼Œå¦‚ViewHolderï¼ŒItemDecoratorï¼ŒLayoutManagerï¼ŒSmothScrollerä»¥åŠå¢åŠ æˆ–åˆ é™¤itemæ—¶itemåŠ¨ç”»ç­‰ã€‚å®˜æ–¹æ¨èæˆ‘ä»¬é‡‡ç”¨RecyclerViewæ¥å–ä»£ListViewã€‚ ç›¸å¯¹ä¼˜åŠ¿ViewHolderListViewéœ€è¦è‡ªå·±å®ç°ViewHolderæ¥æé«˜æ€§èƒ½ï¼Œæˆ–è€…ä¸ä½¿ç”¨ViewHolder,ä½†æ˜¯ä½¿ç”¨ViewHolderæ¥ç»‘å®šå¯¹è±¡æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¹ æƒ¯ã€‚RecyclerViewå¾ˆå¥½çš„å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ŒRecyclerView.ViewHolderåœ¨ä½¿ç”¨RecyclerViewè¿‡ç¨‹ä¸­å¿…é¡»å®ç°ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æ— æ³•ç›´æ¥åˆ›å»ºï¼Œéœ€è¦è‡ªå·±å®Œæˆå¯¹åº”å­ç±»çš„å»ºç«‹ç„¶åä½¿ç”¨ LayoutManagerListViewåªèƒ½åœ¨å‚ç›´æ–¹å‘ä¸Šæ»šåŠ¨ï¼Œä¸æ”¯æŒå…¶ä»–çš„æ»šåŠ¨æ–¹å¼ï¼Œå½“ç„¶å¼€å‘è€…æœ‰å¾ˆå¤šè‡ªå®šä¹‰çš„æ–¹å¼å®Œæˆè¿™äº›åŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸åšäº‰è¾©ï¼Œä»è®¾è®¡çš„è§’åº¦ä¸Šçœ‹ï¼ŒListViewè®¾è®¡ä¹‹åˆåº”è¯¥å°±æ²¡æœ‰æƒ³è¿‡è®©å®ƒå®Œæˆè¿™äº›å¤æ‚çš„åŠŸèƒ½ï¼Œåªæ˜¯ä¸ºäº†å•çº¯çš„åˆ—è¡¨æ˜¾ç¤ºã€‚ä½†æ˜¯RecyclerViewç›¸è¾ƒäºListViewï¼Œåœ¨æ»šåŠ¨ä¸Šé¢çš„åŠŸèƒ½æ‰©å±•äº†è®¸å¤šã€‚å®ƒå¯ä»¥æ”¯æŒå¤šç§ç±»å‹åˆ—è¡¨çš„å±•ç¤ºè¦æ±‚ï¼Œä¸»è¦å¦‚ä¸‹ï¼š GridLayoutManagerï¼Œæ”¯æŒç½‘æ ¼å±•ç¤ºï¼Œå¯ä»¥æ°´å¹³æˆ–è€…ç«–ç›´æ»šåŠ¨ï¼Œå¦‚å±•ç¤ºå›¾ç‰‡çš„ç”»å»Šã€‚ LinearLayoutManager ï¼Œå¯ä»¥æ”¯æŒæ°´å¹³å’Œç«–ç›´æ–¹å‘ä¸Šæ»šåŠ¨çš„åˆ—è¡¨ã€‚8 StaggeredGridLayoutManager ï¼Œå¯ä»¥æ”¯æŒäº¤å‰ç½‘æ ¼é£æ ¼çš„åˆ—è¡¨ï¼Œç±»ä¼¼äºç€‘å¸ƒæµæˆ–è€…Pinterestã€‚ ItemAnimation,ItemAnimationæ˜¯RecyclerViewä¸­å­é¡¹åœ¨å¢åŠ ï¼Œåˆ é™¤æˆ–è€…ç§»åŠ¨çš„æƒ…å†µä¸‹æ˜¾ç¤ºçš„åŠ¨ç”»æ•ˆæœï¼ŒGoogleè¶Šæ¥è¶Šé‡è§†ç”¨æˆ·ä½“éªŒï¼Œä»å±æ€§åŠ¨ç”»çš„æ¨å‡ºå¼€å§‹ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªè¶‹åŠ¿ï¼Œå¼€å‘è€…åœ¨è¿™é‡Œå¯ä»¥è‡ªå·±å®ç°è‡ªå·±æƒ³è¦æ·»åŠ çš„åŠ¨ç”»æ•ˆæœï¼Œå½“ç„¶ï¼Œå¦‚æœä½ æ˜¯ä¸ªæ‡’æ±‰ï¼Œè¯·ä½¿ç”¨new DefaultItemAnimator() ItemDecorationItemDecorationï¼Œåå­—èµ·çš„å¾ˆæ–‡è‰ºï¼Œå­é¡¹çš„è£…é¥°ï¼ŒRecyclerViewåœ¨é»˜è®¤æƒ…å†µä¸‹å¹¶ä¸åœ¨itemä¹‹é—´å±•ç¤ºé—´éš”ç¬¦ã€‚å¦‚æœä½ æƒ³è¦æ·»åŠ é—´éš”ç¬¦ï¼Œä½ å¿…é¡»ä½¿ç”¨RecyclerView.ItemDecorationç±»æ¥å®ç°ã€‚æ‡’æ±‰è¯·ä½¿ç”¨DividerItemDecoration.javaã€‚ Recyclerç¤ºä¾‹å®é™…æ•ˆæœå›¾ ä¸Šé¢è¿™ä¸ªæ•ˆæœå›¾æ˜¯ä½¿ç”¨çš„StaggeredGridLayoutManager åŸºæœ¬ä½¿ç”¨å¸ƒå±€æ–‡ä»¶activity_main.xml 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:id=\"@+id/root_layout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" android:background=\"@color/colorMainBackground\"&gt; &lt;include layout=\"@layout/toolbar\"&gt;&lt;/include&gt; &lt;FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" tools:context=\".model.View.MainActivity\"&gt; &lt;android.support.v7.widget.RecyclerView android:id=\"@+id/rv_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;/android.support.v7.widget.RecyclerView&gt; &lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab_add\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"bottom|right\" android:layout_marginBottom=\"30dp\" android:layout_marginRight=\"30dp\" android:src=\"@drawable/addone\" /&gt; &lt;android.support.design.widget.FloatingActionButton android:id=\"@+id/fab_del\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"bottom|left\" android:layout_marginBottom=\"30dp\" android:layout_marginLeft=\"30dp\" android:src=\"@drawable/delone\" /&gt; &lt;/FrameLayout&gt;&lt;/LinearLayout&gt; recycler_item.xml 12345678910111213141516171819202122&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt; &lt;android.support.v7.widget.CardView android:layout_margin=\"10dp\" android:id=\"@+id/cv_bg\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" app:cardCornerRadius=\"20dp\" app:cardElevation=\"5dp\"&gt; &lt;TextView android:id=\"@+id/tv_name\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:gravity=\"center\" /&gt; &lt;/android.support.v7.widget.CardView&gt;&lt;/FrameLayout&gt; ä¸»Activity 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class MainActivity extends AppCompatActivity { @Bind(R.id.rv_content) RecyclerView rvContent; @Bind(R.id.fab_add) FloatingActionButton fabAdd; @Bind(R.id.fab_del) FloatingActionButton fabDel; @Bind(R.id.root_layout) LinearLayout rootLayout; private LayoutManager mLayoutManager; //LayoutManager private RVAdapter recyclerAdapter; //RecyclerViewå¯¹åº”çš„Adapter private ArrayList&lt;String&gt; mContentList; //å†…å®¹listè¿™é‡Œåªæ˜¯ä½¿ç”¨äº†å­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ›¿æ¢æˆå…¶ä»–çš„JavaBeanç±» private Random mRandom = new Random(); //ç”¨äºäº§ç”Ÿéšæœºå­—ç¬¦ä¸² private int mSum = 50; //åˆå§‹åŒ–å­é¡¹æ•°ç›® @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); //ButterKnifeæ³¨å…¥ï¼Œå‡å°‘ä»£ç è´Ÿæ‹… mContentList = new ArrayList&lt;String&gt;(); for (int i = 0; i &lt; mSum; i++) { mContentList.add(getRandomString()); } //éšæœºç”Ÿæˆæ•°æ® recyclerAdapter = new RVAdapter(mContentList); mLayoutManager = new StaggeredGridLayoutManager(3, LinearLayoutManager.VERTICAL); //3åˆ—çºµå‘ rvContent.setAdapter(recyclerAdapter); rvContent.setLayoutManager(mLayoutManager); rvContent.setItemAnimator(new DefaultItemAnimator()); //è®¾ç½®åŠ¨ç”»æ•ˆæœï¼Œå¯ä»¥çœ‹ä¸‹ä¸Šé¢çš„æ•ˆæœå›¾ï¼ŒåŠ¨ç”»æ•ˆæœè¿˜æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ } @OnClick({R.id.fab_add, R.id.fab_del}) public void onClick(View view) { switch (view.getId()) { case R.id.fab_add: recyclerAdapter.addData(1); //åŠ ä¸€ä¸ª makeSnackBar(rootLayout, \"æ·»åŠ ä¸€ä¸ª :)\", null, null);//æ˜¾ç¤ºä¸€ä¸ªSnackbar break; case R.id.fab_del: recyclerAdapter.removeData(1); //å»æ‰ä¸€ä¸ª makeSnakeBar(rootLayout, \"åˆ é™¤ä¸€ä¸ª :(\", null, null); //æ˜¾ç¤ºä¸€ä¸ªSnackbar break; default: break; } } //ç”¨äºäº§ç”Ÿéšæœºå­—ç¬¦ä¸²çš„æ–¹æ³• public String getRandomString() { String src = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\"; StringBuilder dst = new StringBuilder(4); for (int i = 0; i &lt; 4; i++) { dst.append(src.charAt(mRandom.nextInt(62))); } return dst.toString(); } //æ„å»ºä¸€ä¸ªSnackbarå¹¶æ˜¾ç¤ºå‡ºæ¥ private void makeSnackBar(View view, String message, String buttonText, View.OnClickListener onClickListener) { Snackbar.make(view, message, Snackbar.LENGTH_SHORT) .setAction(buttonText, onClickListener) .show(); }} é€‚é…å™¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class RVAdapter extends RecyclerView.Adapter&lt;RVAdapter.MyViewHolder&gt;{ ArrayList&lt;String&gt; mContentList; Random mRandom = new Random(); //ViewHolderç»§æ‰¿è‡ªRecyclerView.ViewHolder å­Viewæ‹¿åˆ°æ–¹ä¾¿åé¢è®¿é—® public class MyViewHolder extends RecyclerView.ViewHolder { TextView textView; CardView cardView; public MyViewHolder(View itemView) { super(itemView); textView = (TextView) itemView.findViewById(R.id.tv_name); cardView = (CardView) itemView.findViewById(R.id.cv_bg); } } public RVAdapter(ArrayList&lt;String&gt; mContentList) { this.mContentList = mContentList; } //åˆ›å»ºViewHolderï¼Œç”±äºRecyclerView.ViewHolderæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æ— æ³•å®ä¾‹åŒ–ï¼Œæ‰€ä»¥å¿…é¡»å®ç°ä¸€ä¸ªå­ç±»æ‰èƒ½ä½¿ç”¨ï¼Œè¿™é‡Œè‡ªå·±å°è¯•çš„è¿‡ç¨‹ä¸­èµ°äº†ä¸€äº›å¼¯è·¯ï¼Œæ³¨æ„inflateæœ€åä¸€ä¸ªå‚æ•°è®¾ç½®æˆfalseä¸ç„¶å¯èƒ½ä¼šå‡ºç°crash @Override public MyViewHolder onCreateViewHolder(ViewGroup parent, int viewType) { View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.recycler_item, parent, false); return new MyViewHolder(view); } //onBindView ç”¨äºè®¾ç½®éœ€è¦æ˜¾ç¤ºçš„Viewä¸­çš„å†…å®¹å’Œä¸€äº›å±æ€§å€¼ @Override public void onBindViewHolder(MyViewHolder holder, int position) { holder.cardView.setCardBackgroundColor(getRandomColor()); holder.textView.setText(mContentList.get(position)); holder.itemView.getLayoutParams().height = getRandomHeight(200,400);//äº§ç”Ÿéšæœºé«˜åº¦ï¼Œçœ‹ä¸Šå»åƒç€‘å¸ƒ } @Override public int getItemCount() { return mContentList.size(); } //äº§ç”Ÿéšæœºé¢œè‰² private int getRandomColor() { return (0xff000000|mRandom.nextInt(0x00ffffff)); } //äº§ç”Ÿéšæœºé«˜åº¦ private int getRandomHeight(int min , int max) { return (mRandom.nextInt(max - min) + min ); } //æ·»åŠ ä¸€ä¸ªå­é¡¹ public void addData(int position) { mContentList.add(position, \"Insert One\"); notifyItemInserted(position);//ä¸è°ƒç”¨è¿™ä¸ªæ²¡æœ‰åŠ¨ç”»æ•ˆæœ } //åˆ é™¤ä¸€ä¸ªå­é¡¹ public void removeData(int position) { mContentList.remove(position); notifyItemRemoved(position);//ä¸è°ƒç”¨è¿™ä¸ªæ²¡æœ‰åŠ¨ç”»æ•ˆæœ }} éœ€è¦æ³¨æ„çš„å‡ ä¸ªåœ°æ–¹ï¼š å®ç°è‡ªå·±çš„ViewHolderç»§æ‰¿recyclerView,ViewHolderï¼Œå› ä¸ºæŠ½è±¡ç±»ä¸å®ä¾‹åŒ– inflateå­é¡¹çš„æ—¶å€™ï¼Œæœ€åä¸€ä¸ªå‚æ•°è®¾ç½®æˆfalse åŠ¨ç”»æ•ˆæœéœ€è¦åœ¨Adapterä¸­è°ƒç”¨notifyItemæ–¹æ³•æ‰è¡Œ StaggeredGridLayoutManagerçš„æ•ˆæœå›¾ä¸Šé¢å·²ç»æœ‰æ˜¾ç¤ºäº† å…¶ä»–æ•ˆæœLinearLayoutManager12mLayoutManager = new LinearLayoutManager(this);rvContent.addItemDecoration(new DividerItemDecoration(this, StaggeredGridLayoutManager.VERTICAL)); GridLayoutManager12mLayoutManager = new GridLayoutManager(this, 3);//3åˆ—rvContent.addItemDecoration(new DividerItemDecoration(this, StaggeredGridLayoutManager.VERTICAL)); StaggeredGridLayoutManager.HORIZONTAL1234mLayoutManager = new StaggeredGridLayoutManager(3, StaggeredGridLayoutManager.HORIZONTAL);RVAdapter.javaä¸­onBindViewHolderholder.itemView.getLayoutParams().width = getRandomHeight(200,400); å…³äºItemDecorationè¿™é‡Œé™„ä¸ŠGoogle Sampleä¸­çš„DividerItemDecoration.javaä»£ç  å¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°å¤§å®¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980public class DividerItemDecoration extends RecyclerView.ItemDecoration { private static final int[] ATTRS = new int[]{ android.R.attr.listDivider }; public static final int HORIZONTAL_LIST = LinearLayoutManager.HORIZONTAL; public static final int VERTICAL_LIST = LinearLayoutManager.VERTICAL; private Drawable mDivider; private int mOrientation; public DividerItemDecoration(Context context, int orientation) { final TypedArray a = context.obtainStyledAttributes(ATTRS); mDivider = a.getDrawable(0); a.recycle(); setOrientation(orientation); } public void setOrientation(int orientation) { if (orientation != HORIZONTAL_LIST &amp;&amp; orientation != VERTICAL_LIST) { throw new IllegalArgumentException(\"invalid orientation\"); } mOrientation = orientation; } @Override public void onDraw(Canvas c, RecyclerView parent) { if (mOrientation == VERTICAL_LIST) { drawVertical(c, parent); } else { drawHorizontal(c, parent); } } public void drawVertical(Canvas c, RecyclerView parent) { final int left = parent.getPaddingLeft(); final int right = parent.getWidth() - parent.getPaddingRight(); final int childCount = parent.getChildCount(); for (int i = 0; i &lt; childCount; i++) { final View child = parent.getChildAt(i); final RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child .getLayoutParams(); final int top = child.getBottom() + params.bottomMargin + Math.round(ViewCompat.getTranslationY(child)); final int bottom = top + mDivider.getIntrinsicHeight(); mDivider.setBounds(left, top, right, bottom); mDivider.draw(c); } } public void drawHorizontal(Canvas c, RecyclerView parent) { final int top = parent.getPaddingTop(); final int bottom = parent.getHeight() - parent.getPaddingBottom(); final int childCount = parent.getChildCount(); for (int i = 0; i &lt; childCount; i++) { final View child = parent.getChildAt(i); final RecyclerView.LayoutParams params = (RecyclerView.LayoutParams) child .getLayoutParams(); final int left = child.getRight() + params.rightMargin + Math.round(ViewCompat.getTranslationX(child)); final int right = left + mDivider.getIntrinsicHeight(); mDivider.setBounds(left, top, right, bottom); mDivider.draw(c); } } @Override public void getItemOffsets(Rect outRect, int itemPosition, RecyclerView parent) { if (mOrientation == VERTICAL_LIST) { outRect.set(0, 0, 0, mDivider.getIntrinsicHeight()); } else { outRect.set(0, 0, mDivider.getIntrinsicWidth(), 0); } }} å¤‡æ³¨Androidæºç ä¸­æœ‰å¾ˆå¤šå…³äºè¿™äº›Viewçš„ä½¿ç”¨æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥æŸ¥é˜…å¹¶å‚è€ƒä½¿ç”¨ã€‚åšæ–‡ä¸­éƒ¨åˆ†ä»£ç ï¼šhttp://download.csdn.net/detail/poorkick/9541326","link":"/2016/06/04/ã€ŠAndroid åŸºç¡€ï¼ˆå››ï¼‰ã€‹ RecyclerView/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››åå…«ï¼‰ã€‹ConstrainLayoutã€è¯‘ã€‘","text":"åŸæ–‡åœ°å€https://developer.android.google.cn/reference/android/support/constraint/ConstraintLayout ä»‹ç» ConstrainLayoutæ˜¯ä¸€ä¸ªå…è®¸å¼€å‘è€…çµæ´»åœ°è®¾ç½®æ§ä»¶çš„ä½ç½®å’Œå¤§å°çš„ViewGroupã€‚åªè¦ä½ ä½¿ç”¨çš„Androidç³»ç»Ÿç‰ˆæœ¬åœ¨9ä»¥ä¸Šï¼Œä½ ä¾¿å¯ä»¥é€šè¿‡æ·»åŠ ä¾èµ–çš„æ–¹å¼æ¥ä½¿ç”¨ConstrainLayout. ä½¿ç”¨æ·»åŠ ä¾èµ– implementation â€˜com.android.support.constraint:constraint-layout:1.1.3â€™ å¸¸ç”¨çº¦æŸç›¸å¯¹å®šä½(Relative positioning)ç›¸å¯¹å®šä½æ˜¯ConstrainLayoutæ„å»ºå¸ƒå±€çš„ä¸€ç§åŸºæœ¬æ–¹å¼ã€‚ç›¸å¯¹å®šä½çº¦æŸå¯ä»¥å¸®åŠ©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»™å®šçš„Widgetæ¥æ‘†æ”¾å¦å¤–ä¸€ä¸ªWidgetã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ¨ªçºµä¸¤ä¸ªæ–¹å‘ä¸Šçº¦æŸWidgetã€‚ æ¨ªå‘: left, right, start and end sidesçºµå‘: top, bottom sides and text baseline ä¸€èˆ¬æ€è·¯æ˜¯å°†ä¸€ä¸ª Widgetçš„ç»™å®šä¾§çº¦æŸåˆ°å…¶ä»–Widgetçš„å¦ä¸€ä¾§ã€‚ æ¯”å¦‚ï¼ŒæŠŠbutton Bæ”¾ç½®åˆ°button Açš„å³ä¾§(ä¸‹å›¾) å®ç°å¯ä»¥å¦‚ä¸‹ 123&lt;Button android:id=\"@+id/buttonA\" ... /&gt;&lt;Button android:id=\"@+id/buttonB\" ... app:layout_constraintLeft_toRightOf=\"@+id/buttonA\" /&gt; ä¸Šè¿°ä»£ç å°±æ˜¯å‘Šè¯‰ç³»ç»Ÿï¼Œæˆ‘ä»¬æƒ³è®©button Bçš„å·¦ä¾§çº¦æŸåˆ°button Açš„å³ä¾§ã€‚è¿™æ ·ä¸€ä¸ªä½ç½®çº¦æŸæ„å‘³ç€ï¼Œç³»ç»Ÿå°†è®©button Açš„å³ä¾§å’Œbutton Bçš„å·¦ä¾§åœ¨Xè½´ä¸Šå…·æœ‰ç›¸åŒçš„ä½ç½®ã€‚ æ­¤ç±»ç›¸å¯¹ä½ç½®å±æ€§è¿˜æœ‰å¾ˆå¤šï¼Œå…·ä½“å¦‚ä¸‹ï¼š layout_constraintLeft_toLeftOf layout_constraintLeft_toRightOf layout_constraintRight_toLeftOf layout_constraintRight_toRightOf layout_constraintTop_toTopOf layout_constraintTop_toBottomOf layout_constraintBottom_toTopOf layout_constraintBottom_toBottomOf layout_constraintBaseline_toBaselineOf layout_constraintStart_toEndOf layout_constraintStart_toStartOf layout_constraintEnd_toStartOf layout_constraintEnd_toEndOf è¿™äº›å±æ€§é€šè¿‡å¼•ç”¨idæ¥ä»£è¡¨ä¸€ä¸ªWidgetï¼Œæˆ–è€…ä½¿ç”¨parentæ¥ä»£è¡¨çˆ¶å¸ƒå±€ 12&lt;Button android:id=\"@+id/buttonB\" ... app:layout_constraintLeft_toLeftOf=\"parent\" /&gt; è¾¹è·(Margins) å¦‚æœè®¾ç½®äº†è¾¹è·ï¼Œåˆ™å®ƒä»¬å°†åº”ç”¨äºç›¸åº”çš„çº¦æŸï¼Œå°†è¾¹è·å¼ºåˆ¶è®¾ç½®ä¸ºç›®æ ‡Widgetå’ŒæºWidgetä¹‹é—´çš„ç©ºé—´ã€‚é€šå¸¸çš„å¸ƒå±€è¾¹è·å±æ€§å°±å¯ä»¥è¾¾åˆ°æ­¤æ•ˆæœã€‚ android:layout_marginStart android:layout_marginEnd android:layout_marginLeft android:layout_marginTop android:layout_marginRight android:layout_marginBottom æ³¨æ„: è¾¹è·åªèƒ½æ˜¯æ­£æ•°æˆ–ç­‰äºé›¶ï¼Œé‡‡ç”¨Dimensionå½¢å¼ã€‚ çº¦æŸç›®æ ‡GONEåè¾¹è·å¤„ç† (Margins when connected to a GONE widget)å½“çº¦æŸç›®æ ‡çš„å¯è§æ€§ä¸ºView.GONEæ—¶ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å±æ€§æŒ‡ç¤ºè¦ä½¿ç”¨çš„ä¸åŒè¾¹è·å€¼ï¼š layout_goneMarginStart layout_goneMarginEnd layout_goneMarginLeft layout_goneMarginTop layout_goneMarginRight layout_goneMarginBottom å±…ä¸­å®šä½å’Œä½ç½®åå·®ConstraintLayoutçš„ä¸€ä¸ªæœ‰ç”¨æ–¹é¢æ˜¯å®ƒå¦‚ä½•å¤„ç†â€œä¸å¯èƒ½â€çš„çº¦æŸã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¦‚ä¸‹ä»£ç ï¼š 12345&lt;android.support.constraint.ConstraintLayout ...&gt; &lt;Button android:id=\"@+id/button\" ... app:layout_constraintLeft_toLeftOf=\"parent\" app:layout_constraintRight_toRightOf=\"parent\"/&gt; &lt;/&gt; é™¤éConstraintLayoutæ°å¥½å…·æœ‰ä¸Buttonå®Œå…¨ç›¸åŒçš„å¤§å°ï¼Œå¦åˆ™ä¸¤ä¸ªçº¦æŸä¸èƒ½åŒæ—¶æ»¡è¶³ï¼ˆåŒæ–¹éƒ½ä¸èƒ½æˆä¸ºæˆ‘ä»¬æƒ³è¦å®ƒä»¬çš„ä½ç½®ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçº¦æŸçš„ä½œç”¨å°±åƒæ˜¯ç›¸åçš„åŠ›é‡å°†Widgetæ‹‰å¹³ï¼ˆä¸Šå›¾ï¼‰;è¿™æ ·Widgetæœ€ç»ˆå°†ä¼šåœ¨çˆ¶å®¹å™¨ä¸­å±…ä¸­æ˜¾ç¤ºã€‚è¿™ç§ä½¿ç”¨æ–¹å¼åœ¨çºµè½´æ–¹å‘ä¸ŠåŒæ ·é€‚ç”¨ã€‚ åå·®(Bias)é‡åˆ°è¿™ç§ç›¸åçš„çº¦æŸæ—¶çš„é»˜è®¤è®¾ç½®æ˜¯ä½¿Widgetå±…ä¸­;ä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨åå·®å±æ€§è°ƒæ•´å®šä½ä»¥ä½¿ä¸€ä¾§åå‘å¦ä¸€ä¾§ã€‚ layout_constraintHorizontal_bias layout_constraintVertical_bias ä¾‹å¦‚ï¼Œå¦‚ä¸‹ä»£ç å°†ä½¿å·¦ä¾§å…·æœ‰30ï¼…çš„åå·®è€Œä¸æ˜¯é»˜è®¤çš„50ï¼…ï¼Œä½¿å¾—å·¦ä¾§å°†æ›´çŸ­ï¼ŒWidgetæ›´å€¾å‘äºå·¦ä¾§ï¼ˆå…·ä½“æ•ˆæœå¦‚ä¸‹å›¾ï¼‰ï¼š 123456&lt;android.support.constraint.ConstraintLayout ...&gt; &lt;Button android:id=\"@+id/button\" ... app:layout_constraintHorizontal_bias=\"0.3\" app:layout_constraintLeft_toLeftOf=\"parent\" app:layout_constraintRight_toRightOf=\"parent/&gt; &lt;/&gt; ä½¿ç”¨åå·®å±æ€§ï¼Œä½ å¯ä»¥åˆ¶ä½œæ›´å¥½åœ°é€‚åº”å±å¹•å°ºå¯¸å˜åŒ–çš„ç”¨æˆ·ç•Œé¢ã€‚ ç¯å½¢å®šä½(Circular positioning (Added in 1.1))ä½ å¯ä»¥ä»¥è·ç¦»æˆ–è€…è§’åº¦æ¥çº¦æŸä¸€ä¸ªWidgetä¸­å¿ƒç›¸å¯¹äºå¦ä¸€ä¸ªWidgetçš„ä¸­å¿ƒã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†Widgetæ”¾ç½®åˆ°ä¸€ä¸ªåœ†ç¯ä¸Šã€‚å…·ä½“å±æ€§å¦‚ä¸‹ï¼š layout_constraintCircle : å¼•ç”¨widget ID layout_constraintCircleRadius : åˆ°å¦ä¸€ä¸ªwidgetçš„è·ç¦» layout_constraintCircleAngle : widgetéœ€è¦æ‘†æ”¾åœ¨å“ªä¸ªè§’åº¦ (0-360) 12345&lt;Button android:id=\"@+id/buttonA\" ... /&gt; &lt;Button android:id=\"@+id/buttonB\" ... app:layout_constraintCircle=\"@+id/buttonA\" app:layout_constraintCircleRadius=\"100dp\" app:layout_constraintCircleAngle=\"45\" /&gt; å¯è§æ€§è¡Œä¸º(Visibility behavior)ConstraintLayoutå¯¹äºå¯è§æ€§ä¸ºView.GONEçš„Widgetæœ‰æ˜ç¡®çš„å¤„ç†æ–¹å¼ã€‚ GONE widgetï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°†ä¸ä¼šæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šï¼ŒåŒæ—¶ä¹Ÿä¸å†æ˜¯å¸ƒå±€ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ ä½†å°±å¸ƒå±€è®¡ç®—è€Œè¨€ï¼ŒGONE Widgetä»ç„¶æ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚ å¯¹äºå¸ƒå±€ä¼ é€’ï¼Œå®ƒä»¬çš„å°ºå¯¸å°†è¢«è§†ä¸ºé›¶ï¼ˆåŸºæœ¬ä¸Šï¼Œå®ƒä»¬å°†è¢«è§£æä¸ºä¸€ä¸ªç‚¹ï¼‰ å¦‚æœä»–ä»¬å¯¹å…¶ä»–Widgetæœ‰é™åˆ¶ï¼Œè¿™äº›é™åˆ¶ä»ç„¶ä¼šå¾—åˆ°ä½“ç°ï¼Œä½†ä»»ä½•è¾¹è·éƒ½ä¼šç­‰äºé›¶ è¿™ç§ç‰¹å®šçš„è¡Œä¸ºå¯ä»¥æ»¡è¶³ä½ åœ¨ä¸ç ´åå¸ƒå±€çš„æƒ…å†µä¸‹æ„å»ºå¸ƒå±€ï¼Œåªéœ€è¦æš‚æ—¶å°†å¯¹åº”çš„Widgetæ ‡è®°ä¸ºGONEå³å¯ï¼Œè¿™åœ¨æ„å»ºç®€å•çš„å¸ƒå±€åŠ¨ç”»æ—¶æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ å¦‚ä¸Šå›¾ï¼Œå½“A GONEåï¼ŒBä½¿ç”¨çš„å·¦è¾¹è·æ˜¯Bç›¸å¯¹äºAçš„è¾¹è·ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè¾¹è·å¯èƒ½å¹¶ä¸æ˜¯ä½ æ‰€éœ€è¦çš„(æ¯”å¦‚ï¼ŒAç›¸å¯¹äºå®¹å™¨å­˜åœ¨20dpçš„å·¦è¾¹è·ï¼ŒBç›¸å¯¹äºAæœ‰40dpçš„å·¦è¾¹è·ï¼Œå½“Aè¢«æ ‡è®°ä¸ºGONEåï¼ŒBç›¸å¯¹äºå®¹å™¨å°±ä¼šå­˜åœ¨40dpçš„å·¦è¾¹è·)ã€‚å› æ­¤ï¼Œä½ å¯ä»¥æŒ‡å®šåœ¨è¿æ¥åˆ°çš„Widgetæ ‡è®°ä¸ºGONEæ—¶çš„marginä½œä¸ºå¤‡ç”¨è¾¹è·å€¼ã€‚å…·ä½“çœ‹ä¸Šä¸€ç« èŠ‚çš„ã€çº¦æŸç›®æ ‡GONEåè¾¹è·å¤„ç†ã€‘ã€‚ å°ºå¯¸çº¦æŸ(Dimensions constraints)ConstraintLayoutæœ€å°å°ºå¯¸å’Œæœ€å¤§å°ºå¯¸é€šè¿‡å¦‚ä¸‹å±æ€§ä½ å¯ä»¥ç»™ConstrainLayoutå®šä¹‰æœ€å¤§æˆ–æ˜¯æœ€å°å°ºå¯¸ã€‚ android:minWidth set the minimum width for the layout android:minHeight set the minimum height for the layout android:maxWidth set the maximum width for the layout android:maxHeight set the maximum height for the layout å½“å…¶å°ºå¯¸è®¾ç½®ä¸ºWRAP_CONTENTæ—¶ï¼Œè¿™äº›æœ€å°å’Œæœ€å¤§å°ºå¯¸å°†ä¼šè¢«ConstraintLayoutä½¿ç”¨åˆ°ã€‚ Widgetså°ºå¯¸çº¦æŸWidgetsçš„å°ºå¯¸éœ€è¦é€šè¿‡å¦‚ä¸‹ä¸‰ç§æ–¹å¼è®¾ç½®android:layout_widthå’Œandroid:layout_heightæ¥æ˜ç¡®ã€‚ ä½¿ç”¨ä¸€ä¸ªæ˜ç¡®çš„å°ºå¯¸å¤§å° (æ•°å­—å€¼å¦‚123dpæˆ–è€…æ˜¯ä¸€ä¸ªå°ºå¯¸å¼•ç”¨) ä½¿ç”¨WRAP_CONTENT, è®©æ§ä»¶è‡ªå·±è®¡ç®—å…¶å¤§å° ä½¿ç”¨0dp, ç­‰ä»·äº â€œMATCH_CONSTRAINTâ€ å‰ä¸¤ç§è®¾ç½®çš„æ•ˆæœå’Œå…¶ä»–å¸ƒå±€ä¸€æ ·ã€‚æœ€åä¸€ä¸ªå°†ä»¥åŒ¹é…æ‰€è®¾ç½®çš„çº¦æŸçš„æ–¹å¼è°ƒæ•´Widgetçš„å¤§å°ï¼ˆä¸Šå›¾ä¸­ï¼ˆaï¼‰wrap_content,ï¼ˆbï¼‰0dpï¼‰ã€‚å¦‚æœè®¾ç½®æ¥è¾¹è·ï¼Œå®ƒä»¬ä¹Ÿå°†è¢«è®¡ç®—åœ¨å†…ï¼ˆä¸Šå›¾ä¸­ï¼ˆcï¼‰0dp with marginï¼‰ã€‚ é‡è¦ é’ˆå¯¹ConstrainLayoutä¸­çš„Widgetï¼Œæˆ‘ä»¬ä¸æ¨èä½¿ç”¨MATCH_PARENTã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨MATCH_CONSTRAINTé…åˆçº¦æŸ Widget çš„left/rightæˆ–è€…top/bottom åˆ°â€œparentâ€æ¥å®šä¹‰ç±»ä¼¼çš„è¡Œä¸ºã€‚ WRAP_CONTENTï¼šå¼ºåˆ¶æ‰§è¡Œçº¦æŸ (Added in 1.1)å¦‚æœä¸€ä¸ªå°ºå¯¸è®¾ç½®ä¸ºWRAP_CONTENTï¼Œåœ¨1.1ç‰ˆæœ¬ä¹‹å‰ï¼Œä»–ä»¬å°†ä¼šè¢«å®šä¹‰ä¸ºæ•°å€¼ç±»çš„å°ºå¯¸å¤§å°ï¼Œçº¦æŸå°†ä¸ä¼šé™åˆ¶ç»“æœå°ºå¯¸ã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¿™æ ·å·²ç»è¶³å¤Ÿæ»¡è¶³éœ€æ±‚å¹¶ä¸”è¿è¡Œé€Ÿåº¦ä¹Ÿæ˜¯å¾ˆå¿«çš„ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³ç”¨WRAP_CONTENTæ¥è®¾ç½®å°ºå¯¸ï¼ŒåŒæ—¶ä¹Ÿæƒ³å¼ºåˆ¶çº¦æŸæ¥é™åˆ¶ç»“æœå¸ƒå±€å°ºå¯¸ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å±æ€§ï¼š app:layout_constrainedWidth=â€true|falseâ€ app:layout_constrainedHeight=â€true|falseâ€ MATCH_CONSTRAINT(Added in 1.1)å½“Widgetçš„å°ºå¯¸è¢«è®¾ç½®ä¸ºMATCH_CONSTRAINTæ—¶ï¼Œé»˜è®¤çš„ç»“æœå°±æ˜¯ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„ç©ºé—´ã€‚å¦‚ä¸‹å‡ ä¸ªé¢å¤–çš„å±æ€§å¯ä»¥è¢«ä½¿ç”¨åˆ°ï¼š layout_constraintWidth_min and layout_constraintHeight_min : å°†ä¸ºè¿™ä¸ªå°ºå¯¸è®¾ç½®æœ€å°å€¼ layout_constraintWidth_max and layout_constraintHeight_max : å°†ä¸ºè¿™ä¸ªå°ºå¯¸è®¾ç½®æœ€å¤§å€¼ layout_constraintWidth_percent and layout_constraintHeight_percent : å°†æŒ‰ç›¸å¯¹çˆ¶å¸ƒå±€çš„ç™¾åˆ†æ¯”æ¥è®¾ç½®å°ºå¯¸ æœ€å°å€¼å’Œæœ€å¤§å€¼(Min and Max)ä¸ºminå’ŒmaxæŒ‡ç¤ºçš„å€¼å¯ä»¥æ˜¯Dpå•ä½ï¼Œä¹Ÿå¯ä»¥æ˜¯â€œwrapâ€ï¼Œå®ƒå°†ä½¿ç”¨ä¸WRAP_CONTENTå°†æ‰§è¡Œçš„å€¼ç›¸åŒçš„å€¼ ç™¾åˆ†æ¯”å°ºå¯¸(Percent dimension)è¦ä½¿ç”¨ç™¾åˆ†æ¯”ï¼Œä½ éœ€è¦åšå¦‚ä¸‹é…ç½®ï¼š å°ºå¯¸è®¾ç½®ä¸ºMATCH_CONSTRAINTï¼ˆ0dpï¼‰ é»˜è®¤å€¼è®¾ç½®ä¸ºpercent** app:layout_constraintWidth_default=â€percentâ€** æˆ–è€…app:layout_constraintHeight_default=â€percentâ€(å¤‡æ³¨: åœ¨ç‰ˆæœ¬1.1-beta1 and 1.1-beta2ä¸­è¿™äº›é…ç½®æ˜¯éœ€è¦çš„, ä½†æ˜¯åœ¨åç»­çš„ç‰ˆæœ¬ä¸­åªè¦ç™¾åˆ†æ¯”å±æ€§è¢«å®šä¹‰ï¼Œä¾¿ä¸å†éœ€è¦è¿™äº›é…ç½®) ç„¶åè®¾ç½®layout_constraintWidth_percentæˆ–è€… layout_constraintHeight_percentå±æ€§å€¼ï¼ŒèŒƒå›´0-1 æ¯”ç‡ä½ å¯ä»¥å®šä¹‰Widgetçš„å®½é«˜æ¯”ä¾‹ã€‚ä¸ºäº†å®ç°è¿™ä¸ªæ•ˆæœï¼Œå®½é«˜ä¸­è‡³å°‘åˆä¸€ä¸ªè®¾ç½®ä¸º0dp(i.e.,MATCH_CONSTRAINT)ï¼Œ ç„¶åç»™** layout_constraintDimensionRatio**æŒ‡å®šä¸€ä¸ªæ¯”ä¾‹å€¼ï¼Œå¦‚ä¸‹ 123&lt;Button android:layout_width=\"wrap_content\" android:layout_height=\"0dp\" app:layout_constraintDimensionRatio=\"1:1\" /&gt; è¿™æ®µä»£ç å°†è®¾ç½®buttonçš„å®½é«˜ä¸€æ ·ã€‚æ¯”ä¾‹å€¼å¯ä»¥é€šè¿‡å¦‚ä¸‹ä¸¤ç§æ–¹å¼è®¾ç½®ï¼š floatå€¼, ä»£è¡¨å®½é«˜çš„æ¯”ä¾‹ æ¯”ä¾‹å€¼æŒ‰ç…§â€œwidth:heightâ€çš„æ ¼å¼ä¹¦å†™ åœ¨å®½é«˜éƒ½è®¾ç½®ä¸ºMATCH_CONSTRAINT(0dp)æ—¶ï¼Œæˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿä½¿ç”¨æ¯”ä¾‹å±æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿè®¾ç½®æ»¡è¶³æ‰€æœ‰çº¦æŸçš„æœ€å¤§å°ºå¯¸å¹¶ä¿æŒæŒ‡å®šçš„çºµæ¨ªæ¯”ã€‚è¦æ ¹æ®å¦ä¸€ä¸ªçš„å°ºå¯¸çº¦æŸä¸€ä¸ªç‰¹å®šè¾¹ï¼Œå¯ä»¥é¢„å…ˆé™„åŠ â€œW,â€æˆ–â€œH,â€åˆ†åˆ«çº¦æŸå®½åº¦æˆ–é«˜åº¦ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå°ºå¯¸è¢«ä¸¤ä¸ªç›®æ ‡çº¦æŸ(å®½åº¦0dpå¹¶ä¸”åœ¨çˆ¶å¸ƒå±€å±…ä¸­)ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨æ¯”ä¾‹å€¼å‰æ·»åŠ â€œW(çº¦æŸå®½åº¦)â€æˆ–è€…â€œH(çº¦æŸé«˜åº¦)â€ï¼Œæ¥æŒ‡æ˜çº¦æŸå®½åº¦æˆ–è€…é«˜åº¦ã€‚ 12345&lt;Button android:layout_width=\"0dp\" android:layout_height=\"0dp\" app:layout_constraintDimensionRatio=\"H,16:9\" app:layout_constraintBottom_toBottomOf=\"parent\" app:layout_constraintTop_toTopOf=\"parent\"/&gt; å¦‚ä¸Šä»£ç ï¼Œå°†æŒ‰ç…§16:9çš„æ¯”ä¾‹æ¥è®¾ç½®buttonçš„é«˜åº¦ï¼Œè€Œå®½åº¦å°†åŒ¹é…çˆ¶å¸ƒå±€çš„çº¦æŸã€‚ä¹Ÿå°±æ˜¯è¿™ç§æƒ…å†µä¸‹å®½åº¦:é«˜åº¦=16:9ï¼Œç”±å®½åº¦æ¥å†³å®šé«˜åº¦ã€‚ é“¾(chain)é“¾åœ¨å•ä¸ªè½´ï¼ˆæ°´å¹³æˆ–å‚ç›´ï¼‰ä¸Šæä¾›ç»„ç¾¤è¡Œä¸ºã€‚å¦ä¸€ä¸ªè½´å¯ä»¥ç‹¬ç«‹çº¦æŸ åˆ›å»ºä¸€ä¸ªé“¾å¦‚æœä¸€ç»„Widgetsé€šè¿‡åŒå‘è¿æ¥é“¾æ¥åœ¨ä¸€èµ·ï¼Œåˆ™å®ƒä»¬è¢«è§†ä¸ºé“¾ã€‚ï¼ˆä¸‹å›¾å±•ç¤ºçš„æ˜¯ä¸€ä¸ªç”±ä¸¤ä¸ªWidgetç»„æˆçš„æœ€å°çš„é“¾ï¼‰ é“¾å¤´é“¾ç”±åœ¨é“¾çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸Šè®¾ç½®çš„å±æ€§æ§åˆ¶(æˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºé“¾çš„â€œå¤´â€) å¤´éƒ¨æ˜¯æ°´å¹³é“¾çš„æœ€å·¦ä¾§Widgetï¼Œå‚ç›´é“¾çš„æœ€é¡¶éƒ¨Widgetã€‚ é“¾é—´è¾¹è·å¦‚æœåœ¨åŒå‘è¿æ¥ä¸ŠæŒ‡å®šäº†è¾¹è·ï¼Œåˆ™ä»–ä»¬å°†ä¼šè¢«è®¡ç®—åœ¨å†…ã€‚åœ¨æ‰©æ•£é“¾çš„æƒ…å†µä¸‹ï¼Œå°†ä»åˆ†é…çš„ç©ºé—´ä¸­å‡å»è¿™äº›è¾¹è· é“¾Styleåœ¨é“¾çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸Šè®¾ç½®å±æ€§layout_constraintHorizoâ€‹â€‹ntal_chainStyleæˆ–layout_constraintVertical_chainStyleæ—¶ï¼Œé“¾çš„è¡Œä¸ºå°†æ ¹æ®æŒ‡å®šçš„æ ·å¼æ›´æ”¹ï¼ˆé»˜è®¤ä¸ºCHAIN_SPREADï¼‰ CHAIN_SPREAD â€“ å…ƒç´ å°†ç­‰é—´è·æ•£å¼€(é»˜è®¤style) Weightedé“¾ â€“ CHAIN_SPREAD æ¨¡å¼, å½“ä¸€äº›Widgetsè®¾ç½®ä¸ºMATCH_CONSTRAINT,ä»–ä»¬å°†è¢«åˆ†é…æ‰€æœ‰å¯ç”¨ç©ºé—´ã€‚ CHAIN_SPREAD_INSIDE â€“ ç›¸ä¼¼åœ°, ä½†æ˜¯é“¾çš„ä¸¤ç«¯ä¸ä¼šè¢«åˆ†é…ç©ºé—´ã€‚ CHAIN_PACKED â€“ é“¾ä¸Šå…ƒç´ ä¼šè¢«æ‰“åŒ…åœ¨ä¸€èµ·ã€‚å­é¡¹çš„æ°´å¹³æˆ–å‚ç›´åå·®å±æ€§å°†å½±å“æ•´ä¸ªæ‰“åŒ…å…ƒç´ çš„å®šä½ã€‚ æƒé‡é“¾é“¾çš„é»˜è®¤è¡Œä¸ºæ˜¯åœ¨å¯ç”¨ç©ºé—´ä¸­å¹³å‡åˆ†å¸ƒå…ƒç´ ã€‚å¦‚æœä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ä½¿ç”¨MATCH_CONSTRAINTï¼Œåˆ™å®ƒä»¬å°†ä½¿ç”¨å¯ç”¨çš„ç©ºç™½ç©ºé—´(ä»–ä»¬ä¹‹é—´å¹³ç­‰åˆ†é…)ã€‚layout_constraintHorizoâ€‹â€‹ntal_weightå’Œlayout_constraintVertical_weightå±æ€§å°†æ§åˆ¶å¦‚ä½•ä½¿ç”¨MATCH_CONSTRAINTåœ¨å…ƒç´ ä¹‹é—´åˆ†é…ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨MATCH_CONSTRAINTçš„åŒ…å«ä¸¤ä¸ªå…ƒç´ çš„é“¾ä¸Šï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä½¿ç”¨æƒé‡2ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä½¿ç”¨æƒé‡1ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ å ç”¨çš„ç©ºé—´å°†æ˜¯ç¬¬äºŒä¸ªå…ƒç´ å ç”¨çš„ç©ºé—´çš„ä¸¤å€ã€‚ è¾¹è·å’Œé“¾ï¼ˆ1.1ç‰ˆæœ¬ï¼‰åœ¨é“¾ä¸­çš„å…ƒç´ ä¸Šä½¿ç”¨è¾¹è·æ—¶ï¼Œè¾¹è·æ˜¯ç›¸åŠ çš„ä¾‹å¦‚ï¼Œåœ¨æ°´å¹³é“¾ä¸Šï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ å®šä¹‰äº†10dpçš„å³è¾¹è·è€Œä¸‹ä¸€ä¸ªå…ƒç´ å®šä¹‰äº†5dpçš„å·¦è¾¹è·ï¼Œåˆ™è¿™ä¸¤ä¸ªå…ƒç´ ä¹‹é—´äº§ç”Ÿçš„è¾¹è·ä¸º15dpã€‚åœ¨è®¡ç®—é“¾ç”¨äºå®šä½é¡¹ç›®çš„å‰©ä½™ç©ºé—´æ—¶ï¼Œä¼šåŒæ—¶è€ƒè™‘é¡¹ç›®åŠå…¶è¾¹è·ã€‚å‰©ä½™ç©ºé—´ä¸åŒ…å«è¾¹è·ã€‚ è™šæ‹ŸåŠ©æ‰‹(Virtual Helper objects)é™¤äº†ä¹‹å‰è¯¦è¿°çš„å†…åœ¨åŠŸèƒ½å¤–ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ConstraintLayoutä¸­çš„ç‰¹æ®Šå¸®åŠ©ç¨‹åºå¯¹è±¡æ¥å¸®åŠ©æ‚¨è¿›è¡Œå¸ƒå±€ã€‚ç°åœ¨ï¼ŒGuidelineå¯ä»¥å¸®åŠ©ä½ åˆ›å»ºç›¸å¯¹äºConstraintLayoutå®¹å™¨å®šä½çš„æ°´å¹³å’Œå‚ç›´Guidelineã€‚ç„¶åWidgetså¯ä»¥è¢«çº¦æŸåˆ°è¿™äº›Guidelineä¸Šã€‚åœ¨1.1ç‰ˆæœ¬ä¸­ï¼ŒBarrierå’ŒGroupä¹Ÿåˆ«åŠ å…¥è¿›æ¥ã€‚ ä¼˜åŒ–å™¨(in 1.1)åœ¨1.1ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬æä¾›çº¦æŸä¼˜åŒ–å™¨ã€‚ä½ å¯ä»¥é€šè¿‡å°†æ ‡è®°appï¼šlayout_optimizationLevelæ·»åŠ åˆ°ConstraintLayoutå…ƒç´ æ¥å†³å®šåº”ç”¨å“ªäº›ä¼˜åŒ–ã€‚ none : ä¸åšä»»ä½•ä¼˜åŒ– standard : é»˜è®¤å€¼. åªä¼˜åŒ– direct å’Œ barrier çº¦æŸ direct : ä¼˜åŒ– direct çº¦æŸ barrier : ä¼˜åŒ– barrier çº¦æŸ chain : ä¼˜åŒ– chain çº¦æŸ (è¯•éªŒç‰ˆ) dimensions : ä¼˜åŒ– dimensions æµ‹é‡ (è¯•éªŒç‰ˆ), å‡å°‘match constrainså…ƒç´ çš„æµ‹é‡æ¬¡æ•°ã€‚ æ­¤å±æ€§æ˜¯ä¸€ä¸ªæ©ç ï¼Œå› æ­¤æ‚¨å¯ä»¥é€šè¿‡åˆ—å‡ºæ‰€éœ€çš„ä¼˜åŒ–æ¥å†³å®šæ‰“å¼€æˆ–å…³é—­ç‰¹å®šçš„ä¼˜åŒ–ã€‚ä¾‹å¦‚ 1app:layout_optimizationLevel=\"direct|barrier|chain\"","link":"/2018/10/01/ã€ŠAndroid åŸºç¡€ï¼ˆå››åå…«ï¼‰ã€‹ConstrainLayoutã€è¯‘ã€‘/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆäº”ï¼‰","text":"å‰è¨€å†™äº†ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œè®²äº†ä¸‹è¿™ä¸ªå®ç°å¤©æ°”é¢„æŠ¥çš„ä½¿ç”¨å†…å®¹ï¼Œç°åœ¨åˆåˆ°äº†çœ‹ä»£ç çš„æ—¶å€™ï¼Œä¸»è¦è¿˜æ˜¯è´´ä»£ç ï¼Œç„¶åæ·»åŠ è¶³å¤Ÿçš„æ³¨é‡Šã€‚ èšåˆæ•°æ®SDKé…ç½® å°†juhe_sdk_v_X_X.jarä»¥åŠarmeabiæ–‡ä»¶å¤¹(å†…åŒ…å«libJuheSDK_v_X_X.so)æ·»åŠ åˆ°å·¥ç¨‹ä¸­libsæ–‡ä»¶å¤¹ä¸‹ æ‰“å¼€Moudle setting -&gt; app -&gt; Dependencies,æ·»åŠ juhe_sdk_v_X_X.jar, åœ¨AndroidManifest.xmlä¸­,åŠ å…¥æ‰€éœ€æƒé™: 12345&lt;uses-permission android:name=\"android.permission.READ_PHONE_STATE\" /&gt;&lt;uses-permission android:name=\"android.permission.INTERNET\" /&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" /&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\" /&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" /&gt; æ·»åŠ æ‰€ç”³è¯·çš„openid(è¿™ä¸ªæ˜¯åœ¨Juheå®˜ç½‘ä¸Šç”³è¯·çš„).åœ¨ç»§æ‰¿Applicationç±»ä¹‹å, åœ¨AndroidManifest.xmlä¸­,åŠ å…¥android:nameå±æ€§,å€¼ä¸ºç»§æ‰¿Applicationçš„ç±»çš„è·¯å¾„. åˆå§‹åŒ–èšåˆæ•°æ®SDK 1234567891011import android.app.Application;public class MyApplication extends Application { @Override public void onCreate() { // TODO Auto-generated method stub super.onCreate(); JuheSDKInitializer.initialize(getApplicationContext()); }} å·¥ç¨‹ä»£ç MyApplication.java 1234567891011package com.onlyloveyd.weather;import android.app.Application;import com.thinkland.sdk.android.JuheSDKInitializer;public class MyApplication extends Application { @Override public void onCreate() { // TODO Auto-generated method stub super.onCreate(); JuheSDKInitializer.initialize(getApplicationContext());//åˆå§‹åŒ–Juheæ•°æ®SDK }} åŸå¸‚é€‰æ‹©ç•Œé¢ChooseCityActivity.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108package com.onlyloveyd.weather;import ......;public class ChooseCityActivity extends Activity { public static final String TAG = \"ChooseCityActivity\"; @Bind(R.id.tv_choose_city_title) TextView tvChooseCityTitle; @Bind(R.id.et_search_city) EditText etSearchCity; @Bind(R.id.tv_hotcity) TextView tvHotcity; @Bind(R.id.gv_hotcity) GridView gvHotcity; private ArrayList&lt;CityItem&gt; mSupportCityList;//æ‰€æœ‰åŸå¸‚List private ArrayList&lt;CityItem&gt; mSearchCityList;//åŸå¸‚æŸ¥è¯¢ç»“æœList private CityAdapter mCityAdapter;//åŸå¸‚GridViewçš„Adapter @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); requestWindowFeature(Window.FEATURE_NO_TITLE); setContentView(R.layout.citylist);//åŸå¸‚é€‰æ‹©ç•Œé¢ ButterKnife.bind(this);//ä¾èµ–æ³¨å…¥ mSupportCityList = new ArrayList&lt;CityItem&gt;(); mSearchCityList = new ArrayList&lt;CityItem&gt;(); //è®¾ç½®å¸¦shapeæ¨¡å¼çš„ç¼–è¾‘æ¡†çš„èƒŒæ™¯é¢œè‰² //GradientDrawable myGrad = (GradientDrawable)mSearchEditView.getBackground(); //myGrad.setColor(getResources().getColor(R.color.choosecitysearchbackground)); //ç»™åŸå¸‚åç¼–è¯‘æ¡†æ·»åŠ æ–‡æœ¬å˜åŒ–çš„è§‚å¯Ÿè€… etSearchCity.addTextChangedListener(new TextWatcher() { @Override public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) { } @Override public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) { mSearchCityList.clear();//åŸå¸‚æŸ¥è¯¢ç»“æœlistæ¸…ç©º String searchkey = charSequence.toString(); Log.e(TAG, \" city size \" + mSupportCityList.size()); for (int j = 0; j &lt; mSupportCityList.size(); j++) { CityItem item = mSupportCityList.get(j); if (searchkey.contains(item.getDistrict()) || item.getDistrict().contains(searchkey)) {//éå†æŸ¥è¯¢ mSearchCityList.add(item); } } mCityAdapter.setCityList(mSearchCityList); mCityAdapter.notifyDataSetChanged(); } @Override public void afterTextChanged(Editable editable) { } }); mCityAdapter = new CityAdapter(this, mSupportCityList); gvHotcity.setAdapter(mCityAdapter); getSupportCity(this); } private void getSupportCity(Context context) { /**Juhe SDK å°è£…çš„æ–¹æ³• * è¯·æ±‚çš„æ–¹æ³• å‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•° å½“å‰è¯·æ±‚çš„context ç¬¬äºŒä¸ªå‚æ•° æ¥å£id ç¬¬ä¸‰äºŒä¸ªå‚æ•° æ¥å£è¯·æ±‚çš„url ç¬¬ å››ä¸ªå‚æ•° æ¥å£è¯·æ±‚çš„æ–¹å¼ * ç¬¬äº”ä¸ªå‚æ•° æ¥å£è¯·æ±‚çš„å‚æ•°,é”®å€¼å¯¹com.thinkland.sdk.android.Parametersç±»å‹; ç¬¬å…­ä¸ªå‚æ•° * è¯·æ±‚çš„å›è°ƒæ–¹æ³•,com.thinkland.sdk.android.DataCallBack; * */ JuheData.executeWithAPI(context, 39, \"http://v.juhe.cn/weather/citys\", JuheData.GET, null, new DataCallBack() { @Override public void onSuccess(int statusCode, String responseString) { try { //è§£æJSONæ•°æ® JSONObject jsonObject = new JSONObject(responseString); JSONArray result = jsonObject.getJSONArray(\"result\"); for (int i = 0; i &lt; result.length(); i++) { JSONObject object = (JSONObject) result.get(i); CityItem item = new CityItem(object.getString(\"id\"), object.getString(\"province\"), object.getString(\"city\"), object.getString(\"district\")); mSupportCityList.add(item);//æŸ¥è¯¢ç»“æœæ·»åŠ  mCityAdapter.notifyDataSetChanged();//notifyæ•°æ®å˜åŒ– } } catch (JSONException e) { e.printStackTrace(); } } @Override public void onFinish() { } @Override public void onFailure(int statusCode, String responseString, Throwable throwable) { Log.e(TAG, responseString); } }); } @Override protected void onResume() { super.onResume(); } @Override protected void onPause() { etSearchCity.setText(null);//é¿å…onBackPressçš„æ—¶å€™ç¼–è¾‘æ¡†ä¸­è¿˜æœ‰æ•°æ® super.onPause(); }} èšåˆæ•°æ®é’ˆå¯¹æ”¯æŒçš„åŸå¸‚è¿”å›çš„JSONæ•°æ®æ ¼å¼ä¸º { â€œresultcodeâ€:â€œ200â€, â€œreasonâ€:â€œsuccessedâ€, â€œresultâ€:[ { â€œidâ€:â€œ1â€, /åŸå¸‚ID/ â€œprovinceâ€:â€œåŒ—äº¬â€,/çœä»½åç§°/ â€œcityâ€:â€œåŒ—äº¬â€, /åŸå¸‚/ â€œdistrictâ€:â€œåŒ—äº¬â€ /åŸå¸‚/åŒºåç§°/ }, { â€œidâ€:â€œ2â€, â€œprovinceâ€:â€œåŒ—äº¬â€, â€œcityâ€:â€œåŒ—äº¬â€, â€œdistrictâ€:â€œæµ·æ·€â€ }, } } æŒ‰ç…§è¿™ç§æ ¼å¼è§£æå‡ºJSONæ•°æ® //å¤©æ°”æ˜¾ç¤ºç•Œé¢ WeatherActivity.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187package com.onlyloveyd.weather;import XXXX;public class WeatherActivity extends Activity { private static final String TAG = \"MainActivity\"; @Bind(R.id.imageview) ImageView imageview; @Bind(R.id.tv_cityname) TextView tvCityname; @Bind(R.id.tv_date) TextView tvDate; @Bind(R.id.iv_zhengfu) ImageView ivZhengfu; @Bind(R.id.iv_tenth) ImageView ivTenth; @Bind(R.id.iv_geth) ImageView ivGeth; @Bind(R.id.iv_du) ImageView ivDu; @Bind(R.id.iv_weather_fa) ImageView ivWeatherFa; @Bind(R.id.tv_weather) TextView tvWeather; @Bind(R.id.iv_weather_fb) ImageView ivWeatherFb; @Bind(R.id.tv_temp) TextView tvTemp; @Bind(R.id.tv_humidity) TextView tvHumidity; @Bind(R.id.tv_wind) TextView tvWind; @Bind(R.id.tv_refreshtime) TextView tvRefreshtime; @Bind(R.id.gv_future) GridView gvFuture; WeatherInfo.ResultBean.SkBean mSk; WeatherInfo.ResultBean.TodayBean mToday; FutureAdapter mFutureAdapter; ArrayList&lt;WeatherInfo.ResultBean.FutureBean&gt; mFutureList; private Context mContext; private String mCityName = null; /** * Called when the activity is first created. */ @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); mContext = this; requestWindowFeature(Window.FEATURE_NO_TITLE); setContentView(R.layout.weather); ButterKnife.bind(this);//ä¾èµ–æ³¨å…¥ Intent intent = getIntent(); mCityName = intent.getStringExtra(\"cityname\");//ä»é€‰æ‹©åŸå¸‚ç•Œé¢é€‰æ‹©åŸå¸‚ä¼ é€’åˆ°è¿™ä¸ªActivity mFutureList = new ArrayList&lt;WeatherInfo.ResultBean.FutureBean&gt;();//æœªæ¥7å¤©é¢„æŠ¥çš„List mFutureAdapter = new FutureAdapter(this, mFutureList);//æœªæ¥å¤©æ°”é¢„æŠ¥çš„GridViewçš„Adapter gvFuture.setAdapter(mFutureAdapter); } @Override protected void onResume() { super.onResume(); mFutureList.clear(); getWeatherInfoByCity(this, mCityName);//æŸ¥è¯¢å¤©æ°”ä¿¡æ¯ï¼ŒåŒ…å«çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œé€Ÿåº¦è¿˜ç®—å¿«ï¼Œæ²¡æœ‰å•ç‹¬ä½¿ç”¨çº¿ç¨‹ tvCityname.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { onBackPressed(); } }); } private void getWeatherInfoByCity(Context context, String city) { Log.e(TAG, \"getWeatherInfoByCity\"); Parameters param = new Parameters(); param.add(\"cityname\", city); param.add(\"format\", 2); JuheData.executeWithAPI(context, 39, \"http://v.juhe.cn/weather/index\", JuheData.GET, param, new DataCallBack() { @Override public void onSuccess(int statusCode, String responseString) { Gson gson = new Gson(); try { JSONObject jsonObject = new JSONObject(responseString); JSONObject resultjson = jsonObject.getJSONObject(\"result\"); JSONObject skjson = resultjson.getJSONObject(\"sk\"); JSONObject todayjson = resultjson.getJSONObject(\"today\"); JSONArray futurejson = resultjson.getJSONArray(\"future\"); mSk = gson.fromJson(skjson.toString(), WeatherInfo.ResultBean.SkBean.class); mToday = gson.fromJson(todayjson.toString(), WeatherInfo.ResultBean.TodayBean.class); Log.e(TAG, futurejson.get(2).toString()); for (int i = 0; i &lt; futurejson.length(); i++) { WeatherInfo.ResultBean.FutureBean futureBean = gson.fromJson(futurejson.get(i).toString(), WeatherInfo.ResultBean.FutureBean.class); Log.e(TAG, futureBean.toString()); mFutureList.add(futureBean); } mFutureAdapter.setmFutureList(mFutureList); gvFuture.setAdapter(mFutureAdapter); mFutureAdapter.notifyDataSetChanged(); tvCityname.setText(mCityName); tvDate.setText(mToday.getDate_y() + \" \" + mToday.getWeek()); tvWeather.setText(mToday.getWeather()); tvTemp.setText(mToday.getTemperature()); tvHumidity.setText(mSk.getHumidity()); tvWind.setText(mSk.getWind_direction() + \" \" + mSk.getWind_strength()); tvRefreshtime.setText(getString(R.string.refreshtimesuffix) + mSk.getTime()); String fa = mToday.getWeather_id().getFa(); String fb = mToday.getWeather_id().getFb(); if (fa.equals(fb)) { ivWeatherFa.setImageResource(getWeatherDrawableByWeatherId(\"w_\", fa)); ivWeatherFb.setImageDrawable(null); } else { ivWeatherFa.setImageResource(getWeatherDrawableByWeatherId(\"w_\", fa)); ivWeatherFb.setImageResource(getWeatherDrawableByWeatherId(\"w_\", fb)); } int tmp = Integer.valueOf(mSk.getTemp()); if (tmp &lt; 0) { ivZhengfu.setImageResource(R.drawable.fuhao); int tenth = (0 - tmp) / 10; int geth = (0 - tmp) % 10; ivTenth.setImageResource(getWeatherDrawableByWeatherId(\"org4_widget_nw\", String.valueOf(tenth))); ivGeth.setImageResource(getWeatherDrawableByWeatherId(\"org4_widget_nw\", String.valueOf(geth))); } else { ivZhengfu.setImageDrawable(null); int tenth = tmp / 10; int geth = tmp % 10; ivTenth.setImageResource(getWeatherDrawableByWeatherId(\"org4_widget_nw\", String.valueOf(tenth))); ivGeth.setImageResource(getWeatherDrawableByWeatherId(\"org4_widget_nw\", String.valueOf(geth))); } } catch (JSONException e) { e.printStackTrace(); } } @Override public void onFinish() { // TODO Auto-generated method stub //Toast.makeText(getApplicationContext(), \"finish\", Toast.LENGTH_SHORT).show(); } @Override public void onFailure(int statusCode, String responseString, Throwable throwable) { // TODO Auto-generated method stub Log.e(TAG, responseString); } }); } private int getWeatherDrawableByWeatherId(String suffix, String fa) { String res = suffix + fa; int resid = getResources().getIdentifier(res, \"drawable\", getPackageName()); return resid; } @Override public boolean onTouchEvent(MotionEvent event) { final int action = event.getAction(); float startX = 0; switch (action) { case MotionEvent.ACTION_DOWN: startX = event.getRawX(); break; case MotionEvent.ACTION_UP: float endX = event.getRawX(); if ((int) (endX - startX) &gt; 10) { onBackPressed(); } break; default: break; } return true; }} å…·ä½“çš„å†…å®¹è¯·æŸ¥é˜…æºä»£ç ï¼š https://code.csdn.net/poorkick/weatherclient/tree/master æœ‰çœ‹ä¸æ‡‚çš„å†…å®¹å¯ä»¥ç•™è¨€ï¼Œæ™šä¸Šç»Ÿä¸€å›å¤ã€‚ ä»‹ç»ä¸€ä¸ªIntellijæ’ä»¶ â€”â€“ Gson Format, é€šè¿‡Jsonæ ¼å¼å¿«é€Ÿç”ŸæˆJava Beanç±»ï¼Œæé«˜å¼€å‘æ•ˆç‡ å…¶å®æœ‰å¾ˆå¤šå¾ˆå¥½ç”¨çš„æ’ä»¶å¯ä¾›é€‰æ‹©ï¼Œä¸ä»…å¯ä»¥æé«˜æ•ˆç‡ï¼Œè¿˜å¯ä»¥å¢åŠ è‡ªå·±å¯¹å¼€å‘çš„å…´è¶£ï¼Œå¯ä»¥å»å¤šäº†è§£ä¸€ä¸‹ã€‚","link":"/2016/05/17/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆäº”ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆäºŒï¼‰","text":"ç•Œé¢ç»„æˆ è½½å…¥ç•Œé¢ æ˜¾ç¤ºç•Œé¢ Activityä¸¤ä¸ªï¼Œä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºè½½å…¥ç•Œé¢ï¼Œä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºå¤©æ°”ä¿¡æ¯ ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184public class MyActivity extends Activity { private static final String TAG = \"WelcomeActiivty\"; private ProgressBar mLoadingBar; //è½½å…¥è¿›åº¦æ¡ private TextView mVersionName; //è½½å…¥ç•Œé¢æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ private AsyncTask mLoadingTask; //åå°è½½å…¥å¼‚æ­¥ä»»åŠ¡ private ArrayList&lt;WeatherInfo&gt; weatherInfoList; //ç”¨æ¥ä¿å­˜å¤©æ°”ä¿¡æ¯ //å¤©æ°”ä¿¡æ¯æ¥å£ private static final String frontUrl = \"http://www.weather.com.cn/data/cityinfo/\"; private static final String suffix = \".html\"; //ä¸ä¸Šé¢é…åˆä½¿ç”¨ï¼Œä¸­é—´æ·»åŠ åŸå¸‚code,å¦‚ //http://www.weather.com.cn/data/cityinfo/101010100.html //æ‰€æœ‰åŸå¸‚çš„åˆ—è¡¨ private int[] mCityCodeList = {101010100, 101010300, 101010400, 101010500, 101010600, 101010700, 101010800, 101010900, 101011000, 101011100, 101011200, 101011300, 101011400, 101011500, 101011600, 101011700, 101011800, 101011900, 101012000, 101012100, 101012200, 101010200, 101030100, 101030300, 101030400, 101030500, 101030600, 101031400, 101030800, 101030900, 101031000, 101031100, 101031200, 101030200, 101030700, 101020100, 101020300, 101020500, 101020600, 101021300, 101020800, 101020900, 101021000, 101021100, 101021200, 101020200, 101020700, 101090101, 101090301, 101090402, 101090501, 101091101, 101090701, 101090801, 101090901, 101091001, 101090201, 101090601, 101180101, 101180301, 101180401, 101180501, 101180601, 101180701, 101180801, 101180901, 101181001, 101181101, 101181201, 101181301, 101181401, 101181501, 101181601, 101181701, 101181801, 101180201, 101220101, 101220301, 101220401, 101220501, 101220601, 101220701, 101220801, 101220901, 101221001, 101221101, 101221201, 101221301, 101221401, 101221501, 101221601, 101221701, 101220201, 101210101, 101211101, 101210201, 101210301, 101210901, 101210501, 101210601, 101210701, 101210801, 101211001, 101210401, 101040100, 101040300, 101040400, 101040500, 101040600, 101040700, 101040800, 101040900, 101041000, 101041100, 101041200, 101041300, 101041400, 101041500, 101041600, 101041700, 101041800, 101041900, 101042000, 101042100, 101042200, 101042300, 101042400, 101042500, 101042600, 101042700, 101042800, 101042900, 101043000, 101043100, 101043200, 101043300, 101043400, 101043600, 101043700, 101040200, 101230101, 101230501, 101230601, 101230701, 101230509, 101230901, 101230201, 101230301, 101230401, 101230801, 101160101, 101160301, 101160401, 101160501, 101160601, 101161401, 101160801, 101160901, 101161001, 101161101, 101161201, 101161301, 101160201, 101160701, 101280101, 101280301, 101280401, 101280501, 101280601, 101280701, 101280800, 101280901, 101281001, 101281101, 101281201, 101281301, 101281401, 101281501, 101281601, 101281701, 101281801, 101281901, 101282001, 101282101, 101280201, 101300101, 101300301, 101300401, 101300501, 101300601, 101301401, 101300801, 101300901, 101301001, 101301101, 101301201, 101301301, 101300201, 101300701, 101260101, 101260301, 101260401, 101260906, 101260601, 101260701, 101260801, 101260201, 101260501, 101290101, 101290301, 101290601, 101290701, 101290801, 101290901, 101291001, 101291101, 101291201, 101291301, 101291401, 101291501, 101291601, 101290201, 101290401, 101290501, 101080101, 101080301, 101080401, 101080501, 101081201, 101080701, 101080801, 101080901, 101081000, 101081101, 101080201, 101080601, 101240101, 101240301, 101240401, 101240501, 101241101, 101240701, 101240801, 101240901, 101241001, 101240201, 101240601, 101200101, 101200501, 101200801, 101200901, 101201001, 101201101, 101201201, 101201301, 101201401, 101201501, 101201601, 101201701, 101200201, 101200301, 101200401, 101200601, 101200701, 101270101, 101270301, 101270401, 101270501, 101270601, 101270701, 101270801, 101270901, 101271001, 101271101, 101271201, 101271301, 101271401, 101271501, 101271601, 101271701, 101271801, 101271901, 101272001, 101272101, 101270201, 101170101, 101170501, 101170401, 101170201, 101170301, 101150101, 101150301, 101150801, 101150501, 101150601, 101150701, 101150201, 101150401, 101120101, 101120601, 101120901, 101121001, 101121101, 101121201, 101121301, 101121401, 101121501, 101121601, 101121701, 101120201, 101120301, 101120401, 101120501, 101120701, 101120801, 101110101, 101110300, 101110401, 101111001, 101110601, 101110701, 101110801, 101110901, 101110200, 101110501, 101100101, 101100701, 101100801, 101100901, 101101001, 101100501, 101100201, 101100301, 101100401, 101100601, 101101100, 101130101, 101130301, 101130401, 101130501, 101130601, 101130701, 101130801, 101130901, 101131001, 101131101, 101131201, 101131301, 101131401, 101131501, 101131601, 101130201, 101140101, 101140301, 101140701, 101140501, 101140601, 101140201, 101140401, 101340101, 101340201, 101340401, 101310101, 101310201, 101310202, 101310203, 101310204, 101310205, 101310206, 101310207, 101310208, 101310209, 101310210, 101310211, 101310212, 101310214, 101310215, 101310216, 101310217, 101310220, 101310221, 101310222, 101310102, 101250101, 101250301, 101250401, 101250501, 101250601, 101250700, 101250801, 101250901, 101251001, 101251101, 101251201, 101251301, 101251401, 101251501, 101250201, 101190101, 101190301, 101190401, 101190501, 101190601, 101191301, 101190801, 101190901, 101191001, 101191101, 101191201, 101190201, 101190701, 101050101, 101050301, 101050401, 101050501, 101050601, 101051301, 101050801, 101050901, 101051002, 101051101, 101051201, 101050201, 101050701, 101060101, 101060301, 101060401, 101060901, 101060601, 101060701, 101060801, 101060201, 101060501, 101070101, 101070301, 101070401, 101070501, 101070601, 101071401, 101070801, 101070901, 101071001, 101071101, 101071201, 101071301, 101070201, 101070701}; private int mAvailableLinks = mCityCodeList.length;//ç”¨æ¥ä¿å­˜å¯ç”¨çš„æŸ¥è¯¢ç»“æœï¼Œåé¢ç”¨æ¥åˆ¤æ–­è½½å…¥æ˜¯å¦å®Œæˆ @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); requestWindowFeature(Window.FEATURE_NO_TITLE);//æ²¡æœ‰æ ‡é¢˜çš„ç•Œé¢æ•ˆæœ setContentView(R.layout.welcome); weatherInfoList = new ArrayList&lt;WeatherInfo&gt;(); mLoadingBar = (ProgressBar) findViewById(R.id.loadingbar); mLoadingBar.setProgress(0); mLoadingBar.setMax(mCityCodeList.length);//è¿›åº¦æ¡ mVersionName = (TextView) findViewById(R.id.versionname); mVersionName.setText(getString(R.string.app_name).toString() + \" \" + getLocalVersionName(this)); final RequestQueue mRequestQueue = Volley.newRequestQueue(this); AsyncTask mLoadingDataTask = new AsyncTask() { @Override protected void onProgressUpdate(Object[] values) { super.onProgressUpdate(values); int progress = mLoadingBar.getProgress(); mLoadingBar.setProgress(progress + 1);//æ›´æ–°è¿›åº¦æ¡ if (mLoadingBar.getProgress() == mAvailableLinks) { showWeatherInfo(); } } @Override protected Object doInBackground(Object[] objects) { //æŸ¥è¯¢æ‰€æœ‰çš„ä¿¡æ¯å¹¶è§£æå‡ºæ¥ä¿å­˜åˆ°ArrayListä¸­ for (int i = 0; i &lt; mCityCodeList.length; i++) { String uri = frontUrl + String.valueOf(mCityCodeList[i]) + suffix; JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(uri, null, new Response.Listener&lt;JSONObject&gt;() { @Override public void onResponse(JSONObject jsonObject) { try { JSONObject weatherinfojson = jsonObject.getJSONObject(\"weatherinfo\"); WeatherInfo newWeatherInfo = new WeatherInfo( weatherinfojson.getString(\"city\"), weatherinfojson.getString(\"cityid\"), weatherinfojson.getString(\"temp1\"), weatherinfojson.getString(\"temp2\"), weatherinfojson.getString(\"weather\"), weatherinfojson.getString(\"img1\"), weatherinfojson.getString(\"img2\"), weatherinfojson.getString(\"ptime\")); publishProgress(); weatherInfoList.add(newWeatherInfo); } catch (Exception e) { mAvailableLinks--; e.printStackTrace(); } } }, new Response.ErrorListener() { @Override public void onErrorResponse(VolleyError volleyError) { mAvailableLinks--; Log.e(\"TAG\", volleyError.getMessage(), volleyError); } }); //æ·»åŠ åˆ°RequestQueueä¸­ mRequestQueue.add(jsonObjectRequest); } return null; } }; mLoadingDataTask.execute(); } /** * è·å–æœ¬åœ°è½¯ä»¶ç‰ˆæœ¬åç§° */ public static String getLocalVersionName(Context ctx) { String localVersion = \"\"; try { PackageInfo packageInfo = ctx.getApplicationContext() .getPackageManager() .getPackageInfo(ctx.getPackageName(), 0); localVersion = packageInfo.versionName; } catch (PackageManager.NameNotFoundException e) { e.printStackTrace(); } return localVersion; } //è·³è½¬åˆ°æ˜¾ç¤ºå¤©æ°”ä¿¡æ¯çš„ç•Œé¢ï¼Œå¹¶ä¼ é€’Listæ•°æ® private void showWeatherInfo() { Bundle bundle = new Bundle(); bundle.putSerializable(Utils.WEATHERINFO, (Serializable) weatherInfoList); Intent intent = new Intent(MyActivity.this, MainActivity.class); intent.putExtra(Utils.WEATHERINFO, bundle); startActivity(intent); finish();//finishæ‰è¿™ä¸ªActivity,å¦åˆ™è¿”å›é”®å¯ä»¥å›åˆ°è½½å…¥ç•Œé¢ é‚£å°±å°´å°¬äº†ï¼ }} Activityä¹‹å‰ä¼ é€’æ•°æ®çš„æ–¹å¼ Bundle public void putAll(Bundle bundle) public boolean hasFileDescriptors() public void putByte(String key, byte value) public void putChar(String key, char value) public void putShort(String key, short value) public void putFloat(String key, float value) public void putCharSequence(String key, CharSequence value) public void putParcelable(String key, Parcelable value) public void putSize(String key, Size value) public void putSizeF(String key, SizeF value) public void putParcelableArray(String key, Parcelable[] value) public void putParcelableArrayList(String key, ArrayList&lt; xx extends Parcelable&gt; value) public void putSparseParcelableArray(String key, SparseArray&lt; xx extends Parcelable&gt; value) public void putIntegerArrayList(String key, ArrayList value) public void putStringArrayList(String key, ArrayList value) public void putCharSequenceArrayList(String key, ArrayList value) public void putSerializable(String key, Serializable value) public void putByteArray(String key, byte[] value) public void putShortArray(String key, short[] value) public void putCharArray(String key, char[] value) public void putFloatArray(String key, float[] value) public void putCharSequenceArray(String key, CharSequence[] value) public void putBundle(String key, Bundle value) public void putBinder(String key, IBinder value) å¾ˆå¤šç±»ä¼¼çš„æ–¹æ³•ï¼ŒBundleå°±æ˜¯ä¸€ä¸ªè½½ä½“ï¼Œç”¨ä»€ä¹ˆæ–¹å¼å°è£…åä¼ é€’ï¼Œåœ¨å¯¹åº”ç«¯å°±ç”¨ä»€ä¹ˆæ–¹å¼æŠŠå®ƒè§£è¯»å‡ºæ¥ é€šè¿‡showWeatherInfoæ–¹æ³•è·³è½¬åˆ°æŸ¥è¯¢åˆ°çš„æ‰€æœ‰å¤©æ°”çš„æ˜¾ç¤ºç•Œé¢ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« è®²è§£ã€‚ çœ‹ä¸‹æ•ˆæœå›¾ï¼š","link":"/2016/05/03/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ å¤©æ°”é¢„æŠ¥ï¼ˆäºŒï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ4ï¼‰","text":"å‰è¨€ç™¾åº¦åœ°å›¾çš„å®šä½åŠŸèƒ½å’ŒåŸºç¡€åœ°å›¾åŠŸèƒ½æ˜¯åˆ†å¼€çš„ï¼Œä½¿ç”¨çš„æ˜¯å¦å¤–çš„jaråŒ…å’Œsoåº“æ–‡ä»¶ï¼Œè¯¦æƒ…è¯·å…³æ³¨å®˜ç½‘ï¼šç™¾åº¦å®šä½SDK é…ç½®ä¸‹è½½å¯¹åº”çš„jaråŒ…å’Œsoåº“ï¼Œç„¶åç§»åŠ¨åˆ°libç›®å½•ä¸‹ ASä¸­æ³¨æ„äº‹é¡¹12345sourceSets { main { jniLibs.srcDirs = ['libs'] }} åœ¨applicationæ ‡ç­¾ä¸­å£°æ˜serviceç»„ä»¶,æ¯ä¸ªappæ‹¥æœ‰è‡ªå·±å•ç‹¬çš„å®šä½service12&lt;service android:name=\"com.baidu.location.f\" android:enabled=\"true\" android:process=\":remote\"&gt;&lt;/service&gt; è¿™ä¸ªå¾ˆé‡è¦ ï¼Œä¸è¦ä»¥ä¸ºå’ŒåŸºç¡€åœ°å›¾çš„ä½¿ç”¨æ–¹å¼ç›¸åŒå°±å¿½ç•¥äº†å¯¹å®šä½SDKé…ç½®å®˜æ–¹è¯´æ˜çš„é˜…è¯» å£°æ˜ä½¿ç”¨æƒé™123456789101112131415161718&lt;!-- è¿™ä¸ªæƒé™ç”¨äºè¿›è¡Œç½‘ç»œå®šä½--&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\"&gt;&lt;/uses-permission&gt;&lt;!-- è¿™ä¸ªæƒé™ç”¨äºè®¿é—®GPSå®šä½--&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\"&gt;&lt;/uses-permission&gt;&lt;!-- ç”¨äºè®¿é—®wifiç½‘ç»œä¿¡æ¯ï¼Œwifiä¿¡æ¯ä¼šç”¨äºè¿›è¡Œç½‘ç»œå®šä½--&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\"&gt;&lt;/uses-permission&gt;&lt;!-- è·å–è¿è¥å•†ä¿¡æ¯ï¼Œç”¨äºæ”¯æŒæä¾›è¿è¥å•†ä¿¡æ¯ç›¸å…³çš„æ¥å£--&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"&gt;&lt;/uses-permission&gt;&lt;!-- è¿™ä¸ªæƒé™ç”¨äºè·å–wifiçš„è·å–æƒé™ï¼Œwifiä¿¡æ¯ä¼šç”¨æ¥è¿›è¡Œç½‘ç»œå®šä½--&gt;&lt;uses-permission android:name=\"android.permission.CHANGE_WIFI_STATE\"&gt;&lt;/uses-permission&gt;&lt;!-- ç”¨äºè¯»å–æ‰‹æœºå½“å‰çš„çŠ¶æ€--&gt;&lt;uses-permission android:name=\"android.permission.READ_PHONE_STATE\"&gt;&lt;/uses-permission&gt;&lt;!-- å†™å…¥æ‰©å±•å­˜å‚¨ï¼Œå‘æ‰©å±•å¡å†™å…¥æ•°æ®ï¼Œç”¨äºå†™å…¥ç¦»çº¿å®šä½æ•°æ®--&gt;&lt;uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"&gt;&lt;/uses-permission&gt;&lt;!-- è®¿é—®ç½‘ç»œï¼Œç½‘ç»œå®šä½éœ€è¦ä¸Šç½‘--&gt;&lt;uses-permission android:name=\"android.permission.INTERNET\" /&gt;&lt;!-- SDå¡è¯»å–æƒé™ï¼Œç”¨æˆ·å†™å…¥ç¦»çº¿å®šä½æ•°æ®--&gt;&lt;uses-permission android:name=\"android.permission.MOUNT_UNMOUNT_FILESYSTEMS\"&gt;&lt;/uses-permission&gt; æ³¨æ„äº‹é¡¹ï¼šåœ¨Android6.0ä¹Ÿå°±æ˜¯Mç‰ˆæœ¬çš„æ‰‹æœºä¸Šå®ç°Demoæ—¶ï¼Œç”±äºMç‰ˆæœ¬Googleå¼•å…¥äº†åŠ¨æ€æƒé™åˆ†é…çš„æœºåˆ¶ï¼Œå¦‚æœæ²¡æœ‰åœ¨ä»£ç ä¸­ç”³è¯·æƒé™ï¼Œé»˜è®¤æƒé™æ˜¯ä¸ä¼šè¢«æ‰“å¼€çš„ï¼Œä½œä¸ºè°ƒè¯•çš„æ³¨æ„äº‹é¡¹ï¼Œä½ éœ€è¦åˆ°è®¾ç½®ä¸­æ‰‹åŠ¨çš„ä¸ºDemoç¨‹åºæ‰“å¼€æƒé™ï¼Œæ–¹ä¾¿å®šä½èƒ½å¤Ÿæ­£ç¡®çš„è¿›è¡Œã€‚ AKé…ç½® å‚ç…§åŸºç¡€åœ°å›¾ä½¿ç”¨çš„AKé…ç½®å³å¯ Demoå®ç°å¸ƒå±€æ–‡ä»¶ 12345678910111213141516171819202122232425262728293031&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" tools:context=\"mapdemo.example.com.selfbaidumap.MainActivity\"&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:orientation=\"horizontal\"&gt; &lt;EditText android:layout_weight=\"3\" android:layout_width=\"wrap_content\" android:layout_height=\"match_parent\" android:id=\"@+id/et_locationresult\"/&gt; &lt;Button android:layout_weight=\"1\" android:layout_width=\"wrap_content\" android:layout_height=\"match_parent\" android:id=\"@+id/bt_locate\" android:text=\"å®šä½\"/&gt; &lt;/LinearLayout&gt; &lt;com.baidu.mapapi.map.MapView android:id=\"@+id/bmapView\" android:layout_width=\"fill_parent\" android:layout_height=\"fill_parent\" android:clickable=\"true\" /&gt;&lt;/LinearLayout&gt; ä»£ç å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184public class MainActivity extends AppCompatActivity { private MapView bmapView; private BitmapDescriptor bitmap = null; private BaiduMap mBaiduMap = null; private LocationClient mLocationClient = null; private BDLocationListener myListener = new MyLocationListener(); private EditText editTextLocationResult; private Button doLocateButton; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); SDKInitializer.initialize(getApplicationContext()); setContentView(R.layout.activity_main); bmapView = (MapView) findViewById(R.id.bmapView); mBaiduMap = bmapView.getMap(); //è®¾ç½®Markerçš„ç‚¹å‡»äº‹ä»¶ç›‘å¬ mBaiduMap.setOnMarkerClickListener(new BaiduMap.OnMarkerClickListener() { @Override public boolean onMarkerClick(Marker marker) { if (marker.getExtraInfo() != null) { Bundle bundle = marker.getExtraInfo();//è·å–ä¼ é€’è¿‡æ¥çš„ä¿¡æ¯ LatLng latlng = bundle.getParcelable(\"LatLng\");//æ‹¿åˆ°ç»çº¬åº¦ String address = bundle.getString(\"ADDRESS\");//æ‹¿åˆ°åœ°å€ä¿¡æ¯ TextView tv = new TextView(MainActivity.this); tv.setBackgroundResource(R.drawable.marker_info_bg); tv.setTextColor(Color.WHITE); tv.setText(address); InfoWindow info = new InfoWindow(tv, latlng, -47);//åˆ›å»ºå¼¹å‡ºçª—è¦†ç›–ç‰© mBaiduMap.showInfoWindow(info);//å±•ç¤º } return false; } }); doLocateButton = (Button) findViewById(R.id.bt_locate); doLocateButton.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { startLocate();//å¼€å§‹å®šä½ } }); editTextLocationResult = (EditText) findViewById(R.id.et_locationresult); bitmap = BitmapDescriptorFactory .fromResource(R.drawable.icon_gcoding); mLocationClient = new LocationClient(getApplicationContext()); //å£°æ˜LocationClientç±» mLocationClient.registerLocationListener(myListener); //æ³¨å†Œç›‘å¬å‡½æ•° initLocation();//åˆå§‹åŒ–å®šä½çš„ä¸€äº›é…ç½® } private void initLocation() { LocationClientOption option = new LocationClientOption(); option.setLocationMode(LocationClientOption.LocationMode.Hight_Accuracy );//å¯é€‰ï¼Œé»˜è®¤é«˜ç²¾åº¦ï¼Œè®¾ç½®å®šä½æ¨¡å¼ï¼Œé«˜ç²¾åº¦ï¼Œä½åŠŸè€—ï¼Œä»…è®¾å¤‡ option.setCoorType(\"bd09ll\");//å¯é€‰ï¼Œé»˜è®¤gcj02ï¼Œè®¾ç½®è¿”å›çš„å®šä½ç»“æœåæ ‡ç³» int span = 1000; option.setScanSpan(span);//å¯é€‰ï¼Œé»˜è®¤0ï¼Œå³ä»…å®šä½ä¸€æ¬¡ï¼Œè®¾ç½®å‘èµ·å®šä½è¯·æ±‚çš„é—´éš”éœ€è¦å¤§äºç­‰äº1000msæ‰æ˜¯æœ‰æ•ˆçš„ option.setIsNeedAddress(true);//å¯é€‰ï¼Œè®¾ç½®æ˜¯å¦éœ€è¦åœ°å€ä¿¡æ¯ï¼Œé»˜è®¤ä¸éœ€è¦ option.setOpenGps(true);//å¯é€‰ï¼Œé»˜è®¤false,è®¾ç½®æ˜¯å¦ä½¿ç”¨gps option.setLocationNotify(true);//å¯é€‰ï¼Œé»˜è®¤falseï¼Œè®¾ç½®æ˜¯å¦å½“gpsæœ‰æ•ˆæ—¶æŒ‰ç…§1S1æ¬¡é¢‘ç‡è¾“å‡ºGPSç»“æœ option.setIsNeedLocationDescribe(true);//å¯é€‰ï¼Œé»˜è®¤falseï¼Œè®¾ç½®æ˜¯å¦éœ€è¦ä½ç½®è¯­ä¹‰åŒ–ç»“æœï¼Œå¯ä»¥åœ¨BDLocation.getLocationDescribeé‡Œå¾—åˆ°ï¼Œç»“æœç±»ä¼¼äºâ€œåœ¨åŒ—äº¬å¤©å®‰é—¨é™„è¿‘â€ option.setIsNeedLocationPoiList(true);//å¯é€‰ï¼Œé»˜è®¤falseï¼Œè®¾ç½®æ˜¯å¦éœ€è¦POIç»“æœï¼Œå¯ä»¥åœ¨BDLocation.getPoiListé‡Œå¾—åˆ° option.setIgnoreKillProcess(false);//å¯é€‰ï¼Œé»˜è®¤trueï¼Œå®šä½SDKå†…éƒ¨æ˜¯ä¸€ä¸ªSERVICEï¼Œå¹¶æ”¾åˆ°äº†ç‹¬ç«‹è¿›ç¨‹ï¼Œè®¾ç½®æ˜¯å¦åœ¨stopçš„æ—¶å€™æ€æ­»è¿™ä¸ªè¿›ç¨‹ï¼Œé»˜è®¤ä¸æ€æ­» option.SetIgnoreCacheException(false);//å¯é€‰ï¼Œé»˜è®¤falseï¼Œè®¾ç½®æ˜¯å¦æ”¶é›†CRASHä¿¡æ¯ï¼Œé»˜è®¤æ”¶é›† option.setEnableSimulateGps(false);//å¯é€‰ï¼Œé»˜è®¤falseï¼Œè®¾ç½®æ˜¯å¦éœ€è¦è¿‡æ»¤gpsä»¿çœŸç»“æœï¼Œé»˜è®¤éœ€è¦ mLocationClient.setLocOption(option); } private void startLocate() { if (mLocationClient != null) { mLocationClient.start();//å¯åŠ¨å®šä½ } } @Override protected void onResume() { if (bmapView != null) { bmapView.onResume(); } super.onResume(); } @Override protected void onPause() { if (bmapView != null) { bmapView.onPause(); } super.onPause(); } @Override protected void onDestroy() { if (bmapView != null) { bmapView.onDestroy(); } if (bitmap != null) { bitmap.recycle(); } super.onDestroy(); } //è¿™ä¸ªæ˜¯ä»Demoä¸­æ‹¿è¿‡æ¥çš„ï¼Œæˆ‘è‡ªå·±ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ä¸åŒè¿™ä¹ˆå¤æ‚ï¼Œæ‹¿åˆ°å¯¹åº”çš„ä¿¡æ¯å³å¯ public class MyLocationListener implements BDLocationListener { @Override public void onReceiveLocation(BDLocation location) { //Receive Location StringBuffer sb = new StringBuffer(256); sb.append(\"time : \"); sb.append(location.getTime()); sb.append(\"\\nerror code : \"); sb.append(location.getLocType()); sb.append(\"\\nlatitude : \"); sb.append(location.getLatitude()); sb.append(\"\\nlontitude : \"); sb.append(location.getLongitude()); sb.append(\"\\nradius : \"); sb.append(location.getRadius()); if (location.getLocType() == BDLocation.TypeGpsLocation) {// GPSå®šä½ç»“æœ sb.append(\"\\nspeed : \"); sb.append(location.getSpeed());// å•ä½ï¼šå…¬é‡Œæ¯å°æ—¶ sb.append(\"\\nsatellite : \"); sb.append(location.getSatelliteNumber()); sb.append(\"\\nheight : \"); sb.append(location.getAltitude());// å•ä½ï¼šç±³ sb.append(\"\\ndirection : \"); sb.append(location.getDirection());// å•ä½åº¦ sb.append(\"\\naddr : \"); sb.append(location.getAddrStr()); sb.append(\"\\ndescribe : \"); sb.append(\"gpså®šä½æˆåŠŸ\"); } else if (location.getLocType() == BDLocation.TypeNetWorkLocation) {// ç½‘ç»œå®šä½ç»“æœ sb.append(\"\\naddr : \"); sb.append(location.getAddrStr()); //è¿è¥å•†ä¿¡æ¯ sb.append(\"\\noperationers : \"); sb.append(location.getOperators()); sb.append(\"\\ndescribe : \"); sb.append(\"ç½‘ç»œå®šä½æˆåŠŸ\"); } else if (location.getLocType() == BDLocation.TypeOffLineLocation) {// ç¦»çº¿å®šä½ç»“æœ sb.append(\"\\ndescribe : \"); sb.append(\"ç¦»çº¿å®šä½æˆåŠŸï¼Œç¦»çº¿å®šä½ç»“æœä¹Ÿæ˜¯æœ‰æ•ˆçš„\"); } else if (location.getLocType() == BDLocation.TypeServerError) { sb.append(\"\\ndescribe : \"); sb.append(\"æœåŠ¡ç«¯ç½‘ç»œå®šä½å¤±è´¥ï¼Œå¯ä»¥åé¦ˆIMEIå·å’Œå¤§ä½“å®šä½æ—¶é—´åˆ°loc-bugs@baidu.comï¼Œä¼šæœ‰äººè¿½æŸ¥åŸå› \"); } else if (location.getLocType() == BDLocation.TypeNetWorkException) { sb.append(\"\\ndescribe : \"); sb.append(\"ç½‘ç»œä¸åŒå¯¼è‡´å®šä½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæ˜¯å¦é€šç•…\"); } else if (location.getLocType() == BDLocation.TypeCriteriaException) { sb.append(\"\\ndescribe : \"); sb.append(\"æ— æ³•è·å–æœ‰æ•ˆå®šä½ä¾æ®å¯¼è‡´å®šä½å¤±è´¥ï¼Œä¸€èˆ¬æ˜¯ç”±äºæ‰‹æœºçš„åŸå› ï¼Œå¤„äºé£è¡Œæ¨¡å¼ä¸‹ä¸€èˆ¬ä¼šé€ æˆè¿™ç§ç»“æœï¼Œå¯ä»¥è¯•ç€é‡å¯æ‰‹æœº\"); } sb.append(\"\\nlocationdescribe : \"); sb.append(location.getLocationDescribe());// ä½ç½®è¯­ä¹‰åŒ–ä¿¡æ¯ List&lt;Poi&gt; list = location.getPoiList();// POIæ•°æ® if (list != null) { sb.append(\"\\npoilist size = : \"); sb.append(list.size()); for (Poi p : list) { sb.append(\"\\npoi= : \"); sb.append(p.getId() + \" \" + p.getName() + \" \" + p.getRank()); } } Log.i(\"BaiduLocationApiDem\", sb.toString()); editTextLocationResult.setText(location.getAddrStr());//æ˜¾ç¤ºæŸ¥è¯¢ç»“æœ addMark(location.getLatitude(), location.getLongitude(), location.getAddrStr());//æ·»åŠ è¦†ç›–ç‰© mLocationClient.stop(); } } private void addMark(double latitude, double longitude, String address) { LatLng latlng = new LatLng(latitude, longitude); Bundle bundle = new Bundle(); bundle.putString(\"ADDRESS\", address); bundle.putParcelable(\"LatLng\", latlng);//åˆ›å»ºBundleä¼ é€’ï¼Œç”¨äºåœ¨ç‚¹å‡»çš„æ—¶å€™åˆ›å»ºå¼¹å‡ºçª— OverlayOptions option = new MarkerOptions().icon(bitmap).extraInfo(bundle).position(latlng); if (mBaiduMap != null) { mBaiduMap.addOverlay(option); mBaiduMap.setMapStatus(MapStatusUpdateFactory.newLatLng(latlng));//ç§»åŠ¨åˆ°new marker } }} å®é™…æ•ˆæœ(ä¸ªäººåœ°ç†ä½ç½®ä¿¡æ¯è¢«å¤„ç†äº†ï¼Œå®é™…Demoä»¥ä¸ªäººä½ç½®ä¸ºå‡†)","link":"/2016/09/17/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç™¾åº¦åœ°å›¾APIä½¿ç”¨ï¼ˆ4ï¼‰/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç®€æ˜“æ‰‹ç”µç­’","text":"å‰è¨€ å¿«ä¸€ä¸ªæœˆæ²¡æœ‰å†™è‡ªå·±çš„åšå®¢äº†ï¼Œç”±äºæœ€è¿‘æ¢äº†å·¥ä½œï¼Œæ¢äº†å±…ä½åœ°ï¼Œæ‰€ä»¥æœ‰ä¸€äº›æ‚äº‹éœ€è¦å¤„ç†ï¼Œä»ä»Šå¤©å¼€å§‹æ¢å¤æ­£å¸¸ï¼Œä¸èµ˜è¿°äº†ã€‚è¿›å…¥ä»Šå¤©çš„ä¸»é¢˜ â€”â€“ ç®€æ˜“çš„æ‰‹ç”µç­’ã€‚ è¿™ä¸ªDemoä¸­ä½¿ç”¨çš„æ˜¯æ¯”è¾ƒæ–°çš„APIï¼ŒMç‰ˆæœ¬ä¹‹åæ·»åŠ çš„é’ˆå¯¹äºæ‰‹ç”µç­’çš„æ¥å£ã€‚è¿™é‡Œä½¿ç”¨çš„æ˜¯Cameraçš„API2æ¥å£ï¼Œä¸»è¦ä½¿ç”¨CameraManagerä¸­é’ˆå¯¹äºé—ªå…‰ç¯çš„ä¸€äº›æ–¹æ³•ï¼Œå¯¹äºCamera API2çš„æ¥å£ï¼Œåé¢åœ¨æ¶‰åŠç›¸æœºåº”ç”¨çš„æ—¶å€™ï¼ŒAPI1å’ŒAPI2åº”è¯¥éƒ½ä¼šæ¢³ç†ä¸€ä¸‹ï¼Œåˆ°æ—¶å€™å†ä»”ç»†çš„ç ”ç©¶ä¸€ä¸‹ã€‚ æ€è·¯ å®ç°ä¸€ä¸ªç®€å•çš„æ‰‹ç”µç­’ï¼Œè€ƒè™‘åˆ°Mç‰ˆæœ¬ä¸Šæ–°å¢çš„æ¥å£ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡setTorchModeæ¥æ”¹å˜é—ªå…‰ç¯çš„çŠ¶æ€ï¼Œå®ç°å¼€å…³ï¼Œç„¶åæ ¹æ®å½“å‰çš„é—ªå…‰ç¯çŠ¶æ€ï¼Œæœ‰å›è°ƒå‡½æ•°ï¼Œè‹¥å…¶ä»–çš„åº”ç”¨æ‰“å¼€äº†é—ªå…‰ç¯æˆ–è€…æ˜¯å…³é—­äº†é—ªå…‰ç¯ï¼Œè¯¥åº”ç”¨è¦ä½œå‡ºå¯¹åº”çš„è°ƒæ•´ï¼ŒåŒæ—¶ï¼Œå¼€å¯å’Œå…³é—­çš„è¿‡ç¨‹ï¼Œéœ€è¦æœ‰æ˜æ˜¾çš„ç”¨æˆ·æ„ŸçŸ¥å’Œæç¤ºï¼Œè¿™å°±è¦ç»“åˆNotificationManagerå’ŒCameraManagerçš„æ¥å£ä¸€èµ·å®ç°äº†ã€‚ æ¥å£ä»‹ç»CameraManager.java(frameworks/base/core/java/android/hardware/camera2) æ–¹æ³• å«ä¹‰ TorchCallback é’ˆå¯¹é—ªå…‰ç¯çš„å›è°ƒ AvailabilityCallback é’ˆå¯¹ç›¸æœºæ˜¯å¦å¯ç”¨çš„å›è°ƒ CameraManager() æ„é€ å‡½æ•° getCameraIdList() è·å–ç›¸æœºçš„Id registerAvailabilityCallback() æ³¨å†Œç›¸æœºæ˜¯å¦å¯ç”¨çš„å›è°ƒ unregisterAvailabilityCallback() è§£é™¤æ³¨å†Œ registerTorchCallback() æ³¨å†Œé’ˆå¯¹é—ªå…‰ç¯çŠ¶æ€çš„å›è°ƒ unregisterTorchCallback() è§£é™¤æ³¨å†Œ getCameraCharacteristics() ä¼ å…¥å‚æ•°ä¸ºç›¸æœºçš„idï¼Œè·å–ç›¸çš„ä¸€å‚æ•°ä¿¡æ¯ï¼Œå¦‚æ”¯æŒçš„é¢„è§ˆå¤§å°,æ”¯æŒçš„æ»¤é•œç­‰ç­‰ openCamera() ä¼ å…¥çš„å‚æ•°ä¸ºç›¸æœºçš„idå’ŒçŠ¶æ€å›StateCallback,è¿™ä¸ªæ˜¯åœ¨CameraDeviceä¸­å®šä¹‰çš„ï¼Œæ‰“å¼€ç›¸æœºæ“ä½œ setTorchMode() è®¾ç½®é—ªå…‰ç¯çš„çŠ¶æ€ å®æˆ˜ä»£ç 1.å¸ƒå±€æ–‡ä»¶ç”±äºæ˜¯æ‰‹ç”µç­’ï¼Œå¸ƒå±€æ–‡ä»¶å¾ˆç®€å•ï¼Œä¸»å¸ƒå±€ä¸­åªæœ‰ä¸€ä¸ªbuttonactivity_custom_button.xml 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/flash_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@color/black\" tools:context=\".FlashActivity\"&gt; &lt;Button android:id=\"@+id/bt_flash\" android:layout_width=\"100dp\" android:layout_height=\"100dp\" android:layout_gravity=\"center\" android:background=\"@drawable/flash_open\" /&gt;&lt;/FrameLayout&gt; æ˜¾ç¤ºå½“å‰é—ªå…‰ç¯è¢«å ç”¨çš„è‡ªå®šä¹‰Toastå¸ƒå±€busy_toast.xml 12345678910111213141516&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;TextView android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@drawable/busy_snackbar_bg\" android:gravity=\"center\" android:padding=\"@dimen/activity_horizontal_margin\" android:text=\"FlashLight is Busy , Sorryï¼\" android:textStyle=\"bold\" /&gt;&lt;/LinearLayout&gt; 2.ä»£ç æ–‡ä»¶ä¸»è¦å°±æ˜¯ä¸¤ä¸ªç±»ï¼Œä¸€ä¸ªæ˜¯ä¸»Activityï¼Œä¸€ä¸ªå°±æ˜¯ç”¨æ¥æ‰§è¡Œnotificationçš„pendingintentçš„å¹¿æ’­æ¥æ”¶å™¨FlashActivity.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206package mraz.com.custombutton;import android.annotation.TargetApi;import android.app.Notification;import android.app.NotificationManager;import android.app.PendingIntent;import android.content.Context;import android.content.Intent;import android.content.res.Resources;import android.graphics.Bitmap;import android.graphics.BitmapFactory;import android.hardware.camera2.CameraAccessException;import android.hardware.camera2.CameraManager;import android.os.Build;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.support.v7.app.NotificationCompat;import android.view.Gravity;import android.view.View;import android.widget.Button;import android.widget.FrameLayout;import android.widget.Toast;@TargetApi(Build.VERSION_CODES.M)public class FlashActivity extends AppCompatActivity { public static final String CLOSE_FLASH_ACTION = \"android.intent.action.close_flash\"; private static final int NOTIFICATIONID = 0; private Button btFlash; private boolean mIsFlashOn = false; private CameraManager cameraManager = null; private String[] mCameraIds; private Notification mFlashOnNotification = null; private NotificationManager notificationManager = null; private boolean isFlashAvailbale = true; private FrameLayout mContentPanel = null; //é—ªå…‰ç¯çŠ¶æ€å˜åŒ–çš„å›è°ƒ private CameraManager.TorchCallback torchCallback = new CameraManager.TorchCallback() { @Override public void onTorchModeUnavailable(String cameraId) { super.onTorchModeUnavailable(cameraId); //onTorchModeUnavailable å½“å‰é—ªå…‰ç¯ä¸å¯ç”¨ï¼Œå¦‚æœå½“å‰é—ªå…‰å¤„äºæ‰“å¼€çŠ¶æ€ï¼Œåˆ™å…³é—­å®ƒï¼Œå¹¶ä¸”å¯¹åº”çš„æ ‡å¿—ä½ if (cameraId.equals(mCameraIds[0]) &amp;&amp; mIsFlashOn) { reverseFlashState(); } isFlashAvailbale = false; System.out.println(\"cameraId = \" + cameraId + \" onTorchModeUnavailable\"); } @Override public void onTorchModeChanged(String cameraId, boolean enabled) { super.onTorchModeChanged(cameraId, enabled); //onTorchModeChanged é—ªå…‰ç¯çŠ¶æ€å˜åŒ–å›è°ƒ enabled=false é—ªå…‰ç¯å…³é—­ //enabled=true é—ªå…‰ç¯å·²ç»å¼€å¯ //é€šè¿‡è¿™ä¸ªå›è°ƒè®¾ç½®æ ‡å¿—ä½,å¦‚æœå½“å‰é—ªå…‰ç¯å¼€ç€ä½†æ˜¯æ”¶åˆ°äº†é—ªå…‰ç¯å·²ç»è¢«å…³é—­çš„å›è°ƒï¼Œåˆ™æ”¹å˜å¯¹åº”çš„çŠ¶æ€ isFlashAvailbale = true; System.out.println(\"cameraid = \" + cameraId + \" enabled = \" + enabled + \" misFlashOn = \" + mIsFlashOn); if (cameraId.equals(mCameraIds[0]) &amp;&amp; enabled == false &amp;&amp; mIsFlashOn) { reverseFlashState(); } System.out.println(\"cameraId = \" + cameraId + \" onTorchModeChanged enabled = \" + enabled); } }; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_custom_button); //é—ªå…‰ç¯å¼€å…³æŒ‰é’® btFlash = (Button) findViewById(R.id.bt_flash); //æ•´ä¸ªå¸ƒå±€ mContentPanel = (FrameLayout) findViewById(R.id.flash_content); btFlash.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { reverseFlashState(); } }); //æ ¹æ®å½“å‰é—ªå…‰ç¯è£…å¡«è®¾ç½®ä¸€ä¸‹UIç•Œé¢çš„é¢œè‰² changeFlashUi(mIsFlashOn); } //flashçŠ¶æ€ç¿»è½¬ private void reverseFlashState() { //å¦‚æœå½“å‰Flash å¤„äºunavailableçŠ¶æ€ï¼Œè¯´æ˜å½“å‰é—ªå…‰ç¯è¢«å ç”¨ï¼Œæ— æ³•ä½¿ç”¨ if (!isFlashAvailbale) { //æ˜¾ç¤ºå½“å‰é—ªå…‰ç¯è¢«å ç”¨çš„æç¤º showFlashBusy(); return; } changeFlashState(mIsFlashOn);//å¼€-&gt;å…³ å…³-&gt;å¼€ mIsFlashOn = !mIsFlashOn;//æ ‡å¿—ä½è£…æ¢ changeFlashUi(mIsFlashOn);//ç•Œé¢UIåˆ‡æ¢ï¼Œè¿™é‡Œä¸»è¦å°±æ˜¯ä¸ºäº†çªå‡ºé—ªå…‰ç¯å¼€å…³çš„çŠ¶æ€ä¸åŒ applyNotification(mIsFlashOn);//é—ªå…‰ç¯å¼€å¯çš„æç¤ºæ˜¾ç¤ºå’Œæ¶ˆé™¤ } @TargetApi(Build.VERSION_CODES.JELLY_BEAN) private void applyNotification(boolean isFlashOn) { if (!isFlashOn) { dismissNotification(); return; } if (mFlashOnNotification != null &amp;&amp; notificationManager != null) { notificationManager.notify(NOTIFICATIONID, mFlashOnNotification); } } @Override protected void onResume() { super.onResume(); cameraManager = (CameraManager) getSystemService(CAMERA_SERVICE); notificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE); cameraManager.registerTorchCallback(torchCallback, null);//æ³¨å†Œå›è°ƒ getCameraList();//è·å–å½“å‰æ‰‹æœºçš„æ‘„åƒå¤´ä¸ªæ•° generateNotify();//ç”Ÿæˆéœ€è¦æ˜¾ç¤ºçš„æç¤ºï¼Œæ–¹ä¾¿åé¢æ˜¾ç¤º } @Override protected void onDestroy() { super.onDestroy(); cameraManager.unregisterTorchCallback(torchCallback);//ondestoryçš„æ—¶å€™è§£é™¤å›è°ƒ } @TargetApi(Build.VERSION_CODES.M) //åªæœ‰Mç‰ˆæœ¬çš„æ‰‹æœºå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³• private void changeFlashState(boolean isFlashOn) { if (cameraManager != null &amp;&amp; mCameraIds != null) { try { cameraManager.setTorchMode(mCameraIds[0], !isFlashOn); } catch (CameraAccessException e) { e.printStackTrace(); } } } @TargetApi(Build.VERSION_CODES.LOLLIPOP) //åªæœ‰Lç‰ˆæœ¬çš„æ”¶é›†å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³• private void getCameraList() { if (cameraManager != null) { try { mCameraIds = cameraManager.getCameraIdList(); } catch (CameraAccessException e) { e.printStackTrace(); } } } //æŒ‰é’®çš„èƒŒæ™¯å›¾åˆ‡æ¢ private void changeFlashUi(boolean isFlashOn) { if (isFlashOn) { btFlash.setBackgroundResource(R.drawable.flash_open); } else { btFlash.setBackgroundResource(R.drawable.flash_close); } } //ç”Ÿæˆnotificationçš„å¤§å›¾æ ‡ private Bitmap createNotificationLargeIcon(Context c) { Resources res = c.getResources(); int width = (int) res.getDimension(android.R.dimen.notification_large_icon_width); int height = (int) res.getDimension(android.R.dimen.notification_large_icon_height); Bitmap result = Bitmap.createScaledBitmap(BitmapFactory.decodeResource(res, R.mipmap.ic_flash_on_normal), width, height, false); return result; } //ç”Ÿæˆnotification private void generateNotify() { if (mFlashOnNotification != null) return; NotificationCompat.Builder builder = new NotificationCompat.Builder(this); builder.setLargeIcon(createNotificationLargeIcon(this)) .setContentTitle(\"æ‰‹ç”µç­’å·²å¼€å¯\") .setContentText(\"ç‚¹å‡»å¯å…³é—­æ‰‹ç”µç­’\") .setSmallIcon(R.mipmap.ic_flash_off_normal, 3) .setContentIntent(createCloseFlashPendingIntent()); mFlashOnNotification = builder.build(); } //æ¶ˆé™¤notification private void dismissNotification() { if (notificationManager != null &amp;&amp; mFlashOnNotification != null) { notificationManager.cancel(NOTIFICATIONID); } } //åˆ›å»ºç‚¹å‡»notificationå¯¹åº”çš„PendingIntent private PendingIntent createCloseFlashPendingIntent() { Intent intent = new Intent(); intent.setClass(this, FlashCloseReceiver.class); intent.setAction(CLOSE_FLASH_ACTION); return PendingIntent.getBroadcast(this, 0, intent, 0); } //æ˜¾ç¤ºä¸€ä¸ªæ‰‹ç”µç­’å¿™ç¢Œçš„æç¤º private void showFlashBusy() { View toastContent = getLayoutInflater().inflate(R.layout.busy_toast, null, false); Toast toast = new Toast(this); toast.setView(toastContent); toast.setGravity(Gravity.CENTER, 0, 0); toast.setDuration(Toast.LENGTH_LONG); toast.show(); }} FlashCloseReceiver.java 123456789101112131415161718192021222324252627282930313233343536373839404142package mraz.com.custombutton;import android.annotation.TargetApi;import android.content.BroadcastReceiver;import android.content.Context;import android.content.Intent;import android.hardware.camera2.CameraAccessException;import android.hardware.camera2.CameraManager;import android.os.Build;public class FlashCloseReceiver extends BroadcastReceiver { CameraManager mCameraManager = null; String[] mCameraIds = null; public FlashCloseReceiver() { } @TargetApi(Build.VERSION_CODES.M) @Override public void onReceive(Context context, Intent intent) { System.out.println(\"onReceiver\"); mCameraManager = (CameraManager) context.getSystemService(Context.CAMERA_SERVICE); if (mCameraManager != null) { try { mCameraIds = mCameraManager.getCameraIdList(); } catch (CameraAccessException e) { e.printStackTrace(); } } String action = intent.getAction(); if (action.equals(FlashActivity.CLOSE_FLASH_ACTION)) { if (mCameraManager != null &amp;&amp; mCameraIds != null &amp;&amp; mCameraIds.length != 0) { try { System.out.println(\"setTorchMode\"); mCameraManager.setTorchMode(mCameraIds[0], false); } catch (CameraAccessException e) { e.printStackTrace(); } } } }} å®é™…æ•ˆæœå›¾æ‰‹ç”µç­’å…³é—­çŠ¶æ€ æ‰‹ç”µç­’å¼€å¯çŠ¶æ€ æ‰‹ç”µç­’å¼€å¯çŠ¶æ€æç¤ºä¿¡æ¯ å¤‡æ³¨ç”±äºå¼€å‘æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œæµ‹è¯•å¯èƒ½ä¸å……åˆ†ï¼Œæœ‰é—®é¢˜æ¬¢è¿ç•™è¨€è®¨è®º~","link":"/2016/08/01/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ ç®€æ˜“æ‰‹ç”µç­’/"},{"title":"ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ç®€æ˜“è´ªåƒè›‡","text":"æœ€ç®€å•çš„è´ªåƒè›‡ æœ€è¿‘æƒ³ç€å¿™é‡Œå·é—²å†™ç‚¹ç®€å•çš„Androidåº”ç”¨ï¼Œå¢åŠ ä¸€äº›ç”Ÿæ´»ä¹è¶£ï¼Œç”±äºå¹³æ—¶å·¥ä½œä¸»è¦ç²¾åŠ›å¹¶ä¸æ˜¯é›†ä¸­åœ¨ä¹¦å†™apkä¸Šï¼Œæ›´å¤šçš„æ˜¯è§£å†³ä»£ç é—®é¢˜å’Œç»´æŠ¤æ¨¡å—ç¨³å®šï¼Œä½†æ˜¯å†™ä»£ç æœ¬èº«æ˜¯ä¸€ä»¶æ¯”è¾ƒæœ‰è¶£çš„äº‹æƒ…ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹æ˜¯ä»æ— åˆ°æœ‰çš„ã€‚ åç§°ï¼šè´ªåƒè›‡ å¼€å‘ç¯å¢ƒï¼šIntelliJ IDEA 14.0.3 æ€è·¯ï¼š å®šæ—¶åˆ·æ–°ç•Œé¢ï¼Œå› ä¸ºè›‡æ˜¯ä¸ä¼šåœæ­¢çš„ éšæœºäº§ç”Ÿé£Ÿç‰© è›‡ä½“çš„æ›´æ–° è›‡ä½“å¦‚ä½•å‡ºç°ç§»åŠ¨çš„æ•ˆæœ ç¼ºé™·ï¼šæ²¡æœ‰ç»“æŸï¼Œæ²¡æœ‰ç¢°å£ï¼Œæ²¡æœ‰è¿½å°¾ï¼Œé™¤éæ¨å‡ºï¼ˆç°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆæ˜¯æœ€ç®€å•çš„äº†å§ï¼‰ ä»£ç åˆ†æï¼š MyActivityï¼Œ ä¸»è¦ä½œç”¨å°±æ˜¯å®šæ—¶åˆ·æ–°ç•Œé¢ï¼Œè®©è›‡ä¸åœçš„å‰è¿› 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748private SnakeView mSnakeView; //å¡«å……çª—å£çš„View,åˆ·æ–°çš„å¯¹è±¡private static final int REFRESH = 1; //å®šä¹‰æ¶ˆæ¯ é˜²æ­¢ç¡¬ç¼–ç private static final int REFRESHINTERVAL = 300; //åˆ·æ–°çš„æ—¶é—´é—´éš”private boolean isPaused = false; //çº¿ç¨‹çš„åœæ­¢æ ‡å¿—ä½private Handler mHandler = new Handler() { //thread handler æ¶ˆæ¯å¤„ç† @Override public void handleMessage(Message msg) { // TODO Auto-generated method stub super.handleMessage(msg); if(msg.arg1 == REFRESH) { if(mSnakeView != null) { mSnakeView.invalidate(); } } }};private Thread mRefreshThread; //ç”¨äºå‘é€åˆ·æ–°æ¶ˆæ¯çš„çº¿ç¨‹//Activityçš„onCreateæ–¹æ³•protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); mSnakeView = new SnakeView(this); setContentView(mSnakeView); isPaused = false; mRefreshThread = new Thread(\"TimerThread\"){ @Override public void run() { // TODO Auto-generated method stub super.run(); while(!isPaused) { Message msg = mHandler.obtainMessage(); msg.arg1 = REFRESH; mHandler.sendMessage(msg); try { Thread.sleep(REFRESHINTERVAL); //ä¼‘çœ ä¸€æ®µæ—¶é—´åå†å‘é€æ¶ˆæ¯åˆ·æ–°ç•Œé¢ } catch (InterruptedException e) { // TODO Auto-generated catch block e.printStackTrace(); } } } }; mRefreshThread.start(); //å¯åŠ¨çº¿ç¨‹} SnakeView ï¼Œä¸»æ¸¸æˆç•Œé¢ï¼Œè›‡ä½“ï¼ŒèƒŒæ™¯å’Œé£Ÿç‰©çš„æ˜¾ç¤ºç•Œé¢ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183//è‡ªå®šä¹‰Viewpublic class SnakeView extends View{ public static final String TAG = \"SnakeView\"; private int mWidth; //viewçš„å®½ private int mHeight; //Viewçš„é«˜ private static final int sXOffset = 0 ; private static final int sYOffset = 0 ; // Xåæ ‡å’ŒYåæ ‡çš„åç§»é‡ï¼Œå¯ä»¥ä¿®æ”¹æ¥ç¼©å°æ¸¸æˆèŒƒå›´ private final int BOXWIDTH = 30; //é£Ÿç‰©çš„è¾¹é•¿ï¼Œè›‡ä½“çš„å®½åº¦ private Random mRandom = new Random(); //ç”¨äºäº§ç”Ÿéšæœºæ•° private Point mFoodPosition; //é£Ÿç‰©çš„ä½ç½® private boolean mIsFoodDone = true; //é£Ÿç‰©æ˜¯å¦å·²ç»è¢«åƒæ‰ private ArrayList&lt;Point&gt; mSnakeList; //è›‡ä½“å¯ä»¥çœ‹åšæ˜¯å¾ˆå¤šé£Ÿç‰©ç»„æˆçš„ private Paint mSnakePaint; //ç”¨äºç”»è›‡çš„ç”»ç¬” private int mSnakeDirection = 0; //è›‡ä½“è¿åŠ¨çš„æ–¹å‘ private final int UP = 1; private final int DOWN = 2; private final int LEFT = 3; private final int RIGHT =4; private Paint mBgPaint;//æ¸¸æˆèƒŒæ™¯ç”»ç¬” private Paint mFoodPaint;//é£Ÿç‰©ç”»ç¬” public SnakeView(Context context) { super(context); // TODO Auto-generated constructor stub mSnakeList = new ArrayList&lt;Point&gt;(); mSnakePaint = new Paint(); mSnakePaint.setColor(Color.RED); mSnakePaint.setStyle(Paint.Style.FILL_AND_STROKE); mSnakeList.add(new Point(500,500)); mSnakeList.add(new Point(500,530)); //åˆå§‹åŒ–ä¸€æ¡ä¸‘é™‹çš„è›‡ mSnakeDirection = RIGHT; mIsFoodDone = true; mFoodPosition= new Point(); mFoodPaint = new Paint(); mFoodPaint.setColor(Color.CYAN); mFoodPaint.setStyle(Paint.Style.FILL); mBgPaint = new Paint(); Paint paint = new Paint(); paint.setColor(Color.WHITE); //åˆå§‹åŒ–å„ç§ç”»ç¬” } @Override public boolean onTouchEvent(MotionEvent event) { //é€šè¿‡æ‰‹åŠ¿æ¥æ”¹å˜è›‡ä½“è¿åŠ¨æ–¹å‘ // TODO Auto-generated method stub int x = (int)(event.getX()); int y = (int)(event.getY()); Log.e(TAG, \"x =\" + x + \" y = \" + y + \" mSnakeDirection = \" + mSnakeDirection); if(mSnakeDirection == UP || mSnakeDirection == DOWN) { if(x &lt; head.x) mSnakeDirection = LEFT; if(x &gt; head.x) mSnakeDirection = RIGHT; } else if(mSnakeDirection == LEFT || mSnakeDirection == RIGHT) { if(y &lt; head.y) mSnakeDirection = UP; if(y &gt; head.y) mSnakeDirection= DOWN; } //Log.e(TAG, \"after adjust mSnakeDirection = \" + mSnakeDirection); return super.onTouchEvent(event); } @Override protected void onDraw(Canvas canvas) { // TODO Auto-generated method stub //Log.e(TAG ,\"onDraw\"); super.onDraw(canvas); drawBg(canvas, mBgPaint); //ç”»èƒŒæ™¯ drawFood(canvas, mFoodPaint);//ç”»é£Ÿç‰© drawSnake(canvas, mSnakePaint); //ç”»è›‡ } @Override protected void onSizeChanged(int w, int h, int oldw, int oldh) { // TODO Auto-generated method stub super.onSizeChanged(w, h, oldw, oldh); mWidth = w; mHeight = h; } //ç”»èƒŒæ™¯ è¿™é‡Œé€šè¿‡sXOffset, sYOffsetå¯ä»¥å®ç°å¯¹è›‡æ´»åŠ¨åŒºåŸŸçš„é™åˆ¶ private void drawBg(Canvas canvas, Paint paint) { canvas.drawColor(Color.WHITE); //Rect rect = new Rect(sXOffset, sYOffset, mWidth - sXOffset, mHeight - sYOffset); //canvas.drawRect(rect, paint); } //ç”»è›‡ä½“ private void drawSnake(Canvas canvas, Paint paint) { for(int i = 0 ; i &lt; mSnakeList.size() ; i++ ) { Point point = mSnakeList.get(i); Rect rect = new Rect(point.x , point.y , point.x + BOXWIDTH , point.y + BOXWIDTH); canvas.drawRect(rect, paint); } //è›‡ç§»åŠ¨ï¼Œæ›´æ–°listä¸ºä¸‹ä¸€æ¬¡åˆ·æ–°åšå‡†å¤‡ snakeMove(mSnakeList, mSnakeDirection); if(isFoodEaten()) { //å¦‚æœåƒäº†é£Ÿç‰©ï¼Œé•¿åº¦åŠ 1 mIsFoodDone = true; } else { //å¦‚æœæ²¡æœ‰åƒé£Ÿç‰©ï¼Œç”±äºå‰è¿›æ—¶åŠ äº†ä¸€ä¸ª è¿™é‡Œåˆ é™¤å°¾å·´ï¼Œå‡ºç°ç§»åŠ¨çš„æ•ˆæœ mSnakeList.remove(mSnakeList.size() - 1); } } //ç”»é£Ÿç‰© private void drawFood(Canvas canvas, Paint paint) { if(mIsFoodDone) { //åªåœ¨å‰ä¸€ä¸ªé£Ÿç‰©è¢«åƒæ‰çš„æƒ…å†µä¸‹æ‰äº§ç”Ÿé£Ÿç‰© mFoodPosition.x = mRandom.nextInt(mWidth - 2*sXOffset - BOXWIDTH) + sXOffset ; mFoodPosition.y = mRandom.nextInt(mWidth - 2*sYOffset - BOXWIDTH) + sYOffset ; mIsFoodDone = false; } Rect food = new Rect(mFoodPosition.x , mFoodPosition.y , mFoodPosition.x + BOXWIDTH , mFoodPosition.y + BOXWIDTH); canvas.drawRect(food, paint); } public void snakeMove(ArrayList&lt;Point&gt; list , int direction) { //Log.e(TAG,\" snakeMove ArrayList = \" + list.toString()); Point orighead = list.get(0); Point newhead = new Point(); //è›‡å‰è¿›ï¼Œå®ç°åŸç†å°±æ˜¯å¤´åŠ å°¾å‡ï¼Œè‹¥åƒåˆ°é£Ÿç‰©ï¼Œå¤´åŠ å°¾ä¸å‡ switch(direction) { case UP: newhead.x = orighead.x; newhead.y = orighead.y - BOXWIDTH ; break; case DOWN: newhead.x = orighead.x; newhead.y = orighead.y + BOXWIDTH ; break; case LEFT: newhead.x = orighead.x - BOXWIDTH; newhead.y = orighead.y; break; case RIGHT: newhead.x = orighead.x + BOXWIDTH ; newhead.y = orighead.y; break; default: break; } adjustHead(newhead); list.add(0, newhead); } //è¾¹ç•Œåˆ¤æ–­ private boolean isOutBound(Point point) { if(point.x &lt; sXOffset || point.x &gt; mWidth - sXOffset) return true; if(point.y &lt; sYOffset || point.y &gt; mHeight - sYOffset) return true; return false; } //å‡ºäº†è¾¹ç•Œï¼Œé‡æ–°å›æ¥ private void adjustHead(Point point) { //Log.e(TAG, \"checkBound = \" + isOutBound(point)); if(isOutBound(point)){ if(mSnakeDirection == UP) point.y = mHeight - sYOffset - BOXWIDTH; if(mSnakeDirection == DOWN) point.y = sYOffset; if(mSnakeDirection == LEFT) point.x = mWidth - sYOffset - BOXWIDTH; if(mSnakeDirection == RIGHT) point.x = sXOffset; } } //åˆ¤æ–­é£Ÿç‰©æ˜¯å¦å¯ä»¥è¢«åƒ private boolean isFoodEaten() { if(!mIsFoodDone) { Rect foodrect = new Rect(mFoodPosition.x, mFoodPosition.y, mFoodPosition.x + BOXWIDTH, mFoodPosition.y + BOXWIDTH); Point head = mSnakeList.get(0); Rect headrect = new Rect(head.x, head.y, head.x + BOXWIDTH , head.y + BOXWIDTH); return foodrect.intersect(headrect); } return false; }} æ•ˆæœå±•ç¤ºï¼š(åˆ¶ä½œGifæœ‰ç‚¹ä¸æµç•…å®é™…æ•ˆæœå¾ˆæµç•…) ä»£ç é™„ä»¶ï¼š http://download.csdn.net/detail/poorkick/9497370 æ¬¢è¿è®¨è®ºï¼","link":"/2016/04/20/ã€ŠAndroid åº”ç”¨ ä¹‹è·¯ã€‹ç®€æ˜“è´ªåƒè›‡/"},{"title":"ã€ŠAndroid åº”ç”¨ä¹‹è·¯ã€‹ Android å¼€å‘æŠ€æœ¯é€‰å‹ï¼ˆåšå®¢ï¼Œæ–°é—»ï¼Œé˜…è¯»ç±»ï¼‰","text":"å‰è¨€æœ€å¼€å§‹å­¦ä¹ å†™åº”ç”¨çš„æ—¶å€™ï¼Œå‘ç°ç±»èšåˆæ•°æ®è¿™ä¸ªå¹³å°å¯ä»¥æä¾›ä¸€äº›å…è´¹æ•°æ®æ¥å£ï¼Œäºæ˜¯å†™äº†ä¸ªäººçš„ç¬¬ä¸€ä¸ªåº”ç”¨â€”â€“ JuheNewsï¼Œå½“æ—¶çš„çŸ¥è¯†å‚¨å¤‡ç¨æ˜¾ç²—ç³™ï¼Œè™½ç„¶ç°åœ¨çš„çŸ¥è¯†ä¹Ÿä¸å’‹æ»´ï¼Œä½†æ˜¯ç›¸å¯¹ä¹‹å‰è€Œè¨€è¿˜æ˜¯æœ‰äº›è¿›æ­¥çš„ï¼Œæ‰€ä»¥å†³å®šå°†åº”ç”¨é‡æ„ä¸€ä¸‹ï¼Œå…·ä½“å‚è€ƒæˆ‘çš„ç¬¬äºŒä¸ªä¸ªäººå¼€å‘çš„åº”ç”¨â€” GankIOClientï¼Œé‡‡ç”¨ç±»ä¼¼çš„æŠ€æœ¯æ€è·¯ï¼Œé‡æ„åä¸¤ä¸ªåº”ç”¨åœ¨ä»£ç ç»“æ„ä¸Šæ˜¯å¾ˆç›¸ä¼¼çš„ã€‚ æŠ€æœ¯é€‰å‹1. ä¸‹æ‹‰åˆ·æ–° + åŠ è½½æ›´å¤š é‡‡ç”¨BGARefreshLayout-Androidï¼Œæ”¯æŒçš„ä¸‹æ‹‰åˆ·æ–°æ ·å¼åŸºæœ¬å¯ä»¥æ»¡è¶³æˆ‘çš„éœ€æ±‚ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå®ç°ä¸¤ä¸ªæ¥å£å³å¯è®¾ç½®åˆ·æ–°åŠ¨ä½œå’ŒåŠ è½½æ›´å¤šçš„åŠ¨ä½œã€‚è¿™ä½å“å‹çš„å…¶ä»–å¼€æºåº“ä¹Ÿå¾ˆå¥½ç”¨ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹ä¸‹ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š 123456789101112private void initBGALayout() { // ä¸ºBGARefreshLayout è®¾ç½®ä»£ç† bgaRefreshLayout.setDelegate(this); // è®¾ç½®ä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½æ›´å¤šçš„é£æ ¼ å‚æ•°1ï¼šåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå‚æ•°2ï¼šæ˜¯å¦å…·æœ‰ä¸Šæ‹‰åŠ è½½æ›´å¤šåŠŸèƒ½ BGANormalRefreshViewHolder refreshViewHolder = new BGANormalRefreshViewHolder(getContext(), true); refreshViewHolder.setLoadingMoreText(\"åŠ è½½æ›´å¤š\"); refreshViewHolder.setLoadMoreBackgroundColorRes(R.color.white); refreshViewHolder.setRefreshViewBackgroundColorRes(R.color.white); bgaRefreshLayout.setRefreshViewHolder(refreshViewHolder);} 12345678910@Overridepublic void onBGARefreshLayoutBeginRefreshing(BGARefreshLayout refreshLayout) {//æ‰§è¡Œä¸‹æ‹‰åˆ·æ–°æ“ä½œ}@Overridepublic boolean onBGARefreshLayoutBeginLoadingMore(BGARefreshLayout refreshLayout) { //æ‰§è¡ŒåŠ è½½æ›´å¤šæ“ä½œï¼Œè¿”å›falseä»£è¡¨ä¸æ”¯æŒåŠ è½½æ›´å¤š return false;} 2. ç½‘ç»œè¯·æ±‚Retrofit + RxJava2ï¼Œè¿™ä¸ªå°±ä¸ç”¨å¤šåšä»‹ç»äº†ï¼Œæœ€å¼€å§‹å­¦ä¹ è¿™ä¸¤ä¸ªå†…å®¹çš„æ—¶å€™è¯»è¿‡çš„æ–‡ç« åˆ†äº«ä¸€ä¸‹ï¼š RxJava ä¸ Retrofit ç»“åˆçš„æœ€ä½³å®è·µç»™ Android å¼€å‘è€…çš„ RxJava è¯¦è§£æˆ‘çš„ä¸€ä¸ªRxJava2æ–‡ç« æ”¶è—é›† è¿™ä½æœ‹å‹å†™çš„é€šä¿—æ˜“æ‡‚ï¼Œä¸çœ‹Rxjava2çš„å®˜æ–‡åº”è¯¥ä¹Ÿèƒ½å¾ˆå¿«çš„äº†è§£Rxjavaå‡çº§åˆ°2ä¹‹åçš„å˜åŒ–ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š 12345678910111213141516public interface JuheApi { @GET Observable&lt;NewsBean&gt; getNews(@Url String url); @GET Observable&lt;FunnyBean&gt; getFunny(@Url String url); @GET Observable&lt;JokeBean&gt; getJoke(@Url String url); @GET Observable&lt;HistoryBean&gt; getTodayInHistory(@Url String url); @GET Observable&lt;QueryNewsBean&gt; getQueryNews(@Url String url);} 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980public class Retrofitance { public static final String BASE_URL = \"http://gank.io/api/\"; private static final int DEFAULT_TIMEOUT = 5; private Retrofit retrofit; private JuheApi mJuheApi; private OkHttpClient mOkHttpClient; //æ„é€ æ–¹æ³•ç§æœ‰ private Retrofitance() { //æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªOkHttpClientå¹¶è®¾ç½®è¶…æ—¶æ—¶é—´ OkHttpClient.Builder httpClientBuilder = new OkHttpClient.Builder(); httpClientBuilder.connectTimeout(DEFAULT_TIMEOUT, TimeUnit.SECONDS); mOkHttpClient = httpClientBuilder.build(); retrofit = new Retrofit.Builder().client(mOkHttpClient) .addConverterFactory(GsonConverterFactory.create()) .addCallAdapterFactory(RxJava2CallAdapterFactory.create()) .baseUrl(BASE_URL) .build(); mJuheApi = retrofit.create(JuheApi.class); } //è·å–å•ä¾‹ public static Retrofitance getInstance() { return SingletonHolder.INSTANCE; } /** * æ ¹æ®ç±»å‹è·å–æ–°é—»ä¿¡æ¯ */ public void getNews(Observer&lt;NewsBean&gt; subscriber, String type) { String URL = \"\"; commonOp(mJuheApi.getNews(URL),subscriber); } /** * è·å–è¶£å›¾ä¿¡æ¯ */ public void getFunny(Observer&lt;FunnyBean&gt; subscriber, int pagenum) { String URL =\"\"; commonOp(mJuheApi.getFunny(URL), subscriber); } /** * è·å–å†å²ä¸Šçš„ä»Šå¤© */ public void getHistory(Observer&lt;HistoryBean&gt; subscriber) { Calendar now = Calendar.getInstance(); String URL = \"\"; commonOp(mJuheApi.getTodayInHistory(URL),subscriber); } /** * è·å–ç¬‘è¯å¤§å…¨ */ public void getJoke(Observer&lt;JokeBean&gt; subscriber, int pagenum) { String URL =\"\"; commonOp(mJuheApi.getJoke(URL), subscriber); } public void getQueryNews(Observer&lt;QueryNewsBean&gt; subscriber, String keyword) { String URL = \"\"; commonOp(mJuheApi.getQueryNews(URL), subscriber); } private void commonOp(Observable observable, Observer subscriber) { observable.subscribeOn(Schedulers.io()) .unsubscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(subscriber); } //åœ¨è®¿é—®HttpMethodsæ—¶åˆ›å»ºå•ä¾‹ private static class SingletonHolder { private static final Retrofitance INSTANCE = new Retrofitance(); }} 3. å“åº”å¼ç¼–ç¨‹ä¸äºŒé€‰æ‹©ï¼ŒRxJava2 + RxAndoidï¼Œå‘Šåˆ«Threadå’ŒAsyncTaskï¼Œä¸ç”¨å†™Handleräº†ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536public void getContent(int pagenum) { Observer&lt;FunnyBean&gt; observer = new Observer&lt;FunnyBean&gt;() { @Override public void onComplete() { endLoading(); } @Override public void onError(Throwable e) { e.printStackTrace(); endLoading(); onNetworkError(); } @Override public void onSubscribe(Disposable d) { } @Override public void onNext(FunnyBean funnyBean) { if (bgaRefreshLayout.isLoadingMore()) { } else { mVisitableList.clear(); } if (funnyBean.getResult() == null || funnyBean.getResult().getData() == null || funnyBean.getResult().getData().size() == 0) { onDataEmpty(); } else { mVisitableList.addAll(funnyBean.getResult().getData()); } mMultiRecyclerAdapter.setData(mVisitableList); } }; Retrofitance.getInstance().getFunny(observer, pagenum);} 4. å¤šç±»å‹RecyclerView Itemå®ç°å‚è€ƒåšæ–‡RecyclerViewå¤šç±»å‹Itemçš„æ­£ç¡®å®ç°å§¿åŠ¿å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸€äº›å¼€æºåº“ï¼Œåªæ˜¯æˆ‘ä¹ æƒ¯äº†ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒé¡ºæ‰‹ã€‚æ€è·¯å’Œå®ç°æ–¹å¼ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨æ¥å£åŒ–çš„æ•°æ®å’Œæ³›å‹ï¼ŒæŠ½å–æŠ½è±¡ç±»ï¼Œç»“æ„åˆ†æ˜ï¼Œæ‰©å±•æ€§å¼ºï¼Œèªæ˜çš„ä½ åº”è¯¥ä¸€çœ‹å°±ä¼šæ‡‚ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•å‚è€ƒé¡¹ç›®ä»£ç æˆ–è€…æ˜¯ä¸Šé¢è¿™ç¯‡åšæ–‡ï¼Œæ¶‰åŠçš„ä»£ç æ¯”è¾ƒå¤šï¼Œä¸»è¦æ˜¯ç¨å¾®æœ‰ç‚¹ç»“æ„åŒ–ï¼Œä¸ä¾¿åˆ—ä¸¾ã€‚ 5. æ³¨è§£butterknifeï¼Œå‘Šåˆ«findViewByIdï¼Œä½†æ˜¯æœ‰äº†Kotlinï¼Œæˆ‘è§‰å¾—æˆ‘ä»¬ä¹Ÿå¯ä»¥å‘Šåˆ«butterknifeäº†ï¼Œæ¯•ç«Ÿä¸€æŠŠå°åˆ€ã€‚ä½¿ç”¨æ–¹æ³•ï¼š 1234567891011@BindView(R.id.tl_web)Toolbar tlWeb;@BindView(R.id.wv_content)WebView wvContent;@BindView(R.id.activity_web)LinearLayout activityWeb;@BindView(R.id.progressbar)ProgressBar progressbar;....ButterKnife.bind(this); é…åˆæ’ä»¶ä½¿ç”¨æ•ˆæœä¼šæ›´å¥½å–”ã€‚ 6. å›¾ç‰‡åŠ è½½æˆ‘é¦–é€‰Glideï¼Œå› ä¸ºæˆ‘æœ‰GIFçš„éœ€æ±‚ï¼ŒPicassoä¸æ”¯æŒGIFï¼Œè™½ç„¶ä½“é‡æ¯”è¾ƒå°ã€‚Glideçš„ä½¿ç”¨æ–¹æ³•å‚è€ƒå®˜æ–‡ï¼Œæœ€è¿‘Glideæœ‰å¤§ç‰ˆæœ¬å‡çº§ï¼Œæ”¹åŠ¨æ¯”è¾ƒå¤šï¼Œæœ‰å…´è¶£çš„å¯ä»¥å…³æ³¨ä¸‹ä½¿ç”¨æ–¹æ³•ï¼š 1Glide.with(itemView.getContext()).load(pic1path).placeholder(R.mipmap.empty_data).into(imageView); Glideæœ‰æ›´é«˜é˜¶çš„ä½¿ç”¨æ–¹æ³•ï¼Œæ ¹æ®éœ€æ±‚å­¦ä¹ å§ã€‚ 7. æ•°æ®è§£æGsonï¼ŒGoogleçš„å¼€æºåº“ï¼ŒåŸºæœ¬å¯ä»¥æ»¡è¶³æˆ‘çš„å¼€å‘éœ€æ±‚ï¼Œæš‚æ—¶æ²¡æœ‰å°è¯•è¿‡å…¶ä»–çš„ã€‚ä½¿ç”¨çš„è¿‡ç¨‹ä¸­é…åˆRetrofitä½¿ç”¨ 1compile 'com.squareup.retrofit2:converter-gson:2.1.0' 12345retrofit = new Retrofit.Builder().client(mOkHttpClient) /*This is the key*/ .addConverterFactory(GsonConverterFactory.create()) .addCallAdapterFactory(RxJava2CallAdapterFactory.create()) .baseUrl(BASE_URL) .build(); é…åˆæ’ä»¶ä½¿ç”¨æ•ˆæœä¼šæ›´å¥½ï¼šGsonFormat 8. ç•Œé¢å¸ƒå±€é‡‡ç”¨TabHost + Framgnetå¯ä»¥æ»¡è¶³æ—¥å¸¸éœ€æ±‚ï¼Œå½“ç„¶ä½¿ç”¨å¼€æºåº“FlycoTabLayoutæ›´æ˜¯å¯ä»¥æ„å»ºå‡ºç‚«é…·çš„Tabé¡µé¢ï¼Œé…åˆä¸ŠFragmentï¼ŒåŸºæœ¬å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚ä½¿ç”¨æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728switch (i) { case 0: textView.setText(\"èµ„è®¯\"); imageView.setImageResource(R.drawable.news); tabHost.addTab(tabHost.newTabSpec(\"1\").setIndicator(view).setContent( R.id.frag_news)); break; case 1: textView.setText(\"ç¬‘è¯\"); imageView.setImageResource(R.drawable.joke); tabHost.addTab(tabHost.newTabSpec(\"2\").setIndicator(view).setContent( R.id.frag_joke)); break; case 2: textView.setText(\"è¶£å›¾\"); imageView.setImageResource(R.drawable.funny); tabHost.addTab(tabHost.newTabSpec(\"3\").setIndicator(view).setContent( R.id.frag_funny)); break; case 3: textView.setText(\"å†å²\"); imageView.setImageResource(R.drawable.history); tabHost.addTab(tabHost.newTabSpec(\"4\").setIndicator(view).setContent( R.id.frag_history)); break; default: break;} FlycoTabLayoutçš„ä½¿ç”¨æ–¹æ³•å‚è€ƒå®˜æ–‡æˆ–è€…ç½‘ä¸Šå¦‚æµ·æ°´èˆ¬çš„åšæ–‡ã€‚ 9. å†…å®¹æœç´¢è‡ªå®šä¹‰Toolbarè¿™ä¸ªæ—¶å€™å°±æ˜¾ç¤ºå‡ºæ¥å¨åŠ›ã€‚ç®€å•çš„ä¸€ä¸ªæ–‡æœ¬æ¡†å’Œä¸€ä¸ªè‹¥éšè‹¥ç°çš„æœç´¢æŒ‰é’®ï¼Œæ»¡è¶³éœ€æ±‚ã€‚å¼€æºåº“ä¹Ÿæœ‰ä¸€äº›ï¼Œä½†æ˜¯é€‚åˆæˆ‘è‡ªå·±çš„ä¸å¤ªå¤šï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæˆ‘éƒ½æ˜¯å¦‚ä¸Šå®ç°ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;android.support.v7.widget.Toolbar android:id=\"@+id/toolbar_search\" android:layout_width=\"match_parent\" android:layout_height=\"40dp\" android:fitsSystemWindows=\"true\" android:background=\"@color/colorToolbar\"&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;EditText android:id=\"@+id/et_search\" android:layout_width=\"0dp\" android:layout_height=\"match_parent\" android:layout_marginBottom=\"8dp\" android:layout_marginTop=\"8dp\" android:layout_weight=\"6\" android:background=\"@drawable/search_edittext_bg\" android:padding=\"2dp\" android:textColor=\"@color/colorBlack\" android:textSize=\"12sp\"/&gt; &lt;Button android:id=\"@+id/bt_search\" android:layout_width=\"0dp\" android:layout_height=\"match_parent\" android:layout_weight=\"2\" android:clickable=\"false\" android:gravity=\"center\" android:text=\"æœç´¢\" android:background=\"@color/colorToolbar\" android:textColor=\"@color/colorToolbar\" android:textSize=\"14sp\"/&gt; &lt;/LinearLayout&gt;&lt;/android.support.v7.widget.Toolbar&gt; 10. ç‰ˆæœ¬æ›´æ–°ç¬¬ä¸‰æ–¹æœåŠ¡ ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯Fir.imï¼Œç›¸å¯¹æ¯”è¾ƒå¥½ç”¨ï¼Œåˆ©ç”¨æä¾›çš„ç‰ˆæœ¬æ¥å£æ£€æµ‹ç‰ˆæœ¬æ›´æ–°ã€‚ç„¶åæœ¬åœ°ä¸‹è½½æˆ–è€…è·³è½¬åˆ°æµè§ˆå™¨ä¸‹è½½åº”ç”¨ï¼Œå®Œæˆå®‰è£…ï¼Œéƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚ç±»ä¼¼çš„å¹³å°è¿˜æœ‰å¾ˆå¤šï¼Œå¯ä»¥ç½‘ä¸Šæœç´¢ä¸€ä¸‹ã€‚","link":"/2017/06/04/ã€ŠAndroid åº”ç”¨ä¹‹è·¯ã€‹ Android å¼€å‘æŠ€æœ¯é€‰å‹ï¼ˆåšå®¢ï¼Œæ–°é—»ï¼Œé˜…è¯»ç±»ï¼‰/"},{"title":"ã€ŠAndroid å¼€æºåº“ã€‹PhotoPicker ä»å¤´åˆ°è„š","text":"1. ç®€ä»‹PhotoPicker, æ˜¯ä¸€æ¬¾å¼€æºçš„å›¾ç‰‡é€‰æ‹©å™¨ã€‚æ•ˆæœä¸Šå’Œå¾®ä¿¡ç›¸ä¼¼ã€‚ 2. ä½¿ç”¨æ–¹æ³•2.1 æ·»åŠ ä¾èµ–12345678dependencies { compile 'me.iwf.photopicker:PhotoPicker:0.9.5@aar' compile 'com.android.support:appcompat-v7:23.4.0' compile 'com.android.support:recyclerview-v7:23.4.0' compile 'com.android.support:design:23.4.0' compile 'com.nineoldandroids:library:2.4.0' compile 'com.github.bumptech.glide:glide:3.7.0'} appcompat-v7version &gt;= 23.0.0 æˆ–è€…ä½¿ç”¨downloadæºç ï¼Œç„¶åä½¿ç”¨moduleä¾èµ–ï¼Œæˆ‘å¹³æ—¶ä½¿ç”¨æ˜¯è¿™ç§æ–¹å¼ã€‚ 12345dependencies { ... compile project(':PhotoPicker') ...} 2.2 ä»£ç é›†æˆå¦‚ä¸‹å†…å®¹æ¥è‡ªGithubä»‹ç» Pick Photo 123456PhotoPicker.builder() .setPhotoCount(9) .setShowCamera(true) .setShowGif(true) .setPreviewEnabled(false) .start(this, PhotoPicker.REQUEST_CODE); Preview Photo 1234567ArrayList&lt;String&gt; photoPaths = ...;PhotoPreview.builder() .setPhotos(selectedPhotos) .setCurrentItem(position) .setShowDeleteButton(false) .start(MainActivity.this); onActivityResult 12345678910@Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { super.onActivityResult(requestCode, resultCode, data); if (resultCode == RESULT_OK &amp;&amp; requestCode == PhotoPicker.REQUEST_CODE) { if (data != null) { ArrayList&lt;String&gt; photos = data.getStringArrayListExtra(PhotoPicker.KEY_SELECTED_PHOTOS); } }} AndroidManifest.xml 12345678910111213141516171819&lt;manifest xmlns:android=\"http://schemas.android.com/apk/res/android\" &gt; &lt;uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\"/&gt; &lt;uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/&gt; &lt;uses-permission android:name=\"android.permission.CAMERA\" /&gt; &lt;application ... &gt; ... &lt;activity android:name=\"me.iwf.photopicker.PhotoPickerActivity\" android:theme=\"@style/Theme.AppCompat.NoActionBar\" /&gt; &lt;activity android:name=\"me.iwf.photopicker.PhotoPagerActivity\" android:theme=\"@style/Theme.AppCompat.NoActionBar\"/&gt; &lt;/application&gt;&lt;/manifest&gt; Custom Style 1234567891011&lt;style name=\"actionBarTheme\" parent=\"ThemeOverlay.AppCompat.Dark.ActionBar\"&gt; &lt;item name=\"android:textColorPrimary\"&gt;@android:color/primary_text_light&lt;/item&gt; &lt;item name=\"actionBarSize\"&gt;@dimen/actionBarSize&lt;/item&gt;&lt;/style&gt;&lt;style name=\"customTheme\" parent=\"Theme.AppCompat.Light.NoActionBar\"&gt; &lt;item name=\"actionBarTheme\"&gt;@style/actionBarTheme&lt;/item&gt; &lt;item name=\"colorPrimary\"&gt;#FFA500&lt;/item&gt; &lt;item name=\"actionBarSize\"&gt;@dimen/actionBarSize&lt;/item&gt; &lt;item name=\"colorPrimaryDark\"&gt;#CCa500&lt;/item&gt;&lt;/style&gt; ProGuard 12345678910111213141516171819202122# Glide-keep public class * implements com.bumptech.glide.module.GlideModule-keep public enum com.bumptech.glide.load.resource.bitmap.ImageHeaderParser$** { **[] $VALUES; public *;}# nineoldandroids-keep interface com.nineoldandroids.view.** { *; }-dontwarn com.nineoldandroids.**-keep class com.nineoldandroids.** { *; }# support-v7-appcompat-keep public class android.support.v7.widget.** { *; }-keep public class android.support.v7.internal.widget.** { *; }-keep public class android.support.v7.internal.view.menu.** { *; }-keep public class * extends android.support.v4.view.ActionProvider { public &lt;init&gt;(android.content.Context);}# support-design-dontwarn android.support.design.**-keep class android.support.design.** { *; }-keep interface android.support.design.** { *; }-keep public class android.support.design.R$* { *; } 3. æºç åˆ†æ3.1 ä»£ç ç»“æ„ ç±»è¯´æ˜(æŒ‰ç…§åŠŸèƒ½) ç±»å æè¿° PhotoPicker å†…éƒ¨ç±»PhotoPickerBuilderæ˜¯å…³é”®ï¼Œè®¾ç½®å›¾ç‰‡é€‰æ‹©å‚æ•°ï¼Œå¯åŠ¨PhotoPickerActivityå‡åœ¨æ­¤ PhotoPickerActivity å›¾ç‰‡é€‰æ‹©ç•Œé¢ï¼Œä¸¤ä¸ªFragment:PhotoPickerFragmentï¼ŒImagePagerFragmentï¼Œä¸€ä¸ªç”¨æ¥å›¾ç‰‡é€‰æ‹©ï¼Œä¸€ä¸ªç”¨æ¥é¢„è§ˆå›¾ç‰‡ PhotoPagerActivity å›¾ç‰‡é¢„è§ˆç•Œé¢ï¼Œå’ŒPhotoPickerActivityä½¿ç”¨åŒæ ·çš„å¸ƒå±€æ–‡ä»¶ï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªFragment,ImagePagerFragment PhotoPreview å†…éƒ¨ç±»PhotoPreviewBuilderæ˜¯å…³é”®ï¼Œè®¾ç½®é¢„è§ˆå‚æ•°ï¼Œå¯åŠ¨PhotoPagerActivityå‡åœ¨æ­¤ PhotoPickerFragment å›¾ç‰‡é€‰æ‹©Fragment,åœ¨PhotoPickerActivityä¸­ä½¿ç”¨åˆ°,Toolbar + RecyclerView + ListPopupWindow ImagePagerFragment å›¾ç‰‡é¢„è§ˆFramgment,åœ¨PhotoPickerActivityä¸­å¦‚æœæ”¯æŒé¢„è§ˆï¼Œç‚¹å‡»å›¾ç‰‡åå°±ä¼šåˆ‡æ¢åˆ°æ­¤Fragment,å•ç‹¬ä½¿ç”¨PhotoPreviewè‡ªç„¶ä¹Ÿæ˜¯ç”¨çš„ImagePagerFragment ImageCaptureManager æ‹ç…§ç®¡ç†ç±»ï¼Œå½“PhotoPickerä¸­setShowCameraè®¾ä¸ºtrueåï¼Œç‚¹å‡»æ‹ç…§é¡¹ï¼Œä¼šè°ƒç”¨ç³»ç»Ÿç›¸æœºæ‹ç…§ï¼Œç›¸å…³æ–¹æ³•å®ç°å‡åœ¨ImageCaptureManager PhotoGridAdapter å›¾ç‰‡é€‰æ‹©ç•Œé¢RecyclerViewçš„ Adapter,ç€‘å¸ƒæµï¼Œä¸»è¦å› ä¸ºå®ƒç»§æ‰¿SelectableAdapter&lt;PhotoGridAdapter.PhotoViewHolder&gt;ï¼Œå¹³æ—¶å¼€å‘æœ‰ç›¸åŒéœ€æ±‚å¯ä»¥å€Ÿé‰´ä¸€äº›è¿™ä¸ªå®ç° PopupDirectoryListAdapter åº•éƒ¨å›¾ç‰‡åˆ†ç±»æ–‡ä»¶å¤¹ListPopupWindowçš„Adapter MediaStoreHelper å›¾ç‰‡æ•°æ®æŸ¥æ‰¾Helperç±»ï¼Œå•ç‹¬æ‹¿å‡ºæ¥çœ‹ï¼ŒLoaderçš„ä½¿ç”¨ SelectableAdapter è‡ªå®šä¹‰ç”¨äºé€‰æ‹©çš„RecyclerView.Adapter,æ”¯æŒtoggleSelection Selectable Selectableæ¥å£ï¼Œæ”¯æŒtoggleSelection PhotoPagerAdapter ImagePagerFragmentä¸­ç”¨äºé¢„è§ˆçš„ViewPagerçš„Adapter PhotoDirectory å›¾ç‰‡ç›®å½•å¯¹è±¡ï¼Œåœ¨PopupDirectoryListAdapterä¸­ä½¿ç”¨åˆ° Photo å›¾ç‰‡å¯¹è±¡ï¼Œå­˜æ”¾idå’ŒPathï¼Œåˆ†åˆ«å¯¹åº”æ•°æ®åº“ä¸­å›¾ç‰‡_IDå­—æ®µå’ŒDATAå­—æ®µ OnItemCheckListener å›¾ç‰‡é€‰æ‹©æ¡†çš„ç‚¹å‡»äº‹ä»¶æ¥å£ OnPhotoClickListener å›¾ç‰‡ç‚¹å‡»äº‹ä»¶æ¥å£ï¼Œåº”è¯¥åªæœ‰åœ¨å›¾ç‰‡é€‰æ‹©å™¨æ”¯æŒé¢„è§ˆçš„æƒ…å†µä¸‹ä½¿ç”¨ AndroidLifecycleUtils åˆ¤æ–­æ˜¯å¦å¯ä»¥åŠ è½½å›¾ç‰‡ FileUtils æ–‡ä»¶å¤„ç†å·¥å…·ç±»ï¼Œåªæœ‰ä¸€ä¸ªåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„æ–¹æ³• PermissionsConstant å…³äºæƒé™è¯·æ±‚çš„éƒ¨åˆ†å¸¸é‡ PermissionsUtils æƒé™è¯·æ±‚å·¥å…·ç±» PhotoDirectoryLoader ç»§æ‰¿CursorLoaderï¼Œä»æ•°æ®åº“ä¸­è¯»å–æ•°æ® SquareItemLayout å›¾ç‰‡é€‰æ‹©å™¨Itemå¸ƒå±€ TouchImageView é¢„è§ˆå›¾ç‰‡è‡ªå®šä¹‰å…ƒä»¶ 3.2 æºç è®¾è®¡æ€è·¯ä»ä»£ç ç»“æ„å’Œä½¿ç”¨æ–¹æ³•ä¸Šæ¥çœ‹ï¼ŒPhotoPickeræ˜¯å°†å›¾ç‰‡é€‰æ‹©ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„åŠŸèƒ½æ¨¡å—è§£è€¦å‡ºæ¥ï¼Œä»¥Activityçš„å½¢å¼è¿›è¡ŒPhotoPickeræˆ–è€…æ˜¯PhotoPreviewï¼Œåœ¨åˆé€‚çš„ä½ç½®åˆ›å»ºIntentæ˜¾ç¤ºå¯åŠ¨PhotoPagerAcitivty(é¢„è§ˆ)æˆ–è€…æ˜¯PhotoPickerActivity(é€‰æ‹©å›¾ç‰‡)ã€‚é’ˆå¯¹å›¾ç‰‡é€‰æ‹©çš„åœºæ™¯ï¼Œé€šè¿‡onActivityResultå¾—åˆ°æ‰€é€‰å›¾ç‰‡çš„Pathã€‚ PhotoPicker æ–¹æ³• å‚æ•° æè¿° setPhotoCount(int photoCount) EXTRA_MAX_COUNT(â€œMAX_COUNTâ€) è®¾ç½®å¯é€‰çš„æœ€å¤§å›¾ç‰‡æ•°é‡ setShowCamera(boolean showCamera) EXTRA_SHOW_CAMERA(â€œSHOW_CAMERAâ€) æ˜¯å¦æ˜¾ç¤ºæ‹ç…§ setShowGif(boolean showGif) EXTRA_SHOW_GIF(â€œSHOW_GIFâ€) æ˜¯å¦æ˜¾ç¤ºgifå›¾ setGridColumnCount(int columnCount) EXTRA_GRID_COLUMN(â€œcolumnâ€) è®¾ç½®å›¾ç‰‡é€‰æ‹©ç½‘æ ¼çš„åˆ—æ•° setSelected(ArrayList&lt; String&gt; imagesUri) EXTRA_ORIGINAL_PHOTOS(â€œORIGINAL_PHOTOSâ€) å·²é€‰ç…§ç‰‡ setPreviewEnabled(boolean previewEnabled) EXTRA_PREVIEW_ENABLED(â€œPREVIEW_ENABLEDâ€) å›¾ç‰‡ç½‘æ ¼è§†å›¾ä¸­æ˜¯å¦æ”¯æŒé¢„è§ˆ å‚æ•° æè¿° KEY_SELECTED_PHOTOS(â€œSELECTED_PHOTOSâ€) æ‰€é€‰å›¾ç‰‡Path åˆ—è¡¨ PhotoPreview æ–¹æ³• å‚æ•° æè¿° setCurrentItem(int currentItem) EXTRA_CURRENT_ITEM(â€œcurrent_itemâ€) è®¾ç½®é¢„è§ˆç•Œé¢å½“å‰æ˜¾ç¤ºå›¾ç‰‡åºå· setPhotos(ArrayList&lt; String&gt; photoPaths) EXTRA_PHOTOS(â€œphotosâ€) è®¾ç½®é¢„è§ˆå›¾ç‰‡åˆ—è¡¨ï¼Œå›¾ç‰‡Pathçš„ArrayList setShowDeleteButton(boolean showDeleteButton) EXTRA_SHOW_DELETE(â€œshow_deleteâ€) æ˜¯å¦æ˜¾ç¤ºåˆ é™¤æŒ‰é’® Buildè®¾è®¡æ¨¡å¼PhotoPickerå’ŒPhotoPreviewéƒ½æ˜¯é‡‡ç”¨çš„Buildè®¾è®¡æ¨¡å¼ã€‚åˆ©ç”¨æ„å»ºè€…æ¨¡å¼ï¼Œå¯ä»¥æ¸…æ™°çš„ç®¡ç†å‚æ•°ï¼Œå±‚æ¬¡æ¸…æ™°ï¼Œå¢åŠ ä»£ç çš„å¯è¯»æ€§ï¼ŒAndroidæºç ç³»ç»Ÿä¸­ä¹Ÿæœ‰æ­¤æ¨¡å¼çš„å¤§é‡ä½¿ç”¨ï¼Œå¦‚AlertDialog.Builderç­‰ç­‰ã€‚PhotoPickerBuilderå’ŒPhotoPreviewBuilderæ­£å¼é‡‡ç”¨çš„è¿™ç§è®¾è®¡æ¨¡å¼ã€‚ Loaderæœºåˆ¶loaderæœºåˆ¶ï¼ŒåŒ…æ‹¬LoaderManagerï¼ŒLoaderï¼ŒLoaderCallbacksä¸‰éƒ¨åˆ†ï¼ŒLoaderManager æ¥ç®¡ç†æˆ‘ä»¬çš„laoderå®ä¾‹ï¼Œè·å–æ¥åˆå§‹åŒ–ï¼Œé‡å¯ä¸€ä¸ªloader,Loader æ¥æ‰§è¡Œæˆ‘ä»¬çš„å¼‚æ­¥æ“ä½œï¼Œæœ‰å¼€å§‹ï¼Œå®Œæˆï¼Œåå°ç­‰æ¥å£å®ç°LoaderCallbacks æ¥æ‰§è¡Œæˆ‘ä»¬çš„loaderå›è°ƒï¼Œä¸»è¦æ˜¯ç»‘å®šåˆ†å‘Loaderï¼Œå®ŒæˆåŠ è½½ï¼Œé‡ç½®æ•°æ®ç­‰MediaStoreHelperä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•getPhotoDirsï¼Œæ–¹æ³•ä¸­ä½¿ç”¨activity.getSupportLoaderManager().initLoader(0, args,new PhotoDirLoaderCallbacks(activity, resultCallback));çš„æ–¹å¼åˆå§‹åŒ–Loader,ç„¶ååœ¨PhotoDirLoaderCallbackså®ç°LoaderManager.LoaderCallbacks&lt; Cursor&gt;æ¥å£ã€‚onCreateLoaderæ–¹æ³•ä¸­åˆ›å»ºPhotoDirectoryLoaderå¹¶ä¼ å…¥å‚æ•°ï¼ŒonLoadFinishedè¿”å›åå°æ•°æ®åº“æŸ¥è¯¢ç»“æœã€‚ 4. å¤‡æ³¨PhotoPickerï¼Œå¯ä»¥æ»¡è¶³æ—¥å¸¸å¼€å‘éœ€æ±‚ï¼Œä»£ç ç»“æ„éå¸¸æ¸…æ™°ï¼Œå¯ä»¥ç›´æ¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚åœ¨æºç ä¸Šè¿›è¡Œå®šåˆ¶ä¿®æ”¹ã€‚æ„Ÿè°¢å¤§ç¥çš„å¼€æºç²¾ç¥ã€‚","link":"/2017/04/27/ã€ŠAndroid å¼€æºåº“ã€‹PhotoPicker ä»å¤´åˆ°è„š/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆä¸€ï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹ä»ªè¡¨ç›˜è¿›åº¦æ¡","text":"1. å‰è¨€ä¸€ç‚¹ä¸€ç‚¹å­¦ä¹ è‡ªå®šä¹‰Viewï¼ŒæŒ‰ç…§ã€ŠAndroidå¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹ä¸­çš„è¯´æ³•ï¼Œè‡ªå®šä¹‰Viewå¤§è‡´å¯ä»¥åˆ†ä¸º4ç±»ï¼š ç»§æ‰¿Viewé‡å†™onDrawæ–¹æ³•ï¼› ç»§æ‰¿ViewGroupæ´¾ç”Ÿç‰¹æ®ŠLayoutï¼› ç»§æ‰¿ç‰¹å®šViewï¼› ç»§æ‰¿ç‰¹å®šViewGroup çœ‹ä¸‹ç¬¬ä¸€ç§ï¼Œåˆ¶ä½œä¸€ä¸ªç®€å•çš„ä»ªè¡¨ç›˜è¿›åº¦æ¡ã€‚ 2. å®ç°æ€è·¯ ç»§æ‰¿Viewï¼› è‡ªå®šä¹‰å±æ€§å€¼ï¼šarcColorï¼ŒbgColorï¼Œarc_textColorï¼Œarc_textSizeåˆ†åˆ«æ˜¯å‰æ™¯è‰²ï¼ŒèƒŒæ™¯è‰²ï¼Œè¿›åº¦æ–‡å­—é¢œè‰²ï¼Œè¿›åº¦æ–‡å­—å­—ä½“å¤§å°ï¼› ç¡®å®šå¼§å½¢ç»˜åˆ¶ä½ç½®å’Œæ–‡å­—ç»˜åˆ¶ä½ç½® å®ç°onDraw()æ–¹æ³• 3. æ•ˆæœ 4. çŸ¥è¯†ç‚¹4.1 MeasureSpec MeasureSpecä»£è¡¨ä¸€ä¸ª32ä½intå€¼ï¼Œé«˜2ä½ä»£è¡¨SpecModeï¼Œä½30ä½ä»£è¡¨SpecSizeã€‚SpecModeæŒ‡çš„æ˜¯æµ‹é‡æ¨¡å¼ï¼ŒSpecSizeæŒ‡çš„æ˜¯å¯¹åº”æµ‹é‡æ¨¡å¼ä¸‹çš„å¤§å°ã€‚ SpecModeæœ‰ä¸‹é¢å¦‚ä¸‹3ä¸­æ¨¡å¼ï¼š 123456789101112131415161718/** * Measure specification mode: The parent has not imposed any constraint * on the child. It can be whatever size it wants. */public static final int UNSPECIFIED = 0 &lt;&lt; MODE_SHIFT;/** * Measure specification mode: The parent has determined an exact size * for the child. The child is going to be given those bounds regardless * of how big it wants to be. */public static final int EXACTLY = 1 &lt;&lt; MODE_SHIFT;/** * Measure specification mode: The child can be as large as it wants up * to the specified size. */public static final int AT_MOST = 2 &lt;&lt; MODE_SHIFT; SpecMode æè¿° UNSPECIFIED çˆ¶å®¹å™¨ä¸å¯¹Viewæœ‰ä»»ä½•é™åˆ¶ï¼Œç³»ç»Ÿæ¶‰åŠï¼Œå¹³æ—¶å¾ˆå°‘æ¶‰åŠ EXACTLY çˆ¶å®¹å™¨å·²ç»æ£€æµ‹å‡ºViewæ‰€éœ€è¦çš„ç²¾å‡†å¤§å°ï¼Œå³SpecSizeå¤§å°ã€‚å¯¹åº”match_parentå’Œå›ºå®šæ•°å€¼ä¸¤ç§æƒ…å†µ AT_MOST çˆ¶å®¹å™¨æŒ‡å®šä¸€ä¸ªViewå¯ç”¨çš„å¤§å°ã€‚Viewçš„å¤§å°ä¸èƒ½è¶…è¿‡è¿™å€¼ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆå€¼è¦çœ‹Viewçš„å…·ä½“å®ç°ã€‚å¯¹åº”wrap_contentæƒ…å†µ SpecSizeå¤§å°å•ä½pxã€‚ ç”ŸæˆMeasureSpecæ–¹å¼å¦‚ä¸‹ï¼š 12345678public static int makeMeasureSpec(@IntRange(from = 0, to = (1 &lt;&lt; MeasureSpec.MODE_SHIFT) - 1) int size, @MeasureSpecMode int mode) { if (sUseBrokenMakeMeasureSpec) { return size + mode; } else { return (size &amp; ~MODE_MASK) | (mode &amp; MODE_MASK); } } è·å–sizeå’Œmodeçš„æ–¹å¼ 1234567891011121314151617181920212223/** * Extracts the mode from the supplied measure specification. * * @param measureSpec the measure specification to extract the mode from * @return {@link android.view.View.MeasureSpec#UNSPECIFIED}, * {@link android.view.View.MeasureSpec#AT_MOST} or * {@link android.view.View.MeasureSpec#EXACTLY} */@MeasureSpecModepublic static int getMode(int measureSpec) { //noinspection ResourceType return (measureSpec &amp; MODE_MASK);}/** * Extracts the size from the supplied measure specification. * * @param measureSpec the measure specification to extract the size from * @return the size in pixels defined in the supplied measure specification */public static int getSize(int measureSpec) { return (measureSpec &amp; ~MODE_MASK);} 4.2 Viewçš„å·¥ä½œæµç¨‹ è¿‡ç¨‹ æè¿° onMeasure æµ‹é‡è¿‡ç¨‹ï¼Œç¡®å®šViewçš„å®½åº¦å’Œé«˜åº¦ï¼Œä¼ å…¥çš„å‚widthMeasureSpecï¼ŒheightMeasureSpec onLayout å¸ƒå±€è¿‡ç¨‹ï¼Œç¡®å®šViewçš„ä¸Šä¸‹å·¦å³å››ä¸ªè§’çš„ä½ç½® onDraw ç»˜åˆ¶è¿‡ç¨‹ï¼Œä¸€èˆ¬ç”¨æ¥ç»˜åˆ¶ç‰¹æ®Šå›¾å½¢ ç»§æ‰¿Viewçš„è‡ªå®šä¹‰ViewåŸºæœ¬åªéœ€è¦å…³æ³¨onDraw()å’ŒonMeasure()ã€‚ç”±äºæ²¡æœ‰å­Viewæ‰€ä»¥ä¸éœ€è¦å…³æ³¨onLayout()ã€‚ 4.3 å›¾å½¢ç»˜åˆ¶å…·ä½“è¯·æŸ¥çœ‹Canvasç±»å’ŒPaintç±»ï¼Œè¿™ä¸¤ä¸ªç±»å†…å®¹æ¯”è¾ƒå¤šï¼Œå¯ä»¥è‡ªå·±ç ”ç©¶ä¸€ä¸‹ï¼Œæœ‰å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿ã€‚ 4.3.1 Canvasç»˜åˆ¶æ–¹æ³• 4.3.2 Paintå±æ€§å€¼Paintæšä¸¾å€¼ è®¾ç½®å±æ€§æ–¹æ³• 5. å…³é”®ä»£ç 5.1 attrs.xml123456&lt;declare-styleable name=\"ArcView\"&gt; &lt;attr name=\"arcColor\" format=\"color\"/&gt; &lt;attr name=\"bgColor\" format=\"color\"/&gt; &lt;attr name=\"arc_textColor\" format=\"color\"/&gt; &lt;attr name=\"arc_textSize\" format=\"dimension\"/&gt;&lt;/declare-styleable&gt; 5.2 ArcView123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138public class ArcView extends View { private final int MAX_SWEEP_ANGLE = 240; private final int START_SWEEP_ANGLE = 150; private final int DEFAULT_MAX_PROGRESS = 100; private final int DEFAULT_ARC_COLOR = Color.RED; private final int DEFAULT_BG_COLOR = Color.DKGRAY; private final int DEFAULT_TEXT_COLOR = Color.BLACK; private final int DEFAULT_TEXT_SIZE = 40; private int mArcColor = DEFAULT_ARC_COLOR; private int mBgColor = DEFAULT_BG_COLOR; private int mTextColor = DEFAULT_TEXT_COLOR; private int mTextSize = DEFAULT_TEXT_SIZE; private int progress = 0; private int mMaxProgress = DEFAULT_MAX_PROGRESS; private Paint mCirclePaint; private Paint mBgPaint; private Paint mTextPaint; private final Rect mTextBound = new Rect(); public ArcView(Context context) { this(context, null); } public ArcView(Context context, @Nullable AttributeSet attrs) { this(context, attrs, 0); } public ArcView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); final TypedArray attributes = getContext().obtainStyledAttributes(attrs, R.styleable.ArcView); mArcColor = attributes .getColor( R.styleable.ArcView_arcColor, DEFAULT_ARC_COLOR); mBgColor = attributes .getColor( R.styleable.ArcView_bgColor, DEFAULT_BG_COLOR); mTextColor = attributes .getColor( R.styleable.ArcView_arc_textColor, DEFAULT_TEXT_COLOR); mTextSize = (int) attributes .getDimension( R.styleable.ArcView_arc_textSize, DEFAULT_TEXT_SIZE); attributes.recycle(); init(); } private void init() { mCirclePaint = new Paint(); mCirclePaint.setColor(mArcColor); mCirclePaint.setStrokeWidth(8.0F); mCirclePaint.setDither(true); mCirclePaint.setAntiAlias(true); mCirclePaint.setStyle(Paint.Style.STROKE); mBgPaint = new Paint(); mBgPaint.setColor(mBgColor); mBgPaint.setStrokeWidth(20.0F); mBgPaint.setAntiAlias(true); mBgPaint.setStyle(Paint.Style.STROKE); mBgPaint.setStrokeCap(Paint.Cap.ROUND); mTextPaint = new Paint(); mTextPaint.setStrokeWidth(4); //å­—ä½“SPå•ä½è½¬æ¢æˆPX int size = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_SP, mTextSize, getResources().getDisplayMetrics()); mTextPaint.setTextSize(size); mTextPaint.setAntiAlias(true); mTextPaint.setColor(mTextColor); mTextPaint.setTextAlign(Paint.Align.LEFT); } @Override protected void onDraw(Canvas canvas) { super.onDraw(canvas); int paddingLeft = getPaddingLeft(); int paddingRight = getPaddingRight(); int paddingTop = getPaddingTop(); int paddingBottom = getPaddingBottom(); int circleWidth = getWidth() - paddingLeft - paddingRight; int circleHeight = getHeight() - paddingTop - paddingBottom; int radius = Math.min(circleWidth, circleHeight) / 2; int left = getLeft() + paddingLeft; int right = left + radius * 2; int top = getTop() + getPaddingTop(); int bottom = top + 2 * radius; canvas.drawArc(left, top, right, bottom, START_SWEEP_ANGLE, MAX_SWEEP_ANGLE, false, mBgPaint); int sweepArc = MAX_SWEEP_ANGLE * progress / mMaxProgress; canvas.drawArc(left, top, right, bottom, START_SWEEP_ANGLE, sweepArc, false, mCirclePaint); String text = String.valueOf(progress) + \"%\"; mTextPaint.getTextBounds(text, 0, text.length(), mTextBound); canvas.drawText(text, (left + right) / 2 - mTextBound.width() / 2, (top + bottom) / 2 + mTextBound.height() / 2, mTextPaint); } /** * è®¾ç½®è¿›åº¦å¤§å° */ public void setProgress(int progress) { if (progress &lt; 0 || progress &gt; mMaxProgress) { return; } this.progress = progress; invalidate(); } /** * è®¾ç½®æœ€å¤§è¿›åº¦å€¼ */ public void setMaxProgress(int maxProgress) { this.mMaxProgress = maxProgress; }} 6. æºç æºç å·²ä¸Šä¼ Githubï¼Œåç»­è‡ªå®šä¹‰Viewçš„å­¦ä¹ Demoä¹Ÿä¼šé™†ç»­ä¸Šä¼  CustomViewDemo","link":"/2017/10/13/ã€ŠAndroid è¿›é˜¶ï¼ˆä¸€ï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹ä»ªè¡¨ç›˜è¿›åº¦æ¡/"},{"title":"ã€ŠAndroid è¿›é˜¶ï¼ˆäºŒï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹Dota2èƒ½åŠ›é›·è¾¾å›¾","text":"1. å‰è¨€æœ€è¿‘çœ‹Dota2çš„æ¯”èµ›çš„æ—¶å€™æ— æ„åœ¨ä¸€ä¸ªåº”ç”¨ä¸­çœ‹åˆ°æ¥ä¸€ä¸ªèƒ½åŠ›åˆ†æçš„é›·è¾¾å›¾ï¼Œå°±æ˜¯å±•ç¤ºä½ çš„å„æ–¹é¢æ•°æ®ã€‚ä½ å¯èƒ½çœ‹è§è¿‡è¿™ä¸ªå›¾ã€‚ 2. å®ç°æ€è·¯ ç»§æ‰¿Viewï¼Œå¤å†™onDrawã€‚ ç¡®å®šNè¾¹å½¢å’Œæ¯ä¸ªè¾¹å¯¹åº”çš„è§’åº¦ï¼› ç¡®å®šå¤šè¾¹å½¢å¤–æ¥åœ†çš„åŠå¾„ä»¥åŠåœ†å¿ƒï¼ˆä¹Ÿå°±æ˜¯ä¸­å¿ƒç‚¹ï¼‰ ç¡®å®šæ¯æ¡åŠå¾„ä¸Šçš„æ‰€æœ‰ç‚¹çš„åæ ‡ã€‚ ç¡®å®šæ¯æ¡æ•°æ®åœ¨å›¾å½¢ä¸Šçš„åæ ‡ï¼› ç¡®å®šæ–‡å­—åœ¨å›¾å½¢ä¸Šçš„ä½ç½®ï¼› é‡‡ç”¨åˆé€‚çš„ç»˜åˆ¶æ–¹å¼ç»˜åˆ¶ï¼› 3. å®ç°3.1 å®šä¹‰è‡ªå®šä¹‰å±æ€§ä¸»è¦å®šä¹‰è¿™å‡ ä¸ªå±æ€§ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ç»§ç»­æ‰©å±•ã€‚ 1234567891011121314&lt;declare-styleable name=\"CustomRadarChart\"&gt; &lt;!-- èœ˜è››ç½‘çº¿æ¡å®½åº¦ --&gt; &lt;attr name=\"radarLineWidth\" format=\"dimension\"/&gt; &lt;!-- èœ˜è››ç½‘é¢œè‰² --&gt; &lt;attr name=\"radarLineColor\" format=\"color\"/&gt; &lt;!-- åŠå¾„åˆ†æˆNæ®µ--&gt; &lt;attr name=\"radarLineSegments\" format=\"integer\"/&gt; &lt;!-- æ–‡å­—é¢œè‰² --&gt; &lt;attr name=\"radarTextColor\" format=\"color\"/&gt; &lt;!-- æ–‡å­—å­—ä½“å¤§å°--&gt; &lt;attr name=\"radarTextSize\" format=\"integer\"/&gt; &lt;!-- æ•°æ®å±•ç¤ºè¦†ç›–åŒºåŸŸé¢œè‰² --&gt; &lt;attr name=\"radarCoverColor\" format=\"color\"/&gt;&lt;/declare-styleable&gt; 3.2 è‡ªå®šä¹‰Viewä»£ç æ³¨é‡Šä»£ç ä¸­éƒ½æœ‰å†™å‡ºæ¥ï¼Œä¸»è¦æ˜¯çœ‹ä¸‹å®ç°çš„æ–¹å¼ã€‚æ²¡æœ‰è¿‡å¤šçš„ä¿®é¥°å’Œç²¾ç®€ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326public class CustomRadarChart extends View { /** * N è¾¹å½¢ï¼Œé»˜è®¤ä¸º6è¾¹å½¢ */ private final int DEFAULT_PIECE_NUMBER = 7; /** * çº¿æ¡å®½åº¦ï¼Œé»˜è®¤ä¸º10px */ private final int DEFAULT_LINE_WIDTH = 4; /** * çº¿æ¡é¢œè‰²,é»˜è®¤ä¸ºç°è‰² */ private final int DEFAULT_LINE_COLOR = 0xffd0d6dc; /** * åŠå¾„åˆ†æˆNæ®µ,é»˜è®¤ä¸º4æ®µï¼Œåœ†å¿ƒç®—ä¸€æ®µ */ private final int DEFAULT_LINE_SEGMENTS = 4; /** * å¤–æ¥åœ†åŠå¾„ï¼Œé»˜è®¤ä¸º50px */ private final int DEFAULT_RADIUS = 50; /** * æ–‡æœ¬é¢œè‰²å’Œæ–‡æœ¬å­—ä½“, é»˜è®¤ä¸ºé»‘è‰²ï¼Œ10px */ private final int DEFAULT_TEXT_COLOR = 0xff647d91; private final int DEFAULT_TEXT_SIZE = 10; /** * è¦†ç›–é¢ç»˜åˆ¶é¢œè‰² */ private final int DEFAULT_COVER_COLOR = 0x55ced6dc; private int mPieceNumber = DEFAULT_PIECE_NUMBER; private int mRadius = DEFAULT_RADIUS; private int mLineWidth = DEFAULT_LINE_WIDTH; private int mLineColor = DEFAULT_LINE_COLOR; private int mLineSegments = DEFAULT_LINE_SEGMENTS; private int mTextColor = DEFAULT_TEXT_COLOR; private int mTextSize = DEFAULT_TEXT_SIZE; private int mCoverColor = DEFAULT_COVER_COLOR; private double mAverageAngle = 0; private Paint mRadarPaint; private TextPaint mTextPaint; private Paint mCoverPaint; private Path mCoverPath; List&lt;RadarPoints&gt; mRadarPointses = new ArrayList&lt;&gt;(); List&lt;RadarEntry&gt; mRadarEntries = new ArrayList&lt;&gt;(); List&lt;PointF&gt; mCoverPoints = new ArrayList&lt;&gt;(); List&lt;PointF&gt; mTextPoints = new ArrayList&lt;&gt;(); /** * å¤–æ¥åœ†ä¸­å¿ƒä½ç½® */ private int mPositionX = 0; private int mPositionY = 0; public CustomRadarChart(Context context) { this(context, null); } public CustomRadarChart(Context context, @Nullable AttributeSet attrs) { this(context, attrs, 0); } public CustomRadarChart(Context context, @Nullable AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); TypedArray attributes = getContext().obtainStyledAttributes(attrs, R.styleable.CustomRadarChart); mLineWidth = (int) attributes.getDimension(R.styleable.CustomRadarChart_radarLineWidth, DEFAULT_LINE_WIDTH); mLineColor = attributes.getColor(R.styleable.CustomRadarChart_radarLineColor, DEFAULT_LINE_COLOR); mLineSegments = attributes.getInteger(R.styleable.CustomRadarChart_radarLineSegments, DEFAULT_LINE_SEGMENTS); mTextColor = attributes.getColor(R.styleable.CustomRadarChart_radarTextColor, DEFAULT_TEXT_COLOR); mTextSize = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_SP, attributes.getInteger(R.styleable.CustomRadarChart_radarTextSize, DEFAULT_TEXT_SIZE), getResources().getDisplayMetrics()); mCoverColor = (int) attributes.getColor(R.styleable.CustomRadarChart_radarCoverColor, DEFAULT_COVER_COLOR); init(); } private void init() { /** * èœ˜è››ç½‘Paintåˆå§‹åŒ– */ mRadarPaint = new Paint(); mRadarPaint.setColor(mLineColor); mRadarPaint.setStrokeWidth(mLineWidth); mRadarPaint.setAntiAlias(true); mRadarPaint.setStyle(Paint.Style.STROKE); /** * æ–‡å­—ç»˜åˆ¶Paintåˆå§‹åŒ– */ mTextPaint = new TextPaint(); mTextPaint.setColor(mTextColor); mTextPaint.setTextSize(mTextSize); mTextPaint.setAntiAlias(true); mTextPaint.setStyle(Paint.Style.STROKE); /** *è¦†ç›–é¢ç»˜åˆ¶Paintåˆå§‹åŒ– */ mCoverPaint = new Paint(); mCoverPaint.setColor(mCoverColor); mCoverPaint.setAntiAlias(true); mCoverPaint.setStyle(Paint.Style.FILL); mCoverPath = new Path(); } @Override protected void onSizeChanged(int w, int h, int oldw, int oldh) { super.onSizeChanged(w, h, oldw, oldh); mPositionX = w / 2; mPositionY = h / 2; mAverageAngle = 360.0 / mPieceNumber; int max = 0; for(RadarEntry entry : mRadarEntries) { Rect textBound = new Rect(); mTextPaint.getTextBounds(entry.title, 0, entry.title.length(), textBound); max = Math.max(textBound.width(), max); } mRadius = Math.min(w / 2 - max, h / 2); if (mRadarEntries==null || mRadarEntries.size()==0) { throw new NullPointerException(\"è¯·å…ˆè®¾ç½®æ•°æ®é›†\"); } /** * è®¡ç®—æ¯ä¸€æ¡è½´çº¿ä¸Šçš„æ‰€æœ‰ç‚¹ */ for (int i = 0; i &lt; mPieceNumber; i++) { List&lt;PointF&gt; pointFs = new ArrayList&lt;&gt;(); for (int j = 0; j &lt; mLineSegments; j++) { PointF point = new PointF(); double percent = j * 1.0 / (mLineSegments - 1); point.set(getPloygonX(mAverageAngle * i, percent), getPloygonY(mAverageAngle * i, percent)); pointFs.add(point); } RadarPoints radarPoints = new RadarPoints(i, pointFs); mRadarPointses.add(radarPoints); } /** * æ ¹æ®æ•°æ®é›†è®¡ç®—è¦†ç›–å¤šå˜å½¢çš„ç‚¹ */ for (int m = 0; m &lt; mPieceNumber; m++) { PointF pointF = new PointF(); double percent = mRadarEntries.get(m).level / 100.0; pointF.set(getPloygonX(mAverageAngle * m, percent), getPloygonY(mAverageAngle * m, percent)); mCoverPoints.add(pointF); } /** * è®¾ç½®æ–‡å­—æ˜¾ç¤ºä½ç½® */ for (int m = 0; m &lt; mPieceNumber; m++) { PointF pointF = new PointF(); String title = mRadarEntries.get(m).title; Rect textBound = new Rect(); mTextPaint.getTextBounds(title, 0, title.length(), textBound); float boundx = mRadarPointses.get(m).getPointFs().get(mLineSegments -1).x; float boundy = mRadarPointses.get(m).getPointFs().get(mLineSegments -1).y; if( boundx &gt; mRadius &amp;&amp; boundy &lt;= mRadius) { pointF.set(getPloygonX(mAverageAngle * m, 1), getPloygonY(mAverageAngle * m, 1) - textBound.height()*2) ; } else if ( boundx &lt;= mRadius &amp;&amp; boundy &lt;= mRadius){ pointF.set(getPloygonX(mAverageAngle * m, 1) - textBound.width(), getPloygonY(mAverageAngle * m, 1) - textBound.height()*2); } else if( boundx &lt;= mRadius &amp;&amp; boundy &gt; mRadius) { pointF.set(getPloygonX(mAverageAngle * m, 1) - textBound.width(), getPloygonY(mAverageAngle * m, 1) ); } else { pointF.set(getPloygonX(mAverageAngle * m, 1), getPloygonY(mAverageAngle * m, 1)); } mTextPoints.add(pointF); } } /** * è®¾ç½®æ•°æ®é›†ï¼Œæ•°æ®é›†çš„indexå†³å®šä½ç½®ï¼Œé¡ºæ—¶é’ˆæ–¹å‘ï¼Œèµ·å§‹è§’åº¦ä¸º0åº¦ */ public void setRadatEntries(List&lt;RadarEntry&gt; entries) { this.mRadarEntries = entries; mPieceNumber = entries.size(); postInvalidate(); } @Override protected void onDraw(Canvas canvas) { super.onDraw(canvas); /** * ç»˜åˆ¶ä¸­å¿ƒç‚¹ */ canvas.drawPoint(mPositionX, mPositionY, mRadarPaint); /** * ç»˜åˆ¶èœ˜è››ç½‘ */ for (int i = 0; i &lt; mLineSegments; i++) { for (int j = 0; j &lt; mPieceNumber - 1; j++) { canvas.drawLine(mRadarPointses.get(j).getPointFs().get(i).x, mRadarPointses.get( j).getPointFs().get(i).y, mRadarPointses.get(j + 1).getPointFs().get(i).x, mRadarPointses.get( j + 1).getPointFs().get(i).y, mRadarPaint); } canvas.drawLine(mRadarPointses.get(mPieceNumber - 2).getPointFs().get(i).x, mRadarPointses.get(mPieceNumber - 2).getPointFs().get(i).y, mRadarPointses.get(mPieceNumber - 1).getPointFs().get(i).x, mRadarPointses.get( mPieceNumber - 1).getPointFs().get(i).y, mRadarPaint); canvas.drawLine(mRadarPointses.get(mPieceNumber - 1).getPointFs().get(i).x, mRadarPointses.get(mPieceNumber - 1).getPointFs().get(i).y, mRadarPointses.get(0).getPointFs().get(i).x, mRadarPointses.get( 0).getPointFs().get(i).y, mRadarPaint); } /** * ç»˜åˆ¶è½´çº¿ */ for (int k = 0; k &lt; mPieceNumber; k++) { canvas.drawLine(mRadarPointses.get(k).getPointFs().get(0).x, mRadarPointses.get(k).getPointFs().get(0).y, mRadarPointses.get(k).getPointFs().get(mLineSegments - 1).x, mRadarPointses.get( k).getPointFs().get(mLineSegments - 1).y, mRadarPaint); } /** * ç»˜åˆ¶æ•°æ® */ if (mCoverPoints != null &amp;&amp; mCoverPoints.size() == mPieceNumber) { mCoverPath.reset(); mCoverPath.moveTo(mCoverPoints.get(0).x, mCoverPoints.get(0).y); for (int i = 1; i &lt; mPieceNumber; i++) { mCoverPath.lineTo(mCoverPoints.get(i).x, mCoverPoints.get(i).y); } mCoverPath.close(); canvas.drawPath(mCoverPath, mCoverPaint); } else { throw new NullPointerException(\"è¯·å…ˆè®¾ç½®æ•°æ®é›†\"); } /** * ç»˜åˆ¶æ–‡å­—,ä½¿ç”¨StaticLayoutè¿›è¡Œæ¢è¡Œæ–‡å­—çš„ç»˜åˆ¶ */ for (int i = 0; i &lt; mPieceNumber; i++) { canvas.save(); String str= mRadarEntries.get(i).title + \"\\r\\n\" + Math.floor(mRadarEntries.get(i).level*10)/10; StaticLayout layout = new StaticLayout(str, mTextPaint, 300, Layout.Alignment.ALIGN_NORMAL, 1.0F, 0.0F, true); canvas.translate(mTextPoints.get(i).x,mTextPoints.get(i).y); layout.draw(canvas); canvas.restore(); } } public float getPloygonX(double angle, double percent) { return Float.parseFloat( String.valueOf( mPositionX + Math.cos(angle / 360.0 * 2 * Math.PI) * mRadius * percent)); } public float getPloygonY(double angle, double percent) { return Float.parseFloat(String.valueOf( mPositionY + Math.sin(angle / 360.0 * 2 * Math.PI) * mRadius * percent)); } /** * é›·è¾¾å›¾æ•°æ®è½½ä½“ */ public static class RadarEntry { private String title; private Float level; public RadarEntry(String title, float level) { this.title = title; this.level = level; } } /** * æ¯ä¸€æ¡çº¿ä¸Šçš„æ‰€æœ‰ç‚¹é›†åˆ */ public class RadarPoints { int index; List&lt;PointF&gt; mPointFs; public RadarPoints(int index, List&lt;PointF&gt; pointFs) { this.index = index; mPointFs = pointFs; } public int getIndex() { return index; } public void setIndex(int index) { this.index = index; } public List&lt;PointF&gt; getPointFs() { return mPointFs; } public void setPointFs(List&lt;PointF&gt; pointFs) { mPointFs = pointFs; } }} å¯èƒ½ç”»å›¾è¿‡ç¨‹ä¸­çš„å®ç°æ–¹å¼ä¼˜ç‚¹ç²—ç³™ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„æ–¹å¼ï¼Œæ”¹å†™å³å¯ã€‚ä¸ªäººæ˜¯å…ˆå°†æ¯æ¡åŠå¾„ä¸Šçš„ç«¯ç‚¹å…¨éƒ¨è®¡ç®—å‡ºæ¥è¿›è¡Œä¿å­˜ï¼Œç„¶åä¸€æ¬¡è¿æ¥ï¼Œç„¶åæŠŠæ¯ä¸ªåŠå¾„é¦–å°¾ç«¯ç‚¹è¿æ¥ï¼Œç„¶åç»˜åˆ¶è¦†ç›–åŒºåŸŸï¼Œè¦†ç›–åŒºåŸŸä¹Ÿæ˜¯é‡‡ç”¨å…ˆè®¡ç®—ç‚¹ä½ç½®ï¼Œç„¶åè¿æ¥çš„æ–¹å¼å®ç°ï¼Œæœ€åç¡®å®šæ–‡æœ¬çš„æ˜¾ç¤ºä½ç½®å’Œæ–‡å­—çš„ç»˜åˆ¶ã€‚ç”±äºè¿™é‡Œæ¶‰åŠåˆ°ç»˜åˆ¶æ¢è¡Œæ–‡å­—ï¼Œä½¿ç”¨åˆ°æ¥StaticLayoutã€‚ä½¿ç”¨æ–¹æ³•è¯·æŸ¥é˜…å¯¹åº”APIã€‚ 4. æ•ˆæœ 5. æºç æºç ä¾ç„¶æ˜¯ä¸Šä¼ åˆ°GithubCustomViewDemo","link":"/2017/10/17/ã€ŠAndroid è¿›é˜¶ï¼ˆäºŒï¼‰ã€‹ è‡ªå®šä¹‰Viewä¹‹Dota2èƒ½åŠ›é›·è¾¾å›¾/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Google æœ€æ–°Hover Menu(æ‚¬æµ®èœå•)","text":"ç®€ä»‹Hoverï¼Œè¿™äº›å¤©å¤§å®¶è®¨è®ºçš„æ¯”è¾ƒå¤šçš„ä¸€ä¸ªå¼€æºåº“ï¼Œgoogleç»„ç»‡ä¸‹çš„ä¸€ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯é¡¹ç›®ä»‹ç»ä¸­åˆå‡ºç°äº† Why ? å®˜ç½‘Demo ç®€å•ä½¿ç”¨ è‡ªå®šä¹‰MyNavigationContentï¼Œç”¨æ¥æ˜¾ç¤ºæ¯ä¸ªä¸åŒçš„Tabä¸‹çš„å†…å®¹é¡µ 1234567891011121314151617181920212223242526272829303132333435public class MyNavigationContent extends FrameLayout implements NavigatorContent { private ImageView imageViewLogo; private TextView textViewTitle; private int imageResId; private String title; public MyNavigationContent(@NonNull Context context, int imageRedId, String title) { super(context); this.imageResId = imageRedId; this.title = title; init(); } private void init() { LayoutInflater.from(getContext()).inflate(R.layout.view_content_text_icon, this, true); imageViewLogo = (ImageView) findViewById(R.id.iv_logo); textViewTitle = (TextView) findViewById(R.id.tv_title); imageViewLogo.setImageResource(imageResId); textViewTitle.setText(title); } @NonNull @Override public View getView() { return this; } @Override public void onShown(@NonNull Navigator navigator) { } @Override public void onHidden() { }} 2.è‡ªå®šä¹‰HoverMenuAdapterï¼Œç”¨äºå°†tabå’ŒNavigationContentè”ç³»èµ·æ¥ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public class HoverDemoMenuAdapter implements HoverMenuAdapter { private final Context mContext; private final List&lt;String&gt; mTabIds; private final Map&lt;String, NavigatorContent&gt; mData; private final Set&lt;ContentChangeListener&gt; mContentChangeListeners = new HashSet&lt;&gt;(); public HoverDemoMenuAdapter(@NonNull Context context, @NonNull Map&lt;String, NavigatorContent&gt; data) throws IOException { mContext = context; mData = data; mTabIds = new ArrayList&lt;&gt;(); for (String tabId : mData.keySet()) { mTabIds.add(tabId); } } @Override public int getTabCount() { return mTabIds.size(); } @Override public View getTabView(int index) { ImageView imageView = new ImageView(mContext); imageView.setBackgroundResource(R.drawable.bg); switch (index) { case 0: imageView.setImageResource(R.drawable.bike);break; case 1: imageView.setImageResource(R.drawable.run);break; case 2: imageView.setImageResource(R.drawable.android);break; default:break; } imageView.setPadding(30,30,30,30); return imageView; } @Override public long getTabId(int position) { return position; } @Override public NavigatorContent getNavigatorContent(int index) { String tabId = mTabIds.get(index); return mData.get(tabId); } @Override public void addContentChangeListener(@NonNull ContentChangeListener listener) { mContentChangeListeners.add(listener); } @Override public void removeContentChangeListener(@NonNull ContentChangeListener listener) { mContentChangeListeners.remove(listener); }} 3.åˆ›å»ºç»§æ‰¿HoverMenuServiceçš„è‡ªå®šä¹‰Service 12345678910111213141516171819202122232425262728293031323334353637383940414243public class HoverDemoService extends HoverMenuService { private HoverDemoMenuAdapter mDemoHoverMenuAdapter; /*æ˜¾ç¤ºæ‚¬æµ®æŒ‰é’®*/ public static void showFloatingMenu(Context context) { context.startService(new Intent(context, HoverDemoService.class)); } @Override protected HoverMenuAdapter createHoverMenuAdapter() { try { Map&lt;String, NavigatorContent&gt; data = new HashMap&lt;&gt;(); /*æ·»åŠ tabå’Œå¯¹åº”çš„NavigationContent*/ data.put(\"1\", new MyNavigationContent(this, R.drawable.bike, \"1ï¼Œè‡ªè¡Œè½¦æ˜¯å…‹æœå¿ƒè„åŠŸèƒ½æ¯›ç—…çš„æœ€ä½³å·¥å…·ä¹‹ä¸€ã€‚ä¸–ç•Œä¸Šæœ‰åŠæ•°ä»¥ä¸Šçš„äººæ˜¯æ­»äºå¿ƒè„ç—…çš„ï¼Œéª‘å•è½¦ä¸åªèƒ½è—‰è…¿éƒ¨çš„è¿åŠ¨å‹ç¼©è¡€æ¶²æµåŠ¨ï¼Œä»¥åŠæŠŠå¤‡æ³¨ä»è¡€ç®¡æœ«æ¢¢æŠ½å›å¿ƒè„ï¼Œäº‹å®ä¸Šå´åŒæ—¶å¼ºåŒ–äº†å¾®è¡€ç®¡ç»„ç»‡ï¼Œè¿™å«â€œé™„å¸¦å¾ªç¯â€ã€‚å¼ºåŒ–è¡€ç®¡å¯ä»¥ä½¿ä½ ä¸å—å¹´é¾„çš„å¨èƒï¼Œé’æ˜¥æ°¸é©»ã€‚ \\n\" + \"2ï¼Œä¹ æƒ¯æ€§çš„å•è½¦è¿åŠ¨ï¼Œæ›´èƒ½æ‰©å¤§ä½ çš„å¿ƒè„ã€‚å¦åˆ™è¡€ç®¡æ„ˆæ¥æ„ˆç»†ï¼Œå¿ƒè„æ„ˆæ¥æ„ˆé€€åŒ–ï¼Œåˆ°äº†æ™šå¹´ï¼Œä½ å°±ä¼šä½“éªŒåˆ°å®ƒæ‰€å¸¦æ¥çš„çƒ¦æ¼ï¼Œé‚£æ—¶ä½ ä¼šå‘ç°ï¼Œè‡ªè¡Œè½¦è¿åŠ¨æ˜¯å¤šä¹ˆçš„å®Œç¾ã€‚å•è½¦æ˜¯éœ€è¦å¤§é‡æ°§æ°”çš„è¿åŠ¨ï¼Œæ›¾ç»æœ‰ä¸ªè€å¹´äººä»¥6å¤©æ—¶é—´ï¼Œå®Œæˆäº†460å…¬é‡Œçš„å•è½¦æ—…è¡Œã€‚ä»–è¯´ï¼šâ€œè€å¹´äººä¸€å‘¨è‡³å°‘è¦æœ‰3æ¬¡è¿åŠ¨ï¼Œä½¿å¿ƒè„å¼ºåŒ–èµ·æ¥ï¼Œæ¢å¤æ­£å¸¸åŠŸèƒ½ã€‚ä½ è¦ä½¿å¿ƒè„æ¿€çƒˆè·³åŠ¨ï¼Œä½†ä¸å¯è¿‡ä¹…ã€‚å¦‚æ­¤å®ƒå°†èƒ½é€‚åº”ç´§æ€¥çŠ¶å†µï¼Œå¦‚èµ¶è½¦æˆ–æŠµæŠ—å›°å¢ƒã€‚â€\\n\" + \"3ï¼Œå•è½¦è¿åŠ¨åŒæ—¶ä¹Ÿèƒ½é˜²æ­¢é«˜è¡€å‹ï¼Œæœ‰æ—¶æ¯”è¯ç‰©æ›´æœ‰æ•ˆã€‚è¿˜èƒ½é˜²æ­¢å‘èƒ–ã€è¡€ç®¡ç¡¬åŒ–ï¼Œå¹¶ä½¿éª¨éª¼å¼ºåŠã€‚è‡ªè¡Œè½¦ä½¿ä½ ä¸å¿…ç”¨è¯ç‰©æ¥ç»´æŒå¥åº·ï¼Œè€Œä¸”æ¯«æ— å®³å¤„ã€‚\")); data.put(\"2\", new MyNavigationContent(this,R.drawable.run, \"1.å‘Šåˆ«è‡ƒè‚¿èº«æã€‚\\n\" + \"\\n\" + \"è®¸å¤šäººå¼€å§‹è·‘æ­¥å°±æ˜¯å› ä¸ºå‡è‚¥ï¼Œè·‘æ­¥ç¡®å®å‡è‚¥çš„æœ€å¥½è¿åŠ¨æ–¹å¼ï¼Œè·‘æ­¥æ¯åˆ†é’Ÿæ¯”èµ·å…¶ä»–è¿åŠ¨ç‡ƒçƒ§æ›´å¤šçš„å¡è·¯é‡Œã€‚\\n\" + \"\\n\" + \"2.é˜²æ­¢ä½ çš„éª¨éª¼ï¼Œè‚Œè‚‰é€€åŒ–ã€‚\\n\" + \"\\n\" + \"æˆ‘ä»¬çš„éª¨éª¼æ˜¯å’Œä½ çš„èº«ä½“éœ€æ±‚ç›¸äº’åè°ƒçš„ã€‚é•¿æœŸååœ¨æ˜¾ç¤ºå™¨å‰çš„æˆ‘ä»¬è®©æˆ‘ä»¬çš„éª¨éª¼è¶Šæ¥è¶Šè„†å¼±ã€‚è€Œé•¿æœŸçš„ï¼Œç»å¸¸çš„è¿åŠ¨ä¼šä½¿ä½ çš„éª¨éª¼ä¿æŒå¥åº·ã€‚æ›´è¿›ä¸€æ­¥è¯´å°±æ˜¯é˜²æ­¢æˆ‘ä»¬èº«ä½“å†…éƒ¨è€åŒ–çš„æ›´å¿«ã€‚ç»å¸¸çš„é«˜å¼ºåº¦é”»ç‚¼ï¼Œä¾‹å¦‚è·‘æ­¥ï¼Œè¢«è¯æ˜å¯ä»¥ä¿ƒè¿›äººä½“è·å°”è’™çš„ç”Ÿé•¿ï¼Œè·å°”è’™å°±æ˜¯é‚£äº›åäººä¸ºäº†çœ‹èµ·æ¥æ›´å¹´è½»è€ŒæŒç»­æ³¨å°„çš„è¯å‰‚ã€‚\\n\" + \"\\n\" + \"3.æŠµæŠ—ç–¾ç—…\\n\" + \"\\n\" + \"è·‘æ­¥å¯ä»¥é™ä½å¾—ä¸­é£å’Œä¹³è…ºç™Œçš„é£é™©ã€‚ç»å¸¸çš„è·‘æ­¥å·²ç»æˆä¸ºåŒ»ç”Ÿå¯¹é‚£äº›å®¹æ˜“å¼•å‘æˆ–åœ¨å·²ç»å¤„åœ¨æ—©æœŸçš„éª¨è´¨ç–æ¾ï¼Œç³–å°¿ç—…ï¼Œé«˜è¡€å‹ç—…äººçš„æ²»ç–—å»ºè®®ã€‚\\n\" + \"\\n\" + \"4.ç»´æŒå¹¶æé«˜æ€»ä½“çš„èº«ä½“æ°´å¹³ã€‚\\n\" + \"\\n\" + \"è·‘æ­¥æ˜¯æ˜¯äººä»¬å¯ä»¥é‡‡å–çš„æœ€å¥½çš„é”»ç‚¼èº«ä½“çš„è¿åŠ¨ã€‚å®ƒå¯ä»¥æé«˜èƒ†å›ºé†‡,é™ä½è¡€æ¶²å‡å—çš„å±é™©ï¼Œé”»ç‚¼ä½ çš„50%çš„ç»å¸¸å¤„äºé—²ç½®çŠ¶æ€çš„è‚ºã€‚è·‘æ­¥è¿˜å¯ä»¥é€šè¿‡å¢åŠ ä½ çš„æ·‹å·´ç»†èƒæ¥å¢å¼ºä½ çš„å…ç–«åŠ›ã€‚\\n\" + \"\\n\" )); data.put(\"3\", new MyNavigationContent(this,R.drawable.android,\"Androidæ˜¯ä¸€ç§åŸºäºLinuxçš„è‡ªç”±åŠå¼€æ”¾æºä»£ç çš„æ“ä½œç³»ç»Ÿï¼Œä¸»è¦ä½¿ç”¨äºç§»åŠ¨è®¾å¤‡ï¼Œå¦‚æ™ºèƒ½æ‰‹æœºå’Œå¹³æ¿ç”µè„‘ï¼Œç”±Googleå…¬å¸å’Œå¼€æ”¾æ‰‹æœºè”ç›Ÿé¢†å¯¼åŠå¼€å‘ã€‚å°šæœªæœ‰ç»Ÿä¸€ä¸­æ–‡åç§°ï¼Œä¸­å›½å¤§é™†åœ°åŒºè¾ƒå¤šäººä½¿ç”¨â€œå®‰å“â€æˆ–â€œå®‰è‡´â€ã€‚Androidæ“ä½œç³»ç»Ÿæœ€åˆç”±Andy Rubinå¼€å‘ï¼Œä¸»è¦æ”¯æŒæ‰‹æœºã€‚2005å¹´8æœˆç”±Googleæ”¶è´­æ³¨èµ„ã€‚2007å¹´11æœˆï¼ŒGoogleä¸84å®¶ç¡¬ä»¶åˆ¶é€ å•†ã€è½¯ä»¶å¼€å‘å•†åŠç”µä¿¡è¥è¿å•†ç»„å»ºå¼€æ”¾æ‰‹æœºè”ç›Ÿå…±åŒç ”å‘æ”¹è‰¯Androidç³»ç»Ÿã€‚éšåGoogleä»¥Apacheå¼€æºè®¸å¯è¯çš„æˆæƒæ–¹å¼ï¼Œå‘å¸ƒäº†Androidçš„æºä»£ç ã€‚ç¬¬ä¸€éƒ¨Androidæ™ºèƒ½æ‰‹æœºå‘å¸ƒäº2008å¹´10æœˆã€‚Androidé€æ¸æ‰©å±•åˆ°å¹³æ¿ç”µè„‘åŠå…¶ä»–é¢†åŸŸä¸Šï¼Œå¦‚ç”µè§†ã€æ•°ç ç›¸æœºã€æ¸¸æˆæœºç­‰ã€‚2011å¹´ç¬¬ä¸€å­£åº¦ï¼ŒAndroidåœ¨å…¨çƒçš„å¸‚åœºä»½é¢é¦–æ¬¡è¶…è¿‡å¡ç­ç³»ç»Ÿï¼Œè·ƒå±…å…¨çƒç¬¬ä¸€ã€‚ 2013å¹´çš„ç¬¬å››å­£åº¦ï¼ŒAndroidå¹³å°æ‰‹æœºçš„å…¨çƒå¸‚åœºä»½é¢å·²ç»è¾¾åˆ°78.1%ã€‚[1] 2013å¹´09æœˆ24æ—¥è°·æ­Œå¼€å‘çš„æ“ä½œç³»ç»ŸAndroidåœ¨è¿æ¥äº†5å²ç”Ÿæ—¥ï¼Œå…¨ä¸–ç•Œé‡‡ç”¨è¿™æ¬¾ç³»ç»Ÿçš„è®¾å¤‡æ•°é‡å·²ç»è¾¾åˆ°10äº¿å°ã€‚\")); /*åˆ›å»ºAdapter*/ mDemoHoverMenuAdapter = new HoverDemoMenuAdapter(this, data); return mDemoHoverMenuAdapter; } catch (IOException e) { throw new RuntimeException(e); } }} 4.å…¥å£Activityä¸­è®¾ç½®ä¸€ä¸ªç‚¹å‡»äº‹ä»¶æ˜¾ç¤ºæ‚¬æµ®æ¡† 1234567891011121314151617public class DeActivity extends AppCompatActivity { Button btShow; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_de); btShow = (Button)findViewById(R.id.bt_show); btShow.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { HoverDemoService.showFloatingMenu(DeActivity.this); } }); }} å®é™…æ•ˆæœ å†™åœ¨æœ€ååšæ–‡å†…å®¹åŸºäºå¦‚ä¸‹ç‰ˆæœ¬ 1compile 'io.mattcarroll.hover:hover:0.9.6' ä¸ªäººåˆ›å»ºç±»çš„æ–¹å¼å’ŒGithubä¸Šæ¨èçš„ä½¿ç”¨æ–¹å¼æ˜¯ç›¸åçš„ï¼Œä¾æ®ä¸ªäººä¹ æƒ¯ä½¿ç”¨å³å¯ã€‚","link":"/2017/01/23/ã€ŠAndroidå¼€æºåº“ã€‹ Google æœ€æ–°Hover Menu(æ‚¬æµ®èœå•)/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 4","text":"16. åŠ¨ç”»æ³¨æ„ï¼šæœ¬ç« çš„åŠ¨ç”»æ•ˆæœåªä¼šåœ¨API 11ï¼ˆAndroid3.0.xï¼‰åŠä»¥ä¸Šçš„Androidç‰ˆæœ¬ä¸Šç”Ÿæ•ˆåœ¨ä½äºä¸Šè¿°çš„Androidç‰ˆæœ¬ä¸­ï¼ŒåŠ¨ç”»å°†ä¸ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚ æ‰€æœ‰ç±»å‹çš„å›¾æ ‡éƒ½å¯ä»¥ç”¨ä¸€ç§çœ‹ä¸Šå»æ¯”è¾ƒç‚«é…·çš„åŠ¨ç”»æ•ˆæœæ¥è¿›è¡Œæ„å»ºã€‚ä¸‰ç§ä¸åŒçš„åŠ¨ç”»æ–¹æ³•æ¥è®©æˆ‘ä»¬åœ¨Xè½´ï¼ŒYè½´æˆ–åˆ™ä¸¤ä¸ªè½´åŒæ—¶æ˜¾ç¤ºåŠ¨ç”»æ•ˆæœã€‚|æ–¹æ³•|ä½¿ç”¨||â€”â€”|â€”â€”â€”â€”||animateX(int durationMillis)|Xæ°´å¹³è½´çš„å›¾è¡¨å€¼åŠ¨ç”»ï¼Œè¿™æ„å‘³ç€åœ¨æŒ‡å®šçš„æ—¶é—´å†…ä»å·¦åˆ°å³ å»ºç«‹å›¾è¡¨||animateY(int durationMillis)|å‚ç›´è½´çš„å›¾è¡¨å€¼åŠ¨ç”»ï¼Œè¿™æ„å‘³ç€åœ¨æŒ‡å®šçš„æ—¶é—´å†…ä»ä¸‹åˆ°ä¸Š å»ºç«‹å›¾è¡¨ã€‚||animateXY(int xDuration, int yDuration)|ä¸¤ä¸ªè½´çš„å›¾è¡¨å€¼åŠ¨ç”»ï¼Œä»å·¦åˆ°å³ï¼Œä»ä¸‹åˆ°ä¸Š å»ºç«‹å›¾è¡¨ã€‚| 12345mChart.animateX(3000); // animate horizontal 3000 milliseconds// or:mChart.animateY(3000); // animate vertical 3000 milliseconds// or:mChart.animateXY(3000, 3000); // animate horizontal and vertical 3000 milliseconds ä»»æ„ä¸€ç§ animate(â€¦) åŠ¨ç”»æ–¹æ³•è¢«è°ƒç”¨åï¼Œæ— éœ€å†è°ƒç”¨ invalidate() æ–¹æ³•ã€‚ 16.1 ç¼“åŠ¨åŠ¨ç”»è¿™ä¸ªåº“å¯ä»¥è®©ä½ å¯¹åŠ¨ç”»åº”ç”¨â€ç¼“åŠ¨å‡½æ•°â€ã€‚ä½ å¯ä»¥é€‰æ‹©ä»¥ä¸‹é¢„å®šä¹‰çš„é™æ€ Easing.EasingOption : 123456789101112131415161718192021222324252627282930public enum EasingOption { Linear, EaseInQuad, EaseOutQuad, EaseInOutQuad, EaseInCubic, EaseOutCubic, EaseInOutCubic, EaseInQuart, EaseOutQuart, EaseInOutQuart, EaseInSine, EaseOutSine, EaseInOutSine, EaseInExpo, EaseOutExpo, EaseInOutExpo, EaseInCirc, EaseOutCirc, EaseInOutCirc, EaseInElastic, EaseOutElastic, EaseInOutElastic, EaseInBack, EaseOutBack, EaseInOutBack, EaseInBounce, EaseOutBounce, EaseInOutBounce,} åŸºæœ¬ä¸Šï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼è¿›è¡Œ easing ä½ çš„åŠ¨ç”»ã€‚ é¢„å®šä¹‰çš„ç¼“åŠ¨é€‰é¡¹ï¼šï¼ˆä¸‹é¢ä»£ç å¯åœ¨æ‰€æœ‰ Android ç‰ˆæœ¬è¿è¡Œï¼‰ 1public void animateY(int durationmillis, Easing.EasingOption option); ä¾‹å¦‚ï¼Œè°ƒç”¨å¸¦æœ‰é¢„å®šä¹‰ç¼“åŠ¨é€‰é¡¹çš„åŠ¨ç”»æ–¹æ³• 12// animate both axes with easingmChart.animateY(3000, Easing.EasingOption.EaseOutBack); å½“ä½ æƒ³ä»£ç è¿è¡Œåœ¨ Android 3.0 (API 11) ä»¥ä¸‹æ—¶ï¼Œè¦ä½¿ç”¨ Easing.EasingOption ã€‚ è‡ªå®šä¹‰ç¼“åŠ¨å‡½æ•°ï¼ˆåœ¨ Android 3.0 è‡ªå®šä¹‰ç¼“åŠ¨å‡½æ•°ä¼šä½¿åº”ç”¨ crashï¼‰ï¼š 1public void animateY(int durationmillis, EasingFunction function); é€šè¿‡åˆ›å»ºä½ è‡ªå·±çš„easing-functionç±»å¹¶ä¸”å®ç°EasingFunctionæ¥å£ï¼Œä½ å¯ä»¥å®ç°ä½ è‡ªå·±çš„easingåŠŸèƒ½ 12345678910/** * Interface for creating custom made easing functions. */ public interface EasingFunction { /** * Called everytime the animation is updated. * @param input - the time passed since the animation started (value between 0 and 1) */ public float getInterpolation(float input); } ç„¶åï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹å¼ä½¿ç”¨(æ³¨æ„ï¼Œè¿™ä¸ªä¸èƒ½åœ¨å°äºAndroid3.0çš„ç‰ˆæœ¬ä¸Šä½¿ç”¨ï¼Œå°†ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ) 12// animate both axes with easingmChart.animateY(3000, new MyEasingFunction()); 17. IMarkeræ¥å£è‡ªç‰ˆæœ¬v3.0.0ä»¥æ¥ï¼Œå›¾è¡¨ä¸­çš„æ ‡è®°ï¼ˆå¼¹å‡ºçª—å£ï¼‰ç”±IMarkeræ¥å£è¡¨ç¤ºã€‚ 17.1 IMarkeræ¥å£è¿™ä¸ªæ¥å£å¯ä»¥å¸®åŠ©ä½ å®ç°åœ¨å›¾è¡¨ä¸­æ¡ç›®é«˜äº®çš„æ—¶å€™æ˜¾ç¤ºè‡ªå®šä¹‰çš„Markerçª—å£ã€‚è¿™ä¸ªæ¥å£ç»™æˆ‘ä»¬æä¾›äº†å¦‚ä¸‹éœ€è¦å®ç°çš„æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839public interface IMarker { /** * @return The desired (general) offset you wish the IMarker to have on the x- and y-axis. * By returning x: -(width / 2) you will center the IMarker horizontally. * By returning y: -(height / 2) you will center the IMarker vertically. */ MPPointF getOffset(); /** * @return The offset for drawing at the specific `point`. This allows conditional adjusting of the Marker position. * If you have no adjustments to make, return getOffset(). * * @param posX This is the X position at which the marker wants to be drawn. * You can adjust the offset conditionally based on this argument. * @param posY This is the X position at which the marker wants to be drawn. * You can adjust the offset conditionally based on this argument. */ MPPointF getOffsetForDrawingAtPos(float posX, float posY); /** * This method enables a specified custom IMarker to update it&apos;s content every time the IMarker is redrawn. * * @param e The Entry the IMarker belongs to. This can also be any subclass of Entry, like BarEntry or * CandleEntry, simply cast it at runtime. * @param highlight The highlight object contains information about the highlighted value such as it&apos;s dataset-index, the * selected range or stack-index (only stacked bar entries). */ void refreshContent(Entry e, Highlight highlight); /** * Draws the IMarker on the given position on the screen with the given Canvas object. * * @param canvas * @param posX * @param posY */ void draw(Canvas canvas, float posX, float posY);} 17.2 åˆ›å»ºä¸€ä¸ªæ ‡è®°è§†å›¾ä¸ºäº†åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„æ ‡è®°è§†å›¾ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå®ç°äº†IMarkeræ¥å£çš„ç±»ï¼š 1public class YourMarkerView implements IMarker { ... } å®ç°IMarkeræ¥å£æ—¶è¿”å›ä»€ä¹ˆæ ·çš„å€¼ï¼Œå®Œå…¨å–å†³äºä½ è‡ªå·±çš„éœ€æ±‚ã€‚æ‰€ä»¥ï¼Œçœ‹çœ‹ä¸Šé¢å…³äºæ¯ä¸ªæ–¹æ³•çš„ä»‹ç»æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ é™¤äº†é€šè¿‡å®ç°IMarkeræ¥å£æ¥åˆ›å»ºè‡ªå·±çš„æ ‡è®°è§†å›¾ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç»§æ‰¿ä¸‹é¢æåˆ°çš„ä¸€ä¸ªç±»æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹Ÿä¸éœ€è¦å®ç°IMarkeræ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚åªæœ‰å‡ ä¸ªç‰¹å®šçš„æ–¹æ³•éœ€è¦æˆ‘ä»¬å¤å†™å’Œè‡ªå®šä¹‰ã€‚æœ€é‡è¦çš„æ˜¯å¤å†™refreshContentï¼ˆâ€¦ï¼‰æ–¹æ³•æ¥è°ƒæ•´æ ‡è®°è§†å›¾ä¸­çš„æ•°æ®ã€‚ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435public class YourMarkerView extends MarkerView { private TextView tvContent; public MyMarkerView(Context context, int layoutResource) { super(context, layoutResource); // find your layout components tvContent = (TextView) findViewById(R.id.tvContent); } // callbacks everytime the MarkerView is redrawn, can be used to update the // content (user-interface) @Override public void refreshContent(Entry e, Highlight highlight) { tvContent.setText(&quot;&quot; + e.getY()); // this will perform necessary layouting super.refreshContent(e, highlight); } private MPPointF mOffset; @Override public MPPointF getOffset() { if(mOffset == null) { // center the marker horizontally and vertically mOffset = new MPPointF(-(getWidth() / 2), -getHeight()); } return mOffset; }} 17.3 è·å–ï¼è®¾ç½®Markerç»™å›¾è¡¨è®¾ç½®ä¸€ä¸ªMarkerï¼Œä½¿ç”¨setMarker(â€¦)æ–¹æ³•ï¼š 12IMarker marker = new YourMarkerView();chart.setMarker(marker); è¦è®¿é—®å›¾è¡¨ä¸Šçš„ä¸€ä¸ªMarkerï¼Œä½¿ç”¨getMarker()æ–¹æ³•ï¼š 1IMarker marker = chart.getMarker(); 17.4 é¢„å®šä¹‰Markersé™¤äº†ä½ è‡ªå®šä¹‰çš„MarkerViewï¼Œå¼€æºåº“ä¸­ä¹Ÿç»™æˆ‘ä»¬æä¾›äº†å‡ ä¸ªé¢„å®šä¹‰çš„markersä»¥ä¾›æ–¹ä¾¿å¿«æ·çš„ä½¿ç”¨ã€‚å…¶ä¸­åŒ…æ‹¬ï¼š MarkerView :åŸºæœ¬markerã€‚å…è®¸æä¾›å¸ƒå±€æ–‡ä»¶ä½œä¸ºå›¾è¡¨ä¸Šå‘ˆç°çš„æ ‡è®°ã€‚ç»§æ‰¿è¿™ä¸ªç±»å¹¶ä¸”å¤å†™refreshContent(â€¦)æ–¹æ³•æ¥è°ƒæ•´æ ‡è®°è§†å›¾ä¸­çš„å†…å®¹ã€‚ MarkerImage:ä¸€ç§ç»˜åˆ¶å›¾ç‰‡çš„æ ‡è®°è§†å›¾ã€‚å…è®¸æä¾›ä¸€ä¸ªå›¾ç‰‡èµ„æºä½œä¸ºå›¾è¡¨ä¸Šçš„æ ‡è®°è§†å›¾ã€‚ç»§æ‰¿è¿™ä¸ªç±»å¹¶ä¸”å¤å†™refreshContent(â€¦)æ–¹æ³•æ¥è°ƒæ•´æ ‡è®°è§†å›¾ä¸­çš„å†…å®¹ã€‚ 17.5 æ—§ç‰ˆMarkerViewç‰ˆæœ¬v3.0.0 ä¹‹å‰ï¼ŒMarkerViewç±»è´Ÿè´£åœ¨å›¾è¡¨é«˜äº®éƒ¨åˆ†ç»˜åˆ¶æ ‡è®°è§†å›¾ã€‚è¯¦æƒ…è¯·æŸ¥é˜…è€ç‰ˆçš„the old MarkerView wiki page. 18. ChartDataç±»æœ¬ç« æ—¨åœ¨è®©ä½ æ›´æ·±å…¥çš„äº†è§£MPAndroidChartä¸­çš„æ•°æ®æ¨¡å‹ã€‚ ChartDataç±»æ˜¯åƒLineDataï¼ŒBarDataç­‰ç­‰è¿™äº›æ•°æ®ç±»çš„çˆ¶ç±»ã€‚setData()æ–¹æ³•å¯ä»¥å°†æ•°æ®è®¾ç½®åˆ°å›¾è¡¨ä¸­ã€‚ 1public class LineData extends ChartData { ...} ä¸‹é¢ä»‹ç»ä¸€äº›ChartDataç±»ä¸­çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨å®ƒçš„å­ç±»ä¸­ä½¿ç”¨ã€‚ 18.1 æ•°æ®æ ·å¼ æ–¹æ³• ä½¿ç”¨ setValueTextColor(int color) è®¾ç½® DataSets æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬çš„é¢œè‰² setValueTextColors(List colors) è®¾ç½®ä¸€ä¸ªé¢œè‰²åˆ—è¡¨ç”¨äºæ˜¾ç¤ºå€¼ setValueTextSize(float size) è®¾ç½® DataSets æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬çš„å¤§å°ï¼ˆå•ä½æ˜¯dpï¼‰ setValueTypeface(Typeface tf) è®¾ç½® DataSets æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬çš„å­—ä½“ setValueFormatter(ValueFormatter f) ä¸ºDataSets æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®è®¾ç½®è‡ªå®šä¹‰çš„ ValueFormatterã€‚æ›´å¤šå…³äºValueFormatterï¼Œè¯·æŸ¥é˜…æ­¤å¤„ setDrawValues(boolean enabled) å¯ç”¨/ç¦ç”¨ ç»˜åˆ¶æ‰€æœ‰ DataSets æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬ **** ### 18.2 Getteræ–¹æ³• æ–¹æ³• ä½¿ç”¨ â€”â€”â€“ â€”â€”â€” getDataSetByIndex(int index) è¿”å›ç›®æ ‡ DataSet åˆ—è¡¨ä¸­ç»™å®šç´¢å¼•çš„æ•°æ®å¯¹è±¡ã€‚ contains(Entry entry) æ£€æŸ¥æ­¤æ•°æ®å¯¹è±¡æ˜¯å¦åŒ…å«æŒ‡å®šçš„Entry ã€‚ æ³¨ï¼šè¿™ä¸ªç›¸å½“å½±å“æ€§èƒ½ï¼Œæ€§èƒ½ä¸¥å³»æƒ…å†µä¸‹ï¼Œä¸è¦è¿‡åº¦ä½¿ç”¨ã€‚ contains(T dataSet) å¦‚æœæ•°æ®ä¸­åŒ…å«æŒ‡å®šdataSet,è¿”å›trueå¦åˆ™è¿”å›false **** ### 18.3 æ¸…é™¤ æ–¹æ³• ä½¿ç”¨ â€”â€”â€“ â€”â€”â€” clearValues() æ¸…é™¤æ‰€æœ‰ DataSet å¯¹è±¡å’Œæ‰€æœ‰ Entries çš„æ•°æ® ã€‚ ä¸ä¼šåˆ é™¤æ‰€æä¾›çš„ x-values **** ### 18.4 é€‰ä¸­é«˜äº® æ–¹æ³• ä½¿ç”¨ â€”â€”â€“ â€”â€”â€” setHighlightEnabled(boolean enabled) è®¾ç½®ä¸ºtrueï¼Œå…è®¸é€šè¿‡ç‚¹å‡»é«˜äº®çªå‡º ChartData å¯¹è±¡å’Œå…¶ DataSets setDrawVerticalHighlightIndicator(boolean enabled) å¯ç”¨ï¼å³ç”¨çºµå‘é€‰ä¸­é«˜äº®æŒ‡ç¤ºçº¿ã€‚å¦‚æœç¦ç”¨ï¼ŒæŒ‡ç¤ºçº¿å°†ä¸ä¼šè¢«ç»˜åˆ¶ setDrawHorizontalHighlightIndicator(boolean enabled) ç”¨ï¼å³ç”¨æ¨ªå‘é€‰ä¸­é«˜äº®æŒ‡ç¤ºçº¿ã€‚å¦‚æœç¦ç”¨ï¼ŒæŒ‡ç¤ºçº¿å°†ä¸ä¼šè¢«ç»˜åˆ¶ **** ### 18.5 åŠ¨æ€æ•°æ® æ–¹æ³• ä½¿ç”¨ â€”â€”â€“ â€”â€”â€” notifyDataChanged() é€šçŸ¥æ•°æ®å¯¹è±¡ï¼Œåº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œå€™æ‰§è¡Œæ‰€æœ‰å¿…éœ€çš„è®¡ç®— æƒ³äº†è§£å¦‚ä½•åœ¨æ•°æ®å¯¹è±¡ä¸Šå¢åŠ æˆ–è€…ç§»é™¤æ•°æ®ï¼Œè¯·æŸ¥é˜…dynamic &amp; realtime dataç« èŠ‚","link":"/2017/06/17/ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 4/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 3","text":"13. å›¾ä¾‹é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„å›¾è¡¨éƒ½æ”¯æŒå›¾ä¾‹å¹¶ä¸”ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚ç»™å›¾è¡¨è®¾ç½®å®Œæ•°æ®ä¹‹åï¼Œå›¾ä¾‹ä¼šè¢«ç»˜åˆ¶å‡ºæ¥ã€‚å›¾ä¾‹é€šå¸¸ç”±å¤šä¸ªæ¡ç›®ç»„æˆï¼Œæ¯ä¸ªæ¡ç›®ç”±æ ‡ç­¾å½¢å¼/å½¢çŠ¶è¡¨ç¤ºã€‚è‡ªåŠ¨ç”Ÿæˆçš„å›¾ä¾‹åŒ…å«çš„æ¡ç›®æ•°å–å†³äºä¸åŒé¢œè‰²çš„æ•°é‡ï¼ˆè·¨æ‰€æœ‰DataSetå¯¹è±¡ï¼‰ä»¥åŠDataSetæ ‡ç­¾ã€‚å›¾ä¾‹çš„æ ‡ç­¾å–å†³äºä¸ºå›¾è¡¨ä¸­ä½¿ç”¨çš„DataSetå¯¹è±¡è®¾ç½®çš„æ ‡ç­¾ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šDataSetå¯¹è±¡çš„æ ‡ç­¾ï¼Œå›¾è¡¨å°†è‡ªåŠ¨ç”Ÿæˆã€‚ ä¸ºäº†è‡ªå®šä¹‰Legendï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ä»å›¾è¡¨ä¸­æ‹¿åˆ°Legendå¯¹è±¡ï¼š 1Legend legend = chart.getLegend(); 13.1 æ§åˆ¶Legendæ˜¯å¦è¢«ç»˜åˆ¶ æ–¹æ³• ä½¿ç”¨ setEnabled(boolean enabled) è®¾ç½®å›¾ä¾‹ç¦ç”¨æˆ–è€…å¯ç”¨ã€‚å¦‚æœè®¾ç½®ä¸ºfalse,å›¾ä¾‹å°†ä¸ä¼šè¢«ç»˜åˆ¶å‡ºæ¥ ** ### 13.2 æ ·å¼/ä¿®æ”¹å›¾ä¾‹ æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€”â€”â€”- setTextColor(int color) è®¾ç½®å›¾ä¾‹æ ‡ç­¾çš„æ–‡æœ¬é¢œè‰² setTextSize(float size) è®¾ç½®å›¾ä¾‹æ ‡ç­¾çš„å­—ä½“å¤§å°ï¼ˆdpï¼‰ setTypeface(Typeface tf) è®¾ç½®å›¾ä¾‹æ ‡ç­¾çš„å­—ä½“ ** ### 13.3 æ¢è¡Œ/é¿å…è£å‰ª æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€”â€”â€”- setWordWrapEnabled(boolean enabled) å¦‚æœè®¾ç½®ä¸ºtrue,å¦‚æœå›¾ä¾‹æ ‡ç­¾è¿‡é•¿ï¼Œå°†ä¼šå¦èµ·ä¸€è¡Œæ¥å±•ç¤ºè¶…å‡ºå›¾è¡¨èŒƒå›´çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æˆªæ–­å®ƒã€‚è¯·æ³¨æ„ï¼Œå¯åŠ¨åä¼šé™ä½æ€§èƒ½å¹¶ä¸”è¿™ä¸ªåªå¯¹å¤„ç†å›¾è¡¨ä¸‹çš„å›¾ä¾‹æ ‡ç­¾æœ‰æ•ˆ setMaxSizePercent(float maxSize) è®¾ç½®æœ€å¤§å›¾ä¾‹çš„ç™¾åˆ†æ¯”ï¼ˆç›¸å¯¹æ•´ä¸ªå›¾è¡¨å¤§å°ï¼‰ã€‚é»˜è®¤ä¸º0.95f (95%) **** ### 13.4 è‡ªå®šä¹‰å›¾ä¾‹ æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€”â€”â€”- setPosition(LegendPosition pos) è®¾ç½®å›¾ä¾‹çš„æ˜¾ç¤ºä½ç½®ã€‚å¯é€‰é¡¹ï¼šRIGHT_OF_CHART, RIGHT_OF_CHART_CENTER, RIGHT_OF_CHART_INSIDE, BELOW_CHART_LEFT, BELOW_CHART_RIGHT, BELOW_CHART_CENTER or PIECHART_CENTER (åªæœ‰é¥¼å›¾ä½¿ç”¨è¿™ä¸ª)ç­‰ç­‰ setForm(LegendForm shape) è®¾ç½®LegendFormã€‚è¿™æ˜¯åœ¨å¸¦æœ‰å›¾ä¾‹æ¡ç›®è¡¨ç¤ºçš„DataSetçš„é¢œè‰²çš„å›¾ä¾‹æ ‡ç­¾æ—è¾¹ç»˜åˆ¶çš„å½¢çŠ¶ã€‚å¯é€‰é¡¹ï¼šSQUAREï¼ŒCIRCLEã€LINEã€‚ setFormSize(float size) è®¾ç½®legend-formsçš„å¤§å°ï¼ˆdpï¼‰ setXEntrySpace(float space) è®¾ç½®æ¨ªè½´ä¸Šçš„å›¾ä¾‹é¡¹ä¹‹é—´çš„ç©ºé—´ setYEntrySpace(float space) è®¾ç½®å‚ç›´è½´ä¸Šçš„å›¾ä¾‹æ¡ç›®ä¹‹é—´çš„ç©ºé—´ setFormToTextSpace(float space) è®¾ç½®å›¾ä¾‹æ ‡ç­¾å’Œç›¸åº”å›¾ä¾‹ä¹‹é—´çš„ç©ºæ ¼ setWordWrapEnabled(boolean enabled) è®¾ç½® Legend æ˜¯å¦è‡ªåŠ¨æ¢è¡Œï¼Ÿ ç›®å‰ä»…æ”¯æŒBelowChartLeftï¼ŒBelowChartRightï¼ŒBelowChartCenter. *** ### 13.5 è®¾ç½®è‡ªå®šä¹‰æ ‡ç­¾&amp;é¢œè‰² æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€”â€”â€”- setCustom(int[] colors, String[] labels) è®¾ç½®è‡ªå®šä¹‰å›¾ä¾‹æ ‡ç­¾å’Œé¢œè‰²æ•°ç»„ï¼Œé¢œè‰²æ•°é‡å’Œæ ‡ç­¾æ•°é‡ç›¸åŒä¸”ä¸€ä¸€å¯¹åº”ã€‚è¿™ä¸ªæ–¹æ³•å°†ä½¿é»˜è®¤çš„å›¾ä¾‹è®¡ç®—åŠŸèƒ½å¤±æ•ˆã€‚è°ƒç”¨resetCustom()æ¥é‡æ–°æ‰“å¼€è‡ªåŠ¨è®¡ç®—å›¾ä¾‹çš„åŠŸèƒ½(ç„¶åè°ƒç”¨notifyDataSetChanged()æ¥æ‰§è¡Œé‡æ–°è®¡ç®—) resetCustom() è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹‹åè‡ªå®šä¹‰å›¾ä¾‹æ ‡ç­¾åŠŸèƒ½å°†ä¼šå¤±æ•ˆã€‚æ ‡ç­¾å°†ä¼šè¢«è‡ªåŠ¨è®¡ç®—(è°ƒç”¨notifyDataSetChanged()ä¹‹å) setExtra(int[] colors, String[] labels) è®¾ç½®é¢œè‰²æ•°ç»„å’Œæ ‡ç­¾æ•°æ®ï¼Œé¢œè‰²å’Œæ ‡ç­¾ä¸€ä¸€å¯¹åº”ï¼Œè¿™äº›æ ‡ç­¾å°†ä¼šæ¥åœ¨è‡ªåŠ¨è®¡ç®—å¾—åˆ°çš„æ ‡ç­¾ä¹‹åï¼ˆå¦‚æœå›¾ä¾‹å·²ç»è¢«è®¡ç®—å‡ºæ¥ï¼Œ æˆ‘ä»¬éœ€è¦è°ƒç”¨notifyDataSetChanged()æ¥è®©æˆ‘ä»¬çš„ä¿®æ”¹ç”Ÿæ•ˆï¼‰ ***** ### 13.6 ç¤ºä¾‹ 1234567891011121314Legend l = chart.getLegend(); l.setFormSize(10f); // set the size of the legend forms/shapes l.setForm(LegendForm.CIRCLE); // set what type of form/shape should be used l.setPosition(LegendPosition.BELOW_CHART_LEFT); l.setTypeface(...); l.setTextSize(12f); l.setTextColor(Color.BLACK); l.setXEntrySpace(5f); // set the space between the legend entries on the x-axis l.setYEntrySpace(5f); // set the space between the legend entries on the y-axis // set custom labels and colors l.setCustom(ColorTemplate.VORDIPLOM_COLORS, new String[] { &quot;Set1&quot;, &quot;Set2&quot;, &quot;Set3&quot;, &quot;Set4&quot;, &quot;Set5&quot; }); // and many more... 14. åŠ¨æ€ &amp; å®æ—¶æ•°æ®ä»ç‰ˆæœ¬v1.6.3å¼€å§‹æ”¯æŒï¼ŒæŒç»­æ”¹è¿›ä¸­ã€‚ ä¸ºäº†å®ç°åŠ¨æ€å¢åˆ å›¾è¡¨ä¸­çš„æ•°æ®ï¼Œå¼€æºåº“æä¾›äº†å¤§é‡çš„æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬å®ç°å›¾è¡¨ä¸­DataSet æ•°æ®æ¡ç›®çš„å¢åŠ å’Œåˆ é™¤ã€‚ 14.1 åŠ¨æ€æ·»åŠ /åˆ é™¤æ•°æ®çš„å¯èƒ½æ€§DataSetç±»ï¼ˆå’Œå®ƒçš„æ‰€æœ‰å­ç±»ï¼‰ï¼š|æ–¹æ³•|ä½¿ç”¨||â€”â€”â€”|â€”â€”â€”â€”||addEntry(Entry e)|æŠŠæŒ‡å®šEntryæ·»åŠ åˆ°DataSet| ChartDataç±»ï¼ˆå’Œå®ƒçš„æ‰€æœ‰å­ç±»ï¼‰|æ–¹æ³•|ä½¿ç”¨||â€”â€”â€”|â€”â€”â€”â€”||addEntry(Entry e, int dataSetIndex)|æŠŠæŒ‡å®šEntryæ·»åŠ åˆ°DataSetçš„æŒ‡å®šç´¢å¼•ä½ç½®||addDataSet(DataSet d)|æŠŠæŒ‡å®šDataSetæ·»åŠ åˆ°ChartDataä¸­| é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨åŠ¨æ€ç§»é™¤æ•°æ®çš„æ–¹æ³•ï¼Œå…·ä½“å¦‚ä¸‹ï¼š DateSetç±»ï¼ˆå’Œå®ƒçš„æ‰€æœ‰å­ç±»ï¼‰|æ–¹æ³•|ä½¿ç”¨||â€”â€”â€”|â€”â€”â€”â€”||public boolean removeFirst()|ç§»é™¤ç¬¬ä¸€ä¸ªEntry(ç´¢å¼•ä¸º0)ã€‚æˆåŠŸè¿”å›true,å¤±è´¥è¿”å›false||public boolean removeLast()|ç§»é™¤æœ€åä¸€ä¸ªEntry(ç´¢å¼•ä¸ºsize-1)ã€‚æˆåŠŸè¿”å›true,å¤±è´¥è¿”å›false||public boolean removeEntry(Entry e)|ç§»é™¤æŒ‡å®šEntryã€‚æˆåŠŸè¿”å›true||public boolean removeEntry(int xIndex)|ç§»é™¤æŒ‡å®šç´¢å¼•çš„Entryã€‚æˆåŠŸè¿”å›true| ChartDataç±»ï¼ˆå’Œå®ƒçš„æ‰€æœ‰å­ç±»ï¼‰|æ–¹æ³•|ä½¿ç”¨||â€”â€”â€”|â€”â€”â€”â€”||public boolean removeEntry(Entry e, int dataSetIndex)|ç§»é™¤æŒ‡å®šç´¢å¼•ä½ç½®DataSetä¸­çš„ç»™å®šEntryå¯¹è±¡ã€‚æˆåŠŸåˆ™è¿”å›true||public boolean removeEntry(int xIndex, int dataSetIndex)|ç§»é™¤æŒ‡å®šç´¢å¼•ä½ç½®DataSetä¸­çš„ç»™å®šxIndexç´¢å¼•å¯¹åº”çš„Entryå¯¹è±¡ã€‚æˆåŠŸåˆ™è¿”å›true||public boolean removeDataSet(DataSet d)|ä»ChartDataä¸­ç§»é™¤æŒ‡å®šDataSetã€‚æˆåŠŸåˆ™è¿”å›true||public boolean removeDataSet(int index)|ä»ChartDataä¸­ç§»é™¤æŒ‡å®šç´¢å¼•ä½ç½®å¯¹åº”çš„DataSetã€‚æˆåŠŸåˆ™è¿”å›true| 14.2 æ³¨æ„åœ¨åŠ¨æ€å¢åŠ æˆ–è€…åˆ é™¤æ•°æ®ä¹‹åï¼Œè®°å¾—è°ƒç”¨notifyDataSetChanged() ï¼Œç„¶åè°ƒç”¨invalidate()æ¥æ‰§è¡Œåˆ·æ–°æ“ä½œã€‚ 123456789101112// EXAMPLE 1// add entries to the &quot;data&quot; objectexampleData.addEntry(...);chart.notifyDataSetChanged(); // let the chart know it&apos;s data changedchart.invalidate(); // refresh// EXAMPLE 2// add entries to &quot;dataSet&quot; objectdataSet.addEntry(...);exampleData.notifyDataChanged(); // let the data know a dataSet changedchart.notifyDataSetChanged(); // let the chart know it&apos;s data changedchart.invalidate(); // refresh æ³¨æ„ï¼šåƒmoveViewTo(â€¦)è¿™æ ·çš„æ–¹æ³•ï¼Œå°†ä¼šè‡ªåŠ¨è°ƒç”¨invalidate()ã€‚ 14.3 åŠ¨æ€æ•°æ®ç¤ºä¾‹æœ‰å…³å¦‚ä½•å®ç°åŠ¨æ€æ•°æ®æ·»åŠ /åˆ é™¤çš„ç¤ºä¾‹ï¼Œè¯·å‚è€ƒç¤ºä¾‹åº”ç”¨ç¨‹åºå’Œå…¶ä¸­çš„å¦‚ä¸‹Activityï¼š DynamicalAddingActivity RealtimeDataActivity 15. ä¿®æ”¹è§†çª—æœ¬åº“æä¾›äº†å„ç§æ–¹æ³•æ¥ä¿®æ”¹è§†çª—ï¼ˆå›¾è¡¨çš„å¯è§éƒ¨åˆ†ï¼‰ã€‚æ³¨æ„ï¼Œè¿™äº›ä¿®æ”¹è§†çª—çš„æ–¹æ³•ä»…é€‚ç”¨äºLineChart, BarChart, ScatterChartå’ŒCandleStickChartã€‚ä¸‹é¢æåˆ°çš„æ–¹æ³•éƒ½æ˜¯Chartç±»æä¾›çš„æ–¹æ³•ã€‚ä¿®æ”¹è§†çª—çš„å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡ViewPortHandlerç›´æ¥è®¿é—®å®ƒï¼ˆæ²¡æœ‰å›¾è¡¨æä¾›çš„ä¸­é—´å®‰å…¨æ€§ï¼‰ã€‚è¿™ä»…é€‚ç”¨äºç†Ÿæ‚‰APIçš„é«˜çº§ç”¨æˆ·ã€‚ è¯·æ³¨æ„ï¼Œåªæœ‰åœ¨è®¾ç½®æ•°æ®ä¹‹åæ‰èƒ½è°ƒç”¨ä¸Šé¢è¿™äº›ä¿®æ”¹è§†çª—çš„æ–¹æ³• 15.1 é™åˆ¶å¯è§èŒƒå›´ æ–¹æ³• ä½¿ç”¨ setVisibleXRangeMaximum(float maxXRange) è®¾ç½®åœ¨Xè½´ä¸Šä¸€æ¬¡æ€§æœ€å¤§å¯è§èŒƒå›´ã€‚å¦‚æœè¿™ä¸ªå€¼è®¾ç½®ä¸º10ï¼Œåˆ™Xè½´å–å€¼è¶…è¿‡10ä¹‹å¤–çš„å›¾è¡¨åœ¨ä¸æ»šåŠ¨çš„æƒ…å†µæ˜¯æ— æ³•è¢«çœ‹åˆ°çš„ setVisibleXRangeMinimum(float minXRange) è®¾ç½®åœ¨Xè½´ä¸Šä¸€æ¬¡æ€§èƒ½çœ‹åˆ°çš„æœ€å°èŒƒå›´ï¼Œå¦‚æœè¿™ä¸ªå€¼è®¾ç½®æˆ10ï¼Œåˆ™ä¸ç®¡ä½ æ€ä¹ˆæ”¾å¤§ï¼ŒXè½´çš„å–å€¼èŒƒå›´éƒ½ä¸ä¼šå°äº10 setVisibleYRangeMaximum(float maxYRange, AxisDependency axis) è®¾ç½®Yè½´ä¸Šä¸€æ¬¡æ€§æœ€å¤§å¯è§èŒƒå›´ã€‚é€šè¿‡AxisDependencyæ˜ç¡®å¯¹åº”çš„Yè½´ setViewPortOffsets(float left, float top, float right, float bottom) è®¾ç½®å½“å‰è§†çª—çš„è‡ªå®šä¹‰åç§»é‡ï¼ˆå®é™…å›¾è¡¨çª—å£ä¾§é¢çš„åç§»é‡ï¼‰ï¼Œè®¾ç½®è¿™ä¸ªå€¼å°†é˜»æ­¢å›¾è¡¨è‡ªåŠ¨è®¡ç®—å…¶åç§»é‡ã€‚ä½¿ç”¨resetViewPortOffsets()æ–¹æ³•æ¥æ¢å¤è‡ªåŠ¨è®¡ç®—åç§»é‡çš„åŠŸèƒ½ã€‚æ³¨æ„ï¼Œå¦‚æœä½ ä¸çŸ¥é“è¿™ä¸ªæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œè¯·å…ˆææ¸…æ¥šå†ä½¿ç”¨ resetViewPortOffsets() é‡ç½®æ‰€æœ‰setViewPortOffsets(â€¦)è®¾ç½®çš„åç§»é‡ã€‚å…è®¸å›¾è¡¨è‡ªåŠ¨è®¡ç®—æ‰€æœ‰åç§»é‡ setExtraOffsets(float left, float top, float right, float bottom) åœ¨è‡ªåŠ¨è®¡ç®—çš„åç§»é‡çš„åŸºç¡€ä¸Šå¢åŠ é¢å¤–çš„åç§»é‡ã€‚è¿™ä¸ªæ–¹æ³•ä¸ä¼šæ”¹å˜è‡ªåŠ¨è®¡ç®—çš„åç§»é‡ç»“æœï¼Œåªæ˜¯åœ¨å…¶åŸºç¡€ä¸Šè¿½åŠ  ** ### 15.2 ç§»åŠ¨è§†å›¾ æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€“ â€”â€”â€”â€”â€” fitScreen() é‡è®¾æ‰€æœ‰ç¼©æ”¾å’Œæ‹–åŠ¨ï¼Œä½¿å›¾è¡¨å®Œå…¨é€‚åˆå®ƒçš„è¾¹ç•Œï¼ˆå®Œå…¨ç¼©å°ï¼‰ moveViewToX(float xValue) å°†å½“å‰è§†çª—çš„å·¦ä¾§ï¼ˆè¾¹ï¼‰åˆ°æŒ‡å®šçš„ x å€¼ moveViewToY(float yValue, AxisDependency axis) ä½¿å¾—æŒ‡å®šçš„yå€¼æ˜¾ç¤ºåœ¨å¯¹åº”yè½´( å·¦orå³ )çš„ä¸­é—´ moveViewTo(float xValue, float yValue, AxisDependency axis) å°†å½“å‰è§†çª—çš„å·¦ä¾§ç§»åŠ¨åˆ°xè½´ä¸Šçš„æŒ‡å®šxå€¼ï¼Œå¹¶å°†è§†çª—å±…ä¸­åˆ°æ‰€æä¾›çš„yè½´ä¸Šçš„æŒ‡å®šyå€¼ï¼Œç›¸å½“äºsetVisibleXRange(â€¦) å’Œ setVisibleYRange(â€¦) ç»„åˆä½¿ç”¨ centerViewTo(float xValue, float yValue, AxisDependency axis) å°†ä½¿å½“å‰è§†çª—çš„ä¸­å¿ƒç§»åŠ¨åˆ°æŒ‡å®šçš„xå€¼å’Œyå€¼ç›¸å½“äº setVisibleXRange(â€¦) å’Œ setVisibleYRange(â€¦) ç»„åˆä½¿ç”¨ 15.3 ç§»åŠ¨è§†å›¾åŠ¨ç”» æ–¹æ³• ä½¿ç”¨ moveViewToAnimated(float xValue, float yValue, AxisDependency axis, long duration) å’Œä¸Šé¢moveViewToç»“æœä¸€æ ·ï¼Œåªæ˜¯è¿™ä¸ªè¿‡ç¨‹æœ‰åŠ¨ç”»æ•ˆæœ centerViewToAnimated(float xValue, float yValue, AxisDependency axis, long duration) å’Œä¸Šé¢centerViewToç»“æœä¸€æ ·ï¼Œåªæ˜¯è¿™ä¸ªè¿‡ç¨‹æœ‰åŠ¨ç”»æ•ˆæœ ***** ### 15.4 ç¼©æ”¾ æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€“ â€”â€”â€”â€”â€” zoomIn() ä»¥å›¾è¡¨ä¸­å¿ƒä¸ºä¸­å¿ƒç‚¹ï¼Œ1.4å€æ­¥å¹…æ”¾å¤§ zoomOut() ä»¥å›¾è¡¨ä¸­å¿ƒä¸ºä¸­å¿ƒç‚¹ï¼Œ0.7å€æ­¥å¹…ç¼©å° zoom(float scaleX, float scaleY, float x, float y) æ ¹æ®æ‰€ç»™çš„å‚æ•°è¿›è¡Œæ”¾å¤§æˆ–ç¼©å°ã€‚ å‚æ•° x å’Œ y æ˜¯å˜ç„¦ä¸­å¿ƒçš„åæ ‡ï¼ˆå•ä½ï¼šåƒç´ ï¼‰ã€‚ è®°ä½ï¼Œ1f = æ— æ”¾ç¼© ã€‚ zoomAndCenterAnimated(float scaleX, float scaleY, float xValue, float yValue, AxisDependency axis, long duration) æŒ‰ç…§ç»™å®šçš„ç¼©æ”¾å› å­è¿›è¡Œç¼©æ”¾ï¼Œå¹¶å°†è§†å›¾ä¸­å¿ƒç§»åŠ¨åˆ°æŒ‡å®šä½ç½®ï¼ˆå¸¦åŠ¨ç”»ï¼‰ ** ### 15.5 å®Œæ•´ç¤ºä¾‹ 123456chart.setData(...); // first set data// now modify viewportchart.setVisibleXRangeMaximum(20); // allow 20 values to be displayed at once on the x-axis, not morechart.moveViewToX(10); // set the left edge of the chart to x-index 10// moveViewToX(...) also calls invalidate()","link":"/2017/06/16/ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 3/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ PagerSlidingTabStripä»å¤´åˆ°è„š","text":"ç®€ä»‹PagerSlidingTabStripï¼Œæ˜¯æˆ‘ä¸ªäººç»å¸¸ä½¿ç”¨åˆ°çš„ä¸€ä¸ªå’ŒViewPageré…åˆçš„é¡µé¢æŒ‡ç¤ºå™¨ï¼Œå¯ä»¥æ»¡è¶³å¼€å‘è¿‡ç¨‹ä¸­å¸¸ç”¨çš„éœ€æ±‚ï¼Œå¦‚ç±»ä¼¼äºä»Šæ—¥å¤´æ¡çš„é¦–é¡µæ–°é—»å†…å®¹å¯¼èˆªæ ç­‰ç­‰ï¼Œä¹‹å‰è‡ªå·±å¼€å‘çš„JuheNewså’Œæ­£åœ¨å¼€å‘çš„GankIOClientå‡æœ‰ä½¿ç”¨åˆ°å®ƒï¼Œæ‰€ä»¥æƒ³å¯¹å…¶è¿›è¡Œä¸€ä¸ªå…¨é¢çš„ä»‹ç»ã€‚ PagerSlidingTabStripæºç åœ°å€ï¼š https://github.com/astuetz/PagerSlidingTabStrip ä½¿ç”¨æ–¹æ³• æ·»åŠ åº“ä¾èµ– 123dependencies { compile 'com.astuetz:pagerslidingtabstrip:1.0.1'} å®šä¹‰å¸ƒå±€æ–‡ä»¶ 123456789&lt;com.astuetz.PagerSlidingTabStrip android:id=\"@+id/psts_indicator\" android:layout_width=\"match_parent\" android:layout_height=\"40dp\"/&gt;&lt;android.support.v4.view.ViewPager android:id=\"@+id/vp_content\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"/&gt; å…³è”ViewPager 12345678910111213141516171819public class MainActivity extends AppCompatActivity { @BindView(R.id.psts_indicator) PagerSlidingTabStrip pstsIndicator; @BindView(R.id.activity_main) LinearLayout activityMain; @BindView(R.id.vp_content) ViewPager vpContent; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); MainPagerAdapter mainPagerAdapter = new MainPagerAdapter(getSupportFragmentManager()); vpContent.setAdapter(mainPagerAdapter); pstsIndicator.setViewPager(vpContent); }} æ•ˆæœå›¾ åè¯çœ‹åˆ°è¿™ä¸ªæ•ˆæœï¼Œæ˜¯ä¸æ˜¯å¾ˆç‚¸è£‚ï¼Œå¦‚æ­¤çš„ä¸‘é™‹ï¼Œä¸Šå›¾æ˜¯ä»€ä¹ˆå±æ€§éƒ½æ²¡æœ‰ä¿®æ”¹é»˜è®¤çš„æ•ˆæœå›¾ï¼Œæ¥ç€æˆ‘ä»¬çœ‹ä¸‹æºç ï¼Œçœ‹ä¸‹å¯ä»¥ä»å“ªæ–¹é¢æ¥è¿›è¡Œæ”¹é€ ã€‚ æºç è§£æè¿™ä¸ªå¼€æºåº“ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯å¤§å®¶éƒ½éå¸¸ç†Ÿæ‚‰çš„è‡ªå®šä¹‰Viewï¼Œæ‰€ä»¥ï¼Œè§£è¯»çš„æ–¹å¼å¯ä»¥ä»è‡ªå®šä¹‰å±æ€§åˆ°æ­¤è§†å›¾çš„æ„é€ ï¼ŒonMeasure,onLayout, onDrawç­‰ç­‰ è‡ªå®šä¹‰çš„å±æ€§å€¼ 123456789101112131415161718192021222324252627&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;resources&gt; &lt;declare-styleable name=\"PagerSlidingTabStrip\"&gt; &lt;!--åº•éƒ¨æ»‘åŠ¨æŒ‡ç¤ºå™¨çš„é¢œè‰²--&gt; &lt;attr name=\"pstsIndicatorColor\" format=\"color\" /&gt; &lt;!--åº•éƒ¨ç”¨äºç»™æŒ‡ç¤ºå™¨æ»‘åŠ¨çš„åŒºåŸŸçš„é¢œè‰²--&gt; &lt;attr name=\"pstsUnderlineColor\" format=\"color\" /&gt; &lt;!--åˆ†å‰²çº¿çš„é¢œè‰²--&gt; &lt;attr name=\"pstsDividerColor\" format=\"color\" /&gt; &lt;!--æŒ‡ç¤ºå™¨çš„é«˜åº¦--&gt; &lt;attr name=\"pstsIndicatorHeight\" format=\"dimension\" /&gt; &lt;!--åº•éƒ¨åŒºåŸŸçš„é«˜åº¦--&gt; &lt;attr name=\"pstsUnderlineHeight\" format=\"dimension\" /&gt; &lt;!--åˆ†å‰²çº¿ä¸ä¸Šä¸‹çš„é—´è·--&gt; &lt;attr name=\"pstsDividerPadding\" format=\"dimension\" /&gt; &lt;!--æ¯ä¸ªTabçš„å·¦å³è¾¹è·--&gt; &lt;attr name=\"pstsTabPaddingLeftRight\" format=\"dimension\" /&gt; &lt;!--é€‰ä¸­tabçš„æ»šåŠ¨åç§»é‡,ä¸ªäººåŸºæœ¬æ²¡æœ‰ç”¨åˆ°è¿‡--&gt; &lt;attr name=\"pstsScrollOffset\" format=\"dimension\" /&gt; &lt;!--æ¯ä¸ªTabçš„èƒŒæ™¯å›¾ï¼ŒStateListDrawable--&gt; &lt;attr name=\"pstsTabBackground\" format=\"reference\" /&gt; &lt;!--æ˜¯å¦æ ¹æ®tabå‡ä¸ºä½ç½®ï¼Œtrueçš„æ—¶å€™å‡åˆ†ï¼Œé»˜è®¤ä¸ºfalse,ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨é»˜è®¤å€¼--&gt; &lt;attr name=\"pstsShouldExpand\" format=\"boolean\" /&gt; &lt;!--æ ‡é¢˜æ–‡æœ¬æ˜¯å¦å¤§å†™ï¼Œé»˜è®¤ä¸ºtrue--&gt; &lt;attr name=\"pstsTextAllCaps\" format=\"boolean\" /&gt; &lt;/declare-styleable&gt;&lt;/resources&gt; çœ‹ä¸‹å¤§è‡´çš„å¸ƒå±€å’Œå±æ€§å¯¹å·å…¥åº§ PagerSlidingTabStrip.javaç±»ç»“æ„ç±»ä¸­çš„getterå’Œsetteræ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šå’Œä¸Šé¢çš„è‡ªå®šä¹‰å±æ€§å¯ä»¥å¯¹ä¸Šå·ï¼Œä¸ä»…å¯ä»¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰ï¼Œè¿˜å¯ä»¥é€šè¿‡javaä»£ç è¿›è¡Œè®¾ç½®ã€‚ ç±»ä¸­ä½¿ç”¨åˆ°çš„å˜é‡ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å’Œè‡ªå®šä¹‰å±æ€§æŒ‚é’©çš„ï¼Œä¸»è¦å…³æ³¨å‡ ä¸ª å˜é‡ æ„ä¹‰ ATTRS å¼•ç”¨Androidç³»ç»Ÿçš„ä¸¤ä¸ªå±æ€§ï¼Œæ–‡æœ¬å­—ä½“å¤§å°å’Œå­—ä½“é¢œè‰² pageListener å†…éƒ¨ä½¿ç”¨çš„OnPagerChangeListener,é€šè¿‡setViewPagerå®ç°å’ŒViewPagerçš„è”åŠ¨ delegatePageListener æš´éœ²ç»™å¼€å‘è€…çš„æ¥å£ï¼Œç±»æœ¬èº«ä½¿ç”¨åˆ°äº†ä¸¤ä¸ªOnPageChangeListenerï¼Œä¸€ä¸ªç”¨æ¥å®ç°è‡ªå·±çš„é€»è¾‘ï¼Œè€Œè¿™ä¸ªåˆ™æ˜¯ç•™ç»™å¼€å‘è€…å®ç°è‡ªå·±éœ€è¦é’ˆå¯¹ViewPagerçš„é¡µé¢å˜åŒ–çš„é€»è¾‘ tabsContainer å†…éƒ¨å®¹å™¨ï¼Œç”¨æˆ·æ‰€è§æ–‡æœ¬æŒ‡ç¤ºå™¨å’Œå›¾æ ‡æŒ‡ç¤ºå™¨çš„çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥ï¼Œå¦‚æœéœ€è¦é’ˆå¯¹æ–‡æœ¬æŒ‡ç¤ºå™¨æˆ–è€…æ˜¯å›¾æ ‡æŒ‡ç¤ºå™¨åšä»€ä¹ˆæ“ä½œï¼Œé€šè¿‡è¿™ä¸ªæŸ¥æ‰¾å­©å­èŠ‚ç‚¹å³å¯ IconTabProviderç±»ä¸­æ¯”è¾ƒå…³é”®çš„ä¸€äº›å†…å®¹ï¼Œæ¥å£IconTabProviderï¼ŒViewPagerå¯¹åº”çš„Adapterå®ç°è¯¥æ–¹æ³•å¹¶è¿”å›æ¯ä¸ªViewPagerå¯¹åº”çš„å›¾æ ‡å³å¯å®ç°å›¾æ ‡æŒ‡ç¤ºå™¨ã€‚ PageListenerï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„OnPagerListenerçš„äº‹ä»¶å¤„ç†é›†æˆäºæ­¤å¤„ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162private class PageListener implements OnPageChangeListener { @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { //å­˜å‚¨å½“å‰ä½ç½®ä¿¡æ¯ currentPosition = position; currentPositionOffset = positionOffset; //æ»‘åŠ¨åˆ°å­è§†å›¾ scrollToChild(position, (int) (positionOffset * tabsContainer.getChildAt(position).getWidth())); invalidate();//è§¦å‘é‡ç»˜ //ç”¨æˆ·è‡ªå®šä¹‰çš„OnPagerChangeListeneräº‹ä»¶ä¹‹onPagerScrolled if (delegatePageListener != null) { delegatePageListener.onPageScrolled(position, positionOffset, positionOffsetPixels); } } @Override public void onPageScrollStateChanged(int state) { //å·²ç»æ»‘åŠ¨å®Œæˆï¼Œoffsetå½’0 if (state == ViewPager.SCROLL_STATE_IDLE) { scrollToChild(pager.getCurrentItem(), 0); } //ç”¨æˆ·è‡ªå®šä¹‰çš„OnPagerChangeListeneräº‹ä»¶ä¹‹onPageScrollStateChanged if (delegatePageListener != null) { delegatePageListener.onPageScrollStateChanged(state); } } @Override public void onPageSelected(int position) { //è¿™é‡Œç±»å†…éƒ¨æ²¡æœ‰åšä»€ä¹ˆå¤„ç†ï¼Œåªå¤„ç†ç”¨æˆ·è‡ªå®šä¹‰çš„OnPagerSelectedæ–¹æ³• if (delegatePageListener != null) { delegatePageListener.onPageSelected(position); } }}/** *æ»‘åŠ¨æŒ‡å®šå­è§†å›¾ */ private void scrollToChild(int position, int offset) { if (tabCount == 0) { return; } int newScrollX = tabsContainer.getChildAt(position).getLeft() + offset; if (position &gt; 0 || offset &gt; 0) { newScrollX -= scrollOffset; } if (newScrollX != lastScrollX) { lastScrollX = newScrollX; scrollTo(newScrollX, 0); }} PagerSlidingTabStripæ„é€ æ–¹æ³•æ„é€ æ–¹æ³•çš„å†…å®¹ä¸å¤šï¼ŒåŸºæœ¬ä¸Šå…¨æ˜¯åŸºæœ¬å±æ€§çš„è·å–ï¼Œè‡ªå®šä¹‰Viewä¸­å¸¸ç”¨çš„TypedArray ï¼Œè®°å¾—å›æ”¶recycle()ï¼Œè¿™é‡Œå…³æ³¨ä¸€ä¸‹ TypedValue.applyDimensionæ–¹æ³•çš„ä½¿ç”¨ï¼Œå…¨éƒ¨è½¬æ¢æˆpxã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public PagerSlidingTabStrip(Context context, AttributeSet attrs, int defStyle) { super(context, attrs, defStyle); setFillViewport(true); setWillNotDraw(false); tabsContainer = new LinearLayout(context); tabsContainer.setOrientation(LinearLayout.HORIZONTAL); tabsContainer.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT)); addView(tabsContainer); DisplayMetrics dm = getResources().getDisplayMetrics(); scrollOffset = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, scrollOffset, dm); indicatorHeight = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, indicatorHeight, dm); underlineHeight = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, underlineHeight, dm); dividerPadding = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, dividerPadding, dm); tabPadding = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, tabPadding, dm); dividerWidth = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, dividerWidth, dm); tabTextSize = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_SP, tabTextSize, dm); // get system attrs (android:textSize and android:textColor) TypedArray a = context.obtainStyledAttributes(attrs, ATTRS); tabTextSize = a.getDimensionPixelSize(0, tabTextSize); tabTextColor = a.getColor(1, tabTextColor); a.recycle(); // get custom attrs a = context.obtainStyledAttributes(attrs, R.styleable.PagerSlidingTabStrip); indicatorColor = a.getColor(R.styleable.PagerSlidingTabStrip_pstsIndicatorColor, indicatorColor); underlineColor = a.getColor(R.styleable.PagerSlidingTabStrip_pstsUnderlineColor, underlineColor); dividerColor = a.getColor(R.styleable.PagerSlidingTabStrip_pstsDividerColor, dividerColor); indicatorHeight = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsIndicatorHeight, indicatorHeight); underlineHeight = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsUnderlineHeight, underlineHeight); dividerPadding = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsDividerPadding, dividerPadding); tabPadding = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsTabPaddingLeftRight, tabPadding); tabBackgroundResId = a.getResourceId(R.styleable.PagerSlidingTabStrip_pstsTabBackground, tabBackgroundResId); shouldExpand = a.getBoolean(R.styleable.PagerSlidingTabStrip_pstsShouldExpand, shouldExpand); scrollOffset = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsScrollOffset, scrollOffset); textAllCaps = a.getBoolean(R.styleable.PagerSlidingTabStrip_pstsTextAllCaps, textAllCaps); a.recycle(); /* åˆå§‹åŒ–çŸ©å½¢Paint */ rectPaint = new Paint(); rectPaint.setAntiAlias(true); rectPaint.setStyle(Style.FILL); /* åˆå§‹åŒ–åˆ†å‰²çº¿Paint */ dividerPaint = new Paint(); dividerPaint.setAntiAlias(true); dividerPaint.setStrokeWidth(dividerWidth); /* æ˜¯å¦å»¶ä¼¸ï¼Œé»˜è®¤WRAP_CONTENT,è¿™ç§æ¯”è¾ƒåˆç† */ defaultTabLayoutParams = new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT); expandedTabLayoutParams = new LinearLayout.LayoutParams(0, LayoutParams.MATCH_PARENT, 1.0f); if (locale == null) { locale = getResources().getConfiguration().locale; }} onDraw 12345678910111213141516171819202122232425262728293031323334353637383940414243@Overrideprotected void onDraw(Canvas canvas) { super.onDraw(canvas); if (isInEditMode() || tabCount == 0) { return; } final int height = getHeight(); // è®¾ç½®Indicatoré¢œè‰² rectPaint.setColor(indicatorColor); // è·å–å½“å‰é€‰ä¸­Tab View currentTab = tabsContainer.getChildAt(currentPosition); //è·å–Left,Rightå€¼ float lineLeft = currentTab.getLeft(); float lineRight = currentTab.getRight(); // if there is an offset, start interpolating left and right coordinates between current and next tab if (currentPositionOffset &gt; 0f &amp;&amp; currentPosition &lt; tabCount - 1) { //ç»“åˆä¸‹ä¸€ä¸ªTabè·å–å½“å‰è¦ç»˜åˆ¶çš„indicatorçš„ä½ç½®,è¿™é‡Œçš„currentPositionOffset æ¯”è¾ƒå…³é”®ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªå€¼æ˜¯ä¸ViewPagerç›¸å…³çš„ï¼Œåœ¨onPagerScrolledæ–¹æ³•ä¸­ï¼Œè¿™ä¸ªå€¼åœ¨ä¸æ–­çš„æ›´æ–° View nextTab = tabsContainer.getChildAt(currentPosition + 1); final float nextTabLeft = nextTab.getLeft(); final float nextTabRight = nextTab.getRight(); lineLeft = (currentPositionOffset * nextTabLeft + (1f - currentPositionOffset) * lineLeft); lineRight = (currentPositionOffset * nextTabRight + (1f - currentPositionOffset) * lineRight); } // ç»˜åˆ¶Indicator canvas.drawRect(lineLeft, height - indicatorHeight, lineRight, height, rectPaint); // ç»˜åˆ¶UnderLine rectPaint.setColor(underlineColor); canvas.drawRect(0, height - underlineHeight, tabsContainer.getWidth(), height, rectPaint); // ç»˜åˆ¶åˆ†å‰²çº¿ dividerPaint.setColor(dividerColor); for (int i = 0; i &lt; tabCount - 1; i++) { View tab = tabsContainer.getChildAt(i); canvas.drawLine(tab.getRight(), dividerPadding, tab.getRight(), height - dividerPadding, dividerPaint); }} setViewPagerï¼Œ setOnPageChangeListenerä¸€ä¸ªç”¨æ¥ä¸ViewPagerè”åŠ¨ï¼Œä¸€ä¸ªç”¨æ¥å¤„ç†è‡ªå®šä¹‰çš„OnPagerListeneré€»è¾‘ 123456789101112131415public void setViewPager(ViewPager pager) { this.pager = pager; if (pager.getAdapter() == null) { throw new IllegalStateException(&quot;ViewPager does not have adapter instance.&quot;); } pager.setOnPageChangeListener(pageListener); notifyDataSetChanged(); } public void setOnPageChangeListener(OnPageChangeListener listener) { this.delegatePageListener = listener; } PagerSlidingTabStripç»¼åˆç”¨æ³• æ–‡æœ¬æŒ‡ç¤ºå™¨é€‰ä¸­åæ–‡æœ¬å¤§å°å’Œé¢œè‰²å˜åŒ–å…³é”®ç‚¹åœ¨äºå®ç°è‡ªå·±çš„OnPagerListener 12345678910111213141516171819202122232425262728293031323334353637383940@Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); MainPagerAdapter mainPagerAdapter = new MainPagerAdapter(getSupportFragmentManager()); vpContent.setAdapter(mainPagerAdapter); pstsIndicator.setViewPager(vpContent); vpContent.addOnPageChangeListener(new ViewPager.OnPageChangeListener() { @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { } @Override public void onPageSelected(int position) { updateTextStyle(position); } @Override public void onPageScrollStateChanged(int state) { } }); updateTextStyle(vpContent.getCurrentItem()); } private void updateTextStyle(int position) { LinearLayout tabsContainer = (LinearLayout) pstsIndicator.getChildAt(0); for(int i=0; i&lt; tabsContainer.getChildCount(); i++) { TextView textView = (TextView) tabsContainer.getChildAt(i); if(position == i) { textView.setTextSize(18); textView.setTextColor(getResources().getColor(R.color.colorToolbar)); } else { textView.setTextSize(12); textView.setTextColor(getResources().getColor(R.color.colorBlack)); } } } å›¾æ ‡æŒ‡ç¤ºå™¨é€‰ä¸­å›¾æ ‡é¢œè‰²å˜åŒ– å…³é”®ç‚¹åœ¨äºå®ç°è‡ªå·±çš„OnPagerListenerå’Œç»§æ‰¿PagerSlidingTabStrip.IconTabProvider 123456789101112private void updateIconStyle(int position) { LinearLayout tabsContainer = (LinearLayout) pstsIndicator.getChildAt(0); for (int i = 0; i &lt; tabsContainer.getChildCount(); i++) { ImageButton imageButton = (ImageButton) tabsContainer.getChildAt(i); imageButton.setImageTintMode(PorterDuff.Mode.SRC_IN); if (i == position) { imageButton.setImageTintList(getResources().getColorStateList(R.color.ib_color_list)); } else { imageButton.setImageTintList(getResources().getColorStateList(R.color.ib_color_list_normal)); } }} å†™åœ¨æœ€åçš„è¯PagerSlidingTabStripï¼Œæ€»ä½“æ¥è¯´ç®€æ´æ–¹ä¾¿ï¼Œå¦‚æœå¼€å‘è€…æƒ³é›†æˆè‡ªå·±çš„ä¸€äº›å†…å®¹ï¼Œæ¯”å¦‚è¯´Indicatoræ”¹æˆå…¶ä»–çš„å½¢çŠ¶ï¼Œæˆ–è€…è¯´æƒ³åšåˆ°æ—¢æœ‰æ–‡å­—åˆæœ‰å›¾ç‰‡çš„æ•ˆæœï¼Œéƒ½å¯ä»¥è‡ªå·±ä¿®æ”¹ä»£ç æ¥å®ç°ï¼Œæ¯”è¾ƒçš„æ–¹ä¾¿ã€‚","link":"/2016/12/25/ã€ŠAndroidå¼€æºåº“ã€‹ PagerSlidingTabStripä»å¤´åˆ°è„š/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 5","text":"19. ChartDataå­ç±»è¿™ç¯‡wikiä¸»è¦å…³æ³¨ChartDataå­ç±»çš„å…·ä½“ä»‹ç»ã€‚è‡³äºæ­¤éƒ¨åˆ†æ²¡æœ‰æåŠåˆ°çš„ChartDataçš„å­ç±»ï¼Œä»£è¡¨ä»–ä»¬æ²¡æœ‰ç‰¹æ€§åŠŸèƒ½éœ€è¦ä»‹ç»ã€‚ BarData æ–¹æ³• ä½¿ç”¨ setGroupSpace(float percent) æŒ‰ç…§ä¸€ä¸ªæ çš„æ€»å®½åº¦çš„ç™¾åˆ†æ¯”è®¾ç½®ä¸åŒæ•°æ®é›†çš„æ¡å½¢ç»„ä¹‹é—´çš„ç©ºé—´.100%ä»£è¡¨ä¸€ä¸ªæ¡å½¢çš„å®½åº¦ã€‚é»˜è®¤ä¸º80% isGrouped() å¦‚æœæ­¤æ•°æ®å¯¹è±¡åˆ†ç»„ï¼ˆç”±å¤šä¸ªDataSetç»„æˆï¼‰ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false *** ### ScatterData æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€”- â€”â€”â€”â€” getGreatestShapeSize() è¿”å›æ­¤æ•°æ®å¯¹è±¡åŒ…å«çš„æ‰€æœ‰ScatterDataSetsçš„æœ€å¤§å½¢çŠ¶å¤§å°ã€‚ ***** ### PieData æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€”- â€”â€”â€”â€” getDataSet() è¿”å›åŒ…å«çš„PieDataSetå¯¹è±¡ã€‚PieDataä¸èƒ½åŒ…å«å¤šä¸ªPieDataSetå¯¹è±¡ setDataSet(PieDataSet set) è®¾ç½®PieDataSet *** ### BubbleData æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€”- â€”â€”â€”â€” setHighlightCircleWidth(float width) è®¾ç½®å½“æ•°æ®å¯¹è±¡åŒ…å«çš„æ‰€æœ‰BubbleDataSetå¯¹è±¡å¤„äºçªå‡ºæ˜¾ç¤ºçŠ¶æ€æ—¶çš„ç¯ç»•è¯¥æ°”æ³¡çš„åœ†çš„å®½åº¦ã€‚å•ä½dp **** ### CombinedData è¯¥æ•°æ®å¯¹è±¡è¢«è®¾è®¡ä¸ºåŒ…å«æ‰€æœ‰å…¶ä»–æ•°æ®å¯¹è±¡çš„å®ä¾‹ã€‚ä½¿ç”¨setDataï¼ˆâ€¦ï¼‰æ–¹æ³•æä¾›æ­¤å¯¹è±¡çš„æ•°æ®ã€‚è¿™ä»…ç”¨äºCombinedChartã€‚ 123456789101112131415161718public class CombinedData extends ChartData { // ... public CombinedData(List&lt;String&gt; xVals) { ... } public CombinedData(String[] xVals) { ... } public void setData(LineData data) { ... } public void setData(BarData data) { ... } public void setData(ScatterData data) { ... } public void setData(CandleData data) { ... } // ...} 20. DataSetç±»ï¼ˆé€šç”¨æ ·å¼ï¼‰DataSetæ˜¯å¦‚LineDataSet,BarDataSetç­‰æ‰€æœ‰æ•°æ®é›†ç±»çš„åŸºç±»ã€‚ 1public class LineDataSet extends DataSet { ... DataSetä»£è¡¨ä¸€ç»„æˆ–è€…ä¸€ç±»åœ¨å›¾è¡¨ä¸­å½’ç»“åœ¨ä¸€èµ·çš„æ•°æ®æ¡ç›®é›†åˆã€‚è®¾è®¡å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†å°†å›¾è¡¨ä¸­çš„ä¸åŒç»„æ•°æ®è¿›è¡Œé€»è¾‘åˆ†ç¦»ã€‚ï¼ˆæ¯”å¦‚çº¿å½¢å›¾ä¸­çš„ç‰¹å®šä¸€æ¡çº¿ï¼ŒæŸ±å½¢å›¾ä¸­çš„ç‰¹å®šä¸€ç»„æŸ±å½¢ï¼‰ ä»¥ä¸‹æåˆ°çš„æ–¹æ³•åœ¨DataSetç±»ä¸­å®ç°ï¼Œå› æ­¤å¯ç”¨äºæ‰€æœ‰å­ç±»ã€‚ 20.1 æ•°æ®æ ·å¼ æ–¹æ³• ä½¿ç”¨ setValueTextColor(int color) è®¾ç½® DataSet æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬çš„é¢œè‰² setValueTextColors(List colors) è®¾ç½®ä¸€ä¸ªé¢œè‰²åˆ—è¡¨ç”¨äºæ˜¾ç¤ºå€¼ setValueTextSize(float size) è®¾ç½® DataSet æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬çš„å¤§å°ï¼ˆå•ä½æ˜¯dpï¼‰ setValueTypeface(Typeface tf) è®¾ç½® DataSet æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬çš„å­—ä½“ setValueFormatter(ValueFormatter f) ä¸ºDataSet æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®è®¾ç½®è‡ªå®šä¹‰çš„ ValueFormatterã€‚æ›´å¤šå…³äºValueFormatterï¼Œè¯·æŸ¥é˜…æ­¤å¤„ setDrawValues(boolean enabled) å¯ç”¨/ç¦ç”¨ ç»˜åˆ¶æ‰€æœ‰ DataSet æ•°æ®å¯¹è±¡åŒ…å«çš„æ•°æ®çš„å€¼æ–‡æœ¬ ä»¥ä¸Šæ–¹æ³•åŒæ ·é€‚ç”¨äºChartDataå¯¹è±¡ï¼Œåªæ˜¯æ“ä½œç»“æœé’ˆå¯¹çš„æ˜¯å…¶åŒ…å«çš„æ‰€æœ‰çš„DataSetã€‚ 20.2 é«˜äº® æ–¹æ³• ä½¿ç”¨ setHighlightEnabled(boolean enabled) è®¾ç½®ä¸ºtrueï¼Œå…è®¸é€šè¿‡ç‚¹å‡»é«˜äº®çªå‡º ChartData å¯¹è±¡å’Œå…¶ DataSets setDrawVerticalHighlightIndicator(boolean enabled) å¯ç”¨ï¼ç¦ç”¨çºµå‘é€‰ä¸­é«˜äº®æŒ‡ç¤ºçº¿ã€‚å¦‚æœç¦ç”¨ï¼ŒæŒ‡ç¤ºçº¿å°†ä¸ä¼šè¢«ç»˜åˆ¶ setDrawHorizontalHighlightIndicator(boolean enabled) å¯ç”¨ï¼ç¦ç”¨æ¨ªå‘é€‰ä¸­é«˜äº®æŒ‡ç¤ºçº¿ã€‚å¦‚æœç¦ç”¨ï¼ŒæŒ‡ç¤ºçº¿å°†ä¸ä¼šè¢«ç»˜åˆ¶ *** ### 20.3 Getter/Convenience æ–¹æ³• ä½¿ç”¨ â€”â€”â€“ â€”â€”â€”â€”â€“ contains(Entry entry) æ£€æŸ¥æ­¤æ•°æ®å¯¹è±¡æ˜¯å¦åŒ…å«æŒ‡å®šçš„Entry ã€‚ æ³¨ï¼šè¿™ä¸ªç›¸å½“å½±å“æ€§èƒ½ï¼Œæ€§èƒ½ä¸¥å³»æƒ…å†µä¸‹ï¼Œä¸è¦è¿‡åº¦ä½¿ç”¨ã€‚ 21. DataSetå­ç±»ï¼ˆç‰¹å®šæ ·å¼ï¼‰æœ¬ç« wikiä¸“æ³¨äºDataSetç±»çš„å­ç±»ã€‚æ­¤å¤„æœªæåŠçš„DataSetçš„æ‰€æœ‰å…¶ä»–å­ç±»ä»£è¡¨å®ƒä»¬æ²¡æœ‰ç‰¹å®šçš„å¢å¼ºåŠŸèƒ½ã€‚ 21.1 Line-, Bar-, Scatter-, Bubble- &amp; CandleDataSet æ–¹æ³• ä½¿ç”¨ setHighLightColor(int color) è®¾ç½®é«˜äº®é¢œè‰²ã€‚ä¸è¦å¿˜è®°ç”¨getResources().getColor(â€¦) æˆ–è€… Color.rgb(â€¦)æ¥è§£æé¢œè‰²ï¼ˆæˆ–è€…ä½¿ç”¨Color.BLACKè¿™ç§ç®€å•çš„æ–¹å¼ï¼‰ ***** ### 21.2 Line-, Bar-, Scatter-, Candle- &amp; RadarDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setDrawHighlightIndicators(boolean enabled) å¯ç”¨/ç¦ç”¨å‚ç›´å’Œæ°´å¹³é«˜äº®æŒ‡ç¤ºçº¿ã€‚è°ƒç”¨setDrawVerticalHighlightIndicatorï¼ˆâ€¦ï¼‰å’ŒsetDrawHorizoâ€‹â€‹ntalHighlightIndicatorï¼ˆâ€¦ï¼‰è¿›è¡Œå•ç‹¬é…ç½® setHighlightLineWidth(float width) è®¾ç½®é«˜äº®çº¿ï¼ˆåå­—å‡†çº¿ï¼‰çš„å®½åº¦ã€‚å•ä½dp ** ### 21.3 Line- &amp; RadarDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setFillColor(int color) è®¾ç½®ç”¨äºå¡«å……çº¿æ¡è¡¨é¢çš„é¢œè‰² setFillAlpha(int alpha) è®¾ç½®ç”¨äºå¡«å……çº¿æ¡è¡¨é¢ï¼ˆ0-255ï¼‰çš„Alphaå€¼ï¼ˆé€æ˜åº¦ï¼‰ï¼Œé»˜è®¤å€¼ï¼š85,255 =å®Œå…¨ä¸é€æ˜ï¼Œ0 =å®Œå…¨é€æ˜ setFillDrawable(Drawable d) è®¾ç½®ä¸€ä¸ªå¯ä»¥è¦†ç›–å¡«å……åŒºåŸŸçš„Drawableã€‚è¿™ä¹Ÿå…è®¸ä½¿ç”¨æ¸å˜Drawable setDrawFilled(boolean filled) å¦‚æœDataSetéœ€è¦ç»˜åˆ¶å¡«å……ï¼ˆè¡¨é¢ï¼ŒåŒºåŸŸï¼‰ï¼Œè€Œä¸å•å•æ˜¯ä¸€æ¡çº¿ï¼Œé‚£ä¹ˆå°†æ­¤é¡¹è®¾ç½®ä¸ºtrueï¼Œç¦ç”¨æ­¤åŠŸèƒ½å°†æå‡æ€§èƒ½ã€‚è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ³•ä½¿ç”¨canvas.clipPathï¼ˆâ€¦ï¼‰æ–¹æ³•ç»˜åˆ¶å¡«å……åŒºåŸŸã€‚å¯¹äºAPIçº§åˆ«&lt;18ï¼ˆAndroid 4.3ï¼‰çš„è®¾å¤‡ï¼Œåº”å…³é—­å›¾è¡¨çš„ç¡¬ä»¶åŠ é€Ÿã€‚å…·ä½“æŸ¥é˜…æ­¤å¤„,é»˜è®¤ä¸ºfalse setLineWidth(float width) è®¾ç½®çº¿æ¡å®½åº¦ï¼ˆæœ€å°=0.2f,æœ€å¤§10fï¼‰;é»˜è®¤1fã€‚æ³¨æ„ï¼šç»†çº¿==æ€§èƒ½æ›´å¥½ï¼Œç²—çº¿==æ€§èƒ½æ›´å·® ** ä»¥ä¸‹æåˆ°çš„æ–¹æ³•ä»…é€‚ç”¨äºå…·ä½“æåˆ°çš„DataSetå­ç±»ã€‚ ### 21.4 LineDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setCircleRadius(float size) è®¾ç½®çš„åœ†å½¢å€¼æŒ‡ç¤ºç¬¦çš„å¤§å°ï¼ˆåŠå¾„ï¼‰ï¼Œé»˜è®¤å¤§å°= 4F setDrawCircles(boolean enabled) è®¾ç½®ä¸ºtrueå¯ç”¨LineDataSetçš„åœ†å½¢æŒ‡ç¤ºå™¨ã€‚é»˜è®¤ä¸ºtrue setDrawCubic(boolean enabled) å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™çº¿æ¡å›¾çº¿å°†ä»¥ç«‹æ–¹å¼è€Œä¸æ˜¯çº¿æ€§ç»˜åˆ¶ã€‚è¿™å¯¹æ€§èƒ½æœ‰è´Ÿé¢å½±å“ï¼é»˜è®¤å€¼ï¼šfalse setCubicIntensity(float intensity) è®¾ç½®ç«‹æ–¹ä½“çº¿çš„å¼ºåº¦ï¼ˆå¦‚æœå¯ç”¨ï¼‰ã€‚ Max = 1f =éå¸¸ç«‹æ–¹ï¼ŒMin = 0.05f =ä½ç«‹æ–¹æ•ˆåº”ï¼Œé»˜è®¤å€¼ï¼š0.2f setCircleColor(int color) è®¾ç½®åœ†å½¢æŒ‡ç¤ºå™¨çš„é¢œè‰² setCircleColors(List colors) è®¾ç½®æ­¤LineDataSetå¤–åœˆåº”å…·æœ‰çš„é¢œè‰²ã€‚è¿˜æœ‰éœ€è¦å…¶ä»–çš„æ–¹æ³•æ¥è®¾ç½®å¤–åœˆçš„é¢œè‰² setCircleColorHole(int color) è®¾ç½®å†…åœˆçš„é¢œè‰² setDrawCircleHole(boolean enabled) è®¾ç½®ä¸ºtrue.åœ¨ç»˜åˆ¶å†…åœˆï¼Œå¦åˆ™ä¸ç»˜åˆ¶å†…åœˆ enableDashedLine(float lineLength, float spaceLength, float phase) å¯åŠ¨è™šçº¿ç»˜åˆ¶ï¼Œå…·ä½“åƒâ€- - - - - -â€œè¿™æ ·. â€œlineLengthâ€è™šçº¿æ®µé•¿åº¦, â€œspaceLengthâ€è™šçº¿æ®µä¹‹é—´çš„ç©ºéš™, â€œphaseâ€æ˜¯åç§»é‡ï¼Œä»¥åº¦æ•°ä¸ºå•ä½ï¼ˆé€šå¸¸ä¸º0ï¼‰ **** ### 21.5 BarDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setBarSpacePercent(float percent) ä»¥æ€»æ¡å®½çš„ç™¾åˆ†æ¯”è®¾ç½®æ¡ä¹‹é—´çš„é—´è· setBarShadowColor(int color) è®¾ç½®ç”¨äºç»˜åˆ¶æ¡å½¢é˜´å½±çš„é¢œè‰²ã€‚æ¡å½¢å›¾çš„é˜´å½±éƒ¨åˆ†æ˜¯ä¸€ä¸ªç”¨æ¥è¡¨ç¤ºæœ€å¤§å€¼çš„ç•Œé¢ã€‚ä½¿ç”¨getResources().getColor(â€¦) æˆ–è€…Color.rgb(â€¦)æ¥è®¾ç½®è¿™ä¸ªå€¼ setHighLightAlpha(int alpha) è®¾ç½®ç”¨äºç»˜åˆ¶é«˜äº®æŒ‡ç¤ºæ¡çš„alphaå€¼ï¼ˆé€æ˜åº¦ï¼‰ã€‚æœ€å°å€¼=0ï¼ˆå®Œå…¨é€æ˜ï¼‰ï¼Œæœ€å¤§å€¼=255ï¼ˆå®Œå…¨ä¸é€æ˜ï¼‰ setStackLabels(String[] labels) è®¾ç½®ä¸åŒå€¼çš„æ¡å½¢å †æ ˆçš„æ ‡ç­¾ï¼Œå¦‚æœæœ‰æ ‡ç­¾çš„è¯ **** ### 21.6 ScatterDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setScatterShapeSize(float size) è®¾ç½®ç»˜åˆ¶çš„æ•£ç‚¹å›¾å°†å…·æœ‰çš„å¯†åº¦åƒç´ çš„å¤§å°ã€‚è¿™ä»…é€‚ç”¨äºéè‡ªå®šä¹‰å½¢çŠ¶ setScatterShape(ScatterShape shape) è®¾ç½®åœ¨å€¼æ‰€åœ¨çš„ä½ç½®ç»˜åˆ¶çš„å½¢çŠ¶ **** ### 21.7 CandleDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setBodySpace(float space) è®¾ç½®æ¯ä¸ªèœ¡çƒ›ä½“å·¦ä¾§å’Œå³ä¾§ç•™å‡ºçš„ç©ºé—´ï¼Œé»˜è®¤ä¸º0.1fï¼ˆ10ï¼…ï¼‰ï¼Œæœ€å¤§0.45fï¼Œæœ€å°0f setShadowWidth(float width) è®¾ç½®èœ¡çƒ›çº¿çš„å®½åº¦ï¼Œå•ä½dpã€‚é»˜è®¤3f setShadowColor(int color) è®¾ç½®èœ¡çƒ›çº¿çš„é¢œè‰² setDecreasingColor(int color) è®¾ç½®å½“æ‰“å¼€&gt;å…³é—­æ—¶åº”è¯¥ç”¨äºæ­¤DataSetçš„å”¯ä¸€çš„é¢œè‰² setIncreasingColor(int color) è®¾ç½®å½“æ‰“å¼€&lt;=å…³é—­æ—¶åº”è¯¥ç”¨äºæ­¤DataSetçš„å”¯ä¸€çš„é¢œè‰² setDecreasingPaintStyle(Paint.Style style) è®¾ç½®å½“æ‰“å¼€&gt;å…³é—­æ—¶çš„Painté£æ ¼ï¼ˆå¡«å……æˆ–è€…çº¿æ¡ï¼‰ setIncreasingPaintStyle(Paint.Style style) è®¾ç½®å½“æ‰“å¼€&lt;=å…³é—­æ—¶çš„Painté£æ ¼ï¼ˆå¡«å……æˆ–è€…çº¿æ¡ï¼‰ **** ### 21.8 BubbleDataSet æ–¹æ³• ä½¿ç”¨ â€”â€”â€”â€” â€”â€”â€”â€”â€”â€” setHighlightCircleWidth(float width) è®¾ç½®åœ¨çªå‡ºæ˜¾ç¤ºçŠ¶æ€ä¸‹æ°”æ³¡å‘¨å›´çš„åœ†çš„å®½åº¦ï¼Œå•ä½dp 21.9 PieDataSet æ–¹æ³• ä½¿ç”¨ setSliceSpace(float degrees) è®¾ç½®é¥¼å›¾åˆ‡ç‰‡ä¹‹é—´çš„ç©ºéš™ã€‚é»˜è®¤ï¼š0-&gt;æ²¡æœ‰ç©ºéš™ï¼Œæœ€å¤§20ï¼Œæœ€å°0ï¼ˆæ²¡æœ‰ç©ºéš™ï¼‰ setSelectionShift(float shift) è®¾ç½®æ­¤DataSetçš„çªå‡ºæ˜¾ç¤ºçš„é¥¼å›¾åˆ‡ç‰‡è·ç¦»å›¾è¡¨ä¸­å¿ƒâ€œåç§»â€çš„è·ç¦»ï¼Œé»˜è®¤ä¸º12f","link":"/2017/06/22/ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 5/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Adapter &Supporting other libraryï¼ˆè¯‘æ–‡ï¼‰","text":"Adapter(é€‚é…å™¨)Realmæä¾›äº†ä¸€äº›æŠ½è±¡çš„å·¥å…·ç±»æ¥æ–¹ä¾¿åœ°å°† OrderedRealmCollection ï¼ˆRealmResults å’Œ RealmList éƒ½å®ç°äº†è¿™ä¸ªå€Ÿå£ï¼‰å±•ç¤ºåˆ°UIæ§ä»¶ä¸Šã€‚ RealmBaseAdapter å¯ä»¥ä¸ ListView é…åˆä½¿ç”¨ã€‚å‚è§ç¤ºä¾‹. RealmRecyclerViewAdapter å¯ä»¥ä¸ RecyclerView é…åˆä½¿ç”¨ã€‚å‚è§ç¤ºä¾‹. ä½ éœ€è¦åœ¨ app çš„ build.gradle ä¸­æ·»åŠ é¢å¤–çš„ä¾èµ–ä»¥ä½¿ç”¨è¿™äº›é€‚é…å™¨ã€‚ 123dependencies { compile 'io.realm:android-adapters:1.4.0'} Intentå› ä¸ºä½ ä¸å¯ä»¥ç›´æ¥é€šè¿‡ intent ä¼ é€’ RealmObjectï¼Œæˆ‘ä»¬å»ºè®®ä½ åªä¼ é€’ RealmObject çš„æ ‡è¯†ç¬¦ã€‚ä¸¾ä¸ªå¸¸ç”¨ä¾‹å­ï¼Œå‡å¦‚ä½ çš„å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªä¸»é”®ï¼Œè¯·é€šè¿‡ intent çš„ bundle æ¥ä¼ é€’è¿™ä¸ªä¸»é”®çš„å€¼ã€‚ 1234// Assuming we had a person class with a @PrimaryKey on the 'id' field ...Intent intent = new Intent(getActivity(), ReceivingService.class);intent.putExtra(\"person_id\", person.getId());getActivity().startService(intent); åœ¨æ¥å—æ–¹ï¼ˆActivtyã€Serviceã€IntentServiceã€BroadcastReceiver åŠå…¶å®ƒï¼‰ä» bundle ä¸­è§£æå‡ºè¿™ä¸ªä¸»é”®ç„¶åæ‰“å¼€ Realm æŸ¥è¯¢å¾—åˆ°è¿™ä¸ª RealmObjectã€‚ 123456// in onCreate(), onHandleIntent(), etc.String personId = intent.getStringExtra(\"person_id\");Realm realm = Realm.getDefaultInstance();Person person = realm.where(Person.class).equalTo(\"id\", personId).findFirst();// do something with the person ...realm.close(); å¯ä»¥å‚è€ƒ threading example ä¸­çš„ Object Passing éƒ¨åˆ†ã€‚è¯¥ç¤ºä¾‹å±•ç¤ºäº†åœ¨å®‰å“å¼€å‘ä¸­å¸¸ç”¨çš„å¦‚ä½•ä¼ é€’ id å¹¶ä¸”å¾—åˆ°å¯¹åº”çš„ RealmObjectã€‚ Android Framework å¤šçº¿ç¨‹ API ç›¸å…³å½“ä½ ä½¿ç”¨ä¸‹åˆ— API æ—¶è¯·å°å¿ƒï¼š AsyncTask IntentService AsyncTask çš„ doInBackground() æ–¹æ³•ä¼šè¿è¡Œåœ¨ä¸€ä¸ªåå°çº¿ç¨‹ã€‚IntentService çš„ onHandleIntent(Intent intent) æ–¹æ³•ä¼šè¿è¡Œåœ¨ä¸€ä¸ªåå°å·¥ä½œçº¿ç¨‹ã€‚ å¦‚æœä½ éœ€è¦åœ¨è¿™äº›æ–¹æ³•ä¸­ä½¿ç”¨ Realmï¼Œè¯·åœ¨å¯¹ Realm çš„è°ƒç”¨ç»“æŸåå…³é—­ Realm å®ä¾‹ã€‚è§å¦‚ä¸‹ä¾‹å­ã€‚ AsyncTaskåœ¨ doInBackground æ–¹æ³•ä¸­æ‰“å¼€å¹¶å…³é—­ Realmï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223private class DownloadOrders extends AsyncTask&lt;Void, Void, Long&gt; { protected Long doInBackground(Void... voids) { // Now in a background thread. // Open the Realm Realm realm = Realm.getDefaultInstance(); try { // Work with Realm realm.createAllFromJson(Order.class, api.getNewOrders()); Order firstOrder = realm.where(Order.class).findFirst(); long orderId = firstOrder.getId(); // Id of order return orderId; } finally { realm.close(); } } protected void onPostExecute(Long orderId) { // Back on the Android mainThread // do something with orderId such as query Realm // for the order and perform some operation with it. }} IntentService ChangeListener åœ¨ IntentService ä¸­ä¸ä¼šå·¥ä½œã€‚å°½ç®¡ IntentService æœ¬èº«æ˜¯ä¸€ä¸ª Looper çº¿ç¨‹ï¼Œä½†æ¯æ¬¡ onHandleIntent çš„è°ƒç”¨æ˜¯ç‹¬ç«‹çš„äº‹ä»¶ã€‚ä½ å¯ä»¥æ³¨å†Œç›‘å¬å™¨çš„è°ƒç”¨ä¸ä¼šè¿”å›å¤±è´¥ï¼Œä½†ä»–ä»¬æ°¸è¿œä¸ä¼šè¢«è§¦å‘ã€‚ åœ¨ onHandleIntent() æ–¹æ³•ä¸­æ‰“å¼€å¹¶å…³é—­ Realmï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112131415161718public class OrdersIntentService extends IntentService { public OrdersIntentService(String name) { super(\"OrdersIntentService\"); } @Override protected void onHandleIntent(Intent intent) { // Now in a background thread. // Open the Realm Realm realm = Realm.getDefaultInstance(); // Work with Realm realm.createAllFromJson(Order.class, api.getNewOrders()); Order firstOrder = realm.where(Order.class).findFirst(); long orderId = firstOrder.getId(); // Id of order realm.close(); }} å¯¹å…¶å®ƒåº“çš„æ”¯æŒè¿™ä¸ªç« èŠ‚æè¿°äº†æ€æ ·ä¸å…¶å®ƒ Android æµè¡Œåº“æ­é…ä½¿ç”¨ Realmã€‚ GSONGSON æ˜¯ Google å¼€å‘çš„ JSON å¤„ç†åº“ã€‚GSON ä¸ Realm å¯ä»¥æ— ç¼é…åˆä½¿ç”¨ã€‚ 12345678910// Using the User classpublic class User extends RealmObject { private String name; private String email; // getters and setters left out ...}Gson gson = new GsonBuilder().create();String json = \"{ name : 'John', email : 'john@corporation.com' }\";User user = gson.fromJson(json, User.class); GridViewExample å±•ç¤ºäº†å¦‚ä½•é…åˆ GSON ä½¿ç”¨ Realmã€‚ åºåˆ—åŒ–ï¼ˆSerializationï¼‰ä½ æœ‰æ—¶éœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ä¸€ä¸ª Realm å¯¹è±¡ä»¥ä¾¿ä¸å…¶å®ƒåº“ï¼ˆæ¯”å¦‚ Retrofitï¼‰ç›¸é…åˆã€‚å› ä¸º GSONä½¿ç”¨æˆå‘˜å˜é‡å€¼è€Œé getter å’Œ setter ï¼Œæ‰€ä»¥ä½ æ— æ³•é€šè¿‡ GSON çš„ä¸€èˆ¬æ–¹æ³•æ¥åºåˆ—åŒ– Realm å¯¹è±¡ã€‚ ä½ éœ€è¦ä¸º Realm æ¨¡å‹å¯¹è±¡è‡ªå®šä¹‰ä¸€ä¸ª JsonSerializer å¹¶ä¸”å°†å…¶æ³¨å†Œä¸ºä¸€ä¸ª TypeAdapterã€‚ è¯·å‚è€ƒè¿™ä¸ª Gistã€‚ æ•°ç»„ï¼ˆPrimitive listsï¼‰æŸäº› JSON API ä¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›åŸå§‹æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ String å’Œ integerï¼‰ï¼ŒRealm æš‚æ—¶ä¸æ”¯æŒå¯¹è¿™ç§æ•°ç»„çš„å¤„ç†ã€‚ä½†ä½ å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ TypeAdapteræ¥å¤„ç†è¿™ç§æƒ…å†µã€‚ è¿™ä¸ª Gist å±•ç¤ºäº†å¦‚ä½•å°† JSON ä¸­çš„æ•´å‹æ•°ç»„å­˜å…¥ Realmã€‚ç±»ä¼¼åœ°ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†å…¶å®ƒåŸå§‹æ•°æ®ç±»å‹æ•°ç»„ã€‚ TroubleshootingRealm å¯¹è±¡å±æ€§å¯èƒ½ä¼šåŒ…å«å¾ªç¯å¼•ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒGSON ä¼šæŠ›å‡º StackOverflowErrorã€‚ä¾‹å¦‚å¦‚ä¸‹ Realm å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ª Drawable å±æ€§ï¼š 12345public class Person extends RealmObject { @Ignore Drawable avatar; // other fields, etc} Person ç±»å«æœ‰ä¸€ä¸ª Android Drawable å¹¶ä¸”è¢« @Ignore ä¿®é¥°ã€‚å½“ GSON åºåˆ—åŒ–æ—¶ï¼ŒDrawable è¢«è¯»å–å¹¶ä¸”é€ æˆäº†å †æ ˆæº¢å‡ºã€‚(GitHub Issue)ã€‚æ·»åŠ å¦‚ä¸‹ä»£ç ä»¥é¿å…ç±»ä¼¼é—®é¢˜ï¼š 123public boolean shouldSkipField(FieldAttributes f) { return f.getDeclaringClass().equals(RealmObject.class) || f.getDeclaringClass().equals(Drawable.class);} è¯·æ³¨æ„å¯¹ Drawable.class çš„åˆ¤å®šè¯­å¥ï¼Œå®ƒå‘Šè¯‰ GSON è·³è¿‡è¿™ä¸ªå±æ€§çš„åºåˆ—åŒ–ä»¥é¿å…å †æ ˆæº¢å‡ºé”™è¯¯ã€‚ Jackson-databindJackson-databind ç”¨æ¥ç»‘å®š JSON æ•°æ®å’Œå…¶å¯¹åº”çš„ Java ç±»ã€‚ Jackson éœ€è¦ä½¿ç”¨åå°„è¿›è¡Œå·¥ä½œã€‚è¿™ä¸ Realm çš„ RxJava æ”¯æŒæœ‰å†²çªï¼Œå› ä¸ºä½œä¸ºå¯é€‰åŠŸèƒ½ï¼ŒRxJava æœ‰å¯èƒ½ä¸å†å·¥ç¨‹ä¾èµ–åº“ä¸­ã€‚è¿™ä¼šå¯¼è‡´ç±»ä¼¼å¦‚ä¸‹çš„å¼‚å¸¸æŠ›å‡ºï¼š 12java.lang.NoClassDefFoundError: rx.Observableat libcore.reflect.InternalNames.getClass(InternalNames.java:55) ä¸ºäº†ä¿®æ­£è¿™ä¸ªé—®é¢˜ä½ å¯ä»¥æ·»åŠ  RxJava ä¾èµ–åˆ°å·¥ç¨‹ä¸­æˆ–è€…åˆ›å»ºä¸€ä¸ªå‡ç±»æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š package rx; public class Observable { // Dummy class required for Jackson-Databind support if // RxJava is not a project dependency.} è¿™ä¸ªé—®é¢˜ä¹ŸåŒæ—¶æŠ¥å‘Šç»™äº† Jackson é¡¹ç›®ã€‚ KotlinRealm å®Œå…¨å…¼å®¹ Kotlin è¯­è¨€ï¼Œä½†æœ‰äº›åœ°æ–¹éœ€è¦æ³¨æ„ï¼š ä½ çš„æ¨¡å‹ç±»éœ€è¦æ˜¯å¼€æ”¾çš„ï¼ˆopenï¼‰ã€‚ ä½ å¯èƒ½éœ€è¦åœ¨æŸäº›æƒ…å†µä¸‹æ·»åŠ æ³¨è§£ @RealmCLass ä»¥ä¿è¯ç¼–è¯‘é€šè¿‡ã€‚è¿™æ˜¯ç”±äºå½“å‰ Kotlin æ³¨è§£å¤„ç†å™¨çš„ä¸€ä¸ªé™åˆ¶ã€‚ å¾ˆå¤š Realm API å¼•ç”¨äº† Java ç±»ã€‚ä½ å¿…é¡»åœ¨ç¼–è¯‘ä¾èµ–ä¸­æ·»åŠ  org.jetbrains.kotlin:kotlin-reflect:${kotlin_version}ã€‚å‚è§ç¤ºä¾‹ã€‚ ParcelerParceler å¯ä»¥å¸®åŠ©å¯¹è±¡è‡ªåŠ¨ç”Ÿæˆæ”¯æŒ Parcelable æ¥å£çš„æ ·æ¿ä»£ç ã€‚å› ä¸º Realm çš„ä»£ç†ç±»ï¼Œä½ éœ€è¦ä»¥ä¸‹è®¾ç½®ä»¥ä¾¿åº”ç”¨ Parceler åˆ° Realm å¯¹è±¡ã€‚ 12345678910// All classes that extend RealmObject will have a matching RealmProxy class created// by the annotation processor. Parceler must be made aware of this class. Note that// the class is not available until the project has been compiled at least once.@Parcel(implementations = { PersonRealmProxy.class }, value = Parcel.Serialization.BEAN, analyze = { Person.class })public class Person extends RealmObject {// ...} å¦‚æœä½ ä½¿ç”¨ Gradle æ¥è·å– Parcelerï¼Œè¯·ç¡®ä¿å­˜åœ¨ä»¥ä¸‹é…ç½®ä»£ç ï¼š 12compile \"org.parceler:parceler-api:1.0.3\"apt \"org.parceler:parceler:1.0.3\" è¯·æ³¨æ„ç›®å‰åœ¨ä½¿ç”¨ Parceler çš„æ—¶å€™æœ‰å¦‚ä¸‹çš„é™åˆ¶ï¼š å¦‚æœä½ çš„æ¨¡å‹åŒ…å« RealmListï¼Œé‚£ä¹ˆä½ éœ€è¦æ³¨å†Œä¸€ä¸ªç‰¹æ®Š adapter ä¸€æ—¦å¯¹è±¡è¢«æ‰“åŒ…ï¼ˆparcelledï¼‰ï¼Œå®ƒå°†å˜ä¸ºä¸€ä¸ªæœ‰å½“å‰æ•°æ®å¿«ç…§ï¼Œä¸å†è¢« Realm ç®¡ç†çš„ä¸€ä¸ª unmanaged å¯¹è±¡ã€‚ä¹‹åè¯¥å¯¹è±¡çš„æ•°æ®å˜åŒ–ä¸ä¼šè¢« Realm å†™å…¥ã€‚ RetrofitRetrofitæ˜¯ä¸€ä¸ªç”± Square å¼€å‘ï¼Œä¿è¯ç±»å‹å®‰å…¨ï¼ˆtypesafeï¼‰çš„ REST API å¤„ç†å·¥å…·ã€‚ Realm å¯ä»¥ä¸ Retrofit 1.x å’Œ 2.x æ— ç¼é…åˆå·¥ä½œã€‚ä½†è¯·æ³¨æ„ Retrofit ä¸ä¼šè‡ªåŠ¨å°†å¯¹è±¡å­˜å…¥ Realmã€‚ä½ éœ€è¦é€šè¿‡è°ƒç”¨ Realm.copyToRealm() æˆ– Realm.copyToRealmOrUpdate() æ¥å°†å®ƒä»¬å­˜å…¥ Realmã€‚ 1234567GitHubService service = restAdapter.create(GitHubService.class);List&lt;Repo&gt; repos = service.listRepos(\"octocat\");// Copy elements from Retrofit to Realm to persist them.realm.beginTransaction();List&lt;Repo&gt; realmRepos = realm.copyToRealmOrUpdate(repos);realm.commitTransaction(); Robolectricé€šè¿‡ Robolectricåº“å¯ä»¥è®©ä½ åœ¨ä¸ä½¿ç”¨çœŸå®è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨çš„æƒ…å†µä¸‹ç›´æ¥åœ¨ Java è™šæ‹Ÿæœºä¸Šè¿›è¡Œ JUnit æµ‹è¯•ã€‚ä½†ç›®å‰ Roboletrics ä¸æ”¯æŒå¸¦æœ‰åŸç”Ÿåº“çš„æµ‹è¯•ã€‚è€Œ Realm åŒ…å«ä½¿ç”¨ C++ çš„åŸç”Ÿåº“ï¼Œæ‰€ä»¥ä½ ç›®å‰ä¸å¯ä»¥é€šè¿‡ Roboletrics æµ‹è¯•ä½¿ç”¨ Realm çš„é¡¹ç›®ã€‚ ä½ å¯ä»¥å…³æ³¨è¿™ä¸ª Robolectric çš„æ–°åŠŸèƒ½è¯·æ±‚ã€‚ RxJavaRxJava æ˜¯ Netflix å‘å¸ƒçš„ä¸€ä¸ª [Reactive çš„æ‰©å±• åº“ä»¥æ”¯æŒ è§‚å¯Ÿè€…æ¨¡å¼ã€‚ Realm åŒ…å«äº†å¯¹ RxJava çš„åŸç”Ÿæ”¯æŒã€‚å¦‚ä¸‹ç±»å¯ä»¥è¢«æš´éœ²ä¸ºä¸€ä¸ª Observableï¼šRealm, RealmResults, RealmObject, DynamicRealm and DynamicRealmObjectã€‚ 12345678910// Combining Realm, Retrofit and RxJava (Using Retrolambda syntax for brevity)// Load all persons and merge them with their latest stats from GitHub (if they have any)Realm realm = Realm.getDefaultInstance();GitHubService api = retrofit.create(GitHubService.class);realm.where(Person.class).isNotNull(\"username\").findAllAsync().asObservable() .filter(persons.isLoaded) .flatMap(persons -&gt; Observable.from(persons)) .flatMap(person -&gt; api.user(person.getGithubUserName()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(user -&gt; showUser(user)); è¯·æ³¨æ„å¼‚æ­¥æŸ¥è¯¢ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œå¦‚ä¸Šä»£ç ä¼šç«‹å³è¿”å›ä¸€ä¸ª RealmResults å®ä¾‹ã€‚å¦‚æœä½ æƒ³ç¡®å®šè¯¥ RealmResults å·²ç»åŠ è½½å®Œæˆè¯·ä½¿ç”¨filter operator å’Œ RealmResults&lt;E&gt;.isLoaded() æ–¹æ³•ã€‚é€šè¿‡åˆ¤æ–­ RealmResults æ˜¯å¦å·²ç»åŠ è½½å¯ä»¥å¾—çŸ¥æŸ¥è¯¢æ˜¯å¦å·²ç»å®Œæˆã€‚ å‚è€ƒ RxJava sample projectã€‚ é…ç½®RxJava æ˜¯å¯é€‰ä¾èµ–ï¼Œè¿™æ„å‘³ç€ Realm ä¸ä¼šè‡ªåŠ¨åŒ…å«å®ƒã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ä½ å¯ä»¥é€‰æ‹©éœ€è¦çš„ RxJava ç‰ˆæœ¬ä»¥åŠé˜²æ­¢è¿‡å¤šçš„æ— ç”¨æ–¹æ³•è¢«æ‰“åŒ…ã€‚å¦‚æœä½ è¦ä½¿ç”¨ç›¸å…³åŠŸèƒ½ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ  RxJava åˆ° build.gradle æ–‡ä»¶ã€‚ 123dependencies { compile 'io.reactivex:rxjava:1.1.0'} ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿ RxObservableFactory æ¥å†³å®š Observable çš„ç”Ÿæˆæ–¹å¼ï¼Œç„¶åé€šè¿‡ RealmConfiguration è¿›è¡Œé…ç½®ã€‚ 123RealmConfiguration config = new RealmConfiguration.Builder() .rxFactory(new MyRxFactory()) .build() å¦‚æœæ²¡æœ‰ RxObservableFactory è¢«å®šä¹‰ï¼ŒRealmObservableFactory ä¼šè¢«é»˜è®¤ä½¿ç”¨ï¼Œå®ƒæ”¯æŒ RxJava &lt;= 1.1.*ã€‚ åŸæ–‡é“¾æ¥https://realm.io/cn/docs/java/latest/","link":"/2017/03/25/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Adapter &Supporting other libraryï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Queriesï¼ˆè¯‘æ–‡ï¼‰","text":"æŸ¥è¯¢ Realm ä¸­çš„æ‰€æœ‰è¯»å–ï¼ˆåŒ…æ‹¬æŸ¥è¯¢ï¼‰æ“ä½œéƒ½æ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ï¼Œä¸”æ•°æ®ç»ä¸ä¼šè¢«æ‹·è´ã€‚ Realm çš„æŸ¥è¯¢å¼•æ“ä½¿ç”¨ Fluent interface æ¥æ„é€ å¤šæ¡ä»¶æŸ¥è¯¢ã€‚ä½¿ç”¨ User ç±» 1234567891011121314151617public class User extends RealmObject { @PrimaryKey private String name; private int age; @Ignore private int sessionId; // Standard getters &amp; setters generated by your IDEâ€¦ public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public int getSessionId() { return sessionId; } public void setSessionId(int sessionId) { this.sessionId = sessionId; }} æ¯”å¦‚æŸ¥æ‰¾æ‰€æœ‰å«åš John æˆ– Peter çš„ç”¨æˆ·ï¼Œä½ å¯ä»¥è¿™ä¹ˆå†™ï¼š 12345678910111213141516// Build the query looking at all users:RealmQuery&lt;User&gt; query = realm.where(User.class);// Add query conditions:query.equalTo(\"name\", \"John\");query.or().equalTo(\"name\", \"Peter\");// Execute the query:RealmResults&lt;User&gt; result1 = query.findAll();// Or alternatively do the same all at once (the \"Fluent interface\"):RealmResults&lt;User&gt; result2 = realm.where(User.class) .equalTo(\"name\", \"John\") .or() .equalTo(\"name\", \"Peter\") .findAll(); è¿™ä¸ªæŸ¥è¯¢å°†è¿”å›ä¸€ä¸ªåŒ…å«åä¸ºJohnæˆ–è€…Peterçš„äººçš„RealmResultså®ä¾‹ã€‚åœ¨findAll()æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒæŸ¥è¯¢æ“ä½œå°±æ‰§è¡Œäº†ã€‚findAll()æ˜¯findAllå®¶æ—çš„ä¸€å‘˜ï¼Œä¾‹å¦‚findAllSorted()å°†è¿”å›ä¸€ä¸ªæ’åºåçš„ç»“æœé›†ï¼›findAllAsync()å°†åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œå¼‚æ­¥æŸ¥è¯¢ã€‚å…·ä½“è¯¦æƒ…è¯·é˜…APIæŒ‡å—ã€‚ è¿™äº›å¯¹è±¡å¹¶éæ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¾—åˆ°çš„æ˜¯ä¸€ä¸ªåŒ¹é…å¯¹è±¡å¼•ç”¨çš„åˆ—è¡¨ï¼Œä½ å¯¹åŒ¹é…å¯¹è±¡æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯ç›´æ¥æ–½åŠ äºå®ƒçš„åŸå§‹å¯¹è±¡ã€‚RealmResults ç»§æ‰¿è‡ª Java çš„ AbstractListï¼Œè¡Œä¸ºç±»ä¼¼ã€‚ä¾‹å¦‚ä½ å¯ä»¥é€šè¿‡ index æ¥è®¿é—®å…¶ä¸­çš„æŸä¸ªå¯¹è±¡ã€‚å½“æŸ¥è¯¢æ²¡æœ‰ä»»ä½•åŒ¹é…æ—¶ï¼Œè¿”å›çš„ RealmResults å¯¹è±¡å°†ä¸ä¼šä¸º nullï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å®ƒçš„ size() æ–¹æ³•å°†è¿”å› 0ã€‚ ä¿®æ”¹æˆ–åˆ é™¤ RealmResults ä¸­ä»»ä½•ä¸€ä¸ªå¯¹è±¡éƒ½å¿…é¡»åœ¨å†™å…¥äº‹åŠ¡ä¸­å®Œæˆã€‚ ä½ ä¹Ÿå¯ä»¥æŸ¥è¯¢å…³ç³». æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨where()æ–¹æ³•æ„å»ºä¸€ä¸ªç”±RealmQuery å¯¹è±¡ä»£è¡¨çš„æŸ¥è¯¢ã€‚ä¸€æ—¦æ„å»ºäº†RealmQuery ï¼Œä½ å¯ä»¥ä½¿ç”¨å„ç§å„æ ·çš„è°“è¯æ¥è¿‡æ»¤æŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ã€‚å¤§å¤šæ•°è°“è¯æ„ä¹‰ä»å­—é¢ä¸Šéƒ½èƒ½çœ‹å‡ºæ¥ã€‚ è°“è¯çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—æ®µåã€‚ å¦‚æœå­—æ®µçš„ç±»å‹ä¸æ”¯æŒè°“è¯ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…RealmQueryçš„APIå‚è€ƒã€‚ å¯¹äºæ‰€æœ‰æ•°æ®ç±»å‹ï¼Œä½ æœ‰ä»¥ä¸‹è°“è¯ï¼š equalTo() notEqualTo() è¦å°†å­—æ®µä¸å€¼åˆ—è¡¨åŒ¹é…ï¼Œè¯·ä½¿ç”¨inï¼ˆï¼‰ã€‚ ä¾‹å¦‚ï¼Œè¦æŸ¥æ‰¾åç§°â€œJillâ€ï¼Œâ€œWilliamâ€æˆ–â€œTrillianâ€ï¼Œæ‚¨å¯ä»¥åœ¨ï¼ˆâ€œnameâ€ï¼Œnew String [] {â€œJillâ€ï¼Œâ€œWilliamâ€ï¼Œâ€œTrillianâ€}ä¸­ä½¿ç”¨ã€‚ inï¼ˆï¼‰è°“è¯é€‚ç”¨äºå­—ç¬¦ä¸²ï¼ŒäºŒè¿›åˆ¶æ•°æ®å’Œæ•°å­—å­—æ®µã€‚ æ•°å­—æ•°æ®ç±»å‹ï¼ˆåŒ…æ‹¬æ—¥æœŸï¼‰å…è®¸è¿™äº›é™„åŠ è°“è¯ï¼š between() (ä¸¤ä¸ªç«¯ç‚¹ä¼šè¢«åŒ…å«åœ¨å†…, å³ï¼Œæœ‰ç•Œé—´éš”) greaterThan() lessThan() greaterThanOrEqualTo() lessThanOrEqualTo() å­—ç¬¦ä¸²å­—æ®µå…è®¸å¦‚ä¸‹é™„åŠ è°“è¯ï¼š contains() beginsWith() endsWith() like() æ‰€æœ‰å››ä¸ªå­—ç¬¦ä¸²è°“è¯éƒ½æœ‰å¯é€‰çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæ§åˆ¶å¤§å°å†™åŒºåˆ†ã€‚ å°†å…¶è®¾ç½®ä¸ºCase.INSENSITIVEä»¥åœ¨åŒ¹é…æ—¶å¿½ç•¥å¤§å°å†™ï¼Œæˆ–è€…å°†Case.SENSITIVEè®¾ç½®ä¸ºæ‰§è¡ŒåŒºåˆ†å¤§å°å†™åŒ¹é…ã€‚ é»˜è®¤å€¼ä¸ºCase.SENSITIVEã€‚ è°“è¯likeï¼ˆï¼‰æ‰§è¡Œglobæ ·å¼é€šé…ç¬¦åŒ¹é…ã€‚ åŒ¹é…æ¨¡å¼ç”±å­—ç¬¦å’Œä¸€ä¸ªæˆ–å¤šä¸ªé€šé…ç¬¦ç»„æˆï¼š * åŒ¹é…0ä¸ªæˆ–å¤šä¸ªUnicodeå­—ç¬¦ ï¼ŸåŒ¹é…1ä¸ªUnicodeå­—ç¬¦ ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªæœ‰å››ä¸ªå¯¹è±¡çš„Realmï¼Œåä¸ºnameçš„å­—æ®µï¼Œå…¶å€¼æœ‰Williamï¼ŒBillï¼ŒJillå’ŒTrillianã€‚ ç±»ä¼¼äºï¼ˆâ€œnameâ€ï¼Œâ€œï¼Ÿill *â€ï¼‰çš„è°“è¯å°†åŒ¹é…å‰ä¸‰ä¸ªå¯¹è±¡ï¼Œç±»ä¼¼ï¼ˆâ€œnameâ€ï¼Œâ€œ* iaï¼Ÿâ€ï¼‰å°†åŒ¹é…ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå¯¹è±¡ã€‚ äºŒè¿›åˆ¶æ•°æ®ï¼Œå­—ç¬¦ä¸²å’ŒRealmObjectï¼ˆRealmListï¼‰çš„åˆ—è¡¨å¯ä»¥æ˜¯ç©ºçš„ï¼Œå³å…·æœ‰é›¶çš„é•¿åº¦ã€‚ å¦‚ä¸‹æ˜¯æ£€æŸ¥æ˜¯å¦ä¸ºç©ºçš„è°“è¯ï¼š isEmpty() isNotEmpty() å¦‚æœä¸æ˜¯å¿…å¡«å­—æ®µï¼Œåˆ™å€¼å¯ä»¥ä¸ºnullï¼ˆè®°ä½ï¼ŒRealmObjectså­—æ®µä¸æ˜¯å¿…å¡«ï¼Œå€¼å¯ä»¥ä¸ºnullï¼‰ã€‚ ç”¨äºåŒ¹é…ç©ºå€¼çš„ä¸¤ä¸ªæœ‰ç”¨è°“è¯æ˜¯ï¼š isNull() isNotNull() é€»è¾‘è¿ç®—ç¬¦æ¯ä¸ªæŸ¥è¯¢æ¡ä»¶éƒ½ä¼šè¢«è¢«éšå¼åœ°è¢«é€»è¾‘å’Œï¼ˆ&amp;ï¼‰ç»„åˆåœ¨ä¸€èµ·ï¼Œè€Œé€»è¾‘æˆ–ï¼ˆorï¼‰éœ€è¦æ˜¾å¼åœ°å»æ‰§è¡Œ or()ã€‚ ä½¿ç”¨ User ç±» - 1234567891011121314151617public class User extends RealmObject { @PrimaryKey private String name; private int age; @Ignore private int sessionId; // Standard getters &amp; setters generated by your IDEâ€¦ public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public int getSessionId() { return sessionId; } public void setSessionId(int sessionId) { this.sessionId = sessionId; }} ä½ ä¹Ÿå¯ä»¥å°†æŸ¥è¯¢æ¡ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼Œä½¿ç”¨ beginGroup()ï¼ˆç›¸å½“äºå·¦æ‹¬å·ï¼‰å’Œ endGroup()ï¼ˆç›¸å½“äºå³æ‹¬å·ï¼‰ï¼š 12345678RealmResults&lt;User&gt; r = realm.where(User.class) .greaterThan(\"age\", 10) // implicit AND .beginGroup() .equalTo(\"name\", \"Peter\") .or() .contains(\"name\", \"Jo\") .endGroup() .findAll(); æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨ not() å¦å®šä¸€ä¸ªæ¡ä»¶ã€‚è¯¥ not() è¿ç®—ç¬¦å¯ä»¥ä¸ beginGroup()/endGroup() ä¸€èµ·ä½¿ç”¨æ¥å¦å®šå­æ¡ä»¶ã€‚å‡å¦‚è¯´ä½ æƒ³æŸ¥è¯¢åå­—ä¸æ˜¯â€œPeterâ€æˆ–è€…â€œJo.â€çš„Userã€‚æŸ¥è¯¢æ–¹å¼å¦‚ä¸‹ï¼š 12345678RealmResult&lt;User&gt; r = realm.where(User.class) .not() .beginGroup() .equalTo(\"name\", \"Peter\") .or() .contains(\"name\", \"Jo\") .endGroup() .findAll(); å½“ç„¶ï¼Œå¯¹äºè¿™ç§ç‰¹å®šçš„æŸ¥è¯¢ï¼Œä½¿ç”¨in()æ›´ä¸ºç®€æ´ï¼š 1234RealmResult&lt;User&gt; r = realm.where(User.class) .not() .in(\"name\", new String[]{\"Peter\", \"Jo\"}) finalAll(); æ’åºå½“ä½ æ‰§è¡Œå®ŒæŸ¥è¯¢è·å¾—ç»“æœåï¼Œå¯ä»¥å¯¹å®ƒè¿›è¡Œæ’åºï¼š 123RealmResults&lt;User&gt; result = realm.where(User.class).findAll();result = result.sort(\"age\"); // Sort ascendingresult = result.sort(\"age\", Sort.DESCENDING); æ’åºé»˜è®¤ä¸ºå‡åº; ä½¿ç”¨Sort.DESCENDINGä½œä¸ºç¬¬äºŒä¸ªå¯é€‰å‚æ•°å¯ä»¥ä¿®æ”¹ä¸ºé™åºã€‚ å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªå­—æ®µè¿›è¡Œæ’åºã€‚ å”¯ä¸€å€¼ä½¿ç”¨distinctï¼ˆï¼‰è°“è¯ä»…è¿”å›å”¯ä¸€å€¼ã€‚ ä¾‹å¦‚ï¼Œè¦äº†è§£ä½ çš„Realmä¸­æœ‰å¤šå°‘ä¸åŒçš„åå­—ï¼š 1RealmResults&lt;Person&gt; unique = realm.where(Person.class).distinct(\"name\"); åªæ”¯æŒæ•´æ•°å’Œå­—ç¬¦ä¸²å­—æ®µ; å¦‚æœä½ å°è¯•ä½¿ç”¨distinctï¼ˆï¼‰ä¸æ”¯æŒçš„å­—æ®µç±»å‹ï¼Œå°†æŠ›å‡ºå¼‚å¸¸ã€‚ ä¸æ’åºä¸€æ ·ï¼Œä½ å¯ä»¥æŒ‡å®šå¤šä¸ªå­—æ®µã€‚ é“¾å¼æŸ¥è¯¢å› ä¸ºæŸ¥è¯¢ç»“æœå¹¶ä¸ä¼šè¢«å¤åˆ¶ï¼Œä¸”åœ¨æŸ¥è¯¢æäº¤æ—¶å¹¶ä¸ä¼šè¢«æ‰§è¡Œï¼Œä½ å¯ä»¥é“¾å¼ä¸²èµ·æŸ¥è¯¢å¹¶é€æ­¥è¿›è¡Œåˆ†ç±»ç­›é€‰ï¼š 12RealmResults&lt;Person&gt; teenagers = realm.where(Person.class).between(\"age\", 13, 20).findAll();Person firstJohn = teenagers.where().equalTo(\"name\", \"John\").findFirst(); ä½ ä¹Ÿå¯ä»¥åœ¨å­å¯¹è±¡ä¸Šä½¿ç”¨é“¾å¼æŸ¥è¯¢ã€‚å‡è®¾ä»¥ä¸Š Person å¯¹è±¡åŒ…å«ä¸€ä¸ª Dog å¯¹è±¡åˆ—è¡¨ï¼š 1234567891011public class Dog extends RealmObject { private int age; // getters &amp; setters ...}public class Person extends RealmObject { private int age; private RealmList&lt;Dog&gt; dogs; // getters &amp; setters ...} ä½ å¯ä»¥æŸ¥è¯¢æ‰¾å‡ºæ‰€æœ‰å¹´é¾„åœ¨ 13 å’Œ 20 ä¹‹é—´çš„ Person å¹¶ä¸”ä»–è‡³å°‘æ‹¥æœ‰ä¸€ä¸ª 1 å²çš„ Dogï¼š 1RealmResults&lt;Person&gt; teensWithPups = realm.where(Person.class).between(\"age\", 13, 20).equalTo(\"dogs.age\", 1).findAll(); è¯·æ³¨æ„ï¼ŒæŸ¥è¯¢é“¾æœ€ç»ˆæ˜¯å»ºç«‹åœ¨ RealmResults ä¸Šè€Œé RealmQueryã€‚å¦‚æœä½ åœ¨æŸå­˜åœ¨çš„ RealmQuery ä¸Šæ·»åŠ æ›´å¤šçš„æŸ¥è¯¢æ¡ä»¶ï¼Œé‚£ä¹ˆä½ åœ¨ä¿®æ”¹æŸ¥è¯¢æœ¬èº«ï¼Œè€ŒéæŸ¥è¯¢é“¾ã€‚è¯·å‚è€ƒå…³è”æŸ¥è¯¢ã€‚ æŸ¥è¯¢ç»“æœçš„è‡ªåŠ¨æ›´æ–°ï¼ˆAuto-Updating Resultsï¼‰RealmResults æ˜¯å¯¹å…¶æ‰€åŒ…å«æ•°æ®çš„å®æ—¶ã€è‡ªåŠ¨æ›´æ–°è§†å›¾ï¼Œè¿™æ„å‘³ç€å®ƒæ°¸è¿œä¸éœ€è¦è¢«é‡æ–°æŸ¥è¯¢è·å–ã€‚æ•°æ®å¯¹è±¡çš„æ”¹å˜ä¼šåœ¨ä¸‹ä¸€æ¬¡ Looper äº‹ä»¶ä¸­è¢«åæ˜ åˆ°ç›¸åº”çš„æŸ¥è¯¢ç»“æœã€‚ 1234567891011121314151617181920final RealmResults&lt;Dog&gt; puppies = realm.where(Dog.class).lessThan(\"age\", 2).findAll();puppies.size(); // =&gt; 0realm.executeTransaction(new Realm.Transaction() { @Override void public execute(Realm realm) { Dog dog = realm.createObject(Dog.class); dog.setName(\"Fido\"); dog.setAge(1); }});puppies.addChangeListener(new RealmChangeListener() { @Override public void onChange(RealmResults&lt;Dog&gt; results) { // results and puppies point are both up to date results.size(); // =&gt; 1 puppies.size(); // =&gt; 1 }}); è¿™å¯¹æ‰€æœ‰çš„ RealmResults æœ‰æ•ˆ â€”â€” æ— è®ºæ˜¯å¦æœ‰è¿‡æ»¤æ¡ä»¶ã€æ˜¯å¦æ˜¯é“¾å¼æŸ¥è¯¢ã€‚ RealmResults çš„è¿™ä¸ªç‰¹æ€§ä¸ä»…ä½¿å¾— Realm å¿«é€Ÿé«˜æ•ˆï¼Œè€Œä¸”è®©ä½ çš„ä»£ç æ›´ç®€æ´ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾ä½ çš„ Activity æˆ–è€… Fragment ä¾èµ–äºæŸä¸ªæŸ¥è¯¢ç»“æœï¼Œä½ å¯ä»¥å°†ç›¸åº”çš„ Realm å¯¹è±¡æˆ–è€… RealmResults ä¿å­˜ä¸ºä¸€ä¸ªå±æ€§ï¼Œä½ ä¸éœ€è¦åœ¨æ¯æ¬¡è®¿é—®æ—¶ç¡®å®šå…¶æ˜¯å¦è¢«æ›´æ–° â€”â€” Realm ä¼šä¿è¯è¿™äº›ã€‚ ä½ å¯ä»¥é€šè¿‡è®¢é˜… Realm notifications æ¥å¾—çŸ¥ Realm æ•°æ®æ›´æ–°äº†ï¼Œè¿›è€Œåˆ·æ–° UI è€Œä¸å¿…é‡æ–°æŸ¥è¯¢è·å¾— RealmResultsã€‚ å› ä¸ºæŸ¥è¯¢ç»“æœçš„è‡ªåŠ¨æ›´æ–°ç‰¹æ€§ï¼Œè¯·ä¸è¦ä¾èµ–äºå›ºå®šçš„ç´¢å¼•ï¼ˆindicesï¼‰ã€ä¸å˜çš„æ¡ç›®æ•°ã€‚ æŒ‰ç±»å‹æ£€ç´¢å¯¹è±¡ä» Realm ä¸­æ£€ç´¢å¯¹è±¡çš„æœ€åŸºæœ¬æ–¹æ³•æ˜¯ realm.where(Foo.class).findAll()ï¼Œå®ƒè¿”å›äº†åŒ…å«è¢«æŸ¥è¯¢æ¨¡å‹ç±»çš„æ‰€æœ‰å¯¹è±¡çš„ RealmResultsã€‚ å¦å¤–è¿˜æœ‰æä¾›æ’åºåŠŸèƒ½çš„ findAll()ã€‚å‚è§ realm.where(Foo.class).findAllSorted() äº†è§£è¯¦æƒ…ã€‚ èšåˆRealmResult è‡ªå¸¦ä¸€äº›èšåˆæ–¹æ³•ï¼š 1234567RealmResults&lt;User&gt; results = realm.where(User.class).findAll();long sum = results.sum(\"age\").longValue();long min = results.min(\"age\").longValue();long max = results.max(\"age\").longValue();double average = results.average(\"age\");long matches = results.size(); è¿­ä»£å¯ä»¥è¿™æ ·éå† RealmResultsï¼š 1234RealmResults&lt;User&gt; results = realm.where(User.class).findAll();for (User u : results) { // ... do something with the object ...} æˆ–è€…ä½¿ç”¨ for å¾ªç¯ï¼š 12345RealmResults&lt;User&gt; results = realm.where(User.class).findAll();for (int i = 0; i &lt; results.size(); i++) { User u = results.get(i); // ... do something with the object ...} RealmResults çš„è‡ªåŠ¨æ›´æ–°ä¼šé€šè¿‡ looper äº‹ä»¶è§¦å‘ï¼Œä½†åœ¨äº‹ä»¶åˆ°æ¥ä¹‹å‰ï¼ŒæŸäº›å…ƒç´ æœ‰å¯èƒ½ä¸å†æ»¡è¶³æŸ¥è¯¢æ¡ä»¶æˆ–è€…å…¶å·²è¢«åˆ é™¤ã€‚ 123456789101112final RealmResults&lt;User&gt; users = getUsers();realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { users.get(0).deleteFromRealm(); // indirectly delete object }});for (User user : users) { showUser(user); // Will crash for the deleted user} ä¸ºé¿å…è¯¥é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ RealmResults çš„ deleteFromRealm() æ–¹æ³•ï¼š 123456789101112final RealmResults&lt;User&gt; users = getUsers();realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { users.deleteFromRealm(0); // Delete and remove object directly }});for (User user : users) { showUser(user); // Deleted user will not be shown} åˆ é™¤ä½ å¯ä»¥ä»æŸ¥è¯¢ç»“æœä¸­åˆ é™¤æ•°æ®ï¼š 12345678910111213141516171819// obtain the results of a queryfinal RealmResults&lt;Dog&gt; results = realm.where(Dog.class).findAll();// All changes to data must happen in a transactionrealm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { // remove single match results.deleteFirstFromRealm(); results.deleteLastFromRealm(); // remove a single object Dog dog = results.get(5); dog.deleteFromRealm(); // Delete all matches results.deleteAllFromRealm(); }}); å¼‚æ­¥æŸ¥è¯¢ï¼ˆAsynchronous Queriesï¼‰å¯ä»¥ä½¿ç”¨åå°çº¿ç¨‹è¿›è¡ŒæŸ¥è¯¢ã€‚ Realm çš„å¤§éƒ¨åˆ†æŸ¥è¯¢éƒ½éå¸¸å¿«â€”â€”å¿«åˆ°å¯ä»¥ä½¿ç”¨åœ¨UIçº¿ç¨‹ä¸­è€Œæ„Ÿè§‰ä¸åˆ°å»¶è¿Ÿã€‚ä½†å¦‚æœéœ€è¦è¿›è¡Œéå¸¸å¤æ‚çš„æŸ¥è¯¢æˆ–è€…åœ¨å¤§é‡æ•°æ®ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œé‚£ä¹ˆä½¿ç”¨åå°çº¿ç¨‹è¿›è¡ŒæŸ¥è¯¢å°†ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„ä¸»æ„ã€‚ ç¤ºä¾‹ï¼šæŸ¥æ‰¾åå­—ä¸º â€œJohnâ€ æˆ–è€… â€œPeterâ€ çš„ç”¨æˆ·ã€‚ åˆ›å»ºå¼‚æ­¥æŸ¥è¯¢12345RealmResults&lt;User&gt; result = realm.where(User.class) .equalTo(\"name\", \"John\") .or() .equalTo(\"name\", \"Peter\") .findAllAsync(); è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„è°ƒç”¨å¹¶ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯ç«‹å³è¿”å›ä¸€ä¸ª RealmResultsã€‚è¿™å¾ˆç±»ä¼¼äºæ ‡å‡† Java ä¸­ Future çš„æ¦‚å¿µã€‚æŸ¥è¯¢å°†ä¼šåœ¨åå°çº¿ç¨‹ä¸­è¢«æ‰§è¡Œï¼Œå½“å…¶å®Œæˆæ—¶ï¼Œä¹‹å‰è¿”å›çš„ RealmResults å®ä¾‹ä¼šè¢«æ›´æ–°ã€‚ å¦‚æœä½ å¸Œæœ›å½“æŸ¥è¯¢å®Œæˆã€RealmResults è¢«æ›´æ–°æ—¶è·å¾—é€šçŸ¥ï¼Œä½ å¯ä»¥æ³¨å†Œä¸€ä¸ª RealmChangeListenerã€‚è¿™ä¸ªç›‘å¬å™¨ä¼šåœ¨ RealmResults è¢«æ›´æ–°æ—¶è¢«è°ƒç”¨ï¼ˆé€šå¸¸æ˜¯åœ¨äº‹åŠ¡è¢«æäº¤åï¼‰ã€‚ æ³¨å†Œå›è°ƒ1234567891011private RealmChangeListener callback = new RealmChangeListener&lt;RealmResults&lt;User&gt;&gt;() { @Override public void onChange(RealmResults&lt;User&gt; results) { // called once the query complete and on every update }};public void onStart() { RealmResults&lt;User&gt; result = realm.where(User.class).findAllAsync(); result.addChangeListener(callback);} è¯·åœ¨é€€å‡º Activity æˆ–è€… Fragment æ—¶ç§»é™¤ç›‘å¬å™¨çš„æ³¨å†Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚ 123456public void onStop () { result.removeChangeListener(callback); // remove a particular listener // or result.removeChangeListeners(); // remove all registered listeners} æ£€æŸ¥æŸ¥è¯¢æ˜¯å¦å®Œæˆ1234RealmResults&lt;User&gt; result = realm.where(User.class).findAllAsync();if (result.isLoaded()) { // Results are now available} åŒæ­¥æŸ¥è¯¢è¿”å›çš„ RealmResults å®ä¾‹çš„ isLoaded æ–¹æ³•ä¼šæ°¸è¿œè¿”å› trueã€‚ å¼ºåˆ¶è£…è½½å¼‚æ­¥æŸ¥è¯¢ä½ å¯ä»¥é€‰æ‹©æ€§åœ°ç­‰å¾…å¼‚æ­¥æŸ¥è¯¢å®Œæˆï¼Œè€Œè¿™å°†ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œä½¿æŸ¥è¯¢å˜æˆåŒæ­¥ï¼ˆä¸ Future.get() ç±»ä¼¼çš„æ¦‚å¿µï¼‰ã€‚ 12RealmResults&lt;User&gt; result = realm.where(User.class).findAllAsync();result.load() // be careful, this will block the current thread until it returns é Looper çº¿ç¨‹ä½ å¯ä»¥åœ¨ Looper çº¿ç¨‹ä¸­ä½¿ç”¨å¼‚æ­¥æŸ¥è¯¢ã€‚å¼‚æ­¥æŸ¥è¯¢éœ€è¦ä½¿ç”¨ Handler æ¥ä¼ é€’æŸ¥è¯¢ç»“æœã€‚åœ¨æ²¡æœ‰ Looper çš„çº¿ç¨‹ä¸­ä½¿ç”¨å¼‚æ­¥æŸ¥è¯¢ä¼šå¯¼è‡´ IllegalStateException å¼‚å¸¸è¢«æŠ›å‡ºã€‚ åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#queries","link":"/2017/03/06/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Queriesï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Realmï¼ˆè¯‘æ–‡ï¼‰","text":"RealmRealm(s) æ˜¯æˆ‘ä»¬å¯¹æ•°æ®åº“çš„ç§°è°“ï¼šå®ƒåŒ…å«å¤šä¸ªä¸åŒçš„å¯¹è±¡ï¼Œå¹¶å¯¹åº”ç£ç›˜ä¸­çš„ä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œéœ€è¦å¯¹ Realm åº“è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼š 1Realm.init(context); ä½ éœ€è¦æä¾›ä¸€ä¸ªå®‰å“çš„ Context å¯¹è±¡æ¥å¯¹ Realm è¿›è¡Œåˆå§‹åŒ–ã€‚åˆå§‹åŒ–æ“ä½œåªè¦è¿›è¡Œä¸€æ¬¡ã€‚ç»§æ‰¿ Application å¹¶åœ¨é‡è½½çš„ onCreate() æ–¹æ³•ä¸­è¿›è¡Œåˆå§‹åŒ–æ˜¯ä¸ªä¸é”™çš„ä¸»æ„ã€‚ 1234567public class MyApplication extends Application { @Override public void onCreate() { super.onCreate(); Realm.init(this); }} è¯·åˆ«å¿˜äº†ä¿®æ”¹ AndroidManifest.xml: 1234&lt;application android:name=\".MyApplication\" .../&gt; é…ç½®RealmRealmConfiguration ç”¨æ¥é…ç½®è¦è¢«åˆ›å»ºçš„ Realm çš„å„ç§ç‰¹æ€§ã€‚æœ€ç®€é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š 1RealmConfiguration config = new RealmConfiguration.Builder().build(); å¦‚ä¸Šé…ç½®çš„ Realm ä¼šè¢«å­˜å‚¨åœ¨ Context.getFilesDir() å¹¶ä¸”å‘½åä¸º default.realmã€‚ ä¸€ä¸ªå…¸å‹çš„é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011// The RealmConfiguration is created using the builder pattern.// The Realm file will be located in Context.getFilesDir() with name \"myrealm.realm\"RealmConfiguration config = new RealmConfiguration.Builder() .name(\"myrealm.realm\") .encryptionKey(getKey()) .schemaVersion(42) .modules(new MySchemaModule()) .migration(new MyMigration()) .build();// Use the configRealm realm = Realm.getInstance(config); ä½ è¿˜å¯ä»¥æœ‰å¤šä¸ªRealmConfigurationã€‚å¦‚æ­¤ï¼Œä½ ä¾¿å¯ä»¥æ§åˆ¶Realmçš„ç‰ˆæœ¬ã€ç»“æ„ï¼ˆschemaï¼‰å’Œè·¯å¾„ã€‚ 1234567891011121314RealmConfiguration myConfig = new RealmConfiguration.Builder() .name(\"myrealm.realm\") .schemaVersion(2) .modules(new MyCustomSchema()) .build();RealmConfiguration otherConfig = new RealmConfiguration.Builder() .name(\"otherrealm.realm\") .schemaVersion(5) .modules(new MyOtherSchema()) .build();Realm myRealm = Realm.getInstance(myConfig);Realm otherRealm = Realm.getInstance(otherConfig); ä½ å¯ä»¥ä½¿ç”¨ Realm.getPath() æ¥è·å– Realm æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚ å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ Realm å®ä¾‹æ˜¯çº¿ç¨‹å•ä¾‹åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šæ¬¡åœ¨åŒä¸€çº¿ç¨‹è°ƒç”¨é™æ€æ„å»ºå™¨ä¼šè¿”å›åŒä¸€ Realm å®ä¾‹ã€‚ é»˜è®¤ RealmConfigurationRealmConfigurationå¯ä»¥ä¿å­˜ä¸ºé»˜è®¤é…ç½®ã€‚é€šè¿‡åœ¨è‡ªå®šä¹‰çš„Applicationè®¾ç½®é»˜è®¤çš„Realmé…ç½®ï¼Œå¯ä»¥ä½¿ä½ åœ¨ä»£ç ä¸­çš„å…¶ä»–åœ°æ–¹æ›´åŠ æ–¹ä¾¿åœ°åˆ›å»ºé’ˆå¯¹è¯¥é»˜è®¤é…ç½®çš„Realmã€‚ 1234567891011121314151617181920212223public class MyApplication extends Application { @Override public void onCreate() { super.onCreate(); // The Realm file will be located in Context.getFilesDir() with name \"default.realm\" Realm.init(this); RealmConfiguration config = new RealmConfiguration.Builder().build(); Realm.setDefaultConfiguration(config); }}public class MyActivity extends Activity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); Realm realm = Realm.getDefaultInstance(); try { // ... Do something ... } finally { realm.close(); } }} In-Memory Realmå®šä¹‰ä¸€ä¸ªéæŒä¹…åŒ–çš„ã€å­˜åœ¨äºå†…å­˜ä¸­çš„ Realm å®ä¾‹ï¼š 1234RealmConfiguration myConfig = new RealmConfiguration.Builder() .name(\"myrealm.realm\") .inMemory() .build(); è¿™æ ·å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå­˜åœ¨äºâ€œå†…å­˜ä¸­çš„â€ Realmã€‚â€œå†…å­˜ä¸­çš„â€Realm åœ¨å†…å­˜ç´§å¼ çš„æƒ…å†µä¸‹ä»æœ‰å¯èƒ½ä½¿ç”¨åˆ°ç£ç›˜å­˜å‚¨ï¼Œä½†æ˜¯è¿™äº›ç£ç›˜ç©ºé—´éƒ½ä¼šåœ¨Realmå®ä¾‹å®Œå…¨å…³é—­çš„æ—¶å€™è¢«é‡Šæ”¾ã€‚ è¯·æ³¨æ„ä½¿ç”¨åŒæ ·çš„åç§°åŒæ—¶åˆ›å»ºâ€œå†…å­˜ä¸­çš„â€Realm å’Œå¸¸è§„çš„ï¼ˆæŒä¹…åŒ–ï¼‰Realm æ˜¯ä¸å…è®¸çš„ã€‚ å½“æŸä¸ªâ€œå†…å­˜ä¸­çš„â€Realm çš„æ‰€æœ‰å®ä¾‹å¼•ç”¨éƒ½è¢«é‡Šæ”¾ï¼Œè¯¥ Realm ä¸‹çš„æ•°æ®ä¹ŸåŒæ—¶ä¼šè¢«æ¸…é™¤ã€‚å»ºè®®åœ¨ä½ çš„åº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ä¿æŒå¯¹â€œå†…å­˜ä¸­çš„â€ Realm å®ä¾‹çš„å¼•ç”¨ä»¥é¿å…éæœŸæœ›çš„æ•°æ®ä¸¢å¤±ã€‚ Dynamic Realmå¯¹äºæ™®é€šçš„ Realm æ¥è¯´ï¼Œæ•°æ®æ¨¡å‹è¢«å®šä¹‰æˆäº† RealmObject çš„å­ç±»ã€‚è¿™æ ·åšä¿è¯äº†ç±»å‹å®‰å…¨ï¼Œä½†æœ‰æ—¶å€™æŸäº›æ•°æ®æ¨¡å‹åœ¨ç¼–è¯‘æœŸæ˜¯æ— æ³•è·å¾—çš„ã€‚ä¾‹å¦‚åœ¨å¤„ç†æ•°æ®è¿ç§»ï¼ˆmigrationï¼‰æˆ–CSVæ–‡ä»¶çš„æ—¶å€™ã€‚ DynamicRealm æ˜¯æ™®é€š Realm çš„ä¸€ä¸ªå˜ç§ã€‚å®ƒå¯ä»¥åœ¨æ²¡æœ‰ RealmObject å­ç±»çš„æƒ…å†µä¸‹æ“ä½œ Realm æ•°æ®ã€‚å…¶å¯¹æ•°æ®çš„è®¿é—®æ˜¯åŸºäºå­—ç¬¦ä¸²è€Œé RealmObject çš„å®šä¹‰ã€‚ åˆ›å»º Dynamic Realm ä½¿ç”¨ä¸åˆ›å»ºæ™®é€š Realm ç›¸åŒçš„RealmConfigurationï¼Œä½†æ˜¯å®ƒçš„åˆ›å»ºè¿‡ç¨‹ä¼šå¿½ç•¥å¯¹ schemaã€migrationä»¥åŠ schema ç‰ˆæœ¬çš„æ£€æŸ¥ã€‚ 123456789101112131415161718RealmConfiguration realmConfig = new RealmConfiguration.Builder().build();DynamicRealm realm = DynamicRealm.getInstance(realmConfig);// In a DynamicRealm all objects are DynamicRealmObjectsDynamicRealmObject person = realm.createObject(\"Person\");// All fields are accessed using stringsString name = person.getString(\"name\");int age = person.getInt(\"age\");// An underlying schema still exists, so accessing a field that does not exist// will throw an exceptionperson.getString(\"I don't exist\");// Queries still work normallyRealmResults&lt;DynamicRealmObject&gt; persons = realm.where(\"Person\") .equalTo(\"name\", \"John\") .findAll(); DynamicRealm ä»¥ç±»å‹å®‰å…¨å’Œæ€§èƒ½ä¸ºä»£ä»·ï¼Œæ¢æ¥äº†æ›´å¤šçš„çµæ´»æ€§ã€‚è¯·åœ¨ä½ ç¡®å®éœ€è¦è¿™äº›çµæ´»æ€§çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚ å…³é—­Realmå®ä¾‹Realm å®ç°äº† Closeable æ¥å£ä»¥ä¾¿ä¸é‡Šæ”¾ native å†…å­˜å’Œæ–‡ä»¶æè¿°ç¬¦ï¼Œè¯·åŠ¡å¿…åœ¨ä½¿ç”¨å®Œæ¯•åå…³é—­ Realm å®ä¾‹ã€‚ Realm å®ä¾‹æ˜¯åŸºäºå¼•ç”¨è®¡æ•°çš„, ä¹Ÿå°±æ˜¯è¯´å‡è®¾ä½ åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­è°ƒç”¨äº† getInstance() ä¸¤æ¬¡ï¼Œä½ éœ€è¦åŒæ ·è°ƒç”¨ close() ä¸¤æ¬¡ä»¥å…³é—­è¯¥å®ä¾‹ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ éœ€è¦å®ç° Runnableï¼Œç®€å•åœ°åœ¨å‡½æ•°å¼€å§‹çš„æ—¶å€™è°ƒç”¨ getInstance()ï¼Œåœ¨å‡½æ•°ç»“æŸçš„æ—¶å€™è°ƒç”¨ close() å³å¯ï¼ å¯¹äºUIçº¿ç¨‹ï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨ onDestroy() æ–¹æ³•å†…è°ƒç”¨ realm.close()ã€‚ å¦‚æœä½ æƒ³ä½¿ç”¨é™¤ UI çº¿ç¨‹å¤–çš„ Looper çº¿ç¨‹ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ä»£ç ï¼š 1234567891011121314151617public class MyThread extends Thread { private Realm realm; public void run() { Looper.prepare(); try { realm = Realm.getDefaultInstance(); //... Setup the handlers using the Realm instance ... Lopper.loop(); } finally { if (realm != null) { realm.close(); } } }} å¯¹äº AsyncTaskï¼Œè¿™é‡Œæœ‰ä¸ªä¸é”™çš„ä¾‹å­å¯ä»¥å‚è€ƒï¼š 12345678910protected Void doInBackground(Void... params) { Realm realm = Realm.getDefaultInstance(); try { // ... Use the Realm instance ... } finally { realm.close(); } return null;} å¦‚æœä½ æƒ³ä½¿ç”¨ Thread å’Œ Runnable è¿›è¡Œä¸€äº›çŸ­æœŸä»»åŠ¡ï¼Œå‚è€ƒå¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617/ Run a non-Looper thread with a Realm instance.Thread thread = new Thread(new Runnable() { @Override public void run() { Realm realm = null; try { realm = Realm.getDefaultInstance(); // ... Use the Realm instance ... } finally { if (realm != null) { realm.close(); } } }});thread.start(); å¦‚æœä½ å¾ˆå¹¸è¿åœ°å·¥ä½œåœ¨ minSdkVersion &gt;= 19 ä¸” Java &gt;= 7 ä¹‹ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨try-with-resourcesï¼š 123try (Realm realm = Realm.getDefaultInstance()) { // No need to close the Realm instance manually} è‡ªåŠ¨åˆ·æ–°å¦‚æœ Realm å®ä¾‹å­˜åœ¨äºä¸€ä¸ªå¸¦æœ‰ Looper çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ª Realm å®ä¾‹å³å…·æœ‰è‡ªåŠ¨æ›´æ–°çš„åŠŸèƒ½ã€‚è¿™æ„å‘³è¿™å¦‚æœå‘ç”Ÿäº† Realm æ•°æ®åº“çš„å˜åŒ–ï¼Œé‚£ä¹ˆè¯¥ Realm å®ä¾‹ä¼šåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰ä¸­è‡ªåŠ¨æ›´æ–°ã€‚è¿™ä¸ªä¾¿æ·çš„åŠŸèƒ½ä½¿ä½ ä¸å¿…èŠ±è´¹å¤ªå¤šçš„ç²¾åŠ›å°±èƒ½ä¿è¯çš„UIä¸æ•°æ®çš„å®æ—¶åŒæ­¥ã€‚ å¦‚æœ Realm çš„å®ä¾‹æ‰€åœ¨çº¿ç¨‹æ²¡æœ‰ç»‘å®š Looperï¼Œé‚£ä¹ˆè¯¥å®ä¾‹ä¸ä¼šè¢«æ›´æ–°ç›´åˆ°ä½ æ‰‹åŠ¨è°ƒç”¨ waitForChange() æ–¹æ³•ã€‚è¯·æ³¨æ„ï¼Œä¸æ›´æ–° Realm ä»¥ä¿æŒå¯¹æ—§æ•°æ®çš„å¼•ç”¨ä¼šé€ æˆè€Œå¤–çš„ç£ç›˜å’Œå†…å­˜å¼€é”€ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦åœ¨çº¿ç¨‹ç»“æŸæ—¶è°ƒç”¨ close() å…³é—­ Realm å®ä¾‹çš„ä¸€ä¸ªé‡è¦åŸå› ã€‚ å¦‚æœä½ æƒ³ç¡®å®šå½“å‰ Realm å®ä¾‹æ˜¯å¦æœ‰è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ isAutoRefresh() æ–¹æ³•æŸ¥è¯¢ã€‚ æŸ¥æ‰¾ Realm æ•°æ®åº“æ–‡ä»¶å¦‚æœä½ æƒ³çŸ¥é“ä½ åº”ç”¨çš„ Realm æ–‡ä»¶çš„å…·ä½“è·¯å¾„ï¼Œè¯·å‚è§è¿™ä¸ª StackOverflowä¸Šçš„ç­”æ¡ˆã€‚ åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#realms","link":"/2017/03/07/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Realmï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Retrofit & WebService","text":"1. å‰è¨€æœ€è¿‘å·¥ä½œä¸­éœ€è¦ä½¿ç”¨åˆ°WebServiceæ¥å£ï¼Œä¸ªäººæ¯”è¾ƒå–œæ¬¢Restfulçš„æ¥å£é£æ ¼ï¼Œå¯¹WebServiceä¸æ˜¯å¾ˆäº†è§£ã€‚ Web Serviceä¹Ÿå«XML Web Service WebServiceæ˜¯ä¸€ç§å¯ä»¥æ¥æ”¶ä»Internetæˆ–è€…Intranetä¸Šçš„å…¶å®ƒç³»ç»Ÿä¸­ä¼ é€’è¿‡æ¥çš„è¯·æ±‚ï¼Œè½»é‡çº§çš„ç‹¬ç«‹çš„é€šè®¯æŠ€æœ¯ã€‚æ˜¯:é€šè¿‡SOAPåœ¨Webä¸Šæä¾›çš„è½¯ä»¶æœåŠ¡ï¼Œä½¿ç”¨WSDLæ–‡ä»¶è¿›è¡Œè¯´æ˜ï¼Œå¹¶é€šè¿‡UDDIè¿›è¡Œæ³¨å†Œã€‚ è€Œå¯¹äºæˆ‘ä»¬ç§»åŠ¨å¼€å‘äººå‘˜è€Œè¨€ï¼Œå®ƒå°±æ˜¯ä¸€ç§æ•°æ®äº¤äº’çš„é€šé“ã€‚æˆ‘ä»¬éœ€è¦äº†è§£ä»–çš„è¯·æ±‚ç»“æ„ä½“å’Œå“åº”ç»“æ„ä½“ã€‚ 2. WebServiceè°ƒè¯•å·¥å…·SoapUISoapUIæ˜¯ä¸€ä¸ªå¼€æºæµ‹è¯•å·¥å…·ï¼Œé€šè¿‡soap/httpæ¥æ£€æŸ¥ã€è°ƒç”¨ã€å®ç°Web Serviceçš„åŠŸèƒ½/è´Ÿè½½/ç¬¦åˆæ€§æµ‹è¯•ã€‚è¯¥å·¥å…·æ—¢å¯ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æµ‹è¯•è½¯ä»¶ä½¿ç”¨ï¼Œä¹Ÿå¯åˆ©ç”¨æ’ä»¶é›†æˆåˆ°Eclipseï¼Œmaven2.Xï¼ŒNetbeans å’Œintellijä¸­ä½¿ç”¨ã€‚SoapUI Proæ˜¯SoapUIçš„å•†ä¸šéå¼€æºç‰ˆæœ¬ï¼Œå®ç°çš„åŠŸèƒ½è¾ƒå¼€æºçš„SoapUIæ›´å¤šã€‚(æ‰¾ä¸åˆ°èµ„æºçš„å¯ä»¥åœ¨æ–‡ç« ä¸‹æ–¹ç•™è¨€) 3. æ¥å£åˆ†æï¼ˆä»¥getMobileCodeInfoä¸ºä¾‹ï¼‰ä»¥ http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?wsdl ä¸ºæµ‹è¯•ä¾‹å­ ä»ä¸Šé¢ä¸¤ä¸ªå›¾å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¾—è¯·æ±‚ä½“å’Œå“åº”ä½“çš„ç»“æ„å’Œå†…å®¹ï¼Œä»¥XMLæ ¼å¼ä½œä¸ºæ•°æ®äº¤äº’çš„ç»“æ„ç±»å‹ã€‚ 4. ç¨‹åºè®¾è®¡4.1 æ·»åŠ ä¾èµ–123456789implementation 'com.squareup.okhttp3:okhttp:3.8.0'implementation 'com.parkingwang:okhttp3-loginterceptor:0.5'implementation 'com.squareup.retrofit2:retrofit:2.3.0'implementation 'com.squareup.retrofit2:adapter-rxjava2:2.3.0'implementation('com.squareup.retrofit2:converter-simplexml:2.3.0') { exclude module: 'stax' exclude module: 'stax-api' exclude module: 'xpp3'} 4.2 è¯·æ±‚ä½“è®¾è®¡ä»è¯·æ±‚ä½“XMLç»“æ„è€Œè¨€ 1234567891011&lt;soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:web=\"http://WebXml.com.cn/\"&gt; &lt;soap:Header/&gt; &lt;soap:Body&gt; &lt;web:getMobileCodeInfo&gt; &lt;!--Optional:--&gt; &lt;!--Optional:--&gt; &lt;web:mobileCode&gt;18507152743&lt;/web:mobileCode&gt; &lt;/web:getMobileCodeInfo&gt; &lt;/soap:Body&gt;&lt;/soap:Envelope&gt; æœ€å¤–å±‚soap:Envelopeå…¶æ¬¡soap:Bodyæœ€åweb:getMobileCodeInfoï¼Œè€Œweb:getMobileCodeInfoä¸­æœ‰ä¸€ä¸ªmobileCodeæˆ‘ä»¬å¯ä»¥ç”¨å˜é‡è¡¨ç¤ºï¼Œæ‰€ä»¥åˆ›å»ºå¦‚ä¸‹ä¸‰ä¸ªç±»ï¼šMobileCodeRequestEnvelope.java 12345678910111213141516171819@Root(name = \"soap:Envelope\")@NamespaceList({ @Namespace(prefix = \"xsi\", reference = \"http://www.w3.org/2001/XMLSchema-instance\"), @Namespace(prefix = \"xsd\", reference = \"http://www.w3.org/2001/XMLSchema\"), @Namespace(prefix = \"soap\", reference = \"http://www.w3.org/2003/05/soap-envelope\")})public class MobileCodeRequestEnvelope { @Element(name = \"soap:Body\", required = false) private MobileCodeRequestBody body; public MobileCodeRequestBody getBody() { return body; } public void setBody(MobileCodeRequestBody body) { this.body = body; }} MobileCodeRequestBody.java 1234567891011121314@Root(name = \"soap:Body\", strict = false)public class MobileCodeRequestBody { @Element(name = \"getMobileCodeInfo\", required = false) private MobileCodeRequestData mMobileCodeRequestData; public MobileCodeRequestData getMobileCodeRequestData() { return mMobileCodeRequestData; } public void setMobileCodeRequestData( MobileCodeRequestData mobileCodeRequestData) { mMobileCodeRequestData = mobileCodeRequestData; }} MobileCodeRequestData.java 1234567891011121314@Root(name = \"getMobileCodeInfo\", strict = false)@Namespace(reference = \"http://WebXml.com.cn/\")public class MobileCodeRequestData { @Element(name = \"mobileCode\", required = false) private String mobileCode; public String getMobileCode() { return mobileCode; } public void setMobileCode(String mobileCode) { this.mobileCode = mobileCode; }} 4.3 å“åº”ä½“è®¾è®¡ä»å“åº”ä½“XMLè€Œè¨€ 1234567&lt;soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt; &lt;soap:Body&gt; &lt;getMobileCodeInfoResponse xmlns=\"http://WebXml.com.cn/\"&gt; &lt;getMobileCodeInfoResult&gt;18507152743ï¼šæ¹–åŒ— æ­¦æ±‰ æ¹–åŒ—è”é€šGSMå¡&lt;/getMobileCodeInfoResult&gt; &lt;/getMobileCodeInfoResponse&gt; &lt;/soap:Body&gt;&lt;/soap:Envelope&gt; æœ€å¤–å±‚soap:Envelopeå…¶æ¬¡soap:Bodyç„¶ågetMobileCodeInfoResponseï¼Œæœ€ågetMobileCodeInfoResultï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å˜é‡è¡¨ç¤ºï¼Œæ‰€ä»¥åˆ›å»ºå¦‚ä¸‹ä¸‰ä¸ªç±»ï¼š MobileCodeResponseEnvelope.java 12345678910111213141516171819@Root(name = \"soap:Envelope\")@NamespaceList({ @Namespace( prefix = \"xsi\", reference = \"http://www.w3.org/2001/XMLSchema-instance\"), @Namespace( prefix = \"xsd\", reference = \"http://www.w3.org/2001/XMLSchema\"), @Namespace( prefix = \"soap\", reference = \"http://www.w3.org/2003/05/soap-envelope\")})public class MobileCodeResponseEnvelope { @Element(name = \"Body\", required = false) private MobileCodeResponseBody mMobildCodeResponseBody; public MobileCodeResponseBody getMobildCodeResponseBody() { return mMobildCodeResponseBody; } public void setMobildCodeResponseBody( MobileCodeResponseBody mobildCodeResponseBody) { mMobildCodeResponseBody = mobildCodeResponseBody; }} MobileCodeResponseBody.java 1234567891011121314@Root(name = \"Body\")public class MobileCodeResponseBody { public MobileCodeResponseInfo getMobileCodeResponseInfo() { return mMobileCodeResponseInfo; } public void setMobileCodeResponseInfo( MobileCodeResponseInfo mobileCodeResponseInfo) { mMobileCodeResponseInfo = mobileCodeResponseInfo; } @Element(name = \"getMobileCodeInfoResponse\", required = false) private MobileCodeResponseInfo mMobileCodeResponseInfo;} MobileCodeResponseInfo.java 1234567891011121314@Root(name = \"getMobileCodeInfoResponse\",strict = false)public class MobileCodeResponseInfo { public String getMobileCodeResult() { return MobileCodeResult; } public void setMobileCodeResult(String mobileCodeResult) { MobileCodeResult = mobileCodeResult; } @Element(name = \"getMobileCodeInfoResult\", required = false) private String MobileCodeResult;} 4.4 æ¥å£è®¾è®¡123456789public interface mobileCodeApi { @Headers({ \"Content-Type: text/xml\", \"Accept-Charset: utf-8\" }) @POST(\"MobileCodeWS.asmx\") Call&lt;MobileCodeResponseEnvelope&gt; getMobileCodeInfo( @Body MobileCodeRequestEnvelope requestEnvelope);} 4.5 Retrofitåˆ›å»º1234567891011121314151617181920212223242526272829303132333435public class Retrofitance { private static Strategy strategy = new AnnotationStrategy(); private static Serializer serializer = new Persister(strategy); private static OkHttpClient.Builder okHttpClient = new OkHttpClient.Builder(); private static Retrofit.Builder retrofitBuilder = new Retrofit.Builder() .addConverterFactory(SimpleXmlConverterFactory.create(serializer)) .baseUrl(Constant.BASE_URL); public static &lt;T&gt; T createMobileCodeService(Class&lt;T&gt; serviceClass) { okHttpClient.interceptors().add(new Interceptor() { @Override public okhttp3.Response intercept(Interceptor.Chain chain) throws IOException { Request original = chain.request(); Request.Builder requestBuilder = original.newBuilder() .header(\"Content-Type\", \"text/xml;charset=UTF-8\") .method(original.method(), original.body()); Request request = requestBuilder.build(); return chain.proceed(request); } }); OkHttpClient client = okHttpClient.connectTimeout(1, TimeUnit.MINUTES) .addInterceptor(new LogInterceptor()) .writeTimeout(1, TimeUnit.MINUTES) .readTimeout(1, TimeUnit.MINUTES) .build(); Retrofit retrofit = retrofitBuilder.client(client).build(); return retrofit.create(serviceClass); }} 4.6 è¯·æ±‚æ•°æ®12345678910111213141516171819202122232425262728293031mobileCodeApi apiService = Retrofitance.createMobileCodeService(mobileCodeApi.class);MobileCodeRequestEnvelope requestEnvelope = new MobileCodeRequestEnvelope();MobileCodeRequestBody requestBody = new MobileCodeRequestBody();MobileCodeRequestData requestData = new MobileCodeRequestData();requestData.setMobileCode(\"18507152743\");requestBody.setMobileCodeRequestData(requestData);requestEnvelope.setBody(requestBody);Call&lt;MobileCodeResponseEnvelope&gt; call = apiService.getMobileCodeInfo(requestEnvelope);call.enqueue(new Callback&lt;MobileCodeResponseEnvelope&gt;() { @Override public void onResponse(Call&lt;MobileCodeResponseEnvelope&gt; call, Response&lt;MobileCodeResponseEnvelope&gt; response) { MobileCodeResponseEnvelope mobileCodeResponseEnvelope = response.body(); if (mobileCodeResponseEnvelope != null) { Toast.makeText(MainActivity.this, \"è¯·æ±‚æˆåŠŸ\", Toast.LENGTH_SHORT).show(); String result = mobileCodeResponseEnvelope.getMobildCodeResponseBody() .getMobileCodeResponseInfo().getMobileCodeResult(); mTvMobileResult.setText(result); System.err.println(\"yidong -- result = \" + result); } } @Override public void onFailure(Call&lt;MobileCodeResponseEnvelope&gt; call, Throwable t) { System.err.println(\"yidong -- onFailure\"); Toast.makeText(MainActivity.this, \"è¯·æ±‚å¤±è´¥\", Toast.LENGTH_SHORT).show(); }}); 4.7 æ•ˆæœ 5. æºç åœ°å€RetrofitWebService","link":"/2018/01/27/ã€ŠAndroidå¼€æºåº“ã€‹ Retrofit & WebService/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ RelationShips and Writesï¼ˆè¯‘æ–‡ï¼‰","text":"å…³ç³»ä»»ä½•ä¸¤ä¸ªRealmObjectéƒ½å¯ä»¥é“¾æ¥åœ¨ä¸€èµ·ã€‚ 1234567891011public class Email extends RealmObject { private String address; private boolean active; // ... setters and getters left out}public class Contact extends RealmObject { private String name; private Email email; // ... setters and getters left out} å…³ç³»åœ¨Realmä¸­å¼€é”€ä¸å¤§ã€‚è¿™æ„å‘³ç€ä¿æŒè¿æ¥å¹¶ä¸ä¼šå½±å“é€Ÿåº¦ï¼Œå¹¶ä¸”å…³ç³»çš„å†…éƒ¨å®ç°åœ¨ä½¿ç”¨å†…å­˜ä¸Šä¹Ÿæ˜¯ç›¸å½“é«˜æ•ˆçš„ã€‚ å¤šå¯¹ä¸€åœ¨ç±»ä¸­ç®€å•çš„å®šä¹‰ä¸€ä¸ªç»§æ‰¿è‡ªRealmObjectçš„å­ç±»ä½œä¸ºæˆå‘˜å³å¯ï¼š 1234public class Contact extends RealmObject { private Email email; // Other fieldsâ€¦} æ¯ä¸ªè”ç³»äººï¼ˆContactçš„å®ä¾‹ï¼‰éƒ½æœ‰0æˆ–1ä¸ªç”µå­é‚®ä»¶ï¼ˆEmailå®ä¾‹ï¼‰ã€‚åœ¨Realmä¸­ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢ä½ åœ¨å¤šä¸ªè”ç³»äººä¸­ä½¿ç”¨ç›¸åŒçš„ç”µå­é‚®ä»¶å¯¹è±¡ï¼Œä¸Šè¿°æ¨¡å‹å¯ä»¥æ˜¯å¤šå¯¹ä¸€å…³ç³»ï¼Œä½†é€šå¸¸ç”¨äºå»ºæ¨¡ä¸€å¯¹ä¸€å…³ç³»ã€‚ è®¾ç½®RealmObjectå­—æ®µnullå°†æ¸…é™¤å¼•ç”¨ï¼Œä½†å¯¹è±¡ä¸ä¼šä»Realmä¸­åˆ é™¤ å¤šå¯¹å¤šä½ å¯ä»¥é€šè¿‡RealmList&lt;T&gt;å­—æ®µå£°æ˜ä»å•ä¸ªå¯¹è±¡ä¸ä»»æ„æ•°é‡çš„å¯¹è±¡å»ºç«‹å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰å¤šä¸ªç”µå­é‚®ä»¶åœ°å€çš„è”ç³»äºº 123456789public class Contact extends RealmObject { public String name; public RealmList&lt;Email&gt; emails;}public class Email extends RealmObject { public String address; public boolean active;} RealmListsåŸºæœ¬ä¸Šæ˜¯RealmObjectsçš„å®¹å™¨ï¼Œå¹¶ä¸”RealmListå’Œä¸€ä¸ªæ™®é€šçš„Java Listç”¨æ³•åŸºæœ¬ç›¸åŒã€‚Realmåœ¨ä¸åŒçš„RealmListsä¸­å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å¯¹è±¡ä¸¤æ¬¡ï¼ˆæˆ–æ›´å¤šï¼‰ï¼Œæ²¡æœ‰é™åˆ¶ï¼Œå› æ­¤ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å»ºæ¨¡ä¸€å¯¹å¤šå’Œå¤šå¯¹å¤šå…³ç³»ã€‚ ä½ å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨RealmList.add()å°†Emailå¯¹è±¡æ·»åŠ åˆ°Contactå¯¹è±¡ï¼š 1234567891011121314151617realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { Contact contact = realm.createObject(Contact.class); contact.name = \"John Doe\"; Email email1 = realm.createObject(Email.class); email1.address = \"john@example.com\"; email1.active = true; contact.emails.add(email1); Email email2 = realm.createObject(Email.class); email2.address = \"jd@example.com\"; email2.active = false; contact.emails.add(email2); }}); å¯ä»¥å£°æ˜é€’å½’å…³ç³»ï¼Œå½“å»ºæ¨¡æŸäº›ç±»å‹çš„æ•°æ®æ—¶ï¼Œè¿™äº›å…³ç³»å¯èƒ½å¾ˆæœ‰ç”¨ 12345public class Person extends RealmObject { public String name; public RealmList&lt;Person&gt; friends; // Other fieldsâ€¦} å°†RealmListå­—æ®µçš„å€¼è®¾ç½®nullå°†æ¸…é™¤åˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ—è¡¨å°†ä¸ºç©ºï¼ˆé•¿åº¦ä¸ºé›¶ï¼‰ï¼Œä½†æ²¡æœ‰å¯¹è±¡ä¼šè¢«åˆ é™¤ã€‚é€šè¿‡getteræ–¹æ³•è·å–RealmListå°†æ°¸è¿œä¸ä¼šè¿”å›nullã€‚è¿”å›çš„å¯¹è±¡æ€»æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä½†é•¿åº¦å¯èƒ½ä¸ºé›¶ã€‚ è¿æ¥æŸ¥è¯¢æŸ¥è¯¢è¿æ¥å’Œå…³ç³»æ—¶å¯ä»¥çš„ã€‚è€ƒè™‘å¦‚ä¸‹æ¨¡å‹ï¼š 12345678910111213public class Person extends RealmObject { private String id; private String name; private RealmList&lt;Dog&gt; dogs; // getters and setters}public class Dog extends RealmObject { private String id; private String name; private String color; // getters and setters} æ¯ä¸ªPersonå¯ä»¥å’Œç‹—å»ºç«‹ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæ­£å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š ä½¿ç”¨è¿æ¥æŸ¥è¯¢æ¥æ‰¾ä¸€äº›äºº 1234// persons =&gt; [U1,U2]RealmResults&lt;Person&gt; persons = realm.where(Person.class) .equalTo(\"dogs.color\", \"Brown\") .findAll(); é¦–å…ˆï¼Œè¯·æ³¨æ„ï¼Œæ¡ä»¶ä¸­çš„å­—æ®µåç§°â€equalToâ€åŒ…å«é€šè¿‡å…³ç³»çš„è·¯å¾„ï¼ˆä»¥å¥ç‚¹åˆ†éš”.ï¼‰ã€‚ ä¸Šè¿°æŸ¥è¯¢åº”è¯»å–ï¼ŒæŸ¥æ‰¾åˆ°æ‹¥æœ‰åä¸ºâ€å¸ƒæœ—â€çš„ç‹—çš„æ‰€æœ‰äººã€‚é‡è¦çš„æ˜¯è¦ç†è§£ï¼Œç»“æœå°†åŒ…å«ä¸æ»¡è¶³æ¡ä»¶çš„Dogå¯¹è±¡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯Personå¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚ 12persons.get(0).getDogs(); // =&gt; [A,B]persons.get(1).getDogs(); // =&gt; [B,C,D] è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæŸ¥è¯¢è¿›ä¸€æ­¥æ£€æŸ¥ã€‚ 123456789// r1 =&gt; [U1,U2]RealmResults&lt;Person&gt; r1 = realm.where(Person.class) .equalTo(\"dogs.name\", \"Fluffy\") .findAll();// r2 =&gt; [U1,U2]RealmResults&lt;Person&gt; r2 = r1.where() .equalTo(\"dogs.color\", \"Brown\") .findAll(); æ³¨æ„ç¬¬ä¸€ä¸ªæŸ¥è¯¢å¦‚ä½•è¿”å›è¿™ä¸¤ä¸ªPersonå¯¹è±¡ï¼Œå› ä¸ºæ¡ä»¶ä¸ä¸¤ä¸ªäººéƒ½åŒ¹é…ã€‚æ¯ä¸ªPersonæŸ¥è¯¢ç»“æœéƒ½åŒ…å«ä¸€ä¸ªDogå¯¹è±¡åˆ—è¡¨- å®ƒä»¬çš„æ‰€æœ‰Dogå¯¹è±¡ï¼ˆå³ä½¿æ˜¯é‚£äº›ä¸æ»¡è¶³åŸå§‹æŸ¥è¯¢æ¡ä»¶çš„å¯¹è±¡ï¼‰ã€‚è®°ä½ï¼Œæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾æœ‰ç‰¹å®šç§ç±»çš„Dogï¼ˆå§“åå’Œé¢œè‰²ï¼‰çš„äººï¼Œè€Œä¸æ˜¯å®é™…çš„ç‹—æœ¬èº«ã€‚å› æ­¤ï¼Œç¬¬äºŒä¸ªæŸ¥è¯¢å°†é’ˆå¯¹ç¬¬ä¸€ä¸ªPersonæŸ¥è¯¢resultï¼ˆr1ï¼‰å’Œæ¯ä¸ªPersonsç‹—è¿›è¡Œè¯„ä¼°ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢ä¹ŸåŒ¹é…ä¸¤ä¸ªäººï¼Œä½†è¿™æ¬¡æ˜¯å› ä¸ºç‹—çš„é¢œè‰²ã€‚ è®©æˆ‘ä»¬æ·±å…¥ä¸€ç‚¹ï¼Œä»¥å¸®åŠ©å·©å›ºè¿™ä¸ªæ¦‚å¿µã€‚è¯·æŸ¥çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼š 12345678910111213141516/ r1 =&gt; [U1,U2]RealmResults&lt;Person&gt; r1 = realm.where(Person.class) .equalTo(\"dogs.name\", \"Fluffy\") .equalTo(\"dogs.color\", \"Brown\") .findAll();// r2 =&gt; [U2]RealmResults&lt;Person&gt; r2 = realm.where(Person.class) .equalTo(\"dogs.name\", \"Fluffy\") .findAll() .where() .equalTo(\"dogs.color\", \"Brown\") .findAll(); .where() .equalTo(\"dogs.color\", \"Yellow\") .findAll(); ç¬¬ä¸€ä¸ªæŸ¥è¯¢åº”è¯¥è¯»å–ï¼ŒæŸ¥æ‰¾åˆ°æ‰€æœ‰æœ‰åä¸ºâ€Fluffyâ€ç‹—çš„ Personï¼Œä¹Ÿæ‰¾åˆ°é‚£äº›æœ‰åä¸ºâ€Brownâ€ç‹—çš„Personï¼Œç„¶åç»™æˆ‘ä¸¤ä¸ªçš„â€‹â€‹äº¤é›†ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢å…ˆè¯»å–å¹¶æŸ¥æ‰¾åˆ°æ‰€æœ‰åä¸ºâ€œFluffyâ€çš„ç‹—çš„Personã€‚ç„¶åï¼Œç»™å®šç»“æœé›†ï¼Œæ‰¾åˆ°æ‰€æœ‰æœ‰é¢œè‰²ä¸ºâ€œæ£•è‰²â€çš„ç‹—çš„Personï¼Œå¹¶ä¸”ç»™å®šç»“æœé›†ï¼Œæ‰¾åˆ°å…·æœ‰é¢œè‰²ä¸ºâ€œé»„è‰²â€çš„ç‹—çš„æ‰€æœ‰äººã€‚ è®©æˆ‘ä»¬æ¥çœ‹çœ‹èƒŒåçš„æŸ¥è¯¢ï¼Œr1ä»¥ä¾¿å……åˆ†äº†è§£å‘ç”Ÿäº†ä»€ä¹ˆã€‚ä¸¤ä¸ªæ¡ä»¶æ˜¯equalTo(â€œdogs.nameâ€, â€œFluffyâ€)å’ŒequalTo(â€œdogs.colorâ€, â€œBrownâ€)ã€‚ç¬¬ä¸€ä¸ªæ¡ä»¶æ»¡è¶³U1å’ŒU2- è¿™æ˜¯C1é›†åˆã€‚ç¬¬äºŒä¸ªæ¡ä»¶ä¹Ÿæ»¡è¶³U1å’ŒU2- è¿™æ˜¯C2é›†åˆã€‚æŸ¥è¯¢ä¸­çš„é€»è¾‘å’Œï¼Œå’ŒC1å’ŒC2çš„äº¤é›†æ˜¯ä¸€æ ·çš„ã€‚C1å’ŒC2çš„äº¤é›†ä¸ºU1 and U2ã€‚å› æ­¤ï¼Œr1æ˜¯U1 and U2ã€‚ åé¢çš„æŸ¥è¯¢r2å°±ä¸åŒäº†ã€‚è®©æˆ‘ä»¬å¼€å§‹åˆ†è§£è¿™æ¬¡æŸ¥è¯¢ä»¥æ¢ç©¶ç«Ÿã€‚æŸ¥è¯¢çš„ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼šRealmResults&lt;Person&gt; r2a = realm.where(Person.class).equalTo(â€œdogs.nameâ€, â€œFluffyâ€).findAll();ã€‚å®ƒåŒ¹é…U1å’ŒU2ã€‚ç„¶åï¼Œr2b = r2a.where().equalTo(â€œdogs.colorâ€, â€œBrownâ€).findAll();è¿˜æ˜¯åŒ¹é…U1å’ŒU2ï¼ˆä¸¤ä¸ªäººéƒ½æœ‰æ£•è‰²çš„ç‹—ï¼‰ã€‚æœ€åçš„æŸ¥è¯¢ï¼Œr2 = r2b.where().equalTo(â€œdogs.colorâ€, â€œYellowâ€).findAll();åªåŒ¹é…U2ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªäººåœ¨æ£•è‰²ç‹—ç»“æœé›†ä¸­æœ‰ä¸€ä¸ªé»„è‰²çš„ç‹—ï¼Œä¹Ÿå°±æ˜¯U2 å†™è¯»æ“ä½œæ˜¯éšå¼çš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥éšæ—¶è®¿é—®å’ŒæŸ¥è¯¢å¯¹è±¡ã€‚æ‰€æœ‰å†™æ“ä½œï¼ˆæ·»åŠ ï¼Œä¿®æ”¹å’Œåˆ é™¤å¯¹è±¡ï¼‰å¿…é¡»åŒ…å«åœ¨å†™äº‹åŠ¡ä¸­ã€‚å†™äº‹åŠ¡å¯ä»¥æäº¤æˆ–å–æ¶ˆã€‚åœ¨æäº¤æœŸé—´ï¼Œæ‰€æœ‰æ›´æ”¹éƒ½å°†å†™å…¥ç£ç›˜ï¼Œå¹¶ä¸”æäº¤åªæœ‰åœ¨æ‰€æœ‰æ›´æ”¹éƒ½å¯ä»¥ä¿ç•™æ—¶æ‰ä¼šæˆåŠŸã€‚é€šè¿‡å–æ¶ˆå†™å…¥äº‹åŠ¡ï¼Œæ‰€æœ‰æ›´æ”¹éƒ½å°†è¢«ä¸¢å¼ƒã€‚ä½¿ç”¨å†™äº‹åŠ¡ï¼Œä½ çš„æ•°æ®å°†å§‹ç»ˆå¤„äºä¸€è‡´çŠ¶æ€ã€‚ å†™äº‹åŠ¡ä¹Ÿç”¨äºç¡®ä¿çº¿ç¨‹å®‰å…¨ 12345678// Obtain a Realm instanceRealm realm = Realm.getDefaultInstance();realm.beginTransaction();//... add or update objects here ...realm.commitTransaction(); åœ¨å†™äº‹åŠ¡ä¸­ä½¿ç”¨åˆ°ä½ çš„RealmObjectsæ—¶ï¼Œä½ å¯èƒ½æœ€åæƒ³æ”¾å¼ƒä¿®æ”¹ã€‚ä¸å…¶æäº¤ä¹‹åå†å›é€€ï¼Œä½ å¯ä»¥ç®€å•åœ°å–æ¶ˆå†™äº‹åŠ¡ã€‚ 123456realm.beginTransaction();User user = realm.createObject(User.class);// ...realm.cancelTransaction(); è¯·æ³¨æ„ï¼Œå†™äº‹åŠ¡å¯èƒ½ä¼šç›¸äº’é˜»å¡ã€‚å¦‚æœä½ åœ¨UIçº¿ç¨‹å’Œåå°çº¿ç¨‹ä¸ŠåŒæ—¶åˆ›å»ºå†™å…¥äº‹åŠ¡ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ANRé”™è¯¯ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåœ¨UIçº¿ç¨‹ä¸Šåˆ›å»ºå†™äº‹åŠ¡æ—¶ä½¿ç”¨å¼‚æ­¥äº‹åŠ¡ã€‚ Realmæ˜¯å´©æºƒå®‰å…¨çš„ï¼Œæ‰€ä»¥åœ¨ä¸€æ¬¡äº‹åŠ¡ä¸­å‘ç”Ÿäº†Exceptionï¼ŒRealmæœ¬èº«ä¸ä¼šå´©æºƒã€‚åªæ˜¯å½“å‰äº‹åŠ¡ä¸­çš„æ•°æ®ä¼šä¸¢å¤±ã€‚å¦‚æœå¼‚å¸¸è¢«æ•è·ä½†åº”ç”¨ç¨‹åºä»åœ¨ç»§ç»­ï¼Œè¿™ä¸ªæ—¶å€™å–æ¶ˆæ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚å¦‚æœä½¿ç”¨executeTransaction()ï¼Œè¿™äº›å°†ä¼šè‡ªåŠ¨çš„æ‰§è¡Œã€‚ æ„Ÿè°¢Realmçš„MVCCæ¶æ„ï¼Œåœ¨å†™äº‹åŠ¡æ‰“å¼€çš„æ—¶å€™è¯»å–ä¸ä¼šè¢«é˜»å¡ï¼è¿™æ„å‘³ç€ï¼Œé™¤éä½ éœ€è¦ä»å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œäº‹åŠ¡ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ›´å¤§çš„äº‹åŠ¡ï¼Œè¿™äº›äº‹åŠ¡å¦‚æœä½¿ç”¨å°äº‹åŠ¡æ¥åšçš„è¯å°†ä¼šè€—è´¹æ›´å¤šçš„å·¥ä½œé‡ã€‚å½“ä½ å°†å†™äº‹åŠ¡æäº¤åˆ°Realmæ—¶ï¼Œè¯¥Realmçš„æ‰€æœ‰å…¶ä»–å®ä¾‹å°†è¢«é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚ Realmä¸­çš„è¯»å†™è®¿é—®æ˜¯ACID åˆ›å»ºå¯¹è±¡å› ä¸ºRealmObjectséƒ½å¾—ç»‘å®šåˆ°ä¸€ä¸ªé¢†åŸŸï¼Œä»–ä»¬åº”è¯¥é€šè¿‡Realmç›´æ¥å®ä¾‹åŒ– 12345realm.beginTransaction();User user = realm.createObject(User.class); // Create a new objectuser.setName(\"John\");user.setEmail(\"john@corporation.com\");realm.commitTransaction(); æˆ–è€…ï¼Œä½ å¯ä»¥é¦–å…ˆåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œç„¶åä½¿ç”¨realm.copyToRealmï¼ˆï¼‰æ·»åŠ å®ƒã€‚Realmæ”¯æŒå°½å¯èƒ½å¤šçš„è‡ªå®šä¹‰æ„é€ å‡½æ•°ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªæ˜¯å…¬å…±çš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚ 1234567User user = new User(\"John\");user.setEmail(\"john@corporation.com\");// Copy the object to Realm. Any further changes must happen on realmUserrealm.beginTransaction();User realmUser = realm.copyToRealm(user);realm.commitTransaction(); å½“ä½¿ç”¨æ—¶ï¼Œrealm.copyToRealm()é‡è¦çš„æ˜¯è¦è®°ä½åªæœ‰è¿”å›çš„å¯¹è±¡ç”±Realmç®¡ç†ï¼Œæ‰€ä»¥å¯¹åŸå§‹å¯¹è±¡çš„ä»»ä½•è¿›ä¸€æ­¥çš„æ›´æ”¹éƒ½ä¸ä¼šè¢«æŒä¹…åŒ– äº‹åŠ¡å—ä¸ç”¨æ‰‹åŠ¨ä¿æŒè·Ÿè¸ªrealm.beginTransaction()ï¼Œrealm.commitTransaction()ä»¥åŠrealm.cancelTransaction()å¯ä»¥ä½¿ç”¨realm.executeTransactionï¼ˆï¼‰æ–¹æ³•ï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†å¼€å§‹/æäº¤ï¼Œå‘ç”Ÿé”™è¯¯çš„æ—¶å€™å°†è‡ªåŠ¨å–æ¶ˆ 12345678realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { User user = realm.createObject(User.class); user.setName(\"John\"); user.setEmail(\"john@corporation.com\"); }}); å¼‚æ­¥äº‹åŠ¡å› ä¸ºäº‹åŠ¡è¢«å…¶ä»–äº‹åŠ¡é˜»å¡ï¼Œæ‰€ä»¥åœ¨åå°çº¿ç¨‹ä¸Šæ‰§è¡Œæ‰€æœ‰å†™æ“ä½œä»¥é¿å…é˜»å¡UIçº¿ç¨‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¸»æ„ã€‚é€šè¿‡ä½¿ç”¨å¼‚æ­¥äº‹åŠ¡ï¼ŒRealmå°†åœ¨åå°çº¿ç¨‹ä¸Šè¿è¡Œè¯¥äº‹åŠ¡å¹¶åœ¨äº‹åŠ¡å®Œæˆæ—¶æŠ¥å‘Šã€‚ 123456789101112131415161718realm.executeTransactionAsync(new Realm.Transaction() { @Override public void execute(Realm bgRealm) { User user = bgRealm.createObject(User.class); user.setName(\"John\"); user.setEmail(\"john@corporation.com\"); } }, new Realm.Transaction.OnSuccess() { @Override public void onSuccess() { // Transaction was a success. } }, new Realm.Transaction.OnError() { @Override public void onError(Throwable error) { // Transaction failed and was automatically canceled. } }); OnSuccesså’ŒOnErrorå›è°ƒéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯å¦‚æœæä¾›ï¼Œå®ƒä»¬å°†åœ¨äº‹åŠ¡æˆåŠŸå®Œæˆæˆ–å¤±è´¥æ—¶åˆ†åˆ«è¢«è°ƒç”¨ã€‚å›è°ƒç”±Looperæ§åˆ¶ï¼Œå› æ­¤å®ƒä»¬åªå…è®¸åœ¨Looperçº¿ç¨‹ä¸Šå›è°ƒã€‚ 12345678ealmAsyncTask transaction = realm.executeTransactionAsync(new Realm.Transaction() { @Override public void execute(Realm bgRealm) { User user = bgRealm.createObject(User.class); user.setName(\"John\"); user.setEmail(\"john@corporation.com\"); } }, null); å¼‚æ­¥äº‹åŠ¡ç”±RealmAsyncTaskå¯¹è±¡è¡¨ç¤ºã€‚å¦‚æœåœ¨äº‹åŠ¡å®Œæˆä¹‹å‰é€€å‡ºActivity / Fragmentï¼Œæ­¤å¯¹è±¡å¯ç”¨äºå–æ¶ˆä»»ä½•æŒ‚èµ·çš„äº‹åŠ¡ã€‚å¦‚æœå›è°ƒæ›´æ–°UIï¼Œå¿˜è®°å–æ¶ˆäº‹åŠ¡å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚ 12345ublic void onStop () { if (transaction != null &amp;&amp; !transaction.isCancelled()) { transaction.cancel(); }} æ›´æ–°å­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°Realmæ˜¯ä»¥å®Œæ•´çš„å­—æ®µä½œä¸ºæ“ä½œå¯¹è±¡çš„ï¼Œä¸å¯èƒ½æ›´æ–°å­—ç¬¦ä¸²æˆ–å­—èŠ‚æ•°ç»„çš„å•ä¸ªå…ƒç´ ã€‚å‡å¦‚ä½ éœ€è¦æ›´æ–°å­—ç¬¦ä¸²çš„ç¬¬5ä¸ªå…ƒç´ ï¼Œä½ å°†éœ€è¦åšç±»ä¼¼çš„äº‹æƒ…ï¼š 12345678realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { bytes[] bytes = realmObject.binary; bytes[4] = 'a'; realmObject.binary = bytes; }}); æ˜¯ç”±äºRealmçš„MVCCæ¶æ„ï¼Œå®ƒé¿å…äº†å¯¹ç°æœ‰æ•°æ®çš„æ”¹å˜ï¼Œä»¥ç¡®ä¿è¯»å–æ•°æ®çš„å…¶ä»–çº¿ç¨‹æˆ–è¿›ç¨‹ä¸‹è¡¨ç°ä¸€è‡´ã€‚ å¿«ç…§æ‰€æœ‰Realmé›†åˆéƒ½æ˜¯å®æ—¶çš„ã€‚è¿™æ„å‘³ç€å®ƒä»¬æ€»æ˜¯åæ˜ æœ€æ–°çš„çŠ¶æ€ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™æ˜¯å¯å–çš„ï¼Œä½†å¦‚æœä½ å¾ªç¯ä¸€ä¸ªé›†åˆï¼Œç›®çš„æ˜¯ä¿®æ”¹å…ƒç´ å‘¢ï¼Ÿä¾‹å¦‚ï¼š 123456RealmResults&lt;Person&gt; guests = realm.where(Person.class).equalTo(\"invited\", false).findAll();realm.beginTransaction();for (int i = 0; guests.size(); i++) { guests.get(i).setInvited(true);}realm.commitTransaction(); é€šå¸¸ä½ ä¼šæœŸæœ›è¿™ä¸ªç®€å•çš„å¾ªç¯é‚€è¯·æ‰€æœ‰å®¢äººã€‚å› ä¸ºRealmResultsæ˜¯ç«‹å³æ›´æ–°ï¼Œè™½ç„¶ï¼Œåªæœ‰ä¸€åŠçš„å®¢äººæœ€ç»ˆè¢«é‚€è¯·ï¼å—é‚€çš„é‚€è¯·å¯¹è±¡å°†ä»è¯¥é›†åˆä¸­ç«‹å³åˆ é™¤ï¼Œè¿™ä¼šç§»åŠ¨æ‰€æœ‰å…ƒç´ ã€‚å½“iå‚æ•°å¢åŠ æ—¶ï¼Œå®ƒå°†é”™è¿‡ä¸€ä¸ªå…ƒç´ ã€‚ ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥æ‹æ‘„é›†åˆæ•°æ®çš„å¿«ç…§ã€‚å¿«ç…§ä¿è¯å…ƒç´ çš„é¡ºåºä¸ä¼šæ”¹å˜ï¼Œå³ä½¿å…ƒç´ è¢«åˆ é™¤æˆ–ä¿®æ”¹ã€‚ Iteratorä»Realmé›†åˆåˆ›å»ºçš„æ–‡ä»¶å°†è‡ªåŠ¨ä½¿ç”¨å¿«ç…§ã€‚RealmResultså’ŒRealmListå¯ä»¥ä½¿ç”¨createSnapshot()æ‰‹åŠ¨åˆ›å»ºå¿«ç…§ã€‚ 12345678910111213141516RealmResults&lt;Person&gt; guests = realm.where(Person.class).equalTo(\"invited\", false).findAll();// Use an iterator to invite all guestsrealm.beginTransaction();for (Person guest : guests) { guest.setInvited(true);}realm.commitTransaction();// Use a snapshot to invite all guestsrealm.beginTransaction();OrderedRealmCollectionSnapshot&lt;Person&gt; guestsSnapshot = guests.createSnapshot();for (int i = 0; guestsSnapshot.size(); i++) { guestsSnapshot.get(i).setInvited(true);}realm.commitTransaction(); åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#relationships","link":"/2017/03/05/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ RelationShips and Writesï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Scheme & JSON & Notificationï¼ˆè¯‘æ–‡ï¼‰","text":"SchemeRealm ä½¿ç”¨æ‰€æœ‰é¡¹ç›®ä¸­çš„ Realm æ¨¡å‹ç±»æ¥åˆ›å»º schemaã€‚ä½†è¿™ä¸ªè¡Œä¸ºæ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ RealmModule è®© Realm åªåŒ…å«æ‰€æœ‰æ¨¡å‹ç±»çš„ä¸€ä¸ªå­é›†ã€‚ 123456789101112131415// Create the module@RealmModule(classes = { Person.class, Dog.class })public class MyModule {}// Set the module in the RealmConfiguration to allow only classes defined by the module.RealmConfiguration config = new RealmConfiguration.Builder() .modules(new MyModule()) .build();// It is possible to combine multiple modules to one schema.RealmConfiguration config = new RealmConfiguration.Builder() .modules(new MyModule(), new MyOtherModule()) .build(); å…±äº«schemas åº“ï¼ˆlibraryï¼‰å¼€å‘è€…è¯·æ³¨æ„ï¼š åœ¨åº“ä¸­ä½¿ç”¨åˆ°çš„ Realm å¿…é¡»é€šè¿‡ RealmModule æ¥æš´éœ²å’Œä½¿ç”¨å…¶ schemaã€‚ è¿™æ ·å¯ä»¥é˜²æ­¢åº“é¡¹ç›®è‡ªåŠ¨ç”Ÿæˆé»˜è®¤ RealmModule ä»è€Œé¿å…å’Œ app ç”Ÿæˆçš„é»˜è®¤ RealmModule å†²çªã€‚åº“é¡¹ç›®ä¹Ÿæ˜¯é€šè¿‡ RealmModule æ¥å‘ app é¡¹ç›®æš´éœ²è‡ªå·±çš„ Realm æ¨¡å‹ç±»ã€‚ 123456789101112131415161718// Library must create a module and set library = true. This will prevent the default// module from being created.// allClasses = true can be used instead of listing all classes in the library.@RealmModule(library = true, allClasses = true)public class MyLibraryModule {}// Library projects are therefore required to explicitly set their own module.RealmConfiguration libraryConfig = new RealmConfiguration.Builder() .name(\"library.realm\") .modules(new MyLibraryModule()) .build();// Apps can add the library RealmModule to their own schema.RealmConfiguration config = new RealmConfiguration.Builder() .name(\"app.realm\") .modules(Realm.getDefaultModule(), new MyLibraryModule()) .build(); ç›®å‰ä½ ä¸å¯ä»¥åœ¨ä¸€ä¸ª Realm æ–‡ä»¶é‡Œå£°æ˜å¤šä¸ª RealmModuleã€‚å¦‚æœä½ æœ‰å¤šä¸ª RealmModuleï¼Œä½ éœ€è¦å°†å®ƒä»¬å£°æ˜åœ¨å¤šä¸ª Realm æ–‡ä»¶ä¸­ä»¥ç¡®ä¿æ¯ä¸ªæ–‡ä»¶åªæœ‰ä¸€ä¸ª RealmModule å£°æ˜ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨åœ¨åº“å’Œ app é¡¹ç›®é—´ä½¿ç”¨ RealmModule çš„å®Œæ•´ä¾‹å­ã€‚ JSONä½ å¯ä»¥ç›´æ¥å°† JSON å¯¹è±¡æ·»åŠ åˆ° Realm ä¸­ï¼Œè¿™äº› JSON å¯¹è±¡å¯ä»¥æ˜¯ä¸€ä¸ª Stringã€ä¸€ä¸ª JSONObject æˆ–è€…æ˜¯ä¸€ä¸ª InputStreamã€‚Realm ä¼šå¿½ç•¥ JSON ä¸­å­˜åœ¨ä½†æœªå®šä¹‰åœ¨ Realm æ¨¡å‹ç±»é‡Œçš„å­—æ®µã€‚å•ç‹¬å¯¹è±¡å¯ä»¥é€šè¿‡ Realm.createObjectFromJson() æ·»åŠ ã€‚å¯¹è±¡åˆ—è¡¨å¯ä»¥é€šè¿‡ Realm.createAllFromJson() æ·»åŠ ã€‚ 123456789101112131415161718192021222324252627// A RealmObject that represents a citypublic class City extends RealmObject { private String city; private int id; // getters and setters left out ...}// Insert from a stringrealm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { realm.createObjectFromJson(City.class, \"{ city: \\\"Copenhagen\\\", id: 1 }\"); }});// Insert multiple items using an InputStreamrealm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { try { InputStream is = new FileInputStream(new File(\"path_to_file\")); realm.createAllFromJson(City.class, is); } catch (IOException e) { throw new RuntimeException(); } }}); Realm è§£æ JSON æ—¶éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š ä½¿ç”¨åŒ…å«ç©ºå€¼ï¼ˆnullï¼‰çš„ JSON åˆ›å»ºå¯¹è±¡ï¼š 1) å¯¹äºéå¿…é¡»ï¼ˆå¯ä¸ºç©ºå€¼çš„å±æ€§ï¼‰ï¼Œè®¾ç½®å…¶å€¼ä¸º nullï¼› 2) å¯¹äºå¿…é¡»ï¼ˆä¸å¯ä¸ºç©ºå€¼çš„å±æ€§ï¼‰ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼› ä½¿ç”¨åŒ…å«ç©ºå€¼ï¼ˆnullï¼‰çš„ JSON æ›´æ–°å¯¹è±¡ï¼š 1)å¯¹äºéå¿…é¡»ï¼ˆå¯ä¸ºç©ºå€¼çš„å±æ€§ï¼‰ï¼Œè®¾ç½®å…¶å€¼ä¸º nullï¼› 2) å¯¹äºå¿…é¡»ï¼ˆä¸å¯ä¸ºç©ºå€¼çš„å±æ€§ï¼‰ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼› ä½¿ç”¨ä¸åŒ…å«å¯¹åº”å±æ€§çš„ JSONï¼š 1)è¯¥å±æ€§ä¿æŒä¸å˜ é€šçŸ¥ï¼ˆNotificationsï¼‰ Listener åªå·¥ä½œäº Looper çº¿ç¨‹ã€‚å¯¹äºé Looper çº¿ç¨‹è¯·ä½¿ç”¨ Realm.waitForChange()ã€‚ Realm Notificationå½“åå°çº¿ç¨‹å‘ Realm æ·»åŠ æ•°æ®ï¼Œä½ çš„ UI çº¿ç¨‹æˆ–è€…å…¶å®ƒçº¿ç¨‹å¯ä»¥æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨æ¥è·å–æ•°æ®æ”¹å˜çš„é€šçŸ¥ã€‚ç›‘å¬å™¨åœ¨ Realm æ•°æ®æ”¹å˜çš„æ—¶å€™ä¼šè¢«è§¦å‘ã€‚ 12345678910111213141516171819202122232425public class MyActivity extends Activity { private Realm realm; private RealmChangeListener realmListener; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); realm = Realm.getDefaultInstance(); realmListener = new RealmChangeListener() { @Override public void onChange(Realm realm) { // ... do something with the updates (UI, etc.) ... }}; realm.addChangeListener(realmListener); } @Override protected void onDestroy() { super.onDestroy(); // Remove the listener. realm.removeChangeListener(realmListener); // Close the Realm instance. realm.close(); }} é™¤äº†åœ¨ Realm å®ä¾‹ä¸Šæ·»åŠ ç›‘å¬å™¨ä»¥å¤–ï¼Œä½ è¿˜å¯ä»¥åœ¨ RealmObject å’Œ RealmResults å®ä¾‹ä¸Šæ·»åŠ ç›‘å¬å™¨ã€‚ä½ å¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼æ¥ç›‘è§†å¯¹è±¡å’ŒæŸ¥è¯¢ç»“æœçš„æ”¹å˜ã€‚å¦å¤–ï¼Œå½“ç›‘å¬å›è°ƒå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç›¸åº”çš„æ•°æ®å·²ç»è¢«æ›´æ–°ï¼Œä½ ä¸éœ€è¦å»åšåˆ·æ–°æ“ä½œã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142public class MyActivity extends Activity { private Realm realm; private RealmChangeListener puppiesListener; private RealmChangeListener dogListener; private RealmResults&lt;Dog&gt; puppies; private Dog dog; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); realm = Realm.getDefaultInstance(); puppiesListener = new RealmChangeListener() { @Override public void onChange(RealmResults&lt;Dog&gt; puppies) { // ... do something with the updated puppies instance }}; // Find all the puppies puppies = realm.where(Dog.class).lessThanOrEqualTo(\"age\", 2).findAll(); puppies.addChangeListener(puppiesListener); dogListener = new RealmChangeListener() { @Override public void onChange(Dog dog) { // ... do something with the updated Dog instance }}; dog = realm.where(Dog.class).equalTo(\"name\", \"Fido\").findFirst(); dog.addChangeListener(dogListener); } @Override protected void onDestroy() { super.onDestroy(); // Remove the listeners puppies.removeChangeListener(puppiesListener); dog.removeChangeListener(dogListener); // Close the Realm instance. realm.close(); }} ä½ å¯ä»¥è½»æ¾ç§»é™¤æ‰€æœ‰ç›‘å¬å™¨ã€‚ 1realm.removeAllChangeListeners(); æœ€åï¼Œè¿™äº›ç›‘å¬å™¨åŒæ ·ä¼šåœ¨ç›‘å¬å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡æ”¹å˜æ—¶è¢«è§¦å‘ï¼Œè¯·è§ç¤ºä¾‹ 123456789101112131415Person person = realm.where(Person.class).findFirst();person.getDogs(); // =&gt; 2 - Assume there are 2 dogs in the listperson.addChangeListener(new RealmChangeListener() { @Override public void onChange(Person person) { // React to the change in the Person instance. // This will also get called when any referenced dogs are updated. } });Dog dog = person.getDogs().get(0);realm.beginTransaction();dog.setAge(5);realm.commitTransaction();// Person change listener is called on the next iteration of the run loop because// a referenced dog object changed. Collection Notificationsé›†åˆé€šçŸ¥ä¸Realmé€šçŸ¥ä¸åŒï¼Œå› ä¸ºå®ƒä»¬åŒ…å«æè¿°åœ¨ç»†ç²’åº¦çº§åˆ«å‘ç”Ÿçš„æ›´æ”¹çš„ä¿¡æ¯ã€‚ è¿™åŒ…æ‹¬è‡ªä¸Šæ¬¡é€šçŸ¥ä»¥æ¥å·²æ’å…¥ï¼Œåˆ é™¤æˆ–ä¿®æ”¹çš„å¯¹è±¡çš„ç´¢å¼•ã€‚é›†åˆé€šçŸ¥æ˜¯å¼‚æ­¥ä¼ é€’çš„ï¼Œé¦–å…ˆæ˜¯åˆå§‹ç»“æœï¼Œç„¶åæ˜¯åœ¨ä¿®æ”¹é›†åˆä¸­çš„ä»»ä½•ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯¹è±¡çš„å†™å…¥äº‹åŠ¡ä¹‹åï¼Œè¿™ä¸ªç»“æœéƒ½ä¼šè¢«é‡æ–°åˆå§‹åŒ–ã€‚è¿™äº›æ›´æ”¹å¯ä»¥é€šè¿‡ä¼ é€’ç»™æ›´æ”¹ä¾¦å¬å™¨çš„OrderedCollectionChangeSetå‚æ•°è®¿é—®ã€‚ æ­¤å¯¹è±¡ä¿å­˜æœ‰å…³ç”±åˆ é™¤ï¼Œæ’å…¥å’Œæ›´æ”¹å½±å“çš„ç´¢å¼•çš„ä¿¡æ¯ã€‚åˆ é™¤å’Œæ’å…¥ï¼Œå½“å¯¹è±¡å¼€å§‹å’Œåœæ­¢æ˜¯é›†åˆçš„ä¸€éƒ¨åˆ†æ—¶è®°å½•ç´¢å¼•ã€‚ è¿™ä¼šè€ƒè™‘åˆ°ä½•æ—¶å°†å¯¹è±¡æ·»åŠ åˆ°é¢†åŸŸæˆ–ä»é¢†åŸŸä¸­åˆ é™¤å®ƒä»¬ã€‚ å¯¹äºRealmResultsï¼Œå½“ä½ ç­›é€‰ç‰¹å®šå€¼å¹¶ä¸”å¯¹è±¡å·²æ›´æ”¹ï¼Œä»¥ä½¿å…¶ç°åœ¨åŒ¹é…æŸ¥è¯¢æˆ–ä¸å†åŒ¹é…æ—¶ï¼Œè¿™ä¹Ÿé€‚ç”¨ã€‚å½“å¯¹è±¡çš„å­—æ®µå‘ç”Ÿæ›´æ”¹æ—¶ï¼Œç³»ç»Ÿä¼šé€šçŸ¥ä½ æœ‰å…³æ›´æ”¹çš„ä¿¡æ¯ï¼Œè¯¥å­—æ®µä»¥å‰æ˜¯é›†åˆçš„ä¸€éƒ¨åˆ†ï¼Œä½†ä»å±äºé›†åˆçš„ä¸€éƒ¨åˆ†ã€‚ å½“ä¸€å¯¹ä¸€å’Œå¤šå¯¹å¤šå…³ç³»æ”¹å˜æ—¶ï¼Œè¿™ç§æƒ…å†µä¹Ÿä¼šå‘ç”Ÿã€‚ 123456789public class Dog extends RealmObject { public String name; public int age;}public class Person exteds RealmObject { public String name; public RealmList&lt;Dog&gt; dogs;} è®©æˆ‘ä»¬å‡è®¾ä½ éµå®ˆä¸Šé¢çš„æ¨¡å‹ä»£ç ç»™å‡ºçš„ç‹—ä¸»äººåˆ—è¡¨ã€‚ ä½ å°†æ”¶åˆ°å…³äºåŒ¹é…çš„Personå¯¹è±¡çš„ä¿®æ”¹çš„é€šçŸ¥ï¼Œä¾‹å¦‚ï¼š ä¿®æ”¹Personçš„åå­— ä»ä¸€ä¸ªPersonæ‹¥æœ‰çš„ç‹—çš„åˆ—è¡¨ä¸­å¢åŠ æˆ–è€…åˆ é™¤ä¸€ä¸ª ä¿®æ”¹å±äºè¿™ä¸ªäººçš„ä¸€æ¡ç‹—çš„å¹´é¾„ è¿™ä½¿å¾—å¯ä»¥ç¦»æ•£åœ°æ§åˆ¶å¯¹UIä¸­çš„å†…å®¹è¿›è¡Œçš„åŠ¨ç”»å’Œè§†è§‰æ›´æ–°ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡å‘ç”Ÿé€šçŸ¥æ—¶ä»»æ„é‡æ–°åŠ è½½æ‰€æœ‰å†…å®¹ã€‚ 1234567891011121314151617181920212223242526private final OrderedRealmCollectionChangeListener&lt;RealmResults&lt;Person&gt;&gt; changeListener = new OrderedRealmCollectionChangeListener() { @Override public void onChange(RealmResults&lt;Person&gt; collection, OrderedCollectionChangeSet changeSet) { // `null` means the async query returns the first time. if (changeSet == null) { notifyDataSetChanged(); return; } // For deletions, the adapter has to be notified in reverse order. OrderedCollectionChangeSet.Range[] deletions = changeSet.getDeletionRanges(); for (int i = deletions.length - 1; i &gt;= 0; i--) { OrderedCollectionChangeSet.Range range = deletions[i]; notifyItemRangeRemoved(range.startIndex, range.length); } OrderedCollectionChangeSet.Range[] insertions = changeSet.getInsertionRanges(); for (OrderedCollectionChangeSet.Range range : insertions) { notifyItemRangeInserted(range.startIndex, range.length); } OrderedCollectionChangeSet.Range[] modifications = changeSet.getChangeRanges(); for (OrderedCollectionChangeSet.Range range : modifications) { notifyItemRangeChanged(range.startIndex, range.length); } }}; RealmRecyclerViewAdapter ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ. åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#schemas","link":"/2017/03/15/ã€ŠAndroidå¼€æºåº“ã€‹ Realm For Android~ Scheme & JSON & Notificationï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠKotlinã€‹ Android Studio3.0 æ–°ç‰¹æ€§ ï½ New Features in Android Studio Preview (è¯‘æ–‡)","text":"åŸæ–‡åœ°å€ï¼šhttps://developer.android.google.cn/studio/preview/features/index.html æœ€æ–°Android Studioç‰ˆæœ¬æ˜¯Android Studio 3.0ï¼Œæœ¬æ–‡æä¾›äº†æ‰€æœ‰æ–°åŠŸèƒ½å’Œæ›´æ”¹çš„æ‘˜è¦ã€‚ æ‰€æœ‰è¿™äº›åŠŸèƒ½éƒ½å¯ä»¥åœ¨æœ€æ–°çš„é‡‘ä¸é›€ç‰ˆæœ¬ä¸­å‘å¸ƒï¼Œä½†betaæµ‹è¯•ç‰ˆæœ¬å¯èƒ½å°šæœªæä¾›ã€‚ æ ¸å¿ƒIDEæ›´æ”¹ æˆ‘ä»¬å°†åŸºç¡€IDEä»IntelliJ 2016.2å‡çº§åˆ°2017.1.2ï¼Œåœ¨2016.3å’Œ2017.1ä¸­å¢åŠ äº†è®¸å¤šæ–°åŠŸèƒ½ï¼ŒåŒ…æ‹¬å‚æ•°æç¤ºï¼Œè¯­ä¹‰çªå‡ºæ˜¾ç¤ºï¼Œæœç´¢ä¸­çš„å³æ—¶ç»“æœç­‰ç­‰ã€‚ è®¸å¤šæ–°çš„Lint æ£€æŸ¥ã€‚ å³æ—¶è¿è¡Œè°ƒè¯•é—®é¢˜234401å·²ç»è§£å†³ã€‚ å¦‚æœç¨‹åºåœ¨æ–­ç‚¹ä¸Šæš‚åœï¼Œåº”ç”¨ç¨‹åºå°†ä¼šé‡æ–°å¯åŠ¨ã€‚ ä½†æ˜¯å¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰åœ¨æ–­ç‚¹ä¸Šæš‚åœï¼Œé‚£ä¹ˆå½“åªè¿›è¡Œæ–¹æ³•å®ç°æ›´æ”¹æ—¶ï¼Œç¨‹åºä¸ä¼šé‡æ–°å¯åŠ¨å¹¶ä¸”çƒ­æ’æ‹”ä¼šæ­£å¸¸å·¥ä½œã€‚ Kotlinè¯­è¨€æ”¯æŒAndroid Studio3.0æ”¯æŒKotlinè¯­è¨€ã€‚ä½ å¯ä»¥é€šè¿‡å°†Javaä»£ç è½¬æ¢æˆKotlin(ç‚¹å‡»â€Codeâ€ &gt; â€œConvert Java File to Kotlin Fileâ€)çš„æ–¹å¼æˆ–è€…ç›´æ¥ä½¿ç”¨æ–°å»ºé¡¹ç›®å‘å¯¼åˆ›å»ºå¯åŠ¨Kotlinçš„é¡¹ç›®æ¥åœ¨ä½ çš„å·¥ç¨‹ä¸­ä½¿ç”¨Kotlinã€‚äº†è§£æ›´å¤šå…³äºKotlin in Android JAVA8ç‰¹æ€§æ”¯æŒAndroid Studio 3.0å¼•å…¥äº†å¯¹Java 8åº“å’ŒæŸäº›Java 8è¯­è¨€åŠŸèƒ½çš„å†…ç½®æ”¯æŒã€‚ æˆ‘ä»¬ä¸å†éœ€è¦Jackï¼Œä½ åº”è¯¥ç¦ç”¨Jackæ¥ä½¿ç”¨å†…ç½®æ”¹è¿›åJava 8æ”¯æŒçš„é»˜è®¤å·¥å…·é“¾ã€‚ è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»ä½¿ç”¨Java 8è¯­è¨€åŠŸèƒ½ã€‚ å…¨æ–°çš„Android ProfileAndroid Studio 3.0ä¸­çš„æ–°çš„Android Profileræä¾›äº†ä¸€ä¸ªå®æ—¶ç»Ÿä¸€çš„åº”ç”¨ç¨‹åºæ´»åŠ¨è§†å›¾ã€‚ Android Profilerçª—å£å°†æ›¿æ¢Androidç›‘è§†å™¨çª—å£ã€‚ è¦æ‰“å¼€Android Profilerï¼Œè¯·æŒ‰ç…§ä¸‹åˆ—æ­¥éª¤æ“ä½œï¼š å•å‡»â€View&gt;Tool Windows&gt; Android Profilerâ€œï¼ˆä½ ä¹Ÿå¯ä»¥åœ¨å·¥å…·æ ä¸­å•å‡»â€Android Profilerâ€œï¼‰ã€‚ ä»Android Profilerå·¥å…·æ ä¸­é€‰æ‹©è¦é…ç½®çš„è®¾å¤‡å’Œåº”ç”¨ç¨‹åºè¿›ç¨‹ã€‚ å¦‚æœä½ å·²é€šè¿‡USBè¿æ¥è®¾å¤‡ä½†æœªçœ‹åˆ°å®ƒï¼Œè¯·ç¡®ä¿å·²å¯ç”¨USBè°ƒè¯•ã€‚ å•å‡»â€NETWORKâ€œï¼Œâ€CPUâ€œæˆ–â€MEMORYâ€œæ—¶é—´çº¿ä»¥æ‰“å¼€æ¯ä¸ªåˆ†æå™¨çš„æ›´è¯¦ç»†è§†å›¾ã€‚ æœ‰å…³æ¯ä¸ªæ–°çš„å‰–æå™¨çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»¥ä¸‹é¡µé¢ï¼š ç½‘ç»œåˆ†æå™¨ CPUåˆ†æå™¨ å†…å­˜åˆ†æå™¨ ä½œä¸ºæ­¤æ›´æ–°çš„ä¸€éƒ¨åˆ†ï¼Œlogcatå·²ç§»è‡³å•ç‹¬çš„çª—å£ã€‚ Instant Appsæ”¯æŒAndroid Studio3.0æä¾›ä¸¤ç§æ–°çš„Moduleç±»å‹ï¼šInstant App Moduleå’ŒFeature Moduleç»™å¼€å‘è€…ç”¨æ¥åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­åˆ›å»ºInstant AppsAndroid Studio 3.0è¿˜åŒ…æ‹¬ä¸€ä¸ªæ–°çš„é‡æ„æ¨¡å—åŒ–æ“ä½œå’ŒApp Links Assistantï¼Œä»¥å¸®åŠ©æ‚¨å®æ–½å³æ—¶åº”ç”¨ã€‚ æœ‰å…³Instant Appsçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…Android Instant Appsã€‚ APKè°ƒè¯•å™¨Android Studio 3.0ä¸­çš„æ–°ç‰ˆAPKè°ƒè¯•å™¨å¯è®©ä½ é…ç½®å’Œè°ƒè¯•APKï¼Œè€Œæ— éœ€å°†å…¶ä»Android Studioé¡¹ç›®ä¸­æ„å»ºï¼Œåªè¦å®ƒä»¬æ˜¯å¯è°ƒè¯•çš„ã€‚ æœ‰å…³ä½¿ç”¨APKè°ƒè¯•å™¨çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»Profile and Debug Pre-built APKs æ–°çš„è®¾å¤‡æ–‡ä»¶ç®¡ç†å™¨æ–°çš„è®¾å¤‡æ–‡ä»¶èµ„æºç®¡ç†å™¨å·¥å…·çª—å£å…è®¸æ‚¨ä¸è¿æ¥çš„è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿæ— ç¼äº¤äº’ã€‚ ä½ å¯ä»¥ç‚¹å‡»æŸ¥çœ‹Android Studioä¸­çš„å„ç§æ–‡ä»¶ï¼Œå¹¶å°†æ–‡ä»¶å¤åˆ¶åˆ°æ‚¨çš„è®¡ç®—æœºã€‚æ­¤åŠŸèƒ½å–ä»£äº†ä»¥å‰é€šè¿‡DDMSå®Œæˆçš„è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚ æ”¯æŒAndroid O Developer PreviewAndroid Studio 3.0å¢åŠ äº†å¦‚ä¸‹å¯¹ Android Oçš„æ”¯æŒï¼š ä¸€ä¸ªæ–°çš„è‡ªé€‚åº”å›¾æ ‡å‘å¯¼ï¼Œå…è®¸ä½ åˆ›å»ºæ–°çš„è‡ªé€‚åº”å¯åŠ¨å™¨å›¾æ ‡èµ„æºï¼Œå¹¶é¢„è§ˆå®ƒä»¬å°†å¦‚ä½•æ˜¾ç¤ºåœ¨ä¸åŒçš„è®¾å¤‡ä¸Šã€‚ è¦å¯åŠ¨è‡ªé€‚åº”å›¾æ ‡å‘å¯¼ï¼Œè¯·å³é”®å•å‡»é¡¹ç›®ä¸­çš„/ resæ–‡ä»¶å¤¹ï¼Œç„¶åå•å‡»â€œNew &gt; Image Asset &gt; Launcher Icons (Adaptive and Legacy)â€œã€‚ æœ‰å…³Android Oä¸­çš„è‡ªé€‚åº”å¯åŠ¨å™¨å›¾æ ‡çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…è‡ªé€‚åº”å›¾æ ‡ã€‚ æ–°çš„XMLå­—ä½“é¢„è§ˆï¼Œå­—ä½“é€‰æ‹©å·¥å…·ä»¥åŠå¯¹å¯ä¸‹è½½å­—ä½“çš„æ”¯æŒã€‚ æœ‰å…³Android Oä¸­çš„XMLå­—ä½“å’Œå¯ä¸‹è½½å­—ä½“çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä½¿ç”¨å­—ä½“ã€‚ ä¸ºAndroid Thingsæä¾›çš„æ–°æ¨¡ç‰ˆAndroid Studio 3.0åœ¨æ–°é¡¹ç›®å’Œæ–°æ¨¡å—å‘å¯¼ä¸­åŒ…å«ä¸€ç»„æ–°çš„æ¨¡æ¿ï¼Œå› æ­¤ä½ å¯ä»¥å¼€å§‹ä½¿ç”¨Android Thingså¼€å‘ç‰©è”ç½‘è®¾å¤‡ã€‚ æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…Android Thingsã€‚ å¸ƒå±€ç¼–è¾‘å™¨æ”¹è¿›Android Studio 3.0ä¸­çš„å¸ƒå±€ç¼–è¾‘å™¨åŒ…å«è®¸å¤šæ–°çš„åŠŸèƒ½å¢å¼ºï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š æ›´æ–°çš„ç»„ä»¶æ ‘ï¼Œå…·æœ‰æ”¹è¿›çš„æ‹–æ”¾è§†å›¾æ’å…¥ æ–°é”™è¯¯é¢æ¿ æŸ¥çœ‹éšœç¢å’Œç»„çš„æ–°æ”¯æŒ å¢å¼ºé“¾åˆ›é€  å¸ƒå±€æ£€æŸ¥å™¨çš„æ”¹è¿›Android Studio 3.0ä¸­çš„å¸ƒå±€æ£€æŸ¥å™¨å¢åŠ æ–°çš„æ”¹è¿›åŠŸèƒ½ï¼Œå¯ä»¥è®©ä½ æ›´è½»æ¾åœ°è°ƒè¯•åº”ç”¨ç¨‹åºå¸ƒå±€çš„é—®é¢˜ï¼ŒåŒ…æ‹¬å°†å±æ€§åˆ†ç±»ä¸ºå¸¸è§ç±»åˆ«ï¼Œå¹¶åœ¨â€œæŸ¥çœ‹æ ‘â€å’Œâ€œå±æ€§â€é¢æ¿ä¸­å°†æ–°çš„æœç´¢åŠŸèƒ½åˆ†ç»„ã€‚ è¦æ‰“å¼€å¸ƒå±€æ£€æŸ¥å™¨ï¼Œè¯·å•å‡»â€œTools&gt; Android&gt;Layout Inspectorâ€ã€‚ Googleâ€™s Mavenåº“Androidæ”¯æŒåº“Mavenä¾èµ–å…³ç³»ç°åœ¨å¯ä»¥åœ¨æ–°çš„Mavenå­˜å‚¨åº“ä¸­çš„Android SDK Managerå¤–éƒ¨ä½¿ç”¨ã€‚ ç»“åˆå‘½ä»¤è¡Œsdkmanagerå·¥å…·å’ŒGradleï¼Œè¿™ç§æ–°çš„åˆ†å‘æ–¹æ³•ç®€åŒ–äº†ä½¿ç”¨æŒç»­é›†æˆç³»ç»Ÿçš„Mavenä¾èµ–å…³ç³»ç®¡ç†ã€‚ è¦ä½¿ç”¨æ–°çš„Mavenå­˜å‚¨åº“ï¼Œè¯·å°†URLæ·»åŠ åˆ°build.gradleæ–‡ä»¶çš„repositoryåº“ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345repositories { maven { url \"https://maven.google.com\" }} æƒ³äº†è§£æ›´å¤šï¼Œè¯·ç§»æ­¥Google Maven and offline repositories APK Analyzer æ”¹è¿›Android Studio3.0é’ˆå¯¹APK AnalyzeråŒ…å«å¦‚ä¸‹æ”¹è¿›ï¼š æ˜¾ç¤ºä»¥å‰å¯ç”¨çš„é™¤äº†åŒ…ï¼Œç±»å’Œæ–¹æ³•ä¹‹å¤–çš„å­—æ®µ é¡¶éƒ¨æ˜¾ç¤ºå’Œéšè—å­—æ®µå’Œæ–¹æ³•çš„æ–°è¿‡æ»¤é€‰é¡¹ åœ¨æ ‘è§†å›¾ä¸­ï¼Œä»¥æ–œä½“æ˜¾ç¤ºçš„èŠ‚ç‚¹æ˜¯æœªåœ¨DEXæ–‡ä»¶ä¸­å®šä¹‰çš„å¼•ç”¨ å¯¹äºå¯ç”¨Proguardæ„å»ºçš„APKï¼Œæ‚¨å¯ä»¥åŠ è½½å‘DEXæŸ¥çœ‹å™¨æ·»åŠ åŠŸèƒ½çš„Proguardæ˜ å°„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š ç²—ä½“èŠ‚ç‚¹æŒ‡ç¤ºåœ¨ç¼©å°ä»£ç æ—¶ä¸åº”åˆ é™¤èŠ‚ç‚¹ å¯ç”¨ä¸€ä¸ªæŒ‰é’®ï¼Œä½¿å¾—åœ¨æ”¶ç¼©ï¼ˆshrinkingï¼‰è¿‡ç¨‹ä¸­è¢«åˆ é™¤çš„èŠ‚ç‚¹å¯è§ å¯ç”¨ä¸€ä¸ªæŒ‰é’®ï¼Œæ¢å¤æ ‘è§†å›¾ä¸­ç”±Proguardæ··æ·†åçš„èŠ‚ç‚¹çš„åŸå§‹åç§° æ–°ç‰ˆAndroid Gradle æ’ä»¶Android plugin 3.0.0-alpha1 and higheræ—¨åœ¨è§£å†³æ‹¥æœ‰å¤§é‡æ¨¡å—é¡¹ç›®çš„Androidå·¥ç¨‹çš„æ„å»ºæ€§èƒ½çš„é—®é¢˜ã€‚å½“ä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ–°çš„æ’ä»¶çš„æ—¶å€™ï¼Œä½ å°†æ„Ÿå—åˆ°å¦‚ä¸‹æ”¹è¿›ï¼š æ¨è¿Ÿä¾èµ–ä»¥è¾¾åˆ°æ›´å¿«çš„é…ç½® å˜é‡æ„ŸçŸ¥ï¼ˆVariant-awareï¼‰ä¾èµ–ä»…é€‚ç”¨äºä½ æ­£åœ¨æ„å»ºçš„é¡¹ç›®å’Œå˜é‡ å¯¹ä»£ç æˆ–èµ„æºè¿›è¡Œç®€å•çš„æ›´æ”¹åï¼Œå¢é‡æ„å»ºæ—¶é—´å°†ä¼šæ¯”ä¹‹å‰çš„ç‰ˆæœ¬å¿«ä¸ºäº†å®ç°è¿™äº›æ”¹è¿›ï¼Œæˆ‘ä»¬åœ¨æ’ä»¶è¡Œä¸ºï¼ŒDSLå’ŒAPIä¸Šæœ‰ä¸€äº›çªç ´æ€§çš„å˜åŒ–ã€‚è¿™ä¼šå½±å“æ„å»ºæ–‡ä»¶å’ŒGradleæ’ä»¶ã€‚æœ‰å…³å¦‚ä½•è¿ç§»è‡ªå·±çš„é¡¹ç›®ä»¥ä½¿ç”¨æ­¤æ’ä»¶çš„è¯´æ˜ï¼Œè¯·çœ‹è¿ç§»åˆ°æ–°çš„æ’ä»¶ æ–°çš„Android æ¨¡æ‹Ÿå™¨ç‰¹æ€§æ–°çš„Androidæ¨¡æ‹Ÿå™¨åŒ…å«å¤§é‡çš„æ–°ç‰¹æ€§ï¼Œå…·ä½“å¦‚ä¸‹ï¼š æ–°çš„API Level 24ç³»ç»Ÿæ˜ åƒå’ŒAndroid O Betaç³»ç»Ÿæ˜ åƒï¼ŒåŒ…æ‹¬Google Playå•†åº—ï¼Œä»¥ä¿ƒè¿›ä½ çš„åº”ç”¨ç¨‹åºçš„ç«¯åˆ°ç«¯æµ‹è¯•ï¼Œå¹¶å¸®åŠ©ä½ ä¿æŒGoogle PlayæœåŠ¡ä¸AVDsçš„åŒæ­¥ã€‚ æ”¯æŒWindowså’ŒLinuxæœºå™¨ä¸Šçš„OpenGL ES 3.0ç³»ç»Ÿå›¾åƒAPIçº§åˆ«24åŠæ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶åœ¨è¾ƒè€çš„æ¨¡æ‹Ÿå™¨ç³»ç»Ÿæ˜ åƒä¸Šå¯¹OpenGL ES 2.0å›¾å½¢æ€§èƒ½è¿›è¡Œæ˜¾ç€æ”¹è¿›ã€‚ æ³¨æ„ï¼šæˆ‘ä»¬ç›®å‰æ­£åœ¨å°½åŠ›è‡ªåŠ¨å¯ç”¨æ¥è‡ªè‹±ç‰¹å°”ï¼ŒNVIDIAå’ŒAMDçš„æ‰€æœ‰ç°ä»£GPUçš„OpenGL ES 3.0,å¦‚æœè¿è¡ŒOpenGL ES 3.xåº”ç”¨ç¨‹åºæ—¶é‡åˆ°é—®é¢˜ï¼Œç³»ç»Ÿå¯èƒ½å°šæœªè‡ªåŠ¨å¯ç”¨.ä½ å¯ä»¥é€šè¿‡å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°ã€œ/ .android / advancedFeatures.iniæ–‡ä»¶ä¸­æ¥æ‰‹åŠ¨å¯ç”¨OpenGL ES 3.0GLESDynamicVersion = true ä¸€ç§æ–°çš„æ›´ç®€å•çš„æ–¹æ³•æ¥ä»Androidæ¨¡æ‹Ÿå™¨ç”Ÿæˆåº”ç”¨çš„é”™è¯¯æŠ¥å‘Šã€‚ ä¸€ä¸ªæ–°çš„é“¾æ¥ï¼Œå¯ä»¥åœ¨Androidé—®é¢˜è·Ÿè¸ªå™¨ï¼ˆå•å‡»â€œEmulator Tool Bar &gt; Extended Controls &gt; Help &gt; Emulator Help &gt; File a Bugâ€ï¼‰ä¸Šä¸ºAndroidå›¢é˜Ÿå¿«é€Ÿæäº¤ä¸æ¨¡æ‹Ÿå™¨ç›¸å…³çš„é”™è¯¯ã€‚ ç”¨äºé…ç½®Androidæ¨¡æ‹Ÿå™¨ä½¿ç”¨çš„ä»£ç†è®¾ç½®çš„æ–°UIã€‚è¦é…ç½®Androidæ¨¡æ‹Ÿå™¨çš„ä»£ç†è®¾ç½®ï¼Œè¯·å•å‡» â€œExtended Controls &gt; Settings &gt; Proxyâ€. åœ¨æ¨¡æ‹Ÿå™¨ä¸Šæ”¯æŒAndroid Wearè®¾å¤‡çš„rotary inputçš„æ–°æ”¯æŒæœ‰å…³Androidæ¨¡æ‹Ÿå™¨æ›´æ–°çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…Androidæ¨¡æ‹Ÿå™¨å‘è¡Œè¯´æ˜ã€‚","link":"/2017/05/21/ã€ŠKotlinã€‹ Android Studio3.0 æ–°ç‰¹æ€§ ï½ New Features in Android Studio Preview (è¯‘æ–‡)/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹Realm For Android~ Getting Help and Modelsï¼ˆè¯‘æ–‡ï¼‰","text":"è·å¾—å¸®åŠ©ä½ ç¼–ç¨‹æ—¶éœ€è¦å¸®åŠ©ï¼Ÿï¼šåœ¨ StackOverflow ä¸Šæé—®ã€‚æˆ‘ä»¬åœ¨å®æ—¶ç›‘æ§å¹¶ä¸”å›ç­” SO ä¸Šçš„ç›¸å…³é—®é¢˜ï¼è¦æŠ¥å‘Šä¸€ä¸ª bugï¼Ÿï¼šåœ¨æˆ‘ä»¬çš„ GitHub ä»“åº“é‡Œæ–°å»ºä¸€ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”å°½å¯èƒ½åœ°æŒ‰é—®é¢˜æ¨¡æ¿å°† bug æè¿°æ¸…æ¥šã€‚éœ€è¦ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Ÿï¼šåœ¨æˆ‘ä»¬çš„ GitHub ä»“åº“é‡Œæ–°å»ºä¸€ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”å°½å¯èƒ½åœ°æŒ‰é—®é¢˜æ¨¡æ¿å°†è¯¥åŠŸèƒ½æè¿°æ¸…æ¥šã€‚æƒ³çŸ¥é“æ¥ä¸‹æ¥å°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼šçœ‹çœ‹æˆ‘ä»¬çš„ changelogã€‚è¿™é‡Œæœ‰æˆ‘ä»¬å³å°†å‘å¸ƒçš„æ”¹åŠ¨ä»¥åŠä¿®æ”¹å†å²ã€‚ æ¨¡å‹Realm æ•°æ®æ¨¡å‹å®šä¹‰éœ€è¦ç»§æ‰¿è‡ª RealmObject ç±»ã€‚ 1234567891011121314151617public class User extends RealmObject { private String name; private int age; @Ignore private int sessionId; // Standard getters &amp; setters generated by your IDEâ€¦ public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public int getSessionId() { return sessionId; } public void setSessionId(int sessionId) { this.sessionId = sessionId; }} Realm æ•°æ®æ¨¡å‹ä¸ä»…ä»…æ”¯æŒ private æˆå‘˜å˜é‡ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ publicã€protected ä»¥åŠè‡ªå®šä¹‰çš„æˆå‘˜æ–¹æ³•ã€‚ 12345678910111213public class User extends RealmObject { public String name; public boolean hasLongName() { return name.length() &gt; 7; } @Override public boolean equals(Object o) { // Custom equals comparison }} å­—æ®µç±»å‹Realm æ”¯æŒä»¥ä¸‹å­—æ®µç±»å‹ï¼šbooleanã€byteã€shortã€intã€longã€floatã€doubleã€Stringã€Dateå’Œbyte []ã€‚æ•´æ•°ç±»å‹ shortã€int å’Œ long éƒ½è¢«æ˜ å°„åˆ° Realm å†…çš„ç›¸åŒç±»å‹ï¼ˆå®é™…ä¸Šä¸º long ï¼‰ã€‚å†è€…ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ RealmObject çš„å­ç±»å’Œ RealmList&lt;? extends RealmObject&gt; æ¥è¡¨ç¤ºæ¨¡å‹å…³ç³»ã€‚ Realm å¯¹è±¡ä¸­è¿˜å¯ä»¥å£°æ˜åŒ…è£…ç±»å‹ï¼ˆboxed typeï¼‰å±æ€§ï¼ŒåŒ…æ‹¬ï¼šBooleanã€Byteã€Shortã€Integerã€Longã€Floatå’ŒDoubleã€‚é€šè¿‡ä½¿ç”¨åŒ…è£…ç±»å‹ï¼Œå¯ä»¥ä½¿è¿™äº›å±æ€§å­˜å–ç©ºå€¼ï¼ˆnull)ã€‚ @Requiredä¿®é¥°ç±»å‹å’Œç©ºå€¼ï¼ˆnullï¼‰æŸäº›æ—¶å€™ï¼Œç©ºå€¼ï¼ˆnullï¼‰å¯¹äºå±æ€§å¹¶ä¸åˆé€‚ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨æ³¨è§£ @Required å‘Šè¯‰ Realm å¼ºåˆ¶ç¦æ­¢ç©ºå€¼ï¼ˆnullï¼‰è¢«å­˜å‚¨ã€‚åªæœ‰ Booleanã€ Byteã€ Shortã€ Integerã€ Longã€ Floatã€ Doubleã€ Stringã€ byte[] ä»¥åŠ Date å¯ä»¥è¢« @Required ä¿®é¥°ã€‚åœ¨å…¶å®ƒç±»å‹å±æ€§ä¸Šä½¿ç”¨ @Required ä¿®é¥°ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆprimitive typesï¼‰ä¸éœ€è¦ä½¿ç”¨æ³¨è§£ @Requiredï¼Œå› ä¸ºä»–ä»¬æœ¬èº«å°±ä¸å¯ä¸ºç©ºã€‚RealmObject å±æ€§æ°¸è¿œå¯ä»¥ä¸ºç©ºã€‚ å¿½ç•¥çš„å±æ€§æ³¨è§£ @Ignore æ„å‘³ç€ä¸€ä¸ªå­—æ®µä¸åº”è¯¥è¢«ä¿å­˜åˆ° Realmã€‚æŸäº›æ—¶å€™è¾“å…¥çš„ä¿¡æ¯åŒ…å«æ¯”æ¨¡å‹æ›´å¤šçš„å­—æ®µï¼Œè€Œä½ ä¸å¸Œæœ›å¤„ç†è¿™äº›æœªä½¿ç”¨çš„æ•°æ®å­—æ®µï¼Œä½ å¯ä»¥ç”¨ @Ignore æ¥æ ‡è¯†è¿™äº›ä½ å¸Œæœ›è¢« Realm å¿½ç•¥çš„å­—æ®µ Auto-Updating ObjectsRealmObject æ˜¯å®æ—¶çš„ã€è‡ªåŠ¨æ›´æ–°çš„åº•å±‚æ•°æ®çš„æ˜ å°„è§†å›¾ã€‚ä½ ä¸éœ€è¦å»é‡æ–°è·å¾—å¯¹è±¡å·²å–å¾—å…¶æœ€æ–°ç‰ˆæœ¬ã€‚å¯¹äºæ•°æ®çš„æ”¹åŠ¨ä¼šå³æ—¶ååº”åˆ°ç›¸å…³çš„å¯¹è±¡æˆ–è€…æŸ¥è¯¢ç»“æœã€‚ 1234567891011121314151617181920final Dog myDog;realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { myDog = realm.createObject(Dog.class); myDog.setName(\"Fido\"); myDog.setAge(1); }});realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { Dog myPuppy = realm.where(Dog.class).equalTo(\"age\", 1).findFirst(); myPuppy.setAge(2); }});myDog.getAge(); // =&gt; 2 RealmObject å’Œ RealmResults çš„è®¾è®¡ä¸ä»…ä»…æ˜¯ä¸ºäº†æ›´å¿«å’Œæ›´æœ‰æ•ˆç‡ï¼Œå®ƒä»¬åŒæ—¶ä¹Ÿè®©ä»£ç æ›´åŠ ç®€æ´ä»¥åŠååº”æ€§æ›´å¼ºã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾ä½ çš„ Activity æˆ–è€… Fragment ä¾èµ–äºæŸä¸ª RealmObject æˆ–è€… RealmResultsï¼Œä½ æ— éœ€æ‹…å¿ƒä½•æ—¶å»åˆ·æ–°æˆ–è€…é‡æ–°è·å–å®ƒä»¬ä»¥æ›´æ–° UIâ€”â€”å®ƒä»¬ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ ä½ å¯ä»¥é€šè¿‡è®¢é˜… Realm notifications æ¥å¾—çŸ¥ Realm çš„æ•°æ®åœ¨ä½•æ—¶è¢«æ›´æ–°ä»è€Œåˆ·æ–°ä½ çš„ UIã€‚ ç´¢å¼•ï¼ˆIndexï¼‰å±æ€§æ³¨è§£ @Index ä¼šä¸ºå­—æ®µå¢åŠ æœç´¢ç´¢å¼•ã€‚è¿™ä¼šå¯¼è‡´æ’å…¥é€Ÿåº¦å˜æ…¢ï¼ŒåŒæ—¶æ•°æ®æ–‡ä»¶ä½“ç§¯æœ‰æ‰€å¢åŠ ï¼Œä½†èƒ½åŠ é€ŸæŸ¥è¯¢ã€‚å› æ­¤å»ºè®®ä»…åœ¨éœ€è¦åŠ é€ŸæŸ¥è¯¢æ—¶æ‰æ·»åŠ ç´¢å¼•ã€‚ç›®å‰ä»…æ”¯æŒç´¢å¼•çš„å±æ€§ç±»å‹åŒ…æ‹¬ï¼šStringã€byteã€shortã€intã€longã€booleanå’ŒDateã€‚ ä¸»é”® (primary keys)@PrimaryKey å¯ä»¥ç”¨æ¥å®šä¹‰å­—æ®µä¸ºä¸»é”®ï¼Œè¯¥å­—æ®µç±»å‹å¿…é¡»ä¸ºå­—ç¬¦ä¸²ï¼ˆStringï¼‰æˆ–æ•´æ•°ï¼ˆshortã€int æˆ– longï¼‰ä»¥åŠå®ƒä»¬çš„åŒ…è£…ç±»å‹ï¼ˆShortã€Int æˆ– Longï¼‰ã€‚ä¸å¯ä»¥å­˜åœ¨å¤šä¸ªä¸»é”®ã€‚ä½¿ç”¨æ”¯æŒç´¢å¼•çš„å±æ€§ç±»å‹ä½œä¸ºä¸»é”®åŒæ—¶æ„å‘³ç€ä¸ºè¯¥å­—æ®µå»ºç«‹ç´¢å¼•ã€‚ å½“åˆ›å»º Realm å¯¹è±¡æ—¶ï¼Œæ‰€æœ‰å­—æ®µä¼šè¢«è®¾ç½®ä¸ºé»˜è®¤å€¼ã€‚ä¸ºäº†é¿å…ä¸å…·æœ‰ç›¸åŒä¸»é”®çš„å¦ä¸€ä¸ªå¯¹è±¡å†²çªï¼Œå»ºè®®åˆ›å»ºä¸€ä¸ª unmanaged å¯¹è±¡ï¼Œä¸ºå­—æ®µçš„èµ‹å€¼ï¼Œç„¶åç”¨ copyToRealm() æ–¹æ³•å°†è¯¥å¯¹è±¡å¤åˆ¶åˆ° Realmã€‚ ä¸»é”®çš„å­˜åœ¨æ„å‘³ç€å¯ä»¥ä½¿ç”¨ copyToRealmOrUpdate() æ–¹æ³•ï¼Œå®ƒä¼šç”¨æ­¤ä¸»é”®å°è¯•å¯»æ‰¾ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡å­˜åœ¨ï¼Œå°±æ›´æ–°è¯¥å¯¹è±¡ï¼›åä¹‹ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å½“ copyToRealmOrUpdate() çš„è°ƒç”¨å¯¹è±¡æ²¡æœ‰ä¸»é”®æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ ä½¿ç”¨ä¸»é”®ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“ã€‚åˆ›å»ºå’Œæ›´æ–°å¯¹è±¡å°†ä¼šæ…¢ä¸€ç‚¹ï¼Œè€ŒæŸ¥è¯¢åˆ™ä¼šå˜å¿«ã€‚å¾ˆéš¾é‡åŒ–è¿™äº›æ€§èƒ½çš„å·®å¼‚ï¼Œå› ä¸ºæ€§èƒ½çš„æ”¹å˜è·Ÿä½ æ•°æ®åº“çš„å¤§å°æ¯æ¯ç›¸å…³ã€‚ Realm.createObject()ä¼šè¿”å›ä¸€ä¸ªæ‰€æœ‰å­—æ®µè¢«è®¾ç½®ä¸ºé»˜è®¤å€¼çš„æ–°å¯¹è±¡ã€‚å¦‚æœè¯¥æ¨¡å‹ç±»å­˜åœ¨ä¸»é”®ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½è¿”å›å¯¹è±¡çš„ä¸»é”®çš„é»˜è®¤å€¼ä¸å…¶å®ƒå·²å­˜åœ¨çš„å¯¹è±¡å†²çªã€‚å»ºè®®åˆ›å»ºä¸€ä¸ªéæ‰˜ç®¡ï¼ˆunmanagedï¼‰Realm å¯¹è±¡ï¼Œå¹¶ç»™å…¶ä¸»é”®èµ‹å€¼ï¼Œç„¶åè°ƒç”¨ copyToRealm() æ¥é¿å…å†²çªã€‚ 123456789101112131415final MyObject obj = new MyObject();obj.setId(42);obj.setName(\"Fish\");realm.executeTransaction(new Realm.Transaction() { @Override public void execute(Realm realm) { // This will create a new object in Realm or throw an exception if the // object already exists (same primary key) // realm.copyToRealm(obj); // This will update an existing object with the same primary key // or create a new object if an object with no primary key = 42 realm.copyToRealmOrUpdate(obj); }}); å­—ç¬¦ä¸²ï¼ˆStringï¼‰å’ŒåŒ…è£…ç±»å‹ï¼ˆShortã€Int æˆ– Longï¼‰çš„ä¸»é”®å¯ä»¥è¢«èµ‹äºˆç©ºå€¼ï¼ˆnullï¼‰ï¼›é™¤éå®ƒä»¬åŒæ—¶è¢« @Required ä¿®é¥°ã€‚ å®šåˆ¶å¯¹è±¡ï¼ˆCustomizing Objectsï¼‰ä½ å‡ ä¹å¯ä»¥æŠŠ RealmObject å½“ä½œ POJO ä½¿ç”¨ã€‚åªéœ€æ‰©å±• RealmObjectï¼Œå°†ç›¸åº”å±æ€§å£°æ˜ä¸º publicã€‚ä¸éœ€è¦ setter å’Œ getterï¼Œ è€Œæ˜¯ç›´æ¥è®¿é—®å±æ€§ã€‚ 1234public class Dog extends RealmObject { public String name; public int age;} ä½ å¯ä»¥åƒä½¿ç”¨å…¶ä»–ç±»ä¸€æ ·ç›´æ¥ä½¿ç”¨ Dog ç±»ã€‚createObject() å’Œ copyToRealm() å¯ä»¥å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªæ‰˜ç®¡ç»™ Realm çš„ Dog å¯¹è±¡ã€‚ 12345678realm.executeTransaction(new Realm.Transaction() { @Overrride public void execute(Realm realm) { Dog dog = realm.createObject(Dog.class); dog.name = \"Fido\"; dog.age = 5; }}; å¦‚æœéœ€è¦çš„è¯ï¼Œä½ å¯ä»¥åœ¨ setter å’Œ getter ä¸­æ·»åŠ ä½ è‡ªå·±çš„é€»è¾‘ã€‚ä¾‹å¦‚ä½ å¯èƒ½éœ€è¦åœ¨ä¿å­˜ä¹‹å‰éªŒè¯å€¼çš„åˆæ³•æ€§ã€‚å¦å¤–ï¼Œä½ è¿˜å¯ä»¥ä¸ºä½ çš„ RealmObject æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•ã€‚ é™åˆ¶ç›®å‰ä¸æ”¯æŒ finalã€transient å’Œ volatile ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº† Realm å¯¹è±¡åœ¨éæ‰˜ç®¡ï¼ˆunmanaged RealmObjectï¼‰æ—¶å€™çš„è¡Œä¸ºå·®å¼‚åŒ–ã€‚ Realm æ•°æ®æ¨¡å‹ä¸å¯ä»¥ç»§æ‰¿è‡ªé™¤äº† RealmObject ä»¥å¤–çš„å…¶å®ƒå¯¹è±¡ã€‚ä½ å¯ä»¥é€‰æ‹©ä¸å£°æ˜é»˜è®¤æ— å‚æ•°æ„é€ å™¨ï¼Œä½†æ˜¯å¦‚æœä½ å£°æ˜äº†ï¼Œé‚£ä¹ˆè¯¥æ„é€ å™¨å¿…é¡»ä¸ºç©ºæ„é€ å™¨ã€‚è¿™æ˜¯ç›®å‰ Realm çš„ä¸€ä¸ªé™åˆ¶ã€‚ä½†ä½ å¯ä»¥è‡ªç”±æ·»åŠ ä»»æ„å…¶å®ƒçš„æ„é€ å™¨ã€‚ RealmModel æ¥å£é™¤ç›´æ¥ç»§æ‰¿äº RealmObject æ¥å£°æ˜ Realm æ•°æ®æ¨¡å‹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡å®ç° RealmModel æ¥å£å¹¶æ·»åŠ  @RealmClass ä¿®é¥°ç¬¦æ¥å£°æ˜ã€‚ 12345@RealmClasspublic class User implements RealmModel {} RealmObject çš„æ‰€æœ‰æ–¹æ³•éƒ½æœ‰å…¶ç›¸å¯¹åº”çš„é™æ€æ–¹æ³•ã€‚ 12345678// With RealmObjectuser.isValid();user.addChangeListener(listener);// With RealmModelRealmObject.isValid(user);RealmObject.addChangeListener(user, listener); åŸæ–‡é“¾æ¥https://realm.io/docs/java/latest/#getting-helphttps://realm.io/docs/java/latest/#models","link":"/2017/03/04/ã€ŠAndroidå¼€æºåº“ã€‹Realm For Android~ Getting Help and Modelsï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€Šå¾®ä¿¡å°ç¨‹åºã€‹ å¼€æºé¡¹ç›®","text":"ç®€ä»‹ç§»åŠ¨å¼€å‘è€…æƒ³å­¦ä¹ å¾®ä¿¡å°ç¨‹åºéœ€è¦å­¦ä¹ ä¸€ç‚¹HTML ,CSSå’ŒJSæ‰èƒ½å¤Ÿæ¯”è¾ƒå¿«é€Ÿçš„ä¸Šæ‰‹ï¼Œå‚è€ƒè‡ªå·±å­¦ä¹ Androidå­¦ä¹ è¿‡ç¨‹ï¼Œé˜…è¯»æºç æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼ï¼Œæ‰€ä»¥æ‰æ”¶é›†äº†ä¸€äº›WeAppçš„å¼€æºé¡¹ç›®ã€‚awesome-github-wechat-weapp æ˜¯ç”±OpenDiggæ•´ç†å¹¶ç»´æŠ¤çš„å¾®ä¿¡å°ç¨‹åºå¼€æºé¡¹ç›®åº“é›†åˆã€‚æˆ‘ä»¬ä¼šå®šæœŸåŒæ­¥OpenDiggä¸Šçš„é¡¹ç›®åˆ°è¿™é‡Œï¼Œä¹Ÿæ¬¢è¿å„ä½æäº¤é¡¹ç›®ç»™æˆ‘ä»¬ã€‚ å†…å®¹ UIç»„ä»¶ å¼€å‘æ¡†æ¶ å®ç”¨åº“ å¼€å‘å·¥å…· æœåŠ¡ç«¯ å…¶ä»– Demo ###UIç»„ä»¶ weui-wxss â˜…804 - å¾®ä¿¡åŸç”Ÿè§†è§‰ä½“éªŒä¸€è‡´çš„åŸºç¡€æ ·å¼åº“ Wa-UI â˜…116 - é’ˆå¯¹ä¿¡å°ç¨‹åºæ•´åˆçš„ä¸€å¥—UIåº“ wx-charts â˜…87 - å¾®ä¿¡å°ç¨‹åºå›¾è¡¨å·¥å…· wemark â˜…78 - å¾®ä¿¡å°åºMarkdownæ¸²æŸ“åº“ WeZRender â˜…25 -å¾®ä¿¡å°ç¨‹åºCanvaså¢å¼ºç»„ä»¶ wxapp-charts â˜…20 - å¾®ä¿¡å°ç¨‹åºå›¾è¡¨chartsç»„ä»¶ wetoast â˜…18 - ä»¿å¾®ä¿¡å°ç¨‹åºæä¾›çš„showToaståŠŸèƒ½ WeiXinProject â˜…17 - åˆ—è¡¨çš„ä¸Šæ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½ citySelect â˜…13 - å¾®ä¿¡å°ç¨‹åºåŸå¸‚é€‰æ‹©å™¨ ###å¼€å‘æ¡†æ¶ Labrador â˜…348 -å¾®ä¿¡å°ç¨‹åºæ¨¡å—åŒ–å¼€å‘æ¡†æ¶ wepy â˜…317 - å°ç¨‹åºç»„ä»¶å¼€å‘æ¡†æ¶ wxapp-devFrame â˜…27 - å°ç¨‹åºåŸºæœ¬çš„å¼€å‘æ¡†æ¶ ###å®ç”¨åº“ wxParse â˜…376 - å¾®å°ç¨‹åºå¯Œæ–‡æœ¬è§£æè‡ªå®šä¹‰ç»„ä»¶ wechat-weapp-redux â˜…85 - å¾®ä¿¡å°ç¨‹åºReduxç»‘å®š wilddog-weapp â˜…43 - é‡ç‹—å¾®ä¿¡å°ç¨‹åºå®¢æˆ·SDK wafer-client-sdk â˜…35 - å¾®ä¿¡å°ç¨‹åºå®¢æˆ·ç«¯è…¾è®¯äº‘å¢å¼º SDK WxNotificationCenter â˜…28 - å¾®ä¿¡å°ç¨‹åºé€šçŸ¥å¹¿æ’­æ¨¡å¼ç±» ###å¼€å‘å·¥å…· weapp-ide-crack â˜…4446 - å¾®ä¿¡å°ç¨‹åºIDEåŠç ´è§£æ”»ç•¥ wept â˜…779 - å®æ—¶å¾®ä¿¡ç¨‹åºå¼€å‘å·¥å…· weapp-quick â˜…289 - â€œå¾®ä¿¡Webå¼€å‘è€…â€æ‹·è´å·¥å…· Wxapp.vim â˜…101- å¾®ä¿¡å°ç¨‹åºå¼€å‘ Vim æ’ä»¶ Matchmaker â˜…79- ä¸“ä¸ºå¾®ä¿¡å°ç¨‹åºå¼€å‘çš„æ’ä»¶ wechat_web_devtools â˜…58 - å¾®ä¿¡å¼€å‘è€…å·¥å…·Linuxç‰ˆ ###æœåŠ¡ç«¯ NAMI â˜…28 - ä¸“ä¸ºå°åºè€Œç”Ÿçš„æœåŠ¡ç«¯å¼€å‘å®¹å™¨ weapp-php-server-sdk â˜…22 - è…¾è®¯äº‘å¾®ä¿¡å°ç¨‹åºäº‘ç«¯è§£å†³æ¡ˆ Wafer æœåŠ¡ç«¯ SDK - Java â˜…22 - ä¼ä¸šçº§å¾®ä¿¡å°ç¨‹åºå…¨æ ˆæ–¹æ¡ˆ m-mall-admin â˜…21 - åˆ›å»ºREST APIçš„æ ·æ¿åº”ç”¨ weapp-node-server-demo â˜…17 - Wafer æœåŠ¡ç«¯ Demo ##å…¶ä»– wxapp-redux-starter â˜…49 - æä¾›æ–¹ä¾¿å¿«æ·çš„å¾®ä¿¡å°ç¨‹åºå¼€å‘ç¯å¢ƒ ###Demo weapp-demo â˜…689 -ä»¿è±†ç“£ç”µå½±å¾®ä¿¡å°ç¨‹åº wechat-weapp-gank â˜…532 - Gankå¾®ä¿¡å°ç¨‹åº SmallAppForQQ â˜…447 - å¾®ä¿¡å°ç¨‹åºé«˜ä»¿QQåº”ç”¨ wechat-weapp-mall â˜…412 - å¾®ä¿¡å°ç¨‹åºç§»åŠ¨ç«¯å•†åŸ weapp-wechat-zhihu â˜…280 - å¾®ä¿¡ä¸­çš„çŸ¥ä¹ wecqupt â˜…234 - åœ¨å¾®ä¿¡å†…è¢«ä¾¿æ·åœ°è·å–å’Œä¼ æ’­ wechat-v2ex â˜…164 - ç®€å•çš„v2exå¾®ä¿¡å°ç¨‹åº weChatApp-Run â˜…146 - è·‘æ­¥å¾®ä¿¡å°ç¨‹åºDemo wechat-weapp-taobao â˜…140 - å¾®ä¿¡å°ç¨‹åºdemo ä»¿æ‰‹æœºå® weapp-weipiao â˜…133 - å¾®ä¿¡å°ç¨‹åº-å¾®ç¥¨ wechat-app-zhihudaily â˜…132 - å¾®ä¿¡å°ç¨‹åº-çŸ¥ä¹æ—¥æŠ¥ fenda-mock â˜…123 - ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºå®ç°åˆ†ç­”è¿™æ¬¾APPçš„åŸºç¡€åŠŸèƒ½ weapp-boilerplate â˜…105 - ä¸€ä¸ªä¸ºå¾®ä¿¡å°ç¨‹åºå¼€å‘å‡†å¤‡çš„åŸºç¡€éª¨æ¶ è…¾è®¯äº‘å¾®ä¿¡å°ç¨‹åº â˜…103 - ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆå®¢æˆ·ç«¯ç¤ºä¾‹ wechat-app-music â˜…85 - å¾®ä¿¡å°ç¨‹åºï¼š éŸ³ä¹æ’­æ”¾å™¨ wechat-weapp-mapdemo â˜…72 - å¾®ä¿¡å°ç¨‹åºå¼€å‘demo-åœ°å›¾å®šä½ weapp-demo-session â˜…58 - å¾®ä¿¡å°ç¨‹åºç¤ºä¾‹ä¸€ç¬”åˆ°åº• m-mall â˜…57 - å®ç°ä¸€ç§»åŠ¨ç«¯å°å•†åŸ weapp-douban-film â˜…56 - å¾®ä¿¡å°ç¨‹åº - è±†ç“£ç”µå½± wechat-weapp-redux-todos â˜…55 - å¾®ä¿¡å°ç¨‹åºé›†æˆReduxå®çš„Todo list wxapp-socket-io â˜…55 - å¾®ä¿¡å°ç¨‹åºçš„SocketIOå®¢æˆ·ç«¯ wechat-weapp-movie â˜…54 - å¾®ä¿¡å°ç¨‹åº - ç”µå½±æ¨è Artand â˜…53 - å¾®ä¿¡å°ç¨‹åº wepy-wechat-demo â˜…51 - wepyä»¿å¾®ä¿¡èŠå¤©ç•Œé¢ wechat_mall_applet â˜…50 - å·´çˆ·å¾®ä¿¡å•†åŸçš„ç®€å•ç‰ˆæœ¬ wechat-chat â˜…44 - å¾®ä¿¡å°ç¨‹åºç‰ˆèŠå¤©å®¤ [BearDiary â˜…41](https://github.com/harveyqing/BearDiary - å¾®ä¿¡å°ç¨‹åºä¹‹å°ç†Šã®æ—¥è®° wechat-weapp-demo â˜…41 - ä¸€ä¸ªç®€å•çš„å¾®ä¿¡å°ç¨‹åºè´­è½¦DEMO [wxapp-sCalc â˜…40](https://github.com/dunizb/wxapp-sCalc - å¾®ä¿¡å°ç¨‹åºç‰ˆç®€æ˜“è®¡ç®—å™¨ï¼Œé€‚åˆå…¥é—¨ç»ƒæ‰‹ weapp-one â˜…39 -ä»¿ ã€ŒONE Â· ä¸€ä¸ªã€ çš„å¾®ä¿¡å°ç¨‹åº wxflex â˜…37 - å¾®ä¿¡å°åºçš„Flexå¸ƒå±€demo wxapp-hiapp â˜…33 - HiApp å¾®ä¿¡å°ç¨‹åºç‰ˆ weapp-github â˜…33 - å¾®ä¿¡å°ç¨‹åºçš„ç®€å•å°è¯• weapp-newsapp â˜…33 - å¾®ä¿¡å°ç¨‹åº-å…¬ä¼—å·çƒ­é—¨æ–‡ç« ä¿¡æ¯æµ weapp-girls â˜…31 - é€šè¿‡Node.jså®ç°çš„å¦¹å­ç…§ç‰‡çˆ¬è™«å¾®ä¿¡å°ç¨‹åº ä»¿èŠ’æœTV â˜…31 - å¾®ä¿¡å°ç¨‹åºdemo ç•ªèŒ„æ—¶é’Ÿ â˜…31 - ç•ªèŒ„æ—¶å¾®ä¿¡å°ç¨‹åºç‰ˆ weapp-V2ex â˜…30- V2ex å¾®ä¿¡å°ç¨‹åºç‰ˆ wechat-app-flexlayout â˜…28 - ä»FlexLayoutå¸ƒå±€å¼€å§‹å­¦ä¹ å¾®ä¿¡å°ç¨‹åº wechatapp-news-reader â˜…25 - æ–°é—»é˜…è¯»å™¨ wechat-app-xiaoyima â˜…24 - ä»¿å¤§å§¨å¦ˆçš„å¾®ä¿¡å°ç¨‹åº yiyaowang-wx â˜…21 - åŒ»è¯ç½‘åŸç”ŸAPPçš„å¾®ä¿¡å°ç¨‹åºDEMO weapp â˜…19 - å°ç¨‹åºhello world å°é²œ weapp-demo-breadtrip â˜…19 - åŸºäºé¢åŒ…æ—…è¡Œ API åˆ¶ä½œçš„å¾®ä¿¡å°ç¨‹åºç¤ºä¾‹ WeChatMeiZhi â˜…17 - å¾®ä¿¡å°ç¨‹åºç‰ˆå¦¹çº¸å›¾ weapp-node-server-demo â˜…17 - Wafer æœåŠ¡ç«¯ Demo wxreading â˜…17 -å¾®ä¿¡å°ç¨‹åºè·Ÿè¯» WXBaiSi â˜…16 -å¾®ä¿¡å°ç¨‹åºä»¿ç™¾æ€ä¸å¾—å§ weapp-500px â˜…16 - å¾®ä¿¡å°ç¨‹åº hotapp-notepad â˜…15 - å¾®ä¿¡å°ç¨‹åºHotAppäº‘ç¬”è®° wxapp-2048 â˜…15 -å¾®ä¿¡å°ç¨‹åº2048 netmusic-app â˜…14 - ä»¿ç½‘æ˜“äº‘éŸ³ä¹APPçš„å¾®ä¿¡å°ç¨‹åº WxMasonry â˜…13 -å¾®ä¿¡å°ç¨‹åºç€‘å¸ƒæµå¸ƒå±€æ¨¡å¼ GankCamp-WechatAPP â˜…13 - å¾®ä¿¡å°ç¨‹åºç‰ˆå¹²è´§é›†ä¸­è¥ PigRaising â˜…13- ä¸“æ³¨ç®¡ç†æ—¶é—´çš„å¾®ä¿¡å°ç¨‹åº WexinApp_1024 â˜…12 - ç®€å•çš„å®ç°äº†1024çš„æ¸¸æˆè§„åˆ™ weapp-douban-movie â˜…12 - å¾®ä¿¡å°ç¨‹åºç‰ˆè±†ç“£ç”µå½± weapp-lolgame â˜…11 - è‹±é›„è”ç›Ÿ(LOL)æˆ˜ç»©æŸ¥è¯¢ jspapa-wx â˜…10 -jspapaå¾®ä¿¡å°ç¨‹åºç‰ˆæœ¬ wxSortPickerView â˜…8 - å¾®ä¿¡å°ç¨‹åºé¦–å­—æ¯æ’åºé€‰æ‹©è¡¨ liwushuoapp â˜…8 - å¾®ä¿¡å°ç¨‹åºå¼€å‘çš„App wx-mina-meteor â˜…8 - ä¸€ä¸ª meteor çš„ React todo list ä¾‹å­ wechat-app-githubfeed â˜…7 - å¾®ä¿¡å°ç¨‹åºè¯•ç© caipu_weixin â˜…7 - å¾®ä¿¡å°ç¨‹åºå¥åº·èœè°± weapp-LeanCloud â˜…7 - LeanCloud çš„å¾®ä¿¡å°ç¨‹åºç”¨æˆ·ç™»é™†Demo wx-mime â˜…5 - å¾®ä¿¡ç¨‹åºç‰ˆçš„æ‰«é›· å¤‡æ³¨åŸæ–‡é“¾æ¥ï¼šhttps://github.com/opendigg/awesome-github-wechat-weapp","link":"/2017/01/11/ã€Šå¾®ä¿¡å°ç¨‹åºã€‹ å¼€æºé¡¹ç›®/"},{"title":"RxJava2-çº¿ç¨‹ç®¡ç†å’Œæµç¨‹æµ…æ","text":"ä»‹ç» æ‰¿æ¥ä¸Šæ–‡ï¼Œç»“åˆä½¿ç”¨åœºæ™¯ï¼Œè®¨è®ºä¸€ä¸‹å¦‚ä½•å‘Šåˆ«AsyncTaskï¼Œå°±æ˜¯å› ä¸ºRxJavaçš„å¼ºå¤§çº¿ç¨‹ç®¡ç†åŠŸèƒ½ã€‚ ä¸¾ä¾‹è¯´æ˜è®¤è¯†RxJavaä¹‹å‰ï¼Œæˆ‘ä»¬å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼š AsyncTask Thread + Runnableã€‚ æ¶‰åŠçš„ä»£ç é‡ç›¸æ¯”è¾ƒRxJavaè€Œè¨€å¤§å¤ªå¤šï¼Œé’ˆå¯¹Handlerå¤„ç†ä¸å¥½ï¼Œå¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼çš„é£é™©ã€‚ä¸èµ˜è¿°ï¼Œçœ‹çœ‹å¦‚ä½•ä½¿ç”¨RxJavaå¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚ å¼‚æ­¥å¤„ç†ä»£ç ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637Observable&lt;Integer&gt; observable = Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() { @Override public void subscribe(ObservableEmitter&lt;Integer&gt; e) throws Exception { Logger(\"Emit 111\"); e.onNext(111); Logger(\"Emit 222\"); e.onNext(222); Logger(\"Emit onComplete\"); e.onComplete(); }});Observer&lt;Integer&gt; observer = new Observer&lt;Integer&gt;() { @Override public void onSubscribe(Disposable d) { Logger(\"onSubscribe\"); } @Override public void onNext(Integer integer) { Logger(\"onNext integer = \" + integer); } @Override public void onError(Throwable e) { Logger(\"onError e = \" + e.getMessage()); } @Override public void onComplete() { Logger(\"onComplete\"); }};observable.subscribeOn(Schedulers.newThread()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(observer); è¿è¡Œç»“æœå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼ŒObserverä¸‹çš„æ“ä½œæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸‹å®Œæˆçš„ï¼Œè€ŒObservableä¸‹å‘å°„å™¨çš„å‘å°„åŠ¨ä½œå´æ˜¯åœ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹ä¸­å®Œæˆçš„ã€‚é€šè¿‡è¿™ç§æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨subscribeæ–¹æ³•ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œç„¶åç»“æœé€šè¿‡onNext()æ–¹æ³•è¿”å›ç»™ä¸»çº¿ç¨‹ï¼Œå®ç°å¼‚æ­¥å¤„ç†çš„ç›®çš„ã€‚å¸¸ç”¨çš„åœºæ™¯ï¼šè®¿é—®æ•°æ®åº“ï¼Œç½‘ç»œè¯·æ±‚æ•°æ®ï¼Œåå°è®¡ç®—æ“ä½œç­‰ç­‰ã€‚ Schedulers å’Œ AndroidSchedulersAndroidSchedulersæ˜¯RxAndroidä¸­çš„çº¿ç¨‹è°ƒåº¦å™¨ï¼Œä¸»è¦ç”¨é€”å¦‚ä¸Šæ‰€ç¤ºï¼ŒAndroidSchedulers.mainThreadï¼Œä»£è¡¨Androidä¸­çš„ä¸»çº¿ç¨‹ï¼ˆUIçº¿ç¨‹ï¼‰ã€‚ æ–¹æ³• è§£é‡Š Schedulers.computation() ç”¨äºè®¡ç®—ä»»åŠ¡ Schedulers.from(Executor executor) ä½¿ç”¨æŒ‡å®šçš„Executorä½œä¸ºè°ƒåº¦å™¨ Schedulers.io() ç”¨äºIOå¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚å¼‚æ­¥é˜»å¡IOæ“ä½œï¼Œè¿™ä¸ªè°ƒåº¦å™¨çš„çº¿ç¨‹æ± ä¼šæ ¹æ®éœ€è¦å¢é•¿ Scheduler.newThread() ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ Scheduler.shutdown() åœæ­¢è°ƒåº¦å™¨ Scheduler.single() å•ç‹¬çº¿ç¨‹ Scheduler.start() å¯åŠ¨è°ƒåº¦å™¨ Scheduler.trampoline() åœ¨å½“å‰çº¿ç¨‹ä¸­ï¼Œä½†æ˜¯ä¼šç­‰åˆ°å½“å‰çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åå†å»æ‰§è¡Œ AndroidScheduler.mainThread() ä¸»çº¿ç¨‹ æºç Observable.create()1234public static &lt;T&gt; Observable&lt;T&gt; create(ObservableOnSubscribe&lt;T&gt; source) { ObjectHelper.requireNonNull(source, \"source is null\"); return RxJavaPlugins.onAssembly(new ObservableCreate&lt;T&gt;(source));} å…ˆæ‰§è¡Œéç©ºæ£€æŸ¥ï¼Œç„¶åé€šè¿‡ObservableCreateæ¥åˆ›å»ºObservableã€‚è€ŒObservableCreateç»§æ‰¿Observableã€‚çœ‹ä¸‹ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101//ObservableCreateç»§æ‰¿Observablepublic final class ObservableCreate&lt;T&gt; extends Observable&lt;T&gt; { //ObservableOnSubscribeæ¥å£åªæœ‰ä¸€ä¸ªsubscribeæ–¹æ³• final ObservableOnSubscribe&lt;T&gt; source; public ObservableCreate(ObservableOnSubscribe&lt;T&gt; source) { //èµ‹å€¼ï¼Œç»“åˆä¸Šé¢Observableçš„createæ–¹æ³•ï¼Œè¿™ä¸ªsourceåº”è¯¥æ˜¯æˆ‘ä»¬newå‡ºæ¥çš„ObservableOnSubscribe this.source = source; } //è¿™ä¸ªæ–¹æ³•åœ¨Observableæ‰§è¡Œsubscribe(Observer)çš„æ—¶å€™ä½¿ç”¨åˆ° @Override protected void subscribeActual(Observer&lt;? super T&gt; observer) { //åˆ›å»ºCreateEmitterï¼Œä¼ å…¥observer,å†…éƒ¨ä½¿ç”¨ CreateEmitter&lt;T&gt; parent = new CreateEmitter&lt;T&gt;(observer); //æ‰§è¡Œobserverçš„onSubscribeæ–¹æ³•ï¼Œparentæ˜¯CreateEmitterï¼Œå®ç°äº†Disposableï¼Œå’Œæˆ‘ä»¬åˆ›å»ºObserveræ—¶å®ç°çš„onSubscribeæ–¹æ³•ä¸€è‡´ï¼Œæ²¡æ¯›ç—… observer.onSubscribe(parent); try { //æ‰§è¡Œsubscribeæ–¹æ³•ï¼Œsourceä¸ºObservableOnSubscribeå¯¹è±¡ï¼Œparentä¸ºCreateEmitterï¼Œè€ŒCreateEmitterå®ç°ObservableEmitteræ¥å£ï¼Œæ²¡æ¯›ç—… source.subscribe(parent); } catch (Throwable ex) { Exceptions.throwIfFatal(ex); //CreateEmitteræ‰§è¡ŒonErroræ–¹æ³• parent.onError(ex); } } //CreateEmitterç±»ç»§æ‰¿AtomicReference&lt;Disposable&gt;å®ç°ObservableEmitterå’ŒDisposable æ¥å£ static final class CreateEmitter&lt;T&gt; extends AtomicReference&lt;Disposable&gt; implements ObservableEmitter&lt;T&gt;, Disposable { private static final long serialVersionUID = -3434801548987643227L; //åˆ›å»ºè¿‡ç¨‹ä¸­ä¼ å…¥çš„Observer final Observer&lt;? super T&gt; observer; CreateEmitter(Observer&lt;? super T&gt; observer) { this.observer = observer; } //OnNextæ–¹æ³• @Override public void onNext(T t) { //éç©ºæ£€æŸ¥ï¼ŒonNextåœ¨2.0ä¹‹åä¸å…è®¸ä¼ å…¥nullå€¼ä½œä¸ºå‚æ•° if (t == null) { onError(new NullPointerException(\"onNext called with null. Null values are generally not allowed in 2.x operators and sources.\")); return; } //è¿™ä¸ªå¯¹åº”ä¸Šæˆ‘ä»¬çš„ä¸Šä¸€ç¯‡åšå®¢ï¼Œä¸€æ¬¡æ€§æ°´ç®¡ï¼Œå¦‚æœisDisposedä¸ºtrue,åˆ™å‘å°„å™¨å‘å‡ºçš„äº‹ä»¶ï¼Œå°†ä¸ä¼šè¢«è§‚å¯Ÿè€…æ‰§è¡Œ if (!isDisposed()) { observer.onNext(t); } } //onErroræ–¹æ³•ï¼Œå½“tryOnErroè¿”å›falseçš„æ—¶å€™ï¼Œæ‰§è¡ŒRxJavaPlugins.onError(t)ï¼Œä½•æ—¶tryOnErrorä¼šè¿”å›falseå‘¢ï¼Ÿçœ‹ä¸‹é¢ @Override public void onError(Throwable t) { //å½“isDisposed()ä¸ºtrueåï¼Œä¼šæ‰§è¡ŒRxJavaPlugins.onError(t)æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœåœ¨isDisposed()ä¸ºtrueçš„æƒ…å†µä¸‹ï¼Œå‘å°„å™¨è¿˜å‘å‡ºonError()äº‹ä»¶ï¼Œä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚å…·ä½“çœ‹ä¸‹é¢çš„è¿è¡Œç¤ºä¾‹ã€‚ if (!tryOnError(t)) { RxJavaPlugins.onError(t); } } @Override public boolean tryOnError(Throwable t) { //ä¹Ÿæ˜¯ä¸å…è®¸ä¼ å…¥null if (t == null) { t = new NullPointerException(\"onError called with null. Null values are generally not allowed in 2.x operators and sources.\"); } //å¦‚æœisDisposedä¸ºfalse,æ‰§è¡Œè§‚å¯Ÿè€…çš„onErroræ–¹æ³•ï¼Œç„¶åæ‰§è¡Œdispose()æ“ä½œï¼Œä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…ä¸å¤„ç†åé¢å‘å°„å™¨å‘é€çš„äº‹ä»¶äº†ã€‚ä¼°è®¡onComplete()æ–¹æ³•ä¸­ä¹Ÿä¼šæœ‰ç±»ä¼¼çš„æ“ä½œæµç¨‹ if (!isDisposed()) { try { observer.onError(t); } finally { dispose(); } return true; } //åªæœ‰å½“isDisposedä¸ºtrueçš„æ—¶å€™å›è¿”å›falseï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªæ–¹æ³•å›æ‰§è¡ŒRxJavaPlugins.onError(t);æ“ä½œ return false; } @Override public void onComplete() { //å’Œä¸Šé¢onError(ï¼‰æ“ä½œç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯æ²¡æœ‰éç©ºæ£€æŸ¥ï¼Œå› ä¸ºonCompleteæ²¡æœ‰å‚æ•°ã€‚ if (!isDisposed()) { try { observer.onComplete(); } finally { dispose(); } } } â€¦â€¦ } â€¦â€¦ //è¿™éƒ¨åˆ†ä»‹ç»çš„æ˜¯SerializedEmitterï¼Œæš‚æ— æ¶‰åŠ} ä¸¾ä¾‹è¯´æ˜ï¼ŒisDisposed()ä¸ºtrueæ—¶ï¼Œå‘å°„å™¨ç»§ç»­å‘é€onErroräº‹ä»¶ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142Observable&lt;Integer&gt; observable = Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() { @Override public void subscribe(ObservableEmitter&lt;Integer&gt; e) throws Exception { Logger(\"Emit 111\"); e.onNext(111); Logger(\"Emit 222\"); e.onNext(222); Logger(\"Emit 333\"); e.onNext(333); Logger(\"Emit onError\"); e.onError(new Throwable(\"Test Disposable onError\")); } }); Observer&lt;Integer&gt; observer = new Observer&lt;Integer&gt;() { Disposable mDisposable; @Override public void onSubscribe(Disposable d) { Logger(\"onSubscribe\"); mDisposable = d; } @Override public void onNext(Integer integer) { Logger(\"onNext integer = \" + integer); if(mDisposable!=null &amp;&amp; !mDisposable.isDisposed() &amp;&amp; integer == 222) { mDisposable.dispose(); } } @Override public void onError(Throwable e) { Logger(\"onError e = \" + e.getMessage()); } @Override public void onComplete() { Logger(\"onComplete\"); } }; observable.subscribe(observer); è¿è¡Œç»“æœï¼š Observeråˆ›å»ºObserverï¼Œæ— ç”šç‰¹æ®Šï¼Œæ³¨æ„onSubscribeï¼ŒonNextï¼ŒonErrorä¼ å…¥çš„å‚æ•°ä¸èƒ½ä¸ºç©ºä»¥åŠDisposable çš„ä½¿ç”¨ã€‚ 123456789public interface Observer&lt;T&gt; { void onSubscribe(@NonNull Disposable d); void onNext(@NonNull T t); void onError(@NonNull Throwable e); void onComplete();} observable.subscribe(observer)åˆ†æä¸€ä¸‹subscribeæ–¹æ³• 1234567891011121314151617181920212223public final void subscribe(Observer&lt;? super T&gt; observer) { //observeréç©ºæ£€æŸ¥ ObjectHelper.requireNonNull(observer, \"observer is null\"); try { //å…³è”observableå’Œobserver observer = RxJavaPlugins.onSubscribe(this, observer); ObjectHelper.requireNonNull(observer, \"Plugin returned null Observer\"); //è¿™ä¸ªæ–¹æ³•åœ¨Observableä¸­æ˜¯ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½†æ˜¯ç»“åˆä¸Šé¢Observerableçš„createè¿‡ç¨‹ï¼Œå¯ä»¥çŸ¥é“è¿™é‡Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯ObservableCreateçš„subscribeActualæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬åˆ†æçš„è¿‡ç¨‹ï¼Œæ²¡æ¯›ç—… subscribeActual(observer); } catch (NullPointerException e) { // NOPMD throw e; } catch (Throwable e) { Exceptions.throwIfFatal(e); // can't call onError because no way to know if a Disposable has been set or not // can't call onSubscribe because the call might have set a Subscription already RxJavaPlugins.onError(e); NullPointerException npe = new NullPointerException(\"Actually not, but can't throw other exceptions due to RS\"); npe.initCause(e); throw npe; }} ä¸€è·¯çœ‹ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆå¿«çš„å’Œæˆ‘ä»¬åšçš„æµ‹è¯•å¯¹åº”ä¸Šï¼Œå…ˆè°ƒç”¨onSubscribeæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œsubscribeæ–¹æ³•ä¸­çš„å‘å°„å™¨æ“ä½œï¼Œæ ¹æ®å‘å°„å™¨çš„æ“ä½œObserverä½œå‡ºå¯¹åº”çš„å¤„ç†ã€‚ subscribeOnsubscribeOnç”¨æ¥æŒ‡å®šObservableåœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œè‡ªå·±çš„subscribeæ–¹æ³•ã€‚ 12345public final Observable&lt;T&gt; subscribeOn(Scheduler scheduler) { //scheduleréç©ºæ£€æŸ¥ ObjectHelper.requireNonNull(scheduler, \"scheduler is null\"); return RxJavaPlugins.onAssembly(new ObservableSubscribeOn&lt;T&gt;(this, scheduler));} åˆ›å»ºäº†ä¸€ä¸ªObservableSubscribeOnï¼Œè¿™ä¸ªç±»åƒä¸‡åˆ«å’Œä¸Šé¢åˆ›å»ºObservableè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ObservableOnSubscribeæ¥å£å¼„æ··æ·†ï¼Œç»“åˆå½“å‰æ“ä½œä¸ºsubscribeOnæ¥è®°ä½è¿™ä¸ªç±»åã€‚ 1234public ObservableSubscribeOn(ObservableSource&lt;T&gt; source, Scheduler scheduler) { super(source); this.scheduler = scheduler;} Observerableç»§æ‰¿è‡ªObservableSourceï¼Œæ‰€ä»¥åˆ›å»ºObservableSubscribeOnçš„æ—¶å€™Observableå’Œschedulerä¼ é€’è¿‡æ¥ã€‚ObservableSubscribeOnç»§æ‰¿AbstractObservableWithUpstreamï¼Œè€Œåè€…åˆç»§æ‰¿Observableã€‚æ‰€ä»¥å®é™…ä¸Šç»è¿‡subscribeOnæ“ä½œä¹‹åï¼Œåç»­æ“ä½œçš„å¯¹è±¡ä»Observerableå˜æˆäº†ObservableSubscribeOnï¼Œæ‰€ä»¥ï¼Œå½“åé¢æ‰§è¡Œsubscribeæ—¶æ‰§è¡Œçš„subscribeActualæ–¹æ³•ä¸ºObservableSubscribeOné‡çš„å¯¹åº”æ–¹æ³• 123456789101112 @Override public void subscribeActual(final Observer&lt;? super T&gt; s) { //å°è£…Observerï¼Œå®é™…Observerç”±å…¶å†…éƒ¨actualç»´æŠ¤ final SubscribeOnObserver&lt;T&gt; parent = new SubscribeOnObserver&lt;T&gt;(s); //Observeræ‰§è¡ŒonSubscribeæ–¹æ³•ï¼ŒSubscribeOnObserverå®ç°Disposableæ¥å£ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä¾‹å­ä¸­onSubscribeä¼ é€’çš„æ˜¯Disposableç±»å‹ s.onSubscribe(parent);//è¿™é‡Œæœ‰3ä¸ªæ“ä½œï¼š//1. åˆ›å»ºSubscribeTaskï¼Œä¼ å…¥å°è£…åçš„Observer//2. è°ƒåº¦å™¨æ‰§è¡ŒscheduleDirectæ“ä½œ//3. å°è£…åçš„Observeræ‰§è¡ŒsetDisposableæ“ä½œ parent.setDisposable(scheduler.scheduleDirect(new SubscribeTask(parent))); } å…³æ³¨scheduler.scheduleDirect(new SubscribeTask(parent))ï¼Œå…ˆçœ‹ä¸‹ 123456789101112final class SubscribeTask implements Runnable { private final SubscribeOnObserver&lt;T&gt; parent; SubscribeTask(SubscribeOnObserver&lt;T&gt; parent) { this.parent = parent; } @Override public void run() { source.subscribe(parent); }} å®ç°Runnableï¼Œç»ˆäºçœ‹åˆ°ä¸€ä¸ªæœ‰ç‚¹ç†Ÿæ‚‰çš„ä¸œè¥¿ã€‚ä¼ å…¥çš„parentä¸ºå°è£…åçš„Observerã€‚è€Œsourceåˆ™æ˜¯åˆ›å»ºObservableSubscribeOnè¿‡ç¨‹ä¸­ä¼ å…¥çš„Observableã€‚åœ¨çœ‹scheduleDirectæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆå¼„æ¸…æ¥šè¿™ä¸ªscheduleræ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿåœ¨Schedulersç±»ä¸­ï¼Œä¸åŒçš„Schedulerå·²ç»åˆå§‹åŒ–å®Œæˆã€‚ 1234567891011static { SINGLE = RxJavaPlugins.initSingleScheduler(new SingleTask()); COMPUTATION = RxJavaPlugins.initComputationScheduler(new ComputationTask()); IO = RxJavaPlugins.initIoScheduler(new IOTask()); TRAMPOLINE = TrampolineScheduler.instance(); NEW_THREAD = RxJavaPlugins.initNewThreadScheduler(new NewThreadTask());} å°±çœ‹ä¸‹NEW_THREAD è¿™ä¸ªï¼Œé¦–å…ˆnew NewThreadTask() 123456static final class NewThreadTask implements Callable&lt;Scheduler&gt; { @Override public Scheduler call() throws Exception { return NewThreadHolder.DEFAULT; }} 123static final class NewThreadHolder { static final Scheduler DEFAULT = new NewThreadScheduler();} 12345678910111213141516171819202122232425262728293031public final class NewThreadScheduler extends Scheduler { final ThreadFactory threadFactory; private static final String THREAD_NAME_PREFIX = \"RxNewThreadScheduler\"; private static final RxThreadFactory THREAD_FACTORY; /** The name of the system property for setting the thread priority for this Scheduler. */ private static final String KEY_NEWTHREAD_PRIORITY = \"rx2.newthread-priority\"; static { int priority = Math.max(Thread.MIN_PRIORITY, Math.min(Thread.MAX_PRIORITY, Integer.getInteger(KEY_NEWTHREAD_PRIORITY, Thread.NORM_PRIORITY))); THREAD_FACTORY = new RxThreadFactory(THREAD_NAME_PREFIX, priority); } public NewThreadScheduler() { this(THREAD_FACTORY); } public NewThreadScheduler(ThreadFactory threadFactory) { this.threadFactory = threadFactory; } @NonNull @Override public Worker createWorker() { return new NewThreadWorker(threadFactory); }} çœ‹åˆ°äº†ThreadFactoryï¼ŒRxThreadFactoryï¼Œè€ŒRxThreadFactoryå®ç°äº†ThreadFactoryæ¥å£ï¼Œæ‰€ä»¥æœ€åè¿˜æ˜¯çº¿ç¨‹çš„ä½¿ç”¨ï¼Œåªæ˜¯RxJavaå¯¹è¿™äº›åŸºç¡€çš„ä¸œè¥¿åšäº†æ·±åº¦çš„å°è£…å’Œæµç¨‹ä¸Šçš„ä¼˜åŒ–ï¼Œè®©æˆ‘ä»¬æ›´æ–¹ä¾¿çš„ä½¿ç”¨ã€‚å›æº¯åˆ°ä¸Šé¢çš„scheduleDirectæ–¹æ³•ï¼Œ 123public Disposable scheduleDirect(@NonNull Runnable run) { return scheduleDirect(run, 0L, TimeUnit.NANOSECONDS);} 12345678910111213public Disposable scheduleDirect(@NonNull Runnable run, long delay, @NonNull TimeUnit unit) { //åˆ›å»ºå·¥ä½œçº¿ç¨‹ï¼Œä»¥NewThreadSchedulerä¸ºä¾‹ï¼Œæ˜¯åˆ›å»ºNewThreadWorker final Worker w = createWorker(); // final Runnable decoratedRun = RxJavaPlugins.onSchedule(run); //å°è£…å‡ºä¸€ä¸ªå¸¦Disposeçš„Taskï¼Œæ–¹ä¾¿æ§åˆ¶ DisposeTask task = new DisposeTask(decoratedRun, w); //ä»¥NewThreadSchedulerä¸ºä¾‹ï¼Œè¿™é‡Œæ‰§è¡Œçš„æ˜¯NewThreadWorkerä¸­çš„scheduleæ–¹æ³• w.schedule(task, delay, unit); return task;} 123456public Disposable schedule(@NonNull final Runnable action, long delayTime, @NonNull TimeUnit unit) { if (disposed) { return EmptyDisposable.INSTANCE; } return scheduleActual(action, delayTime, unit, null);} å¿½ç•¥disposedçš„å½±å“ï¼Œæœ€åæ‰§è¡Œåˆ°scheduleActual 1234567891011121314151617181920212223242526272829public ScheduledRunnable scheduleActual(final Runnable run, long delayTime, @NonNull TimeUnit unit, @Nullable DisposableContainer parent) { Runnable decoratedRun = RxJavaPlugins.onSchedule(run); ScheduledRunnable sr = new ScheduledRunnable(decoratedRun, parent); if (parent != null) { if (!parent.add(sr)) { return sr; } } Future&lt;?&gt; f; try { //ç›´æ¥æäº¤æˆ–è€…è¿›å…¥é˜Ÿåˆ— if (delayTime &lt;= 0) { f = executor.submit((Callable&lt;Object&gt;)sr); } else { f = executor.schedule((Callable&lt;Object&gt;)sr, delayTime, unit); } sr.setFuture(f); } catch (RejectedExecutionException ex) { if (parent != null) { parent.remove(sr); } RxJavaPlugins.onError(ex); } return sr; } å¯ä»¥çœ‹åˆ°ç†Ÿæ‚‰çš„ScheduledExecutorServiceå’ŒFutureã€‚æ‰€ä»¥ï¼Œç»¼ä¸Šæ‰€è¿°ï¼Œå…¶å†…éƒ¨ä¹Ÿæ˜¯æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç»“åˆRunnableã€‚ observeOnåŸç†æˆ‘è§‰å¾—å’ŒsubscribeOnæ²¡æœ‰å¤ªå¤§çš„å·®åˆ«ã€‚ä¸åšèµ˜è¿°ã€‚","link":"/2018/01/06/RxJava2å°ç™½æ‰‹å†Œï¼ˆ2ï¼‰- çº¿ç¨‹ç®¡ç†å’Œæµç¨‹æµ…æ/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆä¸€ï¼‰","text":"Android5.0 Camera Framework ç®€ä»‹CameraServiceå¯åŠ¨CameraServiceæ˜¯åœ¨MediaServerå¯åŠ¨è¿‡ç¨‹ä¸­è¿›è¡Œçš„main_mediaserver.cpp (frameworks\\av\\media\\mediaserver) 123456......AudioFlinger::instantiate(); //audioflingeræœåŠ¡ï¼ŒéŸ³é¢‘ç›¸å…³MediaPlayerService::instantiate(); //mediaplayerservice,åª’ä½“æ’­æ”¾ç›¸å…³CameraService::instantiate();//CameraServiceAudioPolicyService::instantiate(); //éŸ³é¢‘ç›¸å…³...... åœ¨ mainå‡½æ•°ä¸­ä¼šæ‰§è¡Œåˆ°CameraService::instantiate()ï¼Œ CameraService æœ¬èº«å¹¶æ²¡æœ‰å®ç°è¿™ä¸ªæ–¹æ³•CameraService.cpp (frameworks\\av\\services\\camera\\libcameraservice)CameraService.h (frameworks\\av\\services\\camera\\libcameraservice)BinderService.h (frameworks\\native\\include\\binder) 12345678class CameraService : public BinderService&lt;CameraService&gt;, public BnCameraService, public IBinder::DeathRecipient, public camera_module_callbacks_t{ ......} åœ¨å…¶çˆ¶ç±»ä¸­å¯»æ‰¾instantiate()å‡½æ•°ï¼ŒBinderServiceæ˜¯ä¸€ä¸ªæ¨¡æ¿ç±» 1234567891011121314template&lt;typename SERVICE&gt;class BinderService{public: static status_t publish(bool allowIsolated = false) { //BinderService::publish sp&lt;IServiceManager&gt; sm(defaultServiceManager()); //æ‹¿åˆ°ServiceManagerçš„Bp return sm-&gt;addService( String16(SERVICE::getServiceName()), new SERVICE(), allowIsolated); //è¿™é‡Œçš„SERVICEå°±æ˜¯CameraService } ..... static void instantiate() { publish(); } //BinderService::instantiate .....}; è¿™é‡Œä¼šnew CameraService()ï¼Œ 12345678910CameraService::CameraService() :mSoundRef(0), mModule(0){ ALOGI(\"CameraService started (pid=%d)\", getpid()); gCameraService = this; //ä¿å­˜ä¸€ä¸ªæœ¬åœ°æŒ‡é’ˆ for (size_t i = 0; i &lt; MAX_CAMERAS; ++i) { mStatusList[i] = ICameraServiceListener::STATUS_PRESENT; } this-&gt;camera_device_status_change = android::camera_device_status_change;} åˆ°è¿™é‡Œï¼ŒCameraServiceå°±å¯åŠ¨äº†ã€‚ Cameraè¿æ¥è¿‡ç¨‹Camera.java (frameworks\\base\\core\\java\\android\\hardware)Camera.cpp (frameworks\\av\\camera)android_hardware_Camera.cpp (frameworks\\base\\core\\jni)ä»java-&gt;jni-&gt;CPPçš„å…¸å‹è¿‡ç¨‹é¦–å…ˆä»Camera.javaå…¥æ‰‹ï¼Œè¿™é‡Œé€šè¿‡open()æ–¹æ³•ï¼Œåˆ›å»ºCamera 123456789101112131415public static Camera open(int cameraId) { return new Camera(cameraId);}public static Camera open() { int numberOfCameras = getNumberOfCameras(); CameraInfo cameraInfo = new CameraInfo(); for (int i = 0; i &lt; numberOfCameras; i++) { getCameraInfo(i, cameraInfo); if (cameraInfo.facing == CameraInfo.CAMERA_FACING_BACK) { return new Camera(i); } } return null;} ä¸¤ä¸ªopen()æ–¹æ³•ï¼Œé»˜è®¤æ‰“å¼€åç½®æ‘„åƒå¤´ï¼Œnew Camera()å¯¹è±¡ï¼Œ 1234567891011121314Camera(int cameraId) { int err = cameraInitNormal(cameraId);//åšäº‹çš„ä¸»è¦åœ°æ–¹ if (checkInitErrors(err)) { switch(err) { //é€šè¿‡è¿”å›çš„é”™è¯¯ä¿¡æ¯ï¼ŒæŠ›ä¸åŒçš„å¼‚å¸¸ä¿¡æ¯ case EACCESS: throw new RuntimeException(\"Fail to connect to camera service\"); case ENODEV: throw new RuntimeException(\"Camera initialization failed\"); default: // Should never hit this. throw new RuntimeException(\"Unknown camera error\"); } }} æ¥ä¸‹æ¥çœ‹ä¸‹ä»£ç ï¼Œæœ€åä¼šè½è„šåˆ°å“ªä¸€å—å‘¢ï¼Ÿ 123456789101112131415161718192021222324252627private int cameraInitNormal(int cameraId) { //è¿™é‡Œçš„CAMERA_HAL_API_VERSION_NORMAL_CONNECTåé¢ä¼šæåˆ°ç”¨æ¥åŒºåˆ«ä¸åŒçš„connect return cameraInitVersion(cameraId, CAMERA_HAL_API_VERSION_NORMAL_CONNECT);}......private int cameraInitVersion(int cameraId, int halVersion) { mShutterCallback = null; mRawImageCallback = null; mJpegCallback = null; mPreviewCallback = null; mPostviewCallback = null; mUsingPreviewAllocation = false; mZoomListener = null; //åˆå§‹åŒ–å‡ ä¸ªcallbackå’Œä¸€äº›å˜é‡ Looper looper; //mEventHandleråé¢ä¼šè®²åˆ°æ˜¯å¯¹åº•å±‚ä¸ŠæŠ¥å†…å®¹çš„å¤„ç†handler if ((looper = Looper.myLooper()) != null) { mEventHandler = new EventHandler(this, looper); } else if ((looper = Looper.getMainLooper()) != null) { mEventHandler = new EventHandler(this, looper); } else { mEventHandler = null; } String packageName = ActivityThread.currentPackageName(); return native_setup(new WeakReference&lt;Camera&gt;(this), cameraId, halVersion, packageName);} å¯ä»¥çœ‹åˆ°native_setupæ˜¯ä¸€ä¸ªnativeæ–¹æ³•ï¼Œå…·ä½“å®ç°åœ¨android_hardware_Camera.cpp (frameworks\\base\\core\\jni) 12345678910111213141516171819202122232425262728static jint android_hardware_Camera_native_setup(JNIEnv *env, jobject thiz, jobject weak_this, jint cameraId, jint halVersion, jstring clientPackageName){ ...... sp&lt;Camera&gt; camera; //ä¹‹å‰åœ¨åˆ›å»ºCameraå¯¹è±¡çš„æ—¶å€™è®¾ç½®çš„ä¸€ä¸ªå¸¸é‡ï¼Œæ­¤æ—¶èµ°åˆ°connectæ–¹æ³• if (halVersion == CAMERA_HAL_API_VERSION_NORMAL_CONNECT) { // Default path: hal version is don't care, do normal camera connect. camera = Camera::connect(cameraId, clientName, Camera::USE_CALLING_UID); } else { jint status = Camera::connectLegacy(cameraId, halVersion, clientName, Camera::USE_CALLING_UID, camera); if (status != NO_ERROR) { return status; } } ...... // We use a weak reference so the Camera object can be garbage collected. // The reference is only used as a proxy for callbacks. sp&lt;JNICameraContext&gt; context = new JNICameraContext(env, weak_this, clazz, camera); context-&gt;incStrong((void*)android_hardware_Camera_native_setup); camera-&gt;setListener(context);//listenerç”¨äºå¤„ç†åº•å±‚æ•°æ®ä¸ŠæŠ¥ // save context in opaque field env-&gt;SetLongField(thiz, fields.context, (jlong)context.get()); return NO_ERROR;} ä»JNIå¾€ä¸‹å°±æ˜¯CPPï¼Œç»§ç»­æ¢å¯»Cameraè¿æ¥è¿‡ç¨‹Camera.cpp (frameworks\\av\\camera)CameraBase.cpp (frameworks\\av\\camera) 12345sp&lt;Camera&gt; Camera::connect(int cameraId, const String16&amp; clientPackageName, int clientUid){ //CameraBaseTä¸ºæ¨¡æ¿ç±» return CameraBaseT::connect(cameraId, clientPackageName, clientUid);} CameraBaseä¸­connectå‡½æ•°æ¨¡æ¿æ›¿æ¢æˆ 123456789101112131415161718192021222324252627sp&lt;Camera&gt; CameraBase&lt;Camera, CameraTraits&lt;Camera&gt;&gt;::connect(int cameraId, const String16&amp; clientPackageName, int clientUid){ ALOGV(\"%s: connect\", __FUNCTION__); sp&lt;Camera&gt; c = new Camera(cameraId); sp&lt;ICameraClient&gt; cl = c; status_t status = NO_ERROR; const sp&lt;ICameraService&gt;&amp; cs = getCameraService();//è·å–CameraServiceçš„Bp if (cs != 0) { //è¿™é‡ŒTCamConncectServiceæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯ICameraServiceä¸­çš„connectæ–¹æ³• TCamConnectService fnConnectService = TCamTraits::fnConnectService; status = (cs.get()-&gt;*fnConnectService)(cl, cameraId, clientPackageName, clientUid, /*out*/ c-&gt;mCamera); status = (cs.get()-&gt;*fnConnectService)(cl, cameraId, clientPackageName, clientUid, /*out*/ c-&gt;mCamera); } if (status == OK &amp;&amp; c-&gt;mCamera != 0) { c-&gt;mCamera-&gt;asBinder()-&gt;linkToDeath(c); c-&gt;mStatus = NO_ERROR; } else { ALOGW(\"An error occurred while connecting to camera: %d\", cameraId); c.clear(); } return c;} è¿™é‡Œå¯èƒ½æœ‰ç‚¹ç»•ï¼Œç¨å¾®è®²è§£ä¸€ä¸‹ï¼Œæ¨¡æ¿ä¸Š template &lt;typename TCam, typename TCamTraits&gt; è¿™é‡ŒTCamåŒ–æˆCameraåº”è¯¥æ¯”è¾ƒæ¸…æ™°ï¼Œè€ŒTCamTraitsçš„æ›¿æ¢ï¼Œé¦–å…ˆä»CameraBase.hæ–‡ä»¶ä¸­çœ‹ 1234template &lt;typename TCam&gt;struct CameraTraits {};template &lt;typename TCam, typename TCamTraits = CameraTraits&lt;TCam&gt; &gt; ç„¶åæˆ‘ä»¬å†åˆ°Camera.hä¸­çœ‹template &lt;&gt; struct CameraTraits { typedef CameraListener TCamListener; typedef ICamera TCamUser; typedef ICameraClient TCamCallbacks; typedef status_t (ICameraService::*TCamConnectService)(const sp&amp;, int, const String16&amp;, int, /out/ sp&amp;); static TCamConnectService fnConnectService; }; ä¸­é—´æœ‰äº›è¿‡ç¨‹ï¼Œåº”è¯¥å¥½ç†è§£äº†ï¼Œè¿™é‡Œç»•äº†ä¸€ä¸‹ï¼Œæœ€åè½è„šåˆ°ICameraService.cppä¸­çš„connectæ–¹æ³•ï¼Œè¿™ä¸€éƒ¨åˆ†æ¶‰åŠåˆ°Binderæœºåˆ¶æ¯”è¾ƒå¤šï¼Œæš‚æ—¶å…ˆä¸è®²è§£å…·ä½“å†…å®¹ï¼Œæ³¨æ„è°ƒç”¨çš„åœ°æ–¹å³å¯ã€‚ ICameraService.cpp (frameworks\\av\\camera) 123456789101112131415161718192021// connect to camera service (android.hardware.Camera)virtual status_t connect(const sp&lt;ICameraClient&gt;&amp; cameraClient, int cameraId, const String16 &amp;clientPackageName, int clientUid, /*out*/ sp&lt;ICamera&gt;&amp; device){ Parcel data, reply; data.writeInterfaceToken(ICameraService::getInterfaceDescriptor()); data.writeStrongBinder(cameraClient-&gt;asBinder()); data.writeInt32(cameraId); data.writeString16(clientPackageName); data.writeInt32(clientUid); remote()-&gt;transact(BnCameraService::CONNECT, data, &amp;reply);//é€šè¿‡binderè¿œç«¯è°ƒç”¨ä¼ å…¥çš„codeä¸ºBnCameraservice::CONNECT if (readExceptionCode(reply)) return -EPROTO; status_t status = reply.readInt32(); if (reply.readInt32() != 0) { device = interface_cast&lt;ICamera&gt;(reply.readStrongBinder());//è½¬æ¢ä¸ºBpCamera } return status;} æ¥ä¸‹æ¥æˆ–æ‰§è¡Œåˆ°BnCameraServiceçš„onTransact()æ–¹æ³•ï¼Œä¸»è¦å°±æ˜¯switch_caseï¼Œä¸Šé¢ä¼ å…¥çš„æ˜¯CONNECT 1234567891011121314151617181920212223242526272829status_t BnCameraService::onTransact( uint32_t code, const Parcel&amp; data, Parcel* reply, uint32_t flags){ switch(code) { ...... case CONNECT: { CHECK_INTERFACE(ICameraService, data, reply); sp&lt;ICameraClient&gt; cameraClient = interface_cast&lt;ICameraClient&gt;(data.readStrongBinder()); int32_t cameraId = data.readInt32(); const String16 clientName = data.readString16(); int32_t clientUid = data.readInt32(); sp&lt;ICamera&gt; camera; status_t status = connect(cameraClient, cameraId, clientName, clientUid, /*out*/camera); //è¿™é‡ŒBnCameraServiceå¹¶æ²¡æœ‰å®ç°connectå‡½æ•°ï¼Œå®é™…å®ç°åœ¨CameraServiceä¸­ reply-&gt;writeNoException(); reply-&gt;writeInt32(status); if (camera != NULL) { reply-&gt;writeInt32(1); reply-&gt;writeStrongBinder(camera-&gt;asBinder()); } else { reply-&gt;writeInt32(0); } return NO_ERROR; } break; ...... } } æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹CameraServiceä¸­çš„connectæ–¹æ³•åˆ°åº•åšäº†å“ªäº›äº‹æƒ… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051status_t CameraService::connect( const sp&lt;ICameraClient&gt;&amp; cameraClient, int cameraId, const String16&amp; clientPackageName, int clientUid, /*out*/ sp&lt;ICamera&gt;&amp; device) { String8 clientName8(clientPackageName); int callingPid = getCallingPid(); LOG1(\"CameraService::connect E (pid %d \\\"%s\\\", id %d)\", callingPid, clientName8.string(), cameraId); //å¯¹å½“å‰è¿æ¥è¯·æ±‚åˆæ³•æ€§çš„åˆ¤æ–­ status_t status = validateConnect(cameraId, /*inout*/clientUid); if (status != OK) { return status; } //Clientç±»ç»§æ‰¿BnCamera BasicClient sp&lt;Client&gt; client; { Mutex::Autolock lock(mServiceLock); sp&lt;BasicClient&gt; clientTmp; //åˆ¤æ–­å½“å‰è®¾å¤‡æ˜¯å¦è¢«å æœ‰æˆ–è€…æ˜¯é‡å¤è¯·æ±‚ if (!canConnectUnsafe(cameraId, clientPackageName, cameraClient-&gt;asBinder(), /*out*/clientTmp)) { return -EBUSY;//ä»è¿”å›ç»“æœå¯ä»¥çœ‹å‡ºè¿™ä¸ªå‡½æ•°çš„ç”¨é€” } else if (client.get() != NULL) { device = static_cast&lt;Client*&gt;(clientTmp.get()); return OK; } //è€ƒè™‘å½“å‰æ²¡æœ‰å…¶ä»–ç¨‹åºå ç”¨æ‘„åƒå¤´ï¼Œèµ°åˆ°ä¸‹ä¸€æ­¥ status = connectHelperLocked(/*out*/client, cameraClient, cameraId, clientPackageName, clientUid, callingPid); if (status != OK) { return status; } } // important: release the mutex here so the client can call back // into the service from its destructor (can be at the end of the call) //èµ‹å€¼ç»™deviceä½œä¸ºä¼ å‡ºå‚æ•° device = client; return OK;} ç»§ç»­è·Ÿè¸ªåˆ°connectHelperLocked()å‡½æ•°ä¸­ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071status_t CameraService::connectHelperLocked( /*out*/ sp&lt;Client&gt;&amp; client, /*in*/ const sp&lt;ICameraClient&gt;&amp; cameraClient, int cameraId, const String16&amp; clientPackageName, int clientUid, int callingPid, int halVersion, bool legacyMode) { int facing = -1; int deviceVersion = getDeviceVersion(cameraId, &amp;facing); if (halVersion &lt; 0 || halVersion == deviceVersion) { // Default path: HAL version is unspecified by caller, create CameraClient // based on device version reported by the HAL. switch(deviceVersion) { case CAMERA_DEVICE_API_VERSION_1_0: //åˆ›å»ºCameraClientå¯¹è±¡ client = new CameraClient(this, cameraClient, clientPackageName, cameraId, facing, callingPid, clientUid, getpid(), legacyMode); break; case CAMERA_DEVICE_API_VERSION_2_0: case CAMERA_DEVICE_API_VERSION_2_1: case CAMERA_DEVICE_API_VERSION_3_0: case CAMERA_DEVICE_API_VERSION_3_1: case CAMERA_DEVICE_API_VERSION_3_2: client = new Camera2Client(this, cameraClient, clientPackageName, cameraId, facing, callingPid, clientUid, getpid(), legacyMode); break; case -1: ALOGE(\"Invalid camera id %d\", cameraId); return BAD_VALUE; default: ALOGE(\"Unknown camera device HAL version: %d\", deviceVersion); return INVALID_OPERATION; } } else { // A particular HAL version is requested by caller. Create CameraClient // based on the requested HAL version. if (deviceVersion &gt; CAMERA_DEVICE_API_VERSION_1_0 &amp;&amp; halVersion == CAMERA_DEVICE_API_VERSION_1_0) { // Only support higher HAL version device opened as HAL1.0 device. client = new CameraClient(this, cameraClient, clientPackageName, cameraId, facing, callingPid, clientUid, getpid(), legacyMode); } else { // Other combinations (e.g. HAL3.x open as HAL2.x) are not supported yet. ALOGE(\"Invalid camera HAL version %x: HAL %x device can only be\" \" opened as HAL %x device\", halVersion, deviceVersion, CAMERA_DEVICE_API_VERSION_1_0); return INVALID_OPERATION; } } //ä¸»è¦æ˜¯å¯¹CameraClientçš„åˆå§‹åŒ–è¿‡ç¨‹ status_t status = connectFinishUnsafe(client, client-&gt;getRemote()); if (status != OK) { // this is probably not recoverable.. maybe the client can try again return status; } //ä¿å­˜CameraClientå¯¹è±¡åˆ°æœ¬åœ°æ•°ç»„ä¸­ï¼Œä»¥å¤‡CameraServiceä½¿ç”¨ mClient[cameraId] = client; LOG1(\"CameraService::connect X (id %d, this pid is %d)\", cameraId, getpid()); return OK;} è¿™é‡Œçš„clientåˆ›å»ºæˆåŠŸåä¼šèµ‹å€¼ç»™deviceï¼Œè€Œdeviceå°±æ˜¯ä¹‹å‰è¿æ¥è¿‡ç¨‹ä¸­çš„ä¼ å…¥å‚æ•°ï¼Œåˆ°è¿™é‡ŒCameraçš„è¿æ¥è¿‡ç¨‹å°±åŸºæœ¬å®Œæˆäº†ã€‚ æœ¬æ–‡ä¸»è¦é¡ºç€ä»£ç ç†äº†ä¸€ä¸‹è¿‡ç¨‹ï¼Œå…·ä½“ç»†èŠ‚åœ°æ–¹å¯èƒ½æœ‰æ‰€å¿½ç•¥ã€‚ä¸»è¦çš„æµç¨‹å›¾å¦‚ä¸‹ï¼Œæ¬¢è¿äº¤æµæŒ‡æ­£ã€‚ æœ¬æ–‡ä¸­ä»£ç ä½¿ç”¨çš„æ˜¯Android5.1åŸå§‹ä»£ç ","link":"/2015/08/15/ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆä¸€ï¼‰/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆäºŒï¼‰","text":"ä¸Šä¸€æ¬¡è®²è§£äº†ä¸€ä¸‹CameraServiceçš„å¯åŠ¨è¿‡ç¨‹ï¼Œä»Šå¤©æ¢³ç†ä¸€ä¸‹Cameraé¢„è§ˆçš„è¿‡ç¨‹ tartPreviewè¿‡ç¨‹ é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»åº”ç”¨å±‚çš„ä½¿ç”¨å…¥æ‰‹ Camera.java (packages\\apps\\legacycamera\\src\\com\\android\\camera) 123456Thread mCameraPreviewThread = new Thread(new Runnable() { public void run() { initializeCapabilities(); //åˆå§‹åŒ–å‚æ•° startPreview(); //å¯åŠ¨é¢„è§ˆ }}); é’ˆå¯¹ç›¸æœºåº”ç”¨ï¼Œé‡‡ç”¨äº†å•ç‹¬çš„çº¿ç¨‹æ¥å¤„ç†é¢„è§ˆï¼ŒçŒœæµ‹æ˜¯ä¸ºäº†åŠ å¿«é¢„è§ˆæ˜¾ç¤ºçš„é€Ÿåº¦ 123456789101112131415161718192021222324252627private void startPreview() { ...... // If we're previewing already, stop the preview first (this will blank // the screen). if (mCameraState != PREVIEW_STOPPED) stopPreview(); setPreviewDisplay(mSurfaceHolder); //è®¾ç½®SurfaceHolder setDisplayOrientation(); //è®¾ç½®æ˜¾ç¤ºæ–¹å‘ ...... setCameraParameters(UPDATE_PARAM_ALL); //è®¾ç½®å‚æ•° // Inform the mainthread to go on the UI initialization. if (mCameraPreviewThread != null) { synchronized (mCameraPreviewThread) { mCameraPreviewThread.notify(); } } try { Log.v(TAG, \"startPreview\"); mCameraDevice.startPreview(); //å¯åŠ¨é¢„è§ˆï¼Œè‹¥å¤±è´¥ï¼Œå…³é—­Camera } catch (Throwable ex) { closeCamera(); throw new RuntimeException(\"startPreview failed\", ex); } ...... } è¿™é‡Œå°±æ˜¯APPä¸­å¯åŠ¨é¢„è§ˆçš„è¿‡ç¨‹ï¼Œè¿‡ç¨‹å¿…ç„¶ä¼šæ˜¯ java -&gt; JNI -&gt; cppï¼Œ ç„¶åé€šè¿‡Binderæœºåˆ¶æ‰§è¡Œåˆ°CameraClientä¸­çš„ CameraClient.cpp (av\\services\\camera\\libcameraservice\\api1) 1234status_t CameraClient::startPreview() { LOG1(\"startPreview (pid %d)\", getCallingPid()); return startCameraMode(CAMERA_PREVIEW_MODE);} è¿™é‡Œä¼ å…¥çš„æ˜¯CAMERA_PREVIEW_MODEï¼Œæšä¸¾ç±»å‹æ˜¯åœ¨CameraClient.hä¸­å®šä¹‰çš„ // camera operation mode enum camera_mode { CAMERA_PREVIEW_MODE = 0, // frame automatically released CAMERA_RECORDING_MODE = 1, // frame has to be explicitly released by releaseRecordingFrame() }; ç¬¬ä¸€ç§æ˜¯é’ˆå¯¹æ™®é€šçš„é¢„è§ˆï¼Œç¬¬äºŒç§æ˜¯é’ˆå¯¹å½•åƒ 123456789101112131415161718192021222324// start preview or recordingstatus_t CameraClient::startCameraMode(camera_mode mode) { LOG1(\"startCameraMode(%d)\", mode); Mutex::Autolock lock(mLock); status_t result = checkPidAndHardware(); if (result != NO_ERROR) return result; switch(mode) { case CAMERA_PREVIEW_MODE: if (mSurface == 0 &amp;&amp; mPreviewWindow == 0) { LOG1(\"mSurface is not set yet.\"); // still able to start preview in this case. } return startPreviewMode(); //å¼€å§‹é¢„è§ˆæ¨¡å¼ case CAMERA_RECORDING_MODE: if (mSurface == 0 &amp;&amp; mPreviewWindow == 0) { ALOGE(\"mSurface or mPreviewWindow must be set before startRecordingMode.\"); return INVALID_OPERATION; } return startRecordingMode(); //å¼€å§‹å½•åƒæ¨¡å¼ default: return UNKNOWN_ERROR; }} è¿™é‡Œæˆ‘ä»¬èµ°çš„æ˜¯é¢„è§ˆæ¨¡å¼ 12345678910111213141516171819202122status_t CameraClient::startPreviewMode() { LOG1(\"startPreviewMode\"); //LOG1,ä¸€ç›´å¿˜è®°è¯´äº†ï¼Œè¿™æ˜¯æœ‰logå¼€å…³ç”¨è¿‡setpropå¯ä»¥ä½¿ç”¨ status_t result = NO_ERROR; // if preview has been enabled, nothing needs to be done if (mHardware-&gt;previewEnabled()) { //å¦‚æœå·²ç»å¯åŠ¨é¢„è§ˆï¼Œä¸å¿…é‡å¤ return NO_ERROR; } if (mPreviewWindow != 0) { //é€‚é…æ˜¾ç¤ºçª—å£çš„å¤§å° native_window_set_scaling_mode(mPreviewWindow.get(), NATIVE_WINDOW_SCALING_MODE_SCALE_TO_WINDOW); //è°ƒæ•´å¸§æ•°æ®çš„æ–¹å‘ native_window_set_buffers_transform(mPreviewWindow.get(), mOrientation); } mHardware-&gt;setPreviewWindow(mPreviewWindow); //è®¾ç½®mPreviewWindowä¸ºæ˜¾ç¤ºçª—å£ result = mHardware-&gt;startPreview(); //HALå±‚å¯åŠ¨é¢„è§ˆ return result; //è¿”å›ç»“æœ} è¿™é‡Œé¢æ¶‰åŠåˆ°native_window_set_scaling_modeï¼Œnative_window_set_buffers_transformï¼Œç›´æ¥è·Ÿä»£ç ï¼Œçœ‹æ³¨é‡Šå°±å¯ä»¥ç†è§£ï¼Œè¿™éƒ¨åˆ†æ¶‰åŠåˆ°æ˜¾ç¤ºçš„ä¸€äº›å†…å®¹ï¼Œè¿™é‡Œæš‚æ—¶ä¸åšè®²è§£ï¼Œnative_window_set_scaling_modeè®¾ç½®æ¨¡å¼ä¸ºNATIVE_WINDOW_SCALING_MODE_SCALE_TO_WINDOWï¼Œnative_window_set_buffers_transformæ˜¯ç”¨æ¥è°ƒæ•´æ–¹å‘ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒmPreviewWindowæ˜¯ä»ä½•è€Œæ¥çš„å‘¢ï¼Ÿ è¿˜è®°å¾—æˆ‘ä»¬åœ¨åº”ç”¨å±‚çš„startPreview()æ–¹æ³•ä¸­ä¼šæœ‰è¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹ 12setPreviewDisplay(mSurfaceHolder);setDisplayOrientation(); è¿™é‡Œçš„setPreviewDisplay(mSurfaceHolder)ï¼Œä¸­é—´çš„è¿‡ç¨‹å¤§å®¶å¯ä»¥è‡ªå·±è·Ÿä¸€ä¸‹ï¼Œæœ€åä¼šæ‰§è¡Œåˆ° 1234567891011121314status_t CameraClient::setPreviewTarget( const sp&lt;IGraphicBufferProducer&gt;&amp; bufferProducer) { ...... sp&lt;IBinder&gt; binder; sp&lt;ANativeWindow&gt; window; if (bufferProducer != 0) { binder = bufferProducer-&gt;asBinder(); // Using controlledByApp flag to ensure that the buffer queue remains in // async mode for the old camera API, where many applications depend // on that behavior. window = new Surface(bufferProducer, /*controlledByApp*/ true); //è¿™ä¸ªå®¶ä¼™ } return setPreviewWindow(binder, window);} 1234567891011121314151617181920212223242526272829303132333435status_t CameraClient::setPreviewWindow(const sp&lt;IBinder&gt;&amp; binder, const sp&lt;ANativeWindow&gt;&amp; window) { Mutex::Autolock lock(mLock); ...... if (window != 0) { result = native_window_api_connect(window.get(), NATIVE_WINDOW_API_CAMERA); if (result != NO_ERROR) { ALOGE(\"native_window_api_connect failed: %s (%d)\", strerror(-result), result); return result; } } // If preview has been already started, register preview buffers now. if (mHardware-&gt;previewEnabled()) { if (window != 0) { native_window_set_scaling_mode(window.get(), NATIVE_WINDOW_SCALING_MODE_SCALE_TO_WINDOW); native_window_set_buffers_transform(window.get(), mOrientation); result = mHardware-&gt;setPreviewWindow(window); } } if (result == NO_ERROR) { // Everything has succeeded. Disconnect the old window and remember the // new window. disconnectWindow(mPreviewWindow); mSurface = binder; mPreviewWindow = window; //è¿™é‡Œä¾¿æ˜¯èµ‹å€¼çš„æ“ä½œäº†ï¼Œåé¢æˆ‘ä»¬æ“ä½œçš„mPreviewWindow } else { // Something went wrong after we connected to the new window, so // disconnect here. disconnectWindow(window); } return result;} æ˜¯ä¸æ˜¯çœ‹çš„å¾ˆçœ¼ç†Ÿï¼Œå’ŒstartPreviewMode()çš„è¿‡ç¨‹æœ‰ç‚¹ç›¸ä¼¼ã€‚è¿™å°±æ˜¯mPreviewWindowçš„èµ‹å€¼è¿‡ç¨‹ã€‚ å›åˆ°setPreviewMode()å‡½æ•°ä¸­ï¼Œå…¶ä¸­ä¸»è¦çš„è¿‡ç¨‹æ˜¯è¿™ä¸¤ä¸ª mHardware-&gt;setPreviewWindow(mPreviewWindow); result = mHardware-&gt;startPreview(); è¿™é‡Œéƒ½æ˜¯HALå±‚çš„å¤„ç†ï¼Œå°†çª—å£ä¼ ä¸‹å»ï¼Œç„¶åå¯åŠ¨é¢„è§ˆï¼Œæœ€åæ•°æ®å°±å¯ä»¥æŠ•å°„åˆ°è¿™ä¸ªé¢„è§ˆçª—å£ä¸Šäº†ã€‚ æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ä¸€ä¸‹ï¼Œ CameraHardwareInterface.h (av\\services\\camera\\libcameraservice\\device1) 123456789101112131415/** Set the ANativeWindow to which preview frames are sent */status_t setPreviewWindow(const sp&lt;ANativeWindow&gt;&amp; buf){ ALOGV(\"%s(%s) buf %p\", __FUNCTION__, mName.string(), buf.get()); if (mDevice-&gt;ops-&gt;set_preview_window) { mPreviewWindow = buf; mHalPreviewWindow.user = this; ALOGV(\"%s &amp;mHalPreviewWindow %p mHalPreviewWindow.user %p\", __FUNCTION__, &amp;mHalPreviewWindow, mHalPreviewWindow.user); return mDevice-&gt;ops-&gt;set_preview_window(mDevice, buf.get() ? &amp;mHalPreviewWindow.nw : 0); } return INVALID_OPERATION;} 12345678910/** * Start preview mode. */ status_t startPreview() { ALOGV(\"%s(%s)\", __FUNCTION__, mName.string()); if (mDevice-&gt;ops-&gt;start_preview) return mDevice-&gt;ops-&gt;start_preview(mDevice); return INVALID_OPERATION; } è¿™æ˜¯ä¸€ä¸ªç©ºå£³ï¼Œæˆ‘ä»¬å»çœ‹å…·ä½“çš„å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¸‹android5.1æºç ä¸­Qcomçš„å®ç°ï¼Œç”±äºé’ˆå¯¹HALå±‚çš„ä¸åŒå‚å•†æœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±éšä¾¿æ‰¾ä¸ªç›®å½•ä¸‹çš„è¿›è¡Œåˆ†æï¼Œæ—¨åœ¨çœ‹æµç¨‹ï¼Œç†è§£ä¸€äº›åŸºç¡€çš„å†…å®¹ï¼Œ QCamera2Hal.cpp ï¼ˆ\\device\\asus\\flo\\camera\\qcamera2\\halï¼‰ 1234567891011121314151617181920212223#include \"QCamera2Factory.h\"static hw_module_t camera_common = { tag: HARDWARE_MODULE_TAG, module_api_version: CAMERA_MODULE_API_VERSION_1_0, hal_api_version: HARDWARE_HAL_API_VERSION, id: CAMERA_HARDWARE_MODULE_ID, name: \"QCamera Module\", author: \"Qualcomm Innovation Center Inc\", methods: &amp;qcamera::QCamera2Factory::mModuleMethods, dso: NULL, reserved: {0},};camera_module_t HAL_MODULE_INFO_SYM = { common: camera_common, get_number_of_cameras: qcamera::QCamera2Factory::get_number_of_cameras, get_camera_info: qcamera::QCamera2Factory::get_camera_info, set_callbacks: NULL, get_vendor_tag_ops: NULL, open_legacy: NULL, reserved: {0}}; è¿™é‡Œæä¸€ä¸‹HAL_MODULE_INFO_SYMè¿™ä¸ªä¸œè¥¿ï¼Œæœ¬èº«å°±æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨hardware.hä¸‹çš„ä¸€ä¸ªå®ï¼Œçœ‹æ³¨é‡Šï¼Œæ„æ€å¾ˆæ˜æ˜¾ 12define HAL_MODULE_INFO_SYM HMI //.soä¸­å°†ä¸€ä¸ªç¬¦å·HMI,è·å–æ­¤ç¬¦å·çš„åœ°å€ï¼Œå°±è·å–åˆ°äº†å¯¹åº”çš„hw_module_tåœ°å€ HAL_MODULE_INFO_SYMï¼Œè¿™ä¸ªæ˜¯HAL ç¼–è¯‘ç”Ÿæˆçš„soçš„å…¥å£ï¼ŒCameraServiceä¼šè·å–è¿™ä¸ªæ¥æ“ä½œso camera_commonæ˜¯é’ˆå¯¹HALè§„èŒƒå®šä¹‰çš„ä¸€äº›å†…å®¹ã€‚ Cameraçš„openæŒ‡å‘çš„æ˜¯&amp;qcamera::QCamera2Factory::mModuleMethodsä¸­çš„openæ–¹æ³•ï¼Œå¦‚ä¸‹ 123struct hw_module_methods_t QCamera2Factory::mModuleMethods = { open: QCamera2Factory::camera_device_open,}; è¿™ä¸ªæ–¹æ³•ä¸­æ‰“å¼€è®¾å¤‡èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°HALå±‚ä¸­opençš„è¿‡ç¨‹æ˜¯å¾ˆæœ‰è®²ç©¶çš„ï¼Œä¹Ÿä¸èƒ½è¿™ä¹ˆè¯´ï¼Œåº”ä¸ºHALçš„å¤„ç†æ–¹å¼åŸºæœ¬ä¸Šéƒ½æ˜¯å¦‚æ­¤ã€‚ 123456789101112131415int QCamera2Factory::camera_device_open( const struct hw_module_t *module, const char *id, struct hw_device_t **hw_device){ if (module != &amp;HAL_MODULE_INFO_SYM.common) { ALOGE(\"Invalid module. Trying to open %p, expect %p\", module, &amp;HAL_MODULE_INFO_SYM.common); return INVALID_OPERATION; } if (!id) { ALOGE(\"Invalid camera id\"); return BAD_VALUE; } return gQCamera2Factory.cameraDeviceOpen(atoi(id), hw_device);} 123456789101112131415161718int QCamera2Factory::cameraDeviceOpen(int camera_id, struct hw_device_t **hw_device){ int rc = NO_ERROR; if (camera_id &lt; 0 || camera_id &gt;= mNumOfCameras) return BAD_VALUE; //åˆ°è¿™é‡Œæ‰æ˜¯çœŸæ­£çš„HALå±‚çš„åˆ›å»ºï¼Œå¯è§HALå±‚çš„åˆ›å»ºå’Œopenæ“ä½œæ˜¯ç›¸å…³çš„ QCamera2HardwareInterface *hw = new QCamera2HardwareInterface(camera_id); if (!hw) { ALOGE(\"Allocation of hardware interface failed\"); return NO_MEMORY; } rc = hw-&gt;openCamera(hw_device); if (rc != NO_ERROR) { delete hw; } return rc;} ä¹‹å‰åœ¨CameraServiceè¿‡ç¨‹ä¸­æåˆ°çš„CameraHardwareInterfaceç©ºå£³å°±æ˜¯ä¸ºè¿™ä¸ªQCamera2HardwareInterfaceå‡†å¤‡çš„ï¼Œå…·ä½“å®ç°å…¨éƒ¨éƒ½åœ¨è¿™ä¸ªç±»ä¸­ã€‚ å…³äºQCamera2HardwareInterfaceçš„å†…å®¹æˆ‘ä»¬åœ¨åé¢ä¼šè®²åˆ°ï¼Œè¿™é‡Œæš‚ä¸”å…ˆæ”¾ä¸€ä¸‹ï¼Œæ¥ç€ä¸Šé¢çš„ mHardware-&gt;setPreviewWindow(mPreviewWindow); result = mHardware-&gt;startPreview(); ç»è¿‡CameraHardwareInterfaceå mDevice-&gt;ops-&gt;set_preview_window(mDevice, buf.get() ? &amp;mHalPreviewWindow.nw : 0); mDevice-&gt;ops-&gt;start_preview(mDevice); ç„¶åç»è¿‡QCamera2HardwareInterfaceä¸­çš„mCameraOpså‡½æ•°æŒ‡é’ˆå¯¹åº”è¡¨ set_preview_window: QCamera2HardwareInterface::set_preview_window start_preview: QCamera2HardwareInterface::start_preview æ‰€ä»¥ä¼šè°ƒç”¨åˆ° 123456789101112131415161718192021int QCamera2HardwareInterface::set_preview_window(struct camera_device *device, struct preview_stream_ops *window){ int rc = NO_ERROR; QCamera2HardwareInterface *hw = reinterpret_cast&lt;QCamera2HardwareInterface *&gt;(device-&gt;priv); if (!hw) { ALOGE(\"%s: NULL camera device\", __func__); return BAD_VALUE; } hw-&gt;lockAPI(); rc = hw-&gt;processAPI(QCAMERA_SM_EVT_SET_PREVIEW_WINDOW, (void *)window); if (rc == NO_ERROR) { hw-&gt;waitAPIResult(QCAMERA_SM_EVT_SET_PREVIEW_WINDOW); rc = hw-&gt;m_apiResult.status; } hw-&gt;unlockAPI(); return rc;} è¿™é‡Œä¼šç»è¿‡ä¸€è½®çŠ¶æ€æœºï¼Œæš‚æ—¶å…ˆä¸è®²ï¼Œç„¶åæ‰§è¡Œåˆ° int QCamera2HardwareInterface::setPreviewWindow( struct preview_stream_ops window) { mPreviewWindow = window; return NO_ERROR; } åŒç†ï¼ŒstartPreviewä¹Ÿä¼šæ‰§è¡Œåˆ° int QCamera2HardwareInterface::startPreview() { int32_t rc = NO_ERROR; ALOGD(â€œ%s: Eâ€, *func); // start preview stream if (mParameters.isZSLMode() &amp;&amp; mParameters.getRecordingHintValue() !=true) { rc = startChannel(QCAMERA_CH_TYPE_ZSL); } else { rc = startChannel(QCAMERA_CH_TYPE_PREVIEW); } ALOGD(â€œ%s: Xâ€, **func); return rc; } è¿™é‡Œå¼€å¯é€šé“ï¼Œå¯ä»¥ç†è§£æˆæ•°æ®é€šé“ï¼ŒZSLæ˜¯ä¹‹å‰æ²¡æœ‰çš„ï¼Œæ‰€è°“ZSLå°±æ˜¯è§¦å‘æ‹ç…§åä¸åœæ­¢é¢„è§ˆã€‚ è¿™é‡Œçœ‹åˆ°ä¼šæ ¹æ®å½“å‰æ˜¯éƒ½æ”¯æŒZSLæ¨¡å¼è€Œè¿›å…¥ä¸åŒçš„é€šé“ï¼Œæˆ‘ä»¬è¿™é‡Œå°±çœ‹QCAMERA_CH_TYPE_PREVIEWï¼ŒstartChannel 123456789int32_t QCamera2HardwareInterface::startChannel(qcamera_ch_type_enum_t ch_type){ int32_t rc = UNKNOWN_ERROR; if (m_channels[ch_type] != NULL) { rc = m_channels[ch_type]-&gt;start(); } return rc;} m_channelsæ˜¯ä¸åŒçš„é€šé“çš„å®ä¾‹çš„æ•°ç»„ï¼Œè¿™é‡Œå¦‚æœæ²¡æœ‰PREVIEWçš„channelå°±ç›´æ¥returnï¼Œå²‚ä¸æ˜¯æ— æ³•å¯åŠ¨é¢„è§ˆï¼Œè¿™ä¸ªæµç¨‹æ„Ÿè§‰æœ‰ç‚¹ä¸å¯¹åŠ²ã€‚ä½†æ˜¯è¿™æ•´ä¸ªè¿‡ç¨‹è·Ÿä¸‹æ¥ä¹Ÿæ²¡æœ‰çœ‹åˆ°m_channelsç›¸å…³çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚ è¿™ä¸ªé—®é¢˜å‡ºåœ¨æˆ‘åˆšæ‰ä»CameraHardwareInterfaceè·Ÿåˆ°QCamera2HardwareInterfaceçš„æ—¶å€™è·³è¿‡çš„ä¸€ä¸ªå†…å®¹â€”â€“çŠ¶æ€æœºï¼Œåœ¨çŠ¶æ€æœºä¸­ä¼šæ‰§è¡Œä¸€ä¸ªpreparePreview()çš„æ“ä½œ 12345678910111213141516171819202122232425262728293031323334353637int32_t QCamera2HardwareInterface::preparePreview(){ int32_t rc = NO_ERROR; if (mParameters.isZSLMode() &amp;&amp; mParameters.getRecordingHintValue() !=true) { rc = addChannel(QCAMERA_CH_TYPE_ZSL); //è¿™é‡Œæˆ‘ä»¬å°±æ·»åŠ äº†ä¸€ä¸ªchannel,å½“ç„¶è¿™é‡Œæ˜¯ZSLçš„ if (rc != NO_ERROR) { return rc; } } else { bool recordingHint = mParameters.getRecordingHintValue(); //recording if(recordingHint) { rc = addChannel(QCAMERA_CH_TYPE_SNAPSHOT); //å½•åƒä¸­æ˜¯å¯ä»¥æ‹ç…§çš„ï¼Œéœ€è¦snapshot channel if (rc != NO_ERROR) { return rc; } rc = addChannel(QCAMERA_CH_TYPE_VIDEO); //video channel if (rc != NO_ERROR) { delChannel(QCAMERA_CH_TYPE_SNAPSHOT); return rc; } } rc = addChannel(QCAMERA_CH_TYPE_PREVIEW); //æ·»åŠ preview channel if (rc != NO_ERROR) { if (recordingHint) { delChannel(QCAMERA_CH_TYPE_SNAPSHOT); delChannel(QCAMERA_CH_TYPE_VIDEO); } return rc; } } return rc;} åœ¨addchannel()çš„è¿‡ç¨‹ä¸­ä¼šæ ¹æ®ä¸åŒçš„channelç±»å‹åˆ›å»ºä¸åŒçš„å®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥çœ‹ä»addChannel()è½¬åˆ°çš„addPreviewChannel()å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940int32_t QCamera2HardwareInterface::addPreviewChannel(){ int32_t rc = NO_ERROR; QCameraChannel *pChannel = NULL; //åˆå§‹åŒ–ä¸€ä¸ªQCameraChanelï¼Œåé¢è¦ä½¿ç”¨ if (m_channels[QCAMERA_CH_TYPE_PREVIEW] != NULL) { // if we had preview channel before, delete it first delete m_channels[QCAMERA_CH_TYPE_PREVIEW]; //å¦‚æœä¹‹å‰preview channelå­˜åœ¨ï¼Œå¹²æ‰ m_channels[QCAMERA_CH_TYPE_PREVIEW] = NULL; } pChannel = new QCameraChannel(mCameraHandle-&gt;camera_handle, mCameraHandle-&gt;ops); //new ä¸€ä¸ªæ–°çš„channel ..... // meta data stream always coexists with preview if applicable rc = addStreamToChannel(pChannel, CAM_STREAM_TYPE_METADATA, metadata_stream_cb_routine, this); //æ·»åŠ metadata stream cb if (rc != NO_ERROR) { ALOGE(\"%s: add metadata stream failed, ret = %d\", __func__, rc); delete pChannel; return rc; } if (isNoDisplayMode()) { //åˆ¤æ–­æ˜¯å¦ä¸ºä¸éœ€è¦æ˜¾ç¤ºçš„æ¨¡å¼ rc = addStreamToChannel(pChannel, CAM_STREAM_TYPE_PREVIEW, nodisplay_preview_stream_cb_routine, this); } else { //è¿™é‡Œæ·»åŠ preview stream cbåˆ°channelä¸­ rc = addStreamToChannel(pChannel, CAM_STREAM_TYPE_PREVIEW, preview_stream_cb_routine, this); } if (rc != NO_ERROR) { ALOGE(\"%s: add preview stream failed, ret = %d\", __func__, rc); delete pChannel; return rc; } m_channels[QCAMERA_CH_TYPE_PREVIEW] = pChannel; //ç»´æŠ¤m_channelsæ•°æ® return rc;} è¿™é‡Œæ³¨å†Œçš„preview_stream_cb_routineå›è°ƒï¼Œè¿™ä¹‹åçš„è¿‡ç¨‹æˆ‘ä»¬æš‚æ—¶å…ˆä¸å»çœ‹ï¼Œäº†è§£è¿™éƒ¨åˆ†ä¹‹åï¼Œå›åˆ°ä¹‹å‰chanel çš„start()ï¼Œæœ€åä¼šæ‰§è¡Œåˆ°QCameraChannel::start()æ–¹æ³•ï¼Œè¿™é‡Œå¾€ä¸‹çš„å†…å®¹æˆ‘ä»¬æš‚æ—¶ä¸å¾€ä¸‹çœ‹ï¼ŒçŸ¥é“è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šæ‰§è¡Œæ•°æ®é‡‡é›†ï¼Œç„¶åè¿”å›ç»™HALå±‚å°±è¡Œäº†ï¼ŒHALé’ˆå¯¹åº•å±‚è¿”å›çš„æ•°æ®ï¼Œæˆ‘ä»¬åœ¨å“ªé‡Œè·å–ï¼Œåšä»€ä¹ˆå¯¹åº”çš„å¤„ç†å‘¢ï¼Ÿæ‰¾åˆ°ä¹‹å‰æ³¨å†Œçš„Callback. QCamera2HWICallbacks.cpp (\\device\\asus\\flo\\camera\\qcamera2\\hal) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657void QCamera2HardwareInterface::preview_stream_cb_routine(mm_camera_super_buf_t *super_frame, QCameraStream * stream, void *userdata){ ALOGD(\"[KPI Perf] %s : BEGIN\", __func__); int err = NO_ERROR; QCamera2HardwareInterface *pme = (QCamera2HardwareInterface *)userdata; QCameraGrallocMemory *memory = (QCameraGrallocMemory *)super_frame-&gt;bufs[0]-&gt;mem_info; ...... mm_camera_buf_def_t *frame = super_frame-&gt;bufs[0]; ...... if (!pme-&gt;needProcessPreviewFrame()) { ALOGE(\"%s: preview is not running, no need to process\", __func__); stream-&gt;bufDone(frame-&gt;buf_idx); free(super_frame); return; } if (pme-&gt;needDebugFps()) { pme-&gt;debugShowPreviewFPS(); } int idx = frame-&gt;buf_idx; pme-&gt;dumpFrameToFile(frame-&gt;buffer, frame-&gt;frame_len, frame-&gt;frame_idx, QCAMERA_DUMP_FRM_PREVIEW); //è¿™é‡Œçš„æ³¨é‡Šå¾ˆæ˜æ˜¾ï¼Œdisplayer bufferè€Œè¿™ä¸ªbufferå°±æ˜¯æˆ‘ä»¬éœ€è¦æŠ•å°„åˆ°å±å¹•ä¸Šçš„æ•°æ® // Display the buffer. int dequeuedIdx = memory-&gt;displayBuffer(idx); //è¿™éƒ¨åˆ†æ¶‰åŠåˆ°æ˜¾ç¤ºçš„è¿‡ç¨‹ï¼Œè¿™é‡Œä¸åšèµ˜è¿° if (dequeuedIdx &lt; 0 || dequeuedIdx &gt;= memory-&gt;getCnt()) { ALOGD(\"%s: Invalid dequeued buffer index %d from display\", __func__, dequeuedIdx); } else { // Return dequeued buffer back to driver err = stream-&gt;bufDone(dequeuedIdx); if ( err &lt; 0) { ALOGE(\"stream bufDone failed %d\", err); } } //é’ˆå¯¹ä¸Šå±‚è®¾ç½®çš„datacallbackè¿‡ç¨‹åšäº›å¤„ç† // Handle preview data callback if (pme-&gt;mDataCb != NULL &amp;&amp; pme-&gt;msgTypeEnabledWithLock(CAMERA_MSG_PREVIEW_FRAME) &gt; 0) { ...... qcamera_callback_argm_t cbArg; memset(&amp;cbArg, 0, sizeof(qcamera_callback_argm_t)); cbArg.cb_type = QCAMERA_DATA_CALLBACK; cbArg.msg_type = CAMERA_MSG_PREVIEW_FRAME; cbArg.data = data; if ( previewMem ) { cbArg.user_data = previewMem; cbArg.release_cb = releaseCameraMemory; } cbArg.cookie = pme; pme-&gt;m_cbNotifier.notifyCallback(cbArg); //å°è£…å®Œä¹‹åå¾€ä¸Šç”© } free(super_frame); ALOGD(\"[KPI Perf] %s : END\", __func__); return;} è¿™å°±æ˜¯åœ¨addPreviewChannelçš„è¿‡ç¨‹ä¸­æ·»åŠ çš„preview stream callbackï¼Œå½“ç„¶è¿˜æœ‰metadataçš„ï¼Œæš‚æ—¶å…ˆçœ‹previewçš„è¿™ä¸ªã€‚è¿™é‡Œé¢ä½œçš„æ“ä½œå°±æ˜¯æ˜¾ç¤ºé¢„è§ˆæ•°æ®åˆ°çª—å£ä¸­ï¼Œç„¶åå¯¹è®¾ç½®ä¸‹é¢çš„preview callbackåšå¯¹åº”çš„callbackå¤„ç†. è®²åˆ°è¿™é‡Œï¼ŒCameraçš„é¢„è§ˆè¿‡ç¨‹åŸºæœ¬ä¸Šå°±ç»“æŸäº†ï¼Œå…³äºåº•å±‚å¦‚æœé‡‡é›†æ•°æ®ä»¥åŠHALä¸­ä¸€äº›å…¶ä»–çš„å†…å®¹ï¼Œåœ¨è¿™é‡Œæ²¡æœ‰è®²è§£ï¼Œä¸»è¦æ˜¯è¦ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹‹åå†æ¯ä¸€ä¸ªè¿‡ç¨‹ä¸­åœ¨å¾€ä¸‹å­¦ä¹ ã€‚ æœ¬æ–‡ä¸­ä»£ç ä½¿ç”¨çš„æ˜¯Android5.1åŸå§‹ä»£ç ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€äº¤æµã€‚","link":"/2015/08/23/ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆäºŒï¼‰/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆä¸‰ï¼‰","text":"ä¸Šä¸€æ¬¡è®²è§£äº†ä¸€ä¸‹startPreviewè¿‡ç¨‹ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç”»å‡ºä¸€æ¡å¤§è‡´çš„ä»ä¸Šåˆ°ä¸‹çš„çº¿æ¡ï¼Œä»Šå¤©æˆ‘ä»¬çœ‹ä¸€ä¸‹Cameraåœ¨Frameworkçš„sendCommandå’ŒdataCallbackï¼Œè¿™éƒ¨åˆ†å±äºè¡”æ¥è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸Šä¸‹æ˜¯å¦‚ä½•äº¤æµæ²Ÿé€šçš„ã€‚ é¦–å…ˆï¼ŒsendCommand Camera.javaä¸­å¹¶æ²¡æœ‰sendCommandæ–¹æ³•ï¼Œåœ¨Camera.cppä¸­å­˜åœ¨sendCommandå‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªsendCommandæ˜¯ä»android_hardware_interface.cppä¸­å¼€å§‹ä½¿ç”¨çš„ android_hardware_Camera.cpp (base\\core\\jni) startSmoothZoom android_hardware_Camera_startSmoothZoom â€”â€”&gt;CAMERA_CMD_START_SMOOTH_ZOOM stopSmoothZoom android_hardware_Camera_stopSmoothZoom â€”â€”&gt;CAMERA_CMD_STOP_SMOOTH_ZOOM setDisplayOrientation android_hardware_Camera_setDisplayOrientation â€”â€”&gt;CAMERA_CMD_SET_DISPLAY_ORIENTATION _enableShutterSound android_hardware_Camera_enableShutterSound â€”â€”&gt;CAMERA_CMD_ENABLE_SHUTTER_SOUND _startFaceDetection android_hardware_Camera_startFaceDetection â€”â€”&gt;CAMERA_CMD_START_FACE_DETECTION _stopFaceDetection android_hardware_Camera_stopFaceDetection â€”â€”&gt;CAMERA_CMD_STOP_FACE_DETECTION enableFocusMoveCallback android_hardware_Camera_enableFocusMoveCallback â€”â€”&gt;CAMERA_CMD_ENABLE_FOCUS_MOVE_MSG è¯¸å¦‚æ­¤ç±»çš„å‘½ä»¤ç±»å‹å®šä¹‰åœ¨Camera.h (system\\core\\include\\system) enum { CAMERA_CMD_START_SMOOTH_ZOOM = 1, CAMERA_CMD_STOP_SMOOTH_ZOOM = 2, CAMERA_CMD_SET_DISPLAY_ORIENTATION = 3, CAMERA_CMD_ENABLE_SHUTTER_SOUND = 4, CAMERA_CMD_PLAY_RECORDING_SOUND = 5, CAMERA_CMD_START_FACE_DETECTION = 6, CAMERA_CMD_STOP_FACE_DETECTION = 7, CAMERA_CMD_ENABLE_FOCUS_MOVE_MSG = 8, CAMERA_CMD_PING = 9, CAMERA_CMD_SET_VIDEO_BUFFER_COUNT = 10, }; ä»¥ä¸Šè€…å‡ ç§æ“ä½œéƒ½æ˜¯é‡‡ç”¨sendCommand()çš„å‡½æ•°æ¥å®ç°çš„ï¼Œå¯¹åº”çš„å‘½ä»¤ç±»å‹ä¹Ÿåˆ—ä¸¾å‡ºæ¥äº†ï¼ŒHALå±‚ä¼šæ ¹æ®è¿™ä¸ªæ¶ˆæ¯ç±»å‹åšå‡ºåˆ¤æ–­ï¼Œç„¶ååšå‡ºå¯¹åº”çš„æ“ä½œã€‚ æ¥çœ‹ä¸‹sendCommandçš„å®ç°ï¼š Camera.cpp (frameworks\\av\\camera) 12345678// send command to camera driverstatus_t Camera::sendCommand(int32_t cmd, int32_t arg1, int32_t arg2){ ALOGV(\"sendCommand\"); sp &lt;ICamera&gt; c = mCamera; if (c == 0) return NO_INIT; return c-&gt;sendCommand(cmd, arg1, arg2); //ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ¶ˆæ¯ç±»å‹ï¼Œåé¢ä¸¤ä¸ªå‚æ•°æœ‰æ—¶å€™ä½¿ç”¨æœ‰æ—¶ä¸ä½¿ç”¨ï¼Œè¿™é‡Œåº”è¯¥æ˜¯å…·æœ‰æ‰©å±•æ€§çš„ï¼Œå¦‚æœéœ€è¦æ·»åŠ æ›´å¤šçš„å‚æ•°ï¼Œä¸Šä¸‹æ¥å£åŒæ—¶ä¿®æ”¹å°±å¯ä»¥äº†ã€‚} ç„¶åé€šè¿‡Binderæœºåˆ¶ï¼Œ 1234567891011virtual status_t sendCommand(int32_t cmd, int32_t arg1, int32_t arg2){ ALOGV(\"sendCommand\"); Parcel data, reply; data.writeInterfaceToken(ICamera::getInterfaceDescriptor()); data.writeInt32(cmd); data.writeInt32(arg1); data.writeInt32(arg2); remote()-&gt;transact(SEND_COMMAND, data, &amp;reply); return reply.readInt32();} 1234567891011121314status_t BnCamera::onTransact( uint32_t code, const Parcel&amp; data, Parcel* reply, uint32_t flags){ ...... case SEND_COMMAND: { ALOGV(\"SEND_COMMAND\"); CHECK_INTERFACE(ICamera, data, reply); int command = data.readInt32(); int arg1 = data.readInt32(); int arg2 = data.readInt32(); reply-&gt;writeInt32(sendCommand(command, arg1, arg2)); return NO_ERROR; } break;} ç„¶åè°ƒç”¨åˆ° 123456789101112131415161718192021222324252627282930313233343536status_t CameraClient::sendCommand(int32_t cmd, int32_t arg1, int32_t arg2) { ...... if (cmd == CAMERA_CMD_SET_DISPLAY_ORIENTATION) { // Mirror the preview if the camera is front-facing. orientation = getOrientation(arg1, mCameraFacing == CAMERA_FACING_FRONT); if (orientation == -1) return BAD_VALUE; if (mOrientation != orientation) { mOrientation = orientation; if (mPreviewWindow != 0) { native_window_set_buffers_transform(mPreviewWindow.get(), mOrientation); } } return OK; } else if (cmd == CAMERA_CMD_ENABLE_SHUTTER_SOUND) { switch (arg1) { //è¿™é‡Œå°±æ˜¯å¯¹å‚æ•°arg1çš„ä½¿ç”¨ï¼Œé€šè¿‡å‚æ•°æ¥å¼€å…³æ‹ç…§å£°éŸ³ case 0: return enableShutterSound(false); case 1: return enableShutterSound(true); default: return BAD_VALUE; } return OK; } else if (cmd == CAMERA_CMD_PLAY_RECORDING_SOUND) { //å½•åƒå£°éŸ³ mCameraService-&gt;playSound(CameraService::SOUND_RECORDING); } else if (cmd == CAMERA_CMD_SET_VIDEO_BUFFER_COUNT) { // Silently ignore this command return INVALID_OPERATION; } else if (cmd == CAMERA_CMD_PING) { // If mHardware is 0, checkPidAndHardware will return error. return OK; } //ä»¥ä¸Šæ˜¯frameworkå¯ä»¥å¤„ç†çš„å‘½ä»¤ return mHardware-&gt;sendCommand(cmd, arg1, arg2); //HALå±‚å¤„ç†} åœ¨HALå±‚ä¸­å¤„ç†çš„æ¶ˆæ¯ç±»å‹ä¸»è¦æ˜¯æ‰“å¼€å’Œåœæ­¢äººè„¸æ£€æµ‹è¿‡ç¨‹ï¼ŒQCamera2HWI.cpp (\\device\\asus\\flo\\camera\\qcamera2\\hal) 123456789101112131415int QCamera2HardwareInterface::sendCommand(int32_t command, int32_t /*arg1*/, int32_t /*arg2*/){ int rc = NO_ERROR; switch (command) { case CAMERA_CMD_START_FACE_DETECTION: case CAMERA_CMD_STOP_FACE_DETECTION: //å¼€å…³äººè„¸æ£€æµ‹ rc = setFaceDetection(command == CAMERA_CMD_START_FACE_DETECTION? true : false); break; default: rc = NO_ERROR; break; } return rc;} ç»¼ä¸Šï¼Œå¦‚ä¸Šå°±æ˜¯sendCommandçš„è¿‡ç¨‹ ç„¶åï¼Œå›è°ƒCallback ä»ä¹‹å‰çš„æ–‡ç« å¯ä»¥çœ‹åˆ°callbackä¸»è¦æœ‰ä¸‰ç§ç±»å‹ notifyCallback dataCallback dataTimestampCallback è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬å°±ä¸èƒ½æŒ‰ç…§ä¹‹å‰çš„ä»ä¸Šè‡³ä¸‹çš„è·Ÿè¿‡ç¨‹äº†ï¼Œè¿™æ¬¡éœ€è¦åç€æ¥ï¼Œä»HALå±‚å›è°ƒåˆ° CameraHardwareInterface.h (frameworks\\av\\services\\camera\\libcameraservice\\device1) 12345678910111213141516171819202122232425262728293031static void __notify_cb(int32_t msg_type, int32_t ext1, int32_t ext2, void *user){ ALOGV(\"%s\", __FUNCTION__); CameraHardwareInterface *__this = static_cast&lt;CameraHardwareInterface *&gt;(user); __this-&gt;mNotifyCb(msg_type, ext1, ext2, __this-&gt;mCbUser);}static void __data_cb(int32_t msg_type, const camera_memory_t *data, unsigned int index, camera_frame_metadata_t *metadata, void *user){ ALOGV(\"%s\", __FUNCTION__); CameraHardwareInterface *__this = static_cast&lt;CameraHardwareInterface *&gt;(user); ...... __this-&gt;mDataCb(msg_type, mem-&gt;mBuffers[index], metadata, __this-&gt;mCbUser);}static void __data_cb_timestamp(nsecs_t timestamp, int32_t msg_type, const camera_memory_t *data, unsigned index, void *user){ ALOGV(\"%s\", __FUNCTION__); CameraHardwareInterface *__this = static_cast&lt;CameraHardwareInterface *&gt;(user); ...... __this-&gt;mDataCbTimestamp(timestamp, msg_type, mem-&gt;mBuffers[index], __this-&gt;mCbUser);} å…¶ä¸­çš„mNotifyCbï¼ŒmDataCbï¼ŒmDataCbTimestampæ˜¯åœ¨CameraClient::initializeå‡½æ•°ä¸­è®¾ç½®çš„ 123456789101112131415161718192021void setCallbacks(notify_callback notify_cb, data_callback data_cb, data_callback_timestamp data_cb_timestamp, void* user){ mNotifyCb = notify_cb; mDataCb = data_cb; mDataCbTimestamp = data_cb_timestamp; mCbUser = user; ALOGV(\"%s(%s)\", __FUNCTION__, mName.string()); if (mDevice-&gt;ops-&gt;set_callbacks) { mDevice-&gt;ops-&gt;set_callbacks(mDevice, __notify_cb, __data_cb, __data_cb_timestamp, __get_memory, this); }} å›è°ƒè‡ªç„¶æ˜¯åˆ°CameraClientä¸­å»æ‰¾äº† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647void CameraClient::notifyCallback(int32_t msgType, int32_t ext1, int32_t ext2, void* user) { ......}void CameraClient::dataCallback(int32_t msgType, const sp&lt;IMemory&gt;&amp; dataPtr, camera_frame_metadata_t *metadata, void* user) { LOG2(\"dataCallback(%d)\", msgType); Mutex* lock = getClientLockFromCookie(user); if (lock == NULL) return; Mutex::Autolock alock(*lock); CameraClient* client = static_cast&lt;CameraClient*&gt;(getClientFromCookie(user)); if (client == NULL) return; if (!client-&gt;lockIfMessageWanted(msgType)) return; if (dataPtr == 0 &amp;&amp; metadata == NULL) { ALOGE(\"Null data returned in data callback\"); client-&gt;handleGenericNotify(CAMERA_MSG_ERROR, UNKNOWN_ERROR, 0); return; } switch (msgType &amp; ~CAMERA_MSG_PREVIEW_METADATA) { case CAMERA_MSG_PREVIEW_FRAME: client-&gt;handlePreviewData(msgType, dataPtr, metadata); break; case CAMERA_MSG_POSTVIEW_FRAME: client-&gt;handlePostview(dataPtr); break; case CAMERA_MSG_RAW_IMAGE: client-&gt;handleRawPicture(dataPtr); break; case CAMERA_MSG_COMPRESSED_IMAGE: client-&gt;handleCompressedPicture(dataPtr); break; default: client-&gt;handleGenericData(msgType, dataPtr, metadata); break; }}void CameraClient::dataCallbackTimestamp(nsecs_t timestamp, int32_t msgType, const sp&lt;IMemory&gt;&amp; dataPtr, void* user) { ......} è¿™é‡Œä¸»è¦çœ‹ä¸‹dataCallbackçš„è¿‡ç¨‹å§ï¼Œ 1234567891011121314151617switch (msgType &amp; ~CAMERA_MSG_PREVIEW_METADATA) { case CAMERA_MSG_PREVIEW_FRAME: //é¢„è§ˆå¸§æ•°æ® client-&gt;handlePreviewData(msgType, dataPtr, metadata); break; case CAMERA_MSG_POSTVIEW_FRAME: //postview image client-&gt;handlePostview(dataPtr); break; case CAMERA_MSG_RAW_IMAGE: //åŸå§‹æ•°æ® client-&gt;handleRawPicture(dataPtr); break; case CAMERA_MSG_COMPRESSED_IMAGE: //çœŸå®å›¾ç‰‡ client-&gt;handleCompressedPicture(dataPtr); break; default: client-&gt;handleGenericData(msgType, dataPtr, metadata); break;} è¿™é‡Œæœ€åä¼šè°ƒç”¨åˆ° c-&gt;dataCallbackï¼Œç„¶åæ ¹æ®æ¶ˆæ¯ç±»å‹æ¥åšå¤„ç†ï¼Œç„¶ååœ¨é€šè¿‡binderæœºåˆ¶ 123456789101112131415// generic data callback from camera service to app with image datavoid dataCallback(int32_t msgType, const sp&lt;IMemory&gt;&amp; imageData, camera_frame_metadata_t *metadata){ ALOGV(\"dataCallback\"); Parcel data, reply; data.writeInterfaceToken(ICameraClient::getInterfaceDescriptor()); data.writeInt32(msgType); data.writeStrongBinder(imageData-&gt;asBinder()); if (metadata) { data.writeInt32(metadata-&gt;number_of_faces); data.write(metadata-&gt;faces, sizeof(camera_face_t) * metadata-&gt;number_of_faces); } remote()-&gt;transact(DATA_CALLBACK, data, &amp;reply, IBinder::FLAG_ONEWAY);} 1234567891011121314151617181920212223status_t BnCameraClient::onTransact( uint32_t code, const Parcel&amp; data, Parcel* reply, uint32_t flags){ switch(code) { ...... case DATA_CALLBACK: { ALOGV(\"DATA_CALLBACK\"); CHECK_INTERFACE(ICameraClient, data, reply); int32_t msgType = data.readInt32(); sp&lt;IMemory&gt; imageData = interface_cast&lt;IMemory&gt;(data.readStrongBinder()); camera_frame_metadata_t *metadata = NULL; if (data.dataAvail() &gt; 0) { metadata = new camera_frame_metadata_t; metadata-&gt;number_of_faces = data.readInt32(); metadata-&gt;faces = (camera_face_t *) data.readInplace( sizeof(camera_face_t) * metadata-&gt;number_of_faces); } dataCallback(msgType, imageData, metadata); if (metadata) delete metadata; return NO_ERROR; } break; ......} è¿™é‡Œè½¬åˆ°Camera.cpp 12345678910111213// callback from camera service when frame or image is readyvoid Camera::dataCallback(int32_t msgType, const sp&lt;IMemory&gt;&amp; dataPtr, camera_frame_metadata_t *metadata){ sp&lt;CameraListener&gt; listener; { Mutex::Autolock _l(mLock); listener = mListener; } if (listener != NULL) { listener-&gt;postData(msgType, dataPtr, metadata); }} é€šè¿‡listenerçš„æ–¹å¼æ¥å¾€ä¸Šå±‚ç”©æ•°æ®ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¿™ä¸ªlisteneræ˜¯ä»€ä¹ˆæ—¶å€™è®¾ç½®çš„ï¼Ÿ å›æƒ³ä¸€ä¸‹ç¬¬ä¸€ç¯‡FWKåˆ†æåšå®¢ä¸­çš„native_setupè¿‡ç¨‹ä¸­æœ‰è¿™ä¹ˆä¸€æ®µ 123sp&lt;JNICameraContext&gt; context = new JNICameraContext(env, weak_this, clazz, camera);context-&gt;incStrong((void*)android_hardware_Camera_native_setup);camera-&gt;setListener(context); å°±æ˜¯åœ¨è¿™é‡Œè®¾ç½®çš„listener,JNICameraContextç»§æ‰¿CameraListenerï¼Œå¤å†™çˆ¶ç±»çš„æ–¹æ³• 123456789101112class JNICameraContext: public CameraListener{ ...... }class CameraListener: virtual public RefBase{public: virtual void notify(int32_t msgType, int32_t ext1, int32_t ext2) = 0; virtual void postData(int32_t msgType, const sp&lt;IMemory&gt;&amp; dataPtr, camera_frame_metadata_t *metadata) = 0; virtual void postDataTimestamp(nsecs_t timestamp, int32_t msgType, const sp&lt;IMemory&gt;&amp; dataPtr) = 0;}; æ‰¿æ¥ä¸Šé¢é‚£ä¸€æ®µï¼Œè¿™é‡Œæˆ‘ä»¬åªçœ‹postData() android_hardware_Camera.cpp (frameworks\\base\\core\\jni) 1234567891011121314151617181920212223242526272829303132333435363738void JNICameraContext::postData(int32_t msgType, const sp&lt;IMemory&gt;&amp; dataPtr, camera_frame_metadata_t *metadata){ ...... int32_t dataMsgType = msgType &amp; ~CAMERA_MSG_PREVIEW_METADATA; // return data based on callback type switch (dataMsgType) { case CAMERA_MSG_VIDEO_FRAME: // should never happen break; // For backward-compatibility purpose, if there is no callback // buffer for raw image, the callback returns null. case CAMERA_MSG_RAW_IMAGE: ALOGV(\"rawCallback\"); if (mRawImageCallbackBuffers.isEmpty()) { env-&gt;CallStaticVoidMethod(mCameraJClass, fields.post_event, mCameraJObjectWeak, dataMsgType, 0, 0, NULL); } else { copyAndPost(env, dataPtr, dataMsgType); } break; // There is no data. case 0: break; default: ALOGV(\"dataCallback(%d, %p)\", dataMsgType, dataPtr.get()); copyAndPost(env, dataPtr, dataMsgType); break; } // post frame metadata to Java if (metadata &amp;&amp; (msgType &amp; CAMERA_MSG_PREVIEW_METADATA)) { postMetadata(env, CAMERA_MSG_PREVIEW_METADATA, metadata);//è¿™é‡Œæœ‰äººè„¸æ•°æ® }} è¿™é‡Œæ¶‰åŠåˆ°çš„ env-&gt;CallStaticVoidMethod(mCameraJClass, fields.post_event, mCameraJObjectWeak, dataMsgType, 0, 0, NULL); copyAndPost(env, dataPtr, dataMsgType); postMetadata(env, CAMERA_MSG_PREVIEW_METADATA, metadata); ç›´æ¥æˆ–é—´æ¥çš„ä½¿ç”¨åˆ°fileds.post_eventå‡½æ•°ï¼Œè¿™é‡Œæ˜¯JNIä¸­çš„æ–¹æ³•æ³¨å†Œï¼Œ fields.post_event = env-&gt;GetStaticMethodID(clazz, â€œpostEventFromNativeâ€, â€œ(Ljava/lang/Object;IIILjava/lang/Object;)Vâ€); è¿™ä¸ªæ˜¯åœ¨register_android_hardware_Camera()å‡½æ•°ä¸­è°ƒç”¨çš„ï¼Œè¿™é‡Œä¸åšè¿‡å¤šåœç•™ï¼Œè¿™ä¸ªå®é™…ä¼šè°ƒç”¨åˆ° Camera.java (frameworks\\base\\core\\java\\android\\hardware) 123456789101112private static void postEventFromNative(Object camera_ref, int what, int arg1, int arg2, Object obj){ Camera c = (Camera)((WeakReference)camera_ref).get(); if (c == null) return; if (c.mEventHandler != null) { Message m = c.mEventHandler.obtainMessage(what, arg1, arg2, obj); c.mEventHandler.sendMessage(m); }} è¿™é‡Œä¹Ÿæ˜¯é‡‡ç”¨äº†JAVAä¸­å¾ˆå¸¸ç”¨çš„handler messageå¤„ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596private class EventHandler extends Handler{ private final Camera mCamera; public EventHandler(Camera c, Looper looper) { super(looper); mCamera = c; } @Override public void handleMessage(Message msg) { switch(msg.what) { case CAMERA_MSG_SHUTTER: if (mShutterCallback != null) { mShutterCallback.onShutter(); } return; case CAMERA_MSG_RAW_IMAGE: if (mRawImageCallback != null) { mRawImageCallback.onPictureTaken((byte[])msg.obj, mCamera); } return; case CAMERA_MSG_COMPRESSED_IMAGE: if (mJpegCallback != null) { mJpegCallback.onPictureTaken((byte[])msg.obj, mCamera); } return; case CAMERA_MSG_PREVIEW_FRAME: PreviewCallback pCb = mPreviewCallback; if (pCb != null) { if (mOneShot) { // Clear the callback variable before the callback // in case the app calls setPreviewCallback from // the callback function mPreviewCallback = null; } else if (!mWithBuffer) { // We're faking the camera preview mode to prevent // the app from being flooded with preview frames. // Set to oneshot mode again. setHasPreviewCallback(true, false); } pCb.onPreviewFrame((byte[])msg.obj, mCamera); } return; case CAMERA_MSG_POSTVIEW_FRAME: if (mPostviewCallback != null) { mPostviewCallback.onPictureTaken((byte[])msg.obj, mCamera); } return; case CAMERA_MSG_FOCUS: AutoFocusCallback cb = null; synchronized (mAutoFocusCallbackLock) { cb = mAutoFocusCallback; } if (cb != null) { boolean success = msg.arg1 == 0 ? false : true; cb.onAutoFocus(success, mCamera); } return; case CAMERA_MSG_ZOOM: if (mZoomListener != null) { mZoomListener.onZoomChange(msg.arg1, msg.arg2 != 0, mCamera); } return; case CAMERA_MSG_PREVIEW_METADATA: if (mFaceListener != null) { mFaceListener.onFaceDetection((Face[])msg.obj, mCamera); } return; case CAMERA_MSG_ERROR : Log.e(TAG, \"Error \" + msg.arg1); if (mErrorCallback != null) { mErrorCallback.onError(msg.arg1, mCamera); } return; case CAMERA_MSG_FOCUS_MOVE: if (mAutoFocusMoveCallback != null) { mAutoFocusMoveCallback.onAutoFocusMoving(msg.arg1 == 0 ? false : true, mCamera); } return; default: Log.e(TAG, \"Unknown message type \" + msg.what); return; } }} åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸Šå±‚çš„å¤„ç†äº†ï¼Œcallbackéƒ½æ˜¯åœ¨ç›¸æœºåº”ç”¨ä¸­è®¾ç½®çš„ï¼Œç„¶åå„ç§æ•°æ®å°±åœ¨ç›¸æœºåº”ç”¨ä¸­å¾—åˆ°å¯¹åº”çš„å¤„ç†ã€‚ å…·ä½“çš„æ¯ä¸€ä¸ªæ•°æ®æ€ä¹ˆå¤„ç†ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸åšåˆ†æï¼Œåç»­æœ‰éœ€è¦ï¼Œå¯ä»¥åœ¨ç»†è®²ä¸€ä¸‹ï¼Œæ—¨åœ¨å¼„æ¸…æ¥šä»£ç æ˜¯æ€ä¹ˆèµ°çš„ã€‚ æœ¬æ–‡ä¸­ä»£ç ä½¿ç”¨çš„æ˜¯Android5.1åŸå§‹ä»£ç ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€äº¤æµã€‚","link":"/2015/08/30/ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 Camera Frameworkï¼ˆä¸‰ï¼‰/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹BootAnimationï¼ˆ2ï¼‰","text":"å‰è¨€ ä¸Šä¸€ç¯‡ä¸»è¦è®²è§£äº†BootAnimationæ˜¯ä»ä½•è€Œæ¥ï¼Œå¦‚ä½•å¯åŠ¨ï¼Œä»å¼€æœºï¼Œåˆ°SurfaceFlingeræœåŠ¡èµ·æ¥ï¼Œç„¶ååˆ°æ‰§è¡Œå¼€æœºåŠ¨ç”»ï¼Œå¦‚æœè¦æ·±å…¥çš„çœ‹é‡Œé¢çš„ä»£ç ï¼Œæ˜¯éœ€è¦èŠ±ä¸€å®šçš„æ—¶é—´çš„ï¼Œæˆ‘ä»¬æ—¨åœ¨äº†è§£å¤§è‡´çš„æµç¨‹ï¼Œå…·ä½“æµç¨‹ä¸­çš„å‡½æ•°ï¼Œå˜é‡æ„ä¹‰ï¼Œå…·ä½“å®ç°ï¼Œè¯»è€…è¯·è‡ªç ”ã€‚ ç”±æ¥å·²çŸ¥ï¼Œæ‰§è¡Œå¾…è¿°~ BootAnimationæ‰§è¡Œä»£ç ä½ç½®frameworks/base/cmds/bootanimationç›®å½•ä¸­åŒ…å«å¦‚ä¸‹æ–‡ä»¶ æ–‡ä»¶å ä½œç”¨ Android.mk mkæ–‡ä»¶ï¼Œç¼–è¯‘æ¨¡å—ä½¿ç”¨ AudioPlayer.cppã€AudioPlayer.h éŸ³é¢‘æ’­æ”¾ BootAnimation.cppã€BootAnimation.h å¼€æœºåŠ¨ç”»çš„æºæ–‡ä»¶å’Œå¤´æ–‡ä»¶ bootanimation_main.cpp å¼€æœºåŠ¨ç”»çš„å…¥å£ æºç åˆ†æbootanimation_main.cppæ–‡ä»¶ä¸­å®šä¹‰mainå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯Cè¯­è¨€ä¸­çš„æ‰§è¡Œæ–‡ä»¶çš„å…¥å£å‡½æ•° 123456789101112131415161718192021222324252627int main(int argc, char** argv){//å®å®šä¹‰åˆ¤æ–­æ˜¯å¦è®¾ç½®è¿›ç¨‹çš„ä¼˜å…ˆçº§#if defined(HAVE_PTHREADS) setpriority(PRIO_PROCESS, 0, ANDROID_PRIORITY_DISPLAY);#endif char value[PROPERTY_VALUE_MAX]; //è¿™ä¸ªé…ç½®é¡¹å†³å®šæ˜¯å¦å­˜åœ¨å¼€æœºåŠ¨ç”» property_get(&quot;debug.sf.nobootanimation&quot;, value, &quot;0&quot;); int noBootAnimation = atoi(value); ALOGI_IF(noBootAnimation, &quot;boot animation disabled&quot;); if (!noBootAnimation) { //åˆ›å»ºProcessSateå¯¹è±¡ // è¿™ä¸ªè¿‡ç¨‹ä¼šæ‰“å¼€/dev/binderè®¾å¤‡ï¼Œå½¢æˆå’Œå†…æ ¸binderæœºåˆ¶çš„äº¤äº’çš„é€šé“; æ˜ å°„fdåˆ°å†…å­˜ sp&lt;ProcessState&gt; proc(ProcessState::self()); //åˆ›å»ºçº¿ç¨‹å¹¶åŠ å…¥åˆ°çº¿ç¨‹æ±  ProcessState::self()-&gt;startThreadPool(); // åˆ›å»ºå¼€æœºåŠ¨ç”»å¯¹è±¡ sp&lt;BootAnimation&gt; boot = new BootAnimation(); //æŠŠä¸»çº¿ç¨‹åŠ å…¥åˆ°çº¿ç¨‹æ±  IPCThreadState::self()-&gt;joinThreadPool(); } return 0;} åˆ›å»ºå¼€æœºåŠ¨ç”»å¯¹è±¡ä¼šæ‰§è¡Œåˆ°BootAnimationçš„æ„é€ æ–¹æ³•ï¼Œå…ˆçœ‹ä¸‹BootAnimationçš„å¤´æ–‡ä»¶ BootAnimation.h 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384......namespace android {class AudioPlayer;class Surface;class SurfaceComposerClient;class SurfaceControl;// ---------------------------------------------------------------------------class BootAnimation : public Thread, public IBinder::DeathRecipient{public: BootAnimation(); virtual ~BootAnimation(); sp&lt;SurfaceComposerClient&gt; session() const;private: virtual bool threadLoop(); virtual status_t readyToRun(); virtual void onFirstRef(); virtual void binderDied(const wp&lt;IBinder&gt;&amp; who); //Textureç±»å®šä¹‰ struct Texture { GLint w; //å®½åº¦ GLint h; //é«˜åº¦ GLuint name; //åç§° }; //åŠ¨ç”»å†…å®¹ç»“æ„ä½“ struct Animation { //åŠ¨ç”»å¸§ struct Frame { String8 name; FileMap* map; mutable GLuint tid; bool operator &lt; (const Frame&amp; rhs) const { return name &lt; rhs.name; } }; //åŠ¨ç”»éƒ¨åˆ†ï¼Œå› ä¸ºåŠ¨ç”»å¯èƒ½æ˜¯ç”±å‡ ä¸ªéƒ¨åˆ†ç»„æˆ struct Part { int count; int pause; String8 path; SortedVector&lt;Frame&gt; frames; bool playUntilComplete; float backgroundColor[3]; FileMap* audioFile; }; int fps; int width; int height; Vector&lt;Part&gt; parts; }; status_t initTexture(Texture* texture, AssetManager&amp; asset, const char* name); status_t initTexture(const Animation::Frame&amp; frame); bool android(); bool readFile(const char* name, String8&amp; outString); bool movie(); void checkExit(); sp&lt;SurfaceComposerClient&gt; mSession; sp&lt;AudioPlayer&gt; mAudioPlayer; AssetManager mAssets; Texture mAndroid[2]; int mWidth; int mHeight; EGLDisplay mDisplay; EGLDisplay mContext; EGLDisplay mSurface; sp&lt;SurfaceControl&gt; mFlingerSurfaceControl; sp&lt;Surface&gt; mFlingerSurface; ZipFileRO *mZip;};// ---------------------------------------------------------------------------}; // namespace android#endif // ANDROID_BOOTANIMATION_H å¤§è‡´çš„å®šä¹‰å’Œå£°æ˜å°±æ˜¯è¿™ä¹ˆå¤šï¼Œçœ‹ä¸‹å…·ä½“å®ç° BootAnimation.cpp é¦–å…ˆæ‰§è¡Œæ„é€ æ–¹æ³• 12345BootAnimation::BootAnimation() : Thread(false), mZip(NULL){ //ç”¨äºç•Œé¢æ˜¾ç¤ºçš„mSessionï¼Œä¸SurfaceFlingeräº¤äº’çš„å®¢æˆ·ç«¯ mSession = new SurfaceComposerClient();} ç„¶åæ‰§è¡Œ 1234567void BootAnimation::onFirstRef() { status_t err = mSession-&gt;linkToComposerDeath(this); ALOGE_IF(err, &quot;linkToComposerDeath failed (%s) &quot;, strerror(-err)); if (err == NO_ERROR) { run(&quot;BootAnimation&quot;, PRIORITY_DISPLAY); }} ç”±äºBootAnimationç»§æ‰¿Threadç±»ï¼Œé¦–å…ˆä¼šè°ƒç”¨readyToRunå‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576status_t BootAnimation::readyToRun() { mAssets.addDefaultAssets(); sp&lt;IBinder&gt; dtoken(SurfaceComposerClient::getBuiltInDisplay( ISurfaceComposer::eDisplayIdMain)); DisplayInfo dinfo; status_t status = SurfaceComposerClient::getDisplayInfo(dtoken, &amp;dinfo); if (status) return -1; // create the native surface sp&lt;SurfaceControl&gt; control = session()-&gt;createSurface(String8(&quot;BootAnimation&quot;), dinfo.w, dinfo.h, PIXEL_FORMAT_RGB_565); SurfaceComposerClient::openGlobalTransaction(); control-&gt;setLayer(0x40000000); SurfaceComposerClient::closeGlobalTransaction(); sp&lt;Surface&gt; s = control-&gt;getSurface(); // initialize opengl and egl const EGLint attribs[] = { EGL_RED_SIZE, 8, EGL_GREEN_SIZE, 8, EGL_BLUE_SIZE, 8, EGL_DEPTH_SIZE, 0, EGL_NONE }; EGLint w, h, dummy; EGLint numConfigs; EGLConfig config; EGLSurface surface; EGLContext context; EGLDisplay display = eglGetDisplay(EGL_DEFAULT_DISPLAY); eglInitialize(display, 0, 0); eglChooseConfig(display, attribs, &amp;config, 1, &amp;numConfigs); surface = eglCreateWindowSurface(display, config, s.get(), NULL); context = eglCreateContext(display, config, NULL, NULL); eglQuerySurface(display, surface, EGL_WIDTH, &amp;w); eglQuerySurface(display, surface, EGL_HEIGHT, &amp;h); if (eglMakeCurrent(display, surface, surface, context) == EGL_FALSE) return NO_INIT; mDisplay = display; mContext = context; mSurface = surface; mWidth = w; mHeight = h; mFlingerSurfaceControl = control; mFlingerSurface = s; // If the device has encryption turned on or is in process // of being encrypted we show the encrypted boot animation. char decrypt[PROPERTY_VALUE_MAX]; property_get(&quot;vold.decrypt&quot;, decrypt, &quot;&quot;); bool encryptedAnimation = atoi(decrypt) != 0 || !strcmp(&quot;trigger_restart_min_framework&quot;, decrypt); ZipFileRO* zipFile = NULL; if ((encryptedAnimation &amp;&amp; (access(SYSTEM_ENCRYPTED_BOOTANIMATION_FILE, R_OK) == 0) &amp;&amp; ((zipFile = ZipFileRO::open(SYSTEM_ENCRYPTED_BOOTANIMATION_FILE)) != NULL)) || ((access(OEM_BOOTANIMATION_FILE, R_OK) == 0) &amp;&amp; ((zipFile = ZipFileRO::open(OEM_BOOTANIMATION_FILE)) != NULL)) || ((access(SYSTEM_BOOTANIMATION_FILE, R_OK) == 0) &amp;&amp; ((zipFile = ZipFileRO::open(SYSTEM_BOOTANIMATION_FILE)) != NULL))) { mZip = zipFile; } return NO_ERROR;} ä¸Šé¢ä¸»è¦åšä¸¤ä¸ªæ“ä½œï¼š åˆå§‹åŒ–æ˜¾ç¤ºç•Œé¢ç”¨äºæ’­æ”¾å¼€æœºåŠ¨ç”»ï¼Œeglçš„ä¸€äº›å†…å®¹ï¼›æ ¹æ®æ‰‹æœºæ˜¯å¦åŠ å¯†é€‰æ‹©ä¸åŒçš„å¼€æœºåŠ¨ç”»æ–‡ä»¶ï¼Œç„¶åæ‹¿åˆ°å…¥å£zipFileå…¶ä¸­ç”¨åˆ°äº†ä¸€ä¸ªæ–‡ä»¶è·¯å¾„åœ¨BootAnimation.cppçš„å¼€å¤´æœ‰å®šä¹‰ 12345#define OEM_BOOTANIMATION_FILE &quot;/oem/media/bootanimation.zip&quot; //è¿™ä¸ªåº”è¯¥æ˜¯OEMå‚å•†è‡ªå·±å®šåˆ¶#define SYSTEM_BOOTANIMATION_FILE &quot;/system/media/bootanimation.zip&quot; //æ­£å¸¸æƒ…å†µä¸‹çš„AndroidåŸå§‹å¼€æœºåŠ¨ç”»#define SYSTEM_ENCRYPTED_BOOTANIMATION_FILE &quot;/system/media/bootanimation-encrypted.zip&quot; //åŠ å¯†æ‰‹æœºçš„å¼€æœºåŠ¨ç”» readyToRunæ–¹æ³•æ‰§è¡Œå®Œä¹‹åï¼Œæ¥ç€çœ‹threaLoopå‡½æ•° 1234567891011121314151617181920bool BootAnimation::threadLoop(){ bool r; // We have no bootanimation file, so we use the stock android logo // animation. if (mZip == NULL) { r = android(); //æ²¡æœ‰å¼€æœºåŠ¨ç”»æ–‡ä»¶ï¼Œæ‰§è¡Œandroid logo } else { r = movie(); //å­˜åœ¨å¼€æœºåŠ¨ç”»æ–‡ä»¶ï¼Œåˆ™æ‰§è¡Œå¯¹åº”çš„å¼€æœºåŠ¨ç”»æ–‡ä»¶è§£æå‡ºæ¥çš„å†…å®¹ } eglMakeCurrent(mDisplay, EGL_NO_SURFACE, EGL_NO_SURFACE, EGL_NO_CONTEXT); eglDestroyContext(mDisplay, mContext); eglDestroySurface(mDisplay, mSurface); mFlingerSurface.clear(); mFlingerSurfaceControl.clear(); eglTerminate(mDisplay); IPCThreadState::self()-&gt;stopProcess(); return r;} â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&gt;android() 1234567891011121314151617181920212223242526272829303132333435363738394041bool BootAnimation::android(){ //åˆå§‹åŒ–ä¸¤ä¸ªçº¹ç†ç”¨äºæ˜¾ç¤ºlogo initTexture(&amp;mAndroid[0], mAssets, &quot;images/android-logo-mask.png&quot;); initTexture(&amp;mAndroid[1], mAssets, &quot;images/android-logo-shine.png&quot;); // clear screen æ¸…å± glShadeModel(GL_FLAT); glDisable(GL_DITHER); glDisable(GL_SCISSOR_TEST); glClearColor(0,0,0,1); glClear(GL_COLOR_BUFFER_BIT); eglSwapBuffers(mDisplay, mSurface); glEnable(GL_TEXTURE_2D); glTexEnvx(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE); const GLint xc = (mWidth - mAndroid[0].w) / 2; const GLint yc = (mHeight - mAndroid[0].h) / 2; const Rect updateRect(xc, yc, xc + mAndroid[0].w, yc + mAndroid[0].h); glScissor(updateRect.left, mHeight - updateRect.bottom, updateRect.width(), updateRect.height()); // Blend state glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); glTexEnvx(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE); const nsecs_t startTime = systemTime(); //ä¸åœçš„æ˜¾ç¤ºçŸ¥é“exitPending()è¿”å›true do { ...... EGLBoolean res = eglSwapBuffers(mDisplay, mSurface); ...... checkExit(); } while (!exitPending()); glDeleteTextures(1, &amp;mAndroid[0].name); glDeleteTextures(1, &amp;mAndroid[1].name); return false;} ä¸»è¦å·¥ä½œï¼Œåˆå§‹åŒ–æ˜¾ç¤ºçš„logoçº¹ç†ï¼Œä¸æ–­åˆ·æ–°ç•Œé¢ç›´åˆ°exitPending()è¿”å›trueï¼ŒexitPenging()æ˜¯Threadç±»ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œåœ¨checkExit()å‡½æ•°ä¸­é€šè¿‡requestExit()æ¥æ‰§è¡Œé€€å‡º 12345678910111213void BootAnimation::checkExit() { // Allow surface flinger to gracefully request shutdown char value[PROPERTY_VALUE_MAX]; //EXIT_PROP_NAME &quot;service.bootanim.exit&quot; è¿™ä¸ªé…ç½®é¡¹åœ¨SurfaceFlingerçš„bootFinishedå‡½æ•°ä¸­è®¾ç½®ä¸º1ï¼Œç„¶åè¿™é‡Œæ‰èƒ½é€€å‡ºå¼€æœºåŠ¨ç”»ï¼Œè¿™ä¸ªè¿‡ç¨‹è®¾è®¡åˆ°å¼€æœºå¯åŠ¨åˆ°launcherçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œè¿™é‡Œä¸èµ˜è¿° property_get(EXIT_PROP_NAME, value, &quot;0&quot;); int exitnow = atoi(value); if (exitnow) { requestExit(); if (mAudioPlayer != NULL) { mAudioPlayer-&gt;requestExit(); } }} â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&gt;movie() movie()è¿™ä¸ªå‡½æ•°æœ‰ç‚¹é•¿ï¼Œæˆ‘ä»¬æˆªæ–­ä¸€ç‚¹ä¸€ç‚¹çš„çœ‹ è¯»å–bootanimation.zipä¸­çš„é…ç½®æ–‡ä»¶ 123456789101112131415if (!readFile(&quot;desc.txt&quot;, desString)) { return false;}char const* s = desString.string();//è¯»å–desc.txtæ–‡ä»¶// Create and initialize an AudioPlayer if we have an audio_conf.txt fileString8 audioConf;//åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ›å»ºAudioPlayer,è¿™éƒ¨åˆ†æˆ‘ä»¬æš‚æ—¶ä¸å…³æ³¨if (readFile(&quot;audio_conf.txt&quot;, audioConf)) { mAudioPlayer = new AudioPlayer; if (!mAudioPlayer-&gt;init(audioConf.string())) { ALOGE(&quot;mAudioPlayer.init failed&quot;); mAudioPlayer = NULL; }} è§£ædesc.txtæ–‡ä»¶ï¼Œå°±æ˜¯ä¸Šé¢æ‹¿åˆ°çš„é‚£ä¸ªchar const *s 123456789101112131415161718192021222324252627282930313233343536373839for (;;) { //ä¸€è¡Œä¸€è¡Œçš„æˆªå– const char* endl = strstr(s, &quot;\\n&quot;); if (!endl) break; String8 line(s, endl - s); const char* l = line.string(); //å‡ ä¸ªéœ€è¦æ•è·çš„å‚æ•°,å¸§ç‡ å®½é«˜ï¼Œæ¬¡æ•° int fps, width, height, count, pause; char path[ANIM_ENTRY_NAME_MAX]; char color[7] = &quot;000000&quot;; // default to black if unspecified char pathType; //è¯»å–å¸§ç‡å’Œå®½é«˜ if (sscanf(l, &quot;%d %d %d&quot;, &amp;width, &amp;height, &amp;fps) == 3) { // ALOGD(&quot;&gt; w=%d, h=%d, fps=%d&quot;, width, height, fps); animation.width = width; animation.height = height; animation.fps = fps; } //æˆ–è€…è¯»å–partå†…å®¹ else if (sscanf(l, &quot; %c %d %d %s #%6s&quot;, &amp;pathType, &amp;count, &amp;pause, path, color) &gt;= 4) { // ALOGD(&quot;&gt; type=%c, count=%d, pause=%d, path=%s, color=%s&quot;, pathType, count, pause, path, color); Animation::Part part; part.playUntilComplete = pathType == &apos;c&apos;; part.count = count; part.pause = pause; part.path = path; part.audioFile = NULL; if (!parseColor(color, part.backgroundColor)) { ALOGE(&quot;&gt; invalid color &apos;#%s&apos;&quot;, color); part.backgroundColor[0] = 0.0f; part.backgroundColor[1] = 0.0f; part.backgroundColor[2] = 0.0f; } animation.parts.add(part); } s = ++endl; } è¯»å–æ‰€æœ‰çš„æ•°æ® 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// read all the data structuresconst size_t pcount = animation.parts.size();void *cookie = NULL;if (!mZip-&gt;startIteration(&amp;cookie)) { return false;}ZipEntryRO entry;char name[ANIM_ENTRY_NAME_MAX];while ((entry = mZip-&gt;nextEntry(cookie)) != NULL) { const int foundEntryName = mZip-&gt;getEntryFileName(entry, name, ANIM_ENTRY_NAME_MAX); if (foundEntryName &gt; ANIM_ENTRY_NAME_MAX || foundEntryName == -1) { ALOGE(&quot;Error fetching entry file name&quot;); continue; } const String8 entryName(name); const String8 path(entryName.getPathDir()); const String8 leaf(entryName.getPathLeaf()); if (leaf.size() &gt; 0) { for (size_t j=0 ; j&lt;pcount ; j++) { if (path == animation.parts[j].path) { int method; // supports only stored png files if (mZip-&gt;getEntryInfo(entry, &amp;method, NULL, NULL, NULL, NULL, NULL)) { if (method == ZipFileRO::kCompressStored) { FileMap* map = mZip-&gt;createEntryFileMap(entry); if (map) { Animation::Part&amp; part(animation.parts.editItemAt(j)); if (leaf == &quot;audio.wav&quot;) { // a part may have at most one audio file part.audioFile = map; } else { Animation::Frame frame; frame.name = leaf; frame.map = map; part.frames.add(frame); } } } } } } }}mZip-&gt;endIteration(cookie); æ˜¾ç¤ºåŠ¨ç”» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111// clear screenglShadeModel(GL_FLAT);glDisable(GL_DITHER);glDisable(GL_SCISSOR_TEST);glDisable(GL_BLEND);glClearColor(0,0,0,1);glClear(GL_COLOR_BUFFER_BIT);eglSwapBuffers(mDisplay, mSurface);glBindTexture(GL_TEXTURE_2D, 0);glEnable(GL_TEXTURE_2D);glTexEnvx(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);glTexParameterx(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);glTexParameterx(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);glTexParameterx(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);glTexParameterx(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);const int xc = (mWidth - animation.width) / 2;const int yc = ((mHeight - animation.height) / 2);nsecs_t lastFrame = systemTime();nsecs_t frameDuration = s2ns(1) / animation.fps;Region clearReg(Rect(mWidth, mHeight));clearReg.subtractSelf(Rect(xc, yc, xc+animation.width, yc+animation.height));for (size_t i=0 ; i&lt;pcount ; i++) { const Animation::Part&amp; part(animation.parts[i]); const size_t fcount = part.frames.size(); glBindTexture(GL_TEXTURE_2D, 0); for (int r=0 ; !part.count || r&lt;part.count ; r++) { // Exit any non playuntil complete parts immediately if(exitPending() &amp;&amp; !part.playUntilComplete) break; // only play audio file the first time we animate the part if (r == 0 &amp;&amp; mAudioPlayer != NULL &amp;&amp; part.audioFile) { mAudioPlayer-&gt;playFile(part.audioFile); } glClearColor( part.backgroundColor[0], part.backgroundColor[1], part.backgroundColor[2], 1.0f); for (size_t j=0 ; j&lt;fcount &amp;&amp; (!exitPending() || part.playUntilComplete) ; j++) { const Animation::Frame&amp; frame(part.frames[j]); nsecs_t lastFrame = systemTime(); if (r &gt; 0) { glBindTexture(GL_TEXTURE_2D, frame.tid); } else { if (part.count != 1) { glGenTextures(1, &amp;frame.tid); glBindTexture(GL_TEXTURE_2D, frame.tid); glTexParameterx(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); glTexParameterx(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR); } initTexture(frame); } if (!clearReg.isEmpty()) { Region::const_iterator head(clearReg.begin()); Region::const_iterator tail(clearReg.end()); glEnable(GL_SCISSOR_TEST); while (head != tail) { const Rect&amp; r(*head++); glScissor(r.left, mHeight - r.bottom, r.width(), r.height()); glClear(GL_COLOR_BUFFER_BIT); } glDisable(GL_SCISSOR_TEST); } glDrawTexiOES(xc, yc, 0, animation.width, animation.height); eglSwapBuffers(mDisplay, mSurface); nsecs_t now = systemTime(); nsecs_t delay = frameDuration - (now - lastFrame); //ALOGD(&quot;%lld, %lld&quot;, ns2ms(now - lastFrame), ns2ms(delay)); lastFrame = now; if (delay &gt; 0) { struct timespec spec; spec.tv_sec = (now + delay) / 1000000000; spec.tv_nsec = (now + delay) % 1000000000; int err; do { err = clock_nanosleep(CLOCK_MONOTONIC, TIMER_ABSTIME, &amp;spec, NULL); } while (err&lt;0 &amp;&amp; errno == EINTR); } checkExit(); } usleep(part.pause * ns2us(frameDuration)); // For infinite parts, we&apos;ve now played them at least once, so perhaps exit if(exitPending() &amp;&amp; !part.count) break; } // free the textures for this part if (part.count != 1) { for (size_t j=0 ; j&lt;fcount ; j++) { const Animation::Frame&amp; frame(part.frames[j]); glDeleteTextures(1, &amp;frame.tid); } }} å¤‡æ³¨ ä¸»è¦å·¥ä½œï¼Œè´´ä»£ç ï¼ŒåŠ è‡ªå·±çš„ç†è§£ï¼Œæœ‰é—®é¢˜ç•™è¨€ã€‚","link":"/2016/08/10/ã€ŠAndroid Framework ä¹‹è·¯ã€‹BootAnimationï¼ˆ2ï¼‰/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåï¼‰ã€‹ CoordinatorLayout Behavior","text":"ä»‹ç» Interaction behavior plugin for child views of {@link CoordinatorLayout}.A Behavior implements one or more interactions that a user can take on a child view. These interactions may include drags, swipes, flings, or any other gestures. @param &lt; V &gt; The View type that this Behavior operates on &gt; &gt;äº¤äº’è¡Œä¸ºä¸»è¦ç”¨äºCoordinatorLayoutçš„å­Viewã€‚ä¸€ä¸ªBehaviorå¯ä»¥åœ¨ä¸€ä¸ªå­—Viewä¸Šå®ç°ä¸€ä¸ªæˆ–è€…å¤šä¸ªäº¤äº’å†…å®¹ã€‚è¿™äº›äº¤äº’å¯èƒ½åŒ…æ‹¬æ‹–æ‹½ï¼Œæ»‘åŠ¨ï¼Œæ»šåŠ¨æˆ–è€…æ˜¯å…¶ä»–æ‰‹åŠ¿ã€‚ &gt;å‚æ•°Vä»£è¡¨è¿™ä¸ªBehaviorå¯ä»¥æ“ä½œçš„è§†å›¾ç±»å‹ ###ç±»ç»“æ„ åŸºæœ¬ä½¿ç”¨ å…³æ³¨ä¸¤ä¸ªæ–¹é¢ï¼š 1ã€å®ç°child view ç›‘å¬å¦å¤–ä¸€ä¸ªchild viewçš„çŠ¶æ€å˜åŒ–ï¼Œä¾‹å¦‚å¤§å°ã€ä½ç½®ã€æ˜¾ç¤ºçŠ¶æ€ç­‰ å…³æ³¨layoutDependsOnå’ŒonDependentViewChangedæ–¹æ³•ã€‚ 2ã€å®ç°child viewç›‘å¬CoordinatorLayoutå†…NestedScrollingChildçš„æ¥å£å®ç°ç±»çš„æ»‘åŠ¨çŠ¶æ€ å…³æ³¨onStartNestedScrollå’ŒonNestedPreScrollæ–¹æ³•ã€‚å¦‚ä¸Šä¸€ç¯‡åšæ–‡ä¸­æåˆ°çš„NestedScrollViewï¼Œè€Œä¸èƒ½ä½¿ç”¨æ™®é€šçš„ScrollView ç¬¬ä¸€ç§æƒ…å†µï¼Œç›‘å¬Viewçš„çŠ¶æ€ä½ç½®è·Ÿéš å¸ƒå±€æ–‡ä»¶123456789101112131415161718192021222324252627282930&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.design.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/main_layout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"true\" tools:context=\"mraz.com.coordinatorlayoutdemo.ScrollingActivity\"&gt; &lt;TextView android:id=\"@+id/depentent\" android:layout_width=\"100dp\" android:layout_height=\"100dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"100dp\" android:layout_gravity=\"top|right\" android:background=\"#ffee00\" android:gravity=\"center\" android:text=\"auto\" android:textColor=\"@android:color/holo_red_dark\" app:layout_behavior=\"mraz.com.coordinatorlayoutdemo.FollowingBehavior\" /&gt;&lt;/android.support.design.widget.CoordinatorLayout&gt; Behavior12345678910111213141516171819202122232425262728package mraz.com.coordinatorlayoutdemo;import android.content.Context;import android.support.design.widget.CoordinatorLayout;import android.support.v4.view.ViewCompat;import android.util.AttributeSet;import android.view.View;/** * Created by Mraz on 2016/8/15. */public class FollowingBehavior extends CoordinatorLayout.Behavior&lt;View&gt; { public FollowingBehavior(Context context, AttributeSet attrs) { super(context, attrs); } @Override public boolean layoutDependsOn(CoordinatorLayout parent, View child, View dependency) { return (dependency.getId() == R.id.depentent);//ä¾èµ–å·¦è¾¹çš„View } @Override public boolean onDependentViewChanged(CoordinatorLayout parent, View child, View dependency) { int offsetX = dependency.getTop() - child.getTop();//æ‹¿åˆ°å·¦è¾¹Viewå’Œå³è¾¹viewçš„é¡¶éƒ¨å·®è· ViewCompat.offsetTopAndBottom(child, offsetX);//ç§»åŠ¨ return true; }} æ•ˆæœ ç¬¬äºŒç§æƒ…å†µï¼Œç›‘å¬æ»šåŠ¨çŠ¶æ€CoordinatorLayoutå®ç°NestedScrollingParentæ¥å£ï¼Œ NestedScrollViewå®ç°NestedScrollingParentï¼Œ NestedScrollingChild, ScrollingViewæ¥å£ 12public class NestedScrollView extends FrameLayout implements NestedScrollingParent, NestedScrollingChild, ScrollingView ç®€è€Œè¨€ä¹‹ï¼Œä¸€ä¸ªåŠ å¼ºçš„ScrollViewï¼Œä½†æ˜¯å®ç°çš„è¿™å‡ ä¸ªæ¥å£æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿä¸€ä¸ªä¸ªçš„çœ‹ä¸‹NestedScrollingParent æ¥å£ å«ä¹‰ onStartNestedScroll childæ‰§è¡ŒstartNestedScrollæ–¹æ³•çš„æ—¶å€™ä¼šè°ƒç”¨ï¼Œè¿”å›trueä»£è¡¨ä»£è¡¨è¦å’Œchildè”åŠ¨ onNestedScrollAccepted onStartNestedScrollæ‰§è¡Œå®Œæˆå¹¶è¿”å›trueä¹‹åæ‰§è¡Œï¼Œç”¨äºåšè”åŠ¨å‰çš„å‡†å¤‡ onStopNestedScroll nested scrollç»“æŸåæ‰§è¡Œ onNestedScroll nested scrollè¿›è¡Œä¸­æ—¶æ‰§è¡Œï¼Œä¼ é€’çš„å‚æ•°æ˜¯æ¶ˆè€—äº†å’Œæ²¡æœ‰æ¶ˆè€—çš„æ»šåŠ¨è·ç¦» onNestedPreScroll neseted scrollè¿›è¡Œå¹¶ä¸”targetæ²¡æœ‰æ¶ˆè€—æ»šåŠ¨æ—¶æ‰§è¡Œï¼Œnested scrollingæ‰§è¡ŒdispatchNestedPreScrollåæ‰§è¡Œè¯¥æ–¹æ³• onNestedFling è¯·æ±‚ä¸€ä¸ªæ»šåŠ¨ç»“æŸåçš„fling onNestedPreFling target viewæ²¡æœ‰æ¶ˆè€—flingerä¹‹å‰æ‰§è¡Œ getNestedScrollAxes è¿”å›NestedScrollingParentçš„æ»šåŠ¨è½´ NestedScrollingChild æ¥å£ å«ä¹‰ setNestedScrollingEnabled è®¾ç½®è§†å›¾æ˜¯å¦å¯ä»¥nested scrolling isNestedScrollingEnabled è·å–å½“å‰viewæ˜¯å¦å¯ä»¥nested scrolling startNestedScroll å¼€å§‹æ‰§è¡Œnested scroll,æ²¿ç€ç»™ç‚¹çš„è½´æ–¹å‘ï¼Œè¿”å›true,ä»£è¡¨æ‰¾åˆ°äº†parent hasNestedScrollingParent åˆ¤æ–­nested scrollingæ˜¯å¦å­˜åœ¨parent dispatchNestedScroll æ´¾å‘ä¸€ä¸ªæ»šåŠ¨ç»™parent dispatchNestedPreScroll åœ¨æ²¡æœ‰æ¶ˆè€—ä¹‹å‰æ´¾å‘ç»™parentï¼Œä¹Ÿå°±æ˜¯parentæœ‰å¯èƒ½ä¼šåœ¨childä¹‹å‰æ¶ˆè€— dispatchNestedPreFling æ¶ˆè€—ä¹‹å‰æ´¾å‘ç»™parent ScrollingView æ¥å£ å«ä¹‰ computeHorizontalScrollRange è®¡ç®—æ¨ªå‘æ»šåŠ¨çš„èŒƒå›´ computeHorizontalScrollOffset è®¡ç®—æ¨ªå‘åç§»é‡ computeHorizontalScrollExtent è®¡ç®—æ¨ªå‘é¢å¤–è·ç¦» computeVerticalScrollRange æ»šåŠ¨è§†å›¾çš„å¯æ»šåŠ¨èŒƒå›´æ˜¯æ‰€æœ‰å­å…ƒç´ çš„é«˜åº¦ computeVerticalScrollOffset è®¡ç®—å‚ç›´æ–¹å‘æ»šåŠ¨æ¡çš„æ»‘å—çš„åç§»ã€‚æ­¤å€¼ç”¨æ¥è®¡ç®—æ»šåŠ¨æ¡è½¨è¿¹çš„æ»‘å—çš„ä½ç½® computeVerticalScrollExtent è®¡ç®—çºµå‘é¢å¤–è·ç¦» åŸºæœ¬ä¸Šæ–¹æ³•å’Œä¸Šé¢çš„æ¯”è¾ƒç±»ä¼¼ï¼Œä¸èµ˜è¿° å¸ƒå±€æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;android.support.design.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" xmlns:tools=\"http://schemas.android.com/tools\" android:id=\"@+id/main_layout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:fitsSystemWindows=\"true\" android:scrollbars=\"vertical\" tools:context=\"mraz.com.coordinatorlayoutdemo.ScrollingActivity\"&gt; &lt;android.support.v4.widget.NestedScrollView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\"&gt; &lt;LinearLayout android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:orientation=\"vertical\"&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#73ff00\" android:gravity=\"center\" android:text=\"depentent\" android:textColor=\"@android:color/black\" /&gt; &lt;/LinearLayout&gt; &lt;/android.support.v4.widget.NestedScrollView&gt; &lt;android.support.v4.widget.NestedScrollView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"center\" app:layout_behavior=\"mraz.com.coordinatorlayoutdemo.MyScrollingBehavior\"&gt; &lt;LinearLayout android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:orientation=\"vertical\"&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ff00aa\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;/LinearLayout&gt; &lt;/android.support.v4.widget.NestedScrollView&gt; &lt;android.support.v4.widget.NestedScrollView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"right\" app:layout_behavior=\"mraz.com.coordinatorlayoutdemo.MyScrollingBehavior\"&gt; &lt;LinearLayout android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:orientation=\"vertical\"&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;TextView android:layout_width=\"100dp\" android:layout_height=\"200dp\" android:layout_gravity=\"top|left\" android:background=\"#ffe600\" android:gravity=\"center\" android:text=\"right\" android:textColor=\"@android:color/black\" /&gt; &lt;/LinearLayout&gt; &lt;/android.support.v4.widget.NestedScrollView&gt;&lt;/android.support.design.widget.CoordinatorLayout&gt; Behavior1234567891011121314151617181920212223242526272829303132package mraz.com.coordinatorlayoutdemo;import android.content.Context;import android.support.design.widget.CoordinatorLayout;import android.support.v4.view.ViewCompat;import android.support.v4.widget.NestedScrollView;import android.util.AttributeSet;import android.view.View;public class MyScrollingBehavior extends CoordinatorLayout.Behavior { public MyScrollingBehavior(Context context, AttributeSet attrs) { super(context, attrs); } @Override public boolean onStartNestedScroll(CoordinatorLayout coordinatorLayout, View child, View directTargetChild, View target, int nestedScrollAxes) { return (nestedScrollAxes &amp; ViewCompat.SCROLL_AXIS_VERTICAL) != 0;//åªå¯¹å‚ç›´æ»šåŠ¨æ„Ÿå…´è¶£ } @Override public void onNestedPreScroll(CoordinatorLayout coordinatorLayout, View child, View target, int dx, int dy, int[] consumed) { super.onNestedPreScroll(coordinatorLayout, child, target, dx, dy, consumed); int leftScrolled = target.getScrollY();//è·å–å·¦ä¾§æ»šåŠ¨è·ç¦» child.setScrollY(leftScrolled);//è®¾ç½®è”åŠ¨ } @Override public boolean onNestedPreFling(CoordinatorLayout coordinatorLayout, View child, View target, float velocityX, float velocityY) { ((NestedScrollView) child).fling((int) velocityY);//æ¾æ‰‹åé€Ÿåº¦ä¼ é€’ä¸‹å» return true; }} æ•ˆæœ","link":"/2016/08/23/ã€ŠAndroid åŸºç¡€ï¼ˆäºŒåï¼‰ã€‹ CoordinatorLayout Behavior/"},{"title":"ã€ŠAndroid åŸºç¡€ï¼ˆå››å)ã€‹ FlexboxLayout","text":"1. ç®€ä»‹Flexbox-layoutï¼Œæ˜¯Googleæ¨å‡ºçš„æµå¼å¸ƒå±€ã€‚å…·ä½“çš„åŸºæœ¬ä»‹ç»å¯ä»¥å‚è€ƒGithubä¸Šçš„Wikiã€‚çœ‹ä¸€ä¸‹ç±»çš„è‹±æ–‡è¯´æ˜ï¼š 123456789101112131415161718192021222324252627282930313233343536`/** * A layout that arranges its children in a way its attributes can be specified like the * CSS Flexible Box Layout Module. * This class extends the {@link ViewGroup} like other layout classes such as {@link LinearLayout} * or {@link RelativeLayout}, the attributes can be specified from a layout XML or from code. * * The supported attributes that you can use are: * &lt;ul&gt; * &lt;li&gt;{@code flexDirection}&lt;/li&gt; * &lt;li&gt;{@code flexWrap}&lt;/li&gt; * &lt;li&gt;{@code justifyContent}&lt;/li&gt; * &lt;li&gt;{@code alignItems}&lt;/li&gt; * &lt;li&gt;{@code alignContent}&lt;/li&gt; * &lt;li&gt;{@code showDivider}&lt;/li&gt; * &lt;li&gt;{@code showDividerHorizontal}&lt;/li&gt; * &lt;li&gt;{@code showDividerVertical}&lt;/li&gt; * &lt;li&gt;{@code dividerDrawable}&lt;/li&gt; * &lt;li&gt;{@code dividerDrawableHorizontal}&lt;/li&gt; * &lt;li&gt;{@code dividerDrawableVertical}&lt;/li&gt; * &lt;/ul&gt; * for the FlexboxLayout. * * And for the children of the FlexboxLayout, you can use: * &lt;ul&gt; * &lt;li&gt;{@code layout_order}&lt;/li&gt; * &lt;li&gt;{@code layout_flexGrow}&lt;/li&gt; * &lt;li&gt;{@code layout_flexShrink}&lt;/li&gt; * &lt;li&gt;{@code layout_flexBasisPercent}&lt;/li&gt; * &lt;li&gt;{@code layout_alignSelf}&lt;/li&gt; * &lt;li&gt;{@code layout_minWidth}&lt;/li&gt; * &lt;li&gt;{@code layout_minHeight}&lt;/li&gt; * &lt;li&gt;{@code layout_maxWidth}&lt;/li&gt; * &lt;li&gt;{@code layout_maxHeight}&lt;/li&gt; * &lt;li&gt;{@code layout_wrapBefore}&lt;/li&gt; * &lt;/ul&gt; */` åº”è¯¥å¾ˆå®¹æ˜“çœ‹æ‡‚ï¼Œä¸»è¦æ˜¯æä¾›ç±»ä¼¼äºCSSä¸­Flexible Box Layoutçš„èƒ½åŠ›ã€‚ 2. å±æ€§å€¼é’ˆå¯¹FlexboxLayout|å±æ€§||â€”â€”|â€”â€”||flexDirection|||flexWrap|||justifyContent|||alignItems|||alignContent|||showDivider|||showDividerHorizontal|||showDividerVertical|||dividerDrawable|||dividerDrawableHorizontal|||dividerDrawableVertical|| é’ˆå¯¹FlexboxLayoutä¸­çš„å­å…ƒç´  |å±æ€§||â€”â€”|â€”â€”||layout_order|||layout_flexGrow|||layout_flexShrink|||layout_flexBasisPercent|||layout_alignSelf|||layout_minWidth|||layout_minHeight|||layout_maxWidth|||layout_maxHeight|||layout_wrapBefore|| 3. FlexboxLayoutå±æ€§è‡ªæµ‹3.1 flexDirectionflexDirectionå±æ€§æ”¯æŒrow , row_reverse , column , column_reverseå››ä¸ªå–å€¼ã€‚åˆ†åˆ«ä»£è¡¨å·¦å³ï¼Œå³å·¦ï¼Œä¸Šä¸‹ï¼Œä¸‹ä¸Šã€‚ flexDIrection æ•ˆæœå›¾ row row_reverse column column_reverse 3.2 flexWrapflexWrap, è¡¨ç¤ºæ¢è¡Œä¸å¦ï¼Œæ”¯æŒ&lt;font color=red&gt;wrap , nowrap , wrap_reverse`ã€‚é»˜è®¤ä¸ºnoWrapï¼Œè¡¨ç¤ºä¸æ¢è¡Œï¼Œwrapè¡¨ç¤ºè‡ªåŠ¨æ¢è¡Œï¼Œè¿˜æœ‰ä¸€ä¸ªwrap_reverse è¡¨ç¤ºå‰¯è½´åè½¬ã€‚ä»¥flexDirectionä¸ºrowæ—¶ä¸ºä¾‹ flexWrap wrap nowrap wrap_reverse 3.3 justifyContentjustifyContentï¼Œè¡¨ç¤ºæ§ä»¶æ²¿ä¸»è½´å¯¹é½æ–¹å‘ã€‚æ”¯æŒflex_start , flex_end , center , space_between , space_aroundäº”ç§å–å€¼ã€‚ ä¸‹é¢ä»¥flexDirectionä¸ºrow , flexWrapä¸ºwrapä¸ºä¾‹ï¼Œæ³¨æ„æ¯”è¾ƒæ•ˆæœä¹‹é—´çš„å·®å¼‚ï¼Œå°±å¯ä»¥å¾ˆç›´è§‚çš„äº†è§£åˆ°æ¯ä¸ªå±æ€§å€¼çš„ä½œç”¨ã€‚ justifyContent æ•ˆæœå›¾ flex_start flex_end center space_between space_around 3.4 alignItemsalignItems , æè¿°å…ƒç´ åœ¨å‰¯è½´ä¸Šçš„å¯¹é½æ–¹å‘ï¼ˆé’ˆå¯¹å•è¡Œ) , æ”¯æŒflex_start , flex_end , center , baseline , stretchäº”ç§å–å€¼ã€‚ ä»¥flexDirectionä¸ºrow , flexWrapä¸ºnowrapä¸ºä¾‹ï¼Œæ³¨æ„æ¯”è¾ƒä¸åŒå±æ€§ä¹‹é—´çš„æ•ˆæœå·®å¼‚ã€‚ç”±äºä¸Šé¢ç¤ºä¾‹ä¸­æˆ‘ä»¬é’ˆå¯¹flexboxlayoutçš„é«˜åº¦ä½¿ç”¨çš„æ—¶wrap_content , ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬ç»™flexboxlayoutä¸€ä¸ªåˆé€‚çš„å›ºå®šé«˜åº¦æ´»ç€æ”¹æˆmatch_parentæ›´å®¹æ˜“çœ‹å‡ºæ•ˆæœ alignItems æ•ˆæœå›¾ flex_start flex_end center baseline stretch 3.5 alignContentalignContent , è¡¨ç¤ºæ§ä»¶åœ¨å‰¯è½´ä¸Šçš„å¯¹é½æ–¹å‘ï¼ˆé’ˆå¯¹å¤šè¡Œå…ƒç´ ï¼‰ã€‚æ”¯æŒflex_start , flex_end , center , space_between , space_around , stretchå…­ç§å–å€¼ flexboxlayoutæ”¹æˆmatch_parent , ä»¥flexDirectionä¸ºrow , flexWrapä¸ºwrapä¸ºä¾‹ï¼Œ çœ‹çœ‹æ•ˆæœ alignContent æ•ˆæœå›¾ flex_start flex_end center space_between space_around stretch 3.6 showDivider and dividerDrawableshowDivider , æ˜¾ç¤ºåˆ†å‰²çº¿ã€‚æ”¯æŒnone , beginning , middle , endå››ç§å–å€¼ ç»˜åˆ¶ä¸€æ¡åˆ†å‰²çº¿ï¼Œç„¶åflexDirectionä¸ºrow , flexWrapä¸ºwrapï¼ŒdividerDrawableä¸º@drawable/dividerä¸ºä¾‹ï¼Œçœ‹çœ‹æ•ˆæœ 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;solid android:color=\"@color/colorAccent\"&gt;&lt;/solid&gt; &lt;size android:width=\"2dp\"/&gt;&lt;/shape&gt; showDivider æ•ˆæœå›¾ none beginning middle end 3.7 showDividerHorizontal and dividerDrawableHorizontalæ¨ªå‘åˆ†å‰²çº¿ï¼Œæ”¯æŒnone , beginning , middle , endå››ç§å–å€¼ï¼Œå››ç§å–å€¼å’Œä¸Šé¢çš„ä½¿ç”¨å·®ä¸å¤šï¼Œæˆ‘ä»¬åªä¸¾ä¸€ä¸ªä¾‹å­ åˆ†å‰²çº¿ 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;solid android:color=\"@color/colorAccent\"&gt;&lt;/solid&gt; &lt;size android:height=\"2dp\"/&gt;&lt;/shape&gt; å¸ƒå±€æ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;com.google.android.flexbox.FlexboxLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"#EBEBEB\" app:flexDirection=\"column\" app:showDividerHorizontal=\"middle\" app:dividerDrawableHorizontal=\"@drawable/divider\" app:flexWrap=\"wrap\"&gt; &lt;TextView android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:text=\"Android\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"android studio\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"Androidå®‰å…¨\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"Androidæ¡†æ¶\" /&gt; &lt;/com.google.android.flexbox.FlexboxLayout&gt;&lt;/RelativeLayout&gt; 3.8 showDividerVertical and dividerDrawableVerticalå’Œä¸Šé¢çš„ç”¨æ³•ç›¸ä¼¼ï¼Œçœ‹ä¸‹æ•ˆæœæŠŠ åˆ†å‰²çº¿ 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt; &lt;solid android:color=\"@color/colorAccent\"&gt;&lt;/solid&gt; &lt;size android:width=\"2dp\"/&gt;&lt;/shape&gt; 4. FlexboxLayoutå­å…ƒç´ å±æ€§è‡ªæµ‹4.1 layout_orderé»˜è®¤æƒ…å†µ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;com.google.android.flexbox.FlexboxLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"#EBEBEB\" app:flexDirection=\"row\" app:flexWrap=\"wrap\"&gt; &lt;TextView android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:gravity=\"center\" android:text=\"Android\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"android studio\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"Androidå®‰å…¨\" /&gt; &lt;/com.google.android.flexbox.FlexboxLayout&gt;&lt;/RelativeLayout&gt; é¡ºåºæ’ä¸€ä¸‹ 2ï¼Œ3ï¼Œ1 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;com.google.android.flexbox.FlexboxLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"#EBEBEB\" app:flexDirection=\"row\" app:flexWrap=\"wrap\"&gt; &lt;TextView android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" app:layout_order=\"2\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:gravity=\"center\" android:text=\"Android\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" app:layout_order=\"3\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"android studio\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" app:layout_order=\"1\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"Androidå®‰å…¨\" /&gt; &lt;/com.google.android.flexbox.FlexboxLayout&gt;&lt;/RelativeLayout&gt; 4.2 layout_flexGrowlayout_flexGrow ,å­å…ƒç´ çš„æ”¾å¤§æ¯”ä¾‹ï¼Œ å†³å®šå¦‚ä½•åˆ†é…å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´çš„è¯ï¼‰ï¼Œé»˜è®¤å€¼ä¸º0,ä¸ä¼šåˆ†é…å‰©ä½™ç©ºé—´ï¼Œå¦‚æœæŸä¸€è¡Œä¸­æœ‰ä¸€ä¸ªitemçš„ layout_flexGrow æ˜¯ä¸€ä¸ªæ­£å€¼ï¼Œé‚£ä¹ˆä¼šå°†è¿™è¡Œå…¨éƒ¨å‰©ä½™ç©ºé—´åˆ†é…ç»™è¿™ä¸ªItem , å¦‚æœè¿™ä¸€è¡Œæœ‰å¤šä¸ªItemè¿™ä¸ªå±æ€§éƒ½ä¸ºæ­£å€¼ï¼Œé‚£ä¹ˆå‰©ä½™ç©ºé—´çš„æŒ‰ç…§layout_flexGrowå®šä¹‰çš„æ¯”ä¾‹ï¼ˆæœ‰ç‚¹åƒLinearLayoutçš„layout_weightå±æ€§ï¼‰è¿›è¡Œåˆ†é… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\"&gt; &lt;com.google.android.flexbox.FlexboxLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:background=\"#EBEBEB\" app:flexDirection=\"row\" app:flexWrap=\"wrap\"&gt; &lt;TextView android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" app:layout_flexGrow=\"10.0\" android:text=\"Android\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" android:text=\"android studio\" /&gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_margin=\"4dp\" android:background=\"@drawable/item_bg\" android:paddingLeft=\"10dp\" android:paddingRight=\"10dp\" android:paddingTop=\"4dp\" android:paddingBottom=\"4dp\" app:layout_flexGrow=\"10.0\" android:text=\"Androidå®‰å…¨\" /&gt; &lt;/com.google.android.flexbox.FlexboxLayout&gt;&lt;/RelativeLayout&gt; å¯ä»¥çœ‹åˆ°é»„è‰²æ¡†å†…çš„ä¸¤ä¸ªå…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå­å…ƒç´ å’Œç¬¬ä¸‰ä¸ªå­å…ƒç´ ï¼‰æŒ‰ç…§1ï¼š1 çš„æ¯”ä¾‹åˆ†é…äº†è¿™ä¸€è¡Œä¸­å‰©ä½™çš„ç©ºé—´ã€‚ 4.3 layout_flexShrinklayout_flexShrink , å­å…ƒç´ ç¼©å°æ¯”ä¾‹ , ä¸ä¸Šé¢çš„å±æ€§å€¼æœ‰ç‚¹å¯¹åº”å…³ç³»ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œå­å…ƒç´ éœ€è¦ç¼©å°ï¼ˆé’ˆå¯¹å•è¡Œï¼‰ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œå¦‚æœæ‰€æœ‰å­å…ƒç´ çš„layout_flexShrink å€¼ä¸º1,ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½ç­‰æ¯”ç¼©å°ï¼Œå¦‚æœæœ‰ä¸€ä¸ªä¸º0ï¼Œå…¶ä»–ä¸º1ï¼Œç©ºé—´ä¸è¶³æ—¶ï¼Œä¸º0çš„ä¸ç¼©å°ï¼Œè´Ÿå€¼æ— æ•ˆã€‚ è¿™é‡Œå¼•ç”¨Githubä¸Šçš„ä¸€ä¸ªå›¾ï¼Œçœ‹çœ‹æ•ˆæœ 4.4 layout_alignSelflayout_alignSelf å±æ€§å¯ä»¥ç»™å­å…ƒç´ è®¾ç½®å¯¹é½æ–¹å¼ï¼Œä¸Šé¢è®²çš„alignItemså±æ€§å¯ä»¥è®¾ç½®å¯¹é½ï¼Œè¿™ä¸ªå±æ€§çš„åŠŸèƒ½å’ŒalignItemsä¸€æ ·ï¼Œåªä¸è¿‡alignItemsä½œç”¨äºæ‰€æœ‰å­å…ƒç´ ï¼Œè€Œlayout_alignSelf ä½œç”¨äºå•ä¸ªå­å…ƒç´ ã€‚é»˜è®¤å€¼ä¸ºauto, è¡¨ç¤ºç»§æ‰¿alignItemså±æ€§ï¼Œå¦‚æœä¸ºautoä»¥å¤–çš„å€¼ï¼Œåˆ™ä¼šè¦†ç›–alignItemså±æ€§ã€‚æ”¯æŒauto , flex_start , flex_end , center , baseline , stretchå…­ç§å–å€¼ã€‚é™¤äº†autoä»¥å¤–ï¼Œå…¶ä»–å’ŒalignItemså±æ€§ä¸€æ ·ï¼Œè€Œautoè¡¨ç¤ºç»§æ‰¿alignItemsçš„å±æ€§ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ•ˆæœç›¸åŒï¼Œè¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šã€‚ 4.5 layout_flexBasisPercentlayout_flexBasisPercen , è¡¨ç¤ºè®¾ç½®å­å…ƒç´ çš„é•¿åº¦ä¸ºå®ƒçˆ¶å®¹å™¨é•¿åº¦çš„ç™¾åˆ†æ¯”ã€‚è¿™ä¸ªå€¼åªæœ‰è®¾ç½®äº†çˆ¶å®¹å™¨çš„é•¿åº¦æ—¶æ‰æœ‰æ•ˆï¼ˆä¹Ÿå°±æ˜¯MeasureSpec mode æ˜¯ MeasureSpec.EXACTLYï¼‰ã€‚é»˜è®¤å€¼æ—¶-1ã€‚ è®¾ç½®ç¬¬ä¸€ä¸ªå…ƒç´ app:layout_flexBasisPercent=â€50%â€ 4.6 layout_minWidth / layout_minHeightå¼ºåˆ¶é™åˆ¶ FlexboxLayoutçš„å­å…ƒç´ ï¼ˆå®½æˆ–é«˜ï¼‰ä¸ä¼šå°äºæœ€å°å€¼ï¼Œä¸ç®¡layout_flexShrinkè¿™ä¸ªå±æ€§çš„å€¼ä¸ºå¤šå°‘ï¼Œå­å…ƒç´ ä¸ä¼šè¢«ç¼©å°åˆ°å°äºè®¾ç½®çš„è¿™ä¸ªæœ€å°å€¼ã€‚ 4.7 layout_maxWidth / layout_maxHeightè¿™ä¸ªå’Œä¸Šé¢çš„åˆšå¥½ç›¸åï¼Œå¼ºåˆ¶é™åˆ¶FlexboxLayoutå­å…ƒç´ ä¸ä¼šå¤§äºè¿™ä¸ªæœ€å¤§å€¼, ä¸ç®¡layout_flexGrowçš„å€¼ä¸ºå¤šå°‘ï¼Œå­å…ƒç´ ä¸ä¼šè¢«æ”¾å¤§åˆ°è¶…è¿‡è¿™ä¸ªæœ€å¤§å€¼ã€‚ 4.8 layout_wrapBeforelayout_wrapBefore å±æ€§æ§åˆ¶å¼ºåˆ¶æ¢è¡Œï¼Œé»˜è®¤å€¼ä¸ºfalse,å¦‚æœå°†ä¸€ä¸ªå­å…ƒç´ çš„è¿™ä¸ªå±æ€§è®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆè¿™ä¸ªå­å…ƒç´ å°†ä¼šæˆä¸ºä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚è¿™ä¸ªå±æ€§å°†å¿½ç•¥flex_wrap è®¾ç½®çš„ noWrapå€¼ã€‚ è®¾ç½®ç¬¬ä¸‰ä¸ªå…ƒç´ app:layout_wrapBefore=â€trueâ€ å¯ä»¥çœ‹åˆ°ç¬¬ä¸‰ä¸ªå…ƒç´ å¦èµ·äº†ä¸€è¡Œ","link":"/2017/08/19/ã€ŠAndroid åŸºç¡€ï¼ˆå››å)ã€‹ FlexboxLayout/"},{"title":"ã€ŠAndroid å®‰å…¨ï¼ˆäºŒï¼‰ã€‹Smaliè¯­æ³•åŸºç¡€","text":"GithubåŸæ–‡ Smalismali/baksmaliæ˜¯Androidçš„Java VMå®ç°dalvikä½¿ç”¨çš„dexæ ¼å¼çš„æ±‡ç¼–ç¨‹åº/åæ±‡ç¼–ç¨‹åºã€‚ è¯­æ³•æ¾æ•£åœ°åŸºäºJasmin/ dedexerçš„è¯­æ³•ï¼Œå¹¶æ”¯æŒdexæ ¼å¼çš„å…¨éƒ¨åŠŸèƒ½ï¼ˆæ³¨é‡Šï¼Œè°ƒè¯•ä¿¡æ¯ï¼Œè¡Œä¿¡æ¯ç­‰ï¼‰ BuildProcedure(æ„å»ºç¨‹åº)ä¾èµ–è¿™å¯èƒ½æ˜¯ä¸€ä»½ä¸å®Œæ•´çš„æ¸…å•ã€‚å¦‚æœæ‚¨é‡åˆ°é—æ¼çš„å†…å®¹ï¼Œè¯·éšæ—¶å‘è¡¨è¯„è®ºï¼Œæˆ‘ä¼šå°†å…¶æ·»åŠ  jdk(8) git å…¶ä»–æ‰€æœ‰å†…å®¹éƒ½åº”è¯¥é€šè¿‡gradle / gradlewä¸‹è½½ æ„å»º123git clone https://github.com/JesusFreke/smali.gitcd smali./gradlew build (windowsä¸Šï¼Œä½¿ç”¨gradlew.bat ä»£æ›¿./gradlew) ç”Ÿæˆçš„jaråŒ…ä½ç½® 123smali/build/libs/smali-&lt;version&gt;.jarbaksmali/build/libs/baksmali-&lt;version&gt;.jar é™¤æ­¤ä¹‹å¤–ï¼Œé€šè¿‡ 1./gradlew proguard å¯ä»¥æ„å»ºå‡ºä½“ç§¯æ›´å°æ··æ·†åçš„jaræ–‡ä»¶ 123smali/build/libs/smali-&lt;version&gt;-small.jarbaksmali/build/libs/baksmali-&lt;version&gt;-small.jar DeodexInstructions(Deodexè¯´æ˜)è¯´æ˜ä»v2.1.0å¼€å§‹ï¼Œbaksmaliæ”¯æŒåç¼–è¯‘ART oatæ–‡ä»¶ã€‚ æ”¯æŒçš„æœ€ä½oatç‰ˆæœ¬ä¸º56ï¼Œä¹Ÿå°±æ˜¯Android 6.0 / Marshmallowç‰ˆæœ¬ä¸­çš„oatæ–‡ä»¶ç‰ˆæœ¬ã€‚ ç”±äºä¸å­—æ®µæ’åºæœ‰å…³çš„ä¸€äº›æ½œåœ¨é—®é¢˜ï¼Œæš‚ä¸æ”¯æŒMç‰ˆæœ¬ä¹‹å‰çš„oatæ–‡ä»¶åç¼–è¯‘ï¼ˆä¾‹å¦‚Lollipopï¼‰ã€‚ ä½ å¯ä»¥åœ¨oatæ–‡ä»¶ä¸Šè¿è¡Œbaksmaliä»¥è·å–å…¶ä¸­æ‰€æœ‰odexæ–‡ä»¶çš„åˆ—è¡¨ã€‚ 123456789101112131415161718&gt; adb pull /system/framework/arm/boot.oat boot.oat&gt; baksmali boot.oatboot.oat contains multiple dex files. You must specify which one to disassemble with the -e optionValid entries include:/system/framework/core-libart.jar/system/framework/conscrypt.jar/system/framework/okhttp.jar/system/framework/core-junit.jar/system/framework/bouncycastle.jar/system/framework/ext.jar/system/framework/framework.jar/system/framework/framework.jar:classes2.dex/system/framework/telephony-common.jar/system/framework/voip-common.jar/system/framework/ims-common.jar/system/framework/mms-common.jar/system/framework/android.policy.jar/system/framework/apache-xml.jar é€šè¿‡å¦‚ä¸‹æ“ä½œæˆ‘ä»¬å¯ä»¥åç¼–è¯‘boot.oatä¸­çš„framework jaræ–‡ä»¶ 12&gt; adb pull /system/framework/arm/boot.oat /tmp/framework/boot.oat&gt; baksmali -x -c boot.oat -d /tmp/framework -e /system/framework/framework.jar /tmp/framework/boot.oat -o framework æˆ–è€…é€šè¿‡å¦‚ä¸‹æ–¹å¼åç¼–è¯‘ä¸€ä¸ªåº”ç”¨ç¨‹åºoat 123&gt; adb pull /system/framework/arm/boot.oat /tmp/framework/boot.oat&gt; adb pull /system/app/Calculator/oat/arm/Calculator.odex Calculator.odex&gt; baksmali -x -c boot.oat -d /tmp/framework Calculator.odex -o Calculator æ³¨æ„ï¼Œåœ¨åç¼–è¯‘oatæ–‡ä»¶æ—¶ä¸éœ€è¦-aé€‰é¡¹æ¥æŒ‡å®šAPI Levelï¼Œbaksmaliä¼šè‡ªåŠ¨ä½¿ç”¨oatæ–‡ä»¶ä¸­çš„API Levelã€‚ ä»v1.4.0å¼€å§‹ï¼Œdeodexingè¿‡ç¨‹å·²ç»å¤§å¤§ç®€åŒ–äº†ï¼Œä¸å†éœ€è¦é€šè¿‡-cé€‰é¡¹æŒ‡å®šå…¶ä»–ç±»è·¯å¾„ã€‚ Deodexingç°åœ¨å¾ˆç®€å• 1baksmali -a &lt;api_level&gt; -x &lt;odex_file&gt; -d &lt;framework_dir&gt; odexæ–‡ä»¶å¸¸è¯†ç®€è€Œè¨€ä¹‹ï¼Œodexæ–‡ä»¶å°±æ˜¯classes.dexæ–‡ä»¶çš„ä¼˜åŒ–ç‰ˆæœ¬ï¼Œé’ˆå¯¹ç‰¹å®šè®¾å¤‡çš„ä¼˜åŒ–ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œodexæ–‡ä»¶ä¾èµ–äºç”Ÿæˆæ—¶åŠ è½½çš„æ¯ä¸ªâ€œBOOTCLASSPATHâ€æ–‡ä»¶ã€‚ odexæ–‡ä»¶ä»…åœ¨ä¸è¿™äº›ç¡®åˆ‡çš„BOOTCLASSPATHæ–‡ä»¶ä¸€èµ·ä½¿ç”¨æ—¶æ‰æœ‰æ•ˆã€‚ dalviké€šè¿‡å­˜å‚¨odexæ–‡ä»¶æ‰€ä¾èµ–çš„æ¯ä¸ªæ–‡ä»¶çš„æ ¡éªŒå’Œæ¥å¼ºåˆ¶æ‰§è¡Œæ­¤æ“ä½œï¼Œå¹¶ç¡®ä¿åœ¨åŠ è½½odexæ–‡ä»¶æ—¶æ¯ä¸ªæ–‡ä»¶çš„æ ¡éªŒå’ŒåŒ¹é…ã€‚ é™¤äº†åŠ è½½çš„ä¸»apk / jarä¹‹å¤–ï¼ŒBOOTCLASSPATHåªæ˜¯å¯ä»¥åŠ è½½ç±»çš„jars / apkåˆ—è¡¨è€Œå·²ã€‚ ä¸€èˆ¬androidç³»ç»Ÿçš„åŸºç¡€BOOTCLASSPATHä¸­åŒ…å«5ä¸ªjaråŒ… - core.jarï¼Œext.jarï¼Œframework.jarï¼Œandroid.policy.jarå’Œservices.jarã€‚ è¿™äº›éƒ½å¯ä»¥åœ¨/ system / frameworkä¸­æ‰¾åˆ°ã€‚ ä½†æ˜¯ï¼Œæœ‰äº›apksä¾èµ–äºé¢å¤–çš„jaræˆ–apksæ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºä½¿ç”¨è°·æ­Œåœ°å›¾çš„åº”ç”¨ç¨‹åºï¼Œcom.google.android.maps.jarå°†é™„åŠ åˆ°è¯¥åº”ç”¨ç¨‹åºçš„apkçš„BOOTCLASSPATHä¸­ã€‚ ä¸‹é¢è¿™å‡ ä¸ªç”±äºodexçš„ä¾èµ–æ€§é€ æˆçš„é—®é¢˜æœ‰æ—¶ä¼šè®©äº‹æƒ…å˜å¾—æ¯”è¾ƒéº»çƒ¦ã€‚ é¦–å…ˆ - ä½ ä¸èƒ½ä»ä¸€ä¸ªç³»ç»Ÿé•œåƒä¸­è·å–apk + odexæ–‡ä»¶å¹¶åœ¨å¦ä¸€ä¸ªç³»ç»Ÿæ˜ åƒä¸Šè¿è¡Œå®ƒï¼ˆé™¤éå…¶ä»–ç³»ç»Ÿæ˜ åƒä½¿ç”¨å®Œå…¨ç›¸åŒçš„frameworkæ–‡ä»¶ï¼‰ã€‚ å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœå¯¹ä»»ä½•BOOTCLASSPATHæ–‡ä»¶è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œå®ƒå°†ä½¿ä¾èµ–äºè¯¥æ–‡ä»¶çš„æ¯ä¸ªodexæ— æ•ˆ - åŸºæœ¬ä¸Šæ¯ä¸ªè®¾å¤‡ä¸Šçš„apk / jaréƒ½ä¼šå¤±æ•ˆã€‚ Deodexing(åç¼–è¯‘Odex) ä»¥ä¸‹ç¤ºä¾‹é»˜è®¤ä½ ä½¿ç”¨ä¸‹è½½é¡µé¢ä¸Šæä¾›çš„baksmali wrapperè„šæœ¬æ¥è°ƒç”¨baksmaliã€‚ å¦‚æœä½ æ˜¯ç›´æ¥è°ƒç”¨jarï¼Œå¯ä»¥å°†â€œbaksmaliâ€æ›¿æ¢ä¸ºâ€œjava -jar baksmali.jarâ€ deodexingçš„ä¸¤ä¸ªä¸»è¦é€‰é¡¹æ˜¯-xå’Œ-dã€‚ -xæ˜¯å‘Šè¯‰baksmaliä½ æƒ³è¦deodexçš„å¯¹è±¡ï¼Œ-då‘Šè¯‰baksmaliä»å“ªé‡ŒåŠ è½½ä¾èµ–é¡¹ã€‚ä¾èµ–å†…å®¹å¯ä»¥æ˜¯odexæ–‡ä»¶çš„å½¢å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«classes.dexæ–‡ä»¶çš„jar / apkã€‚ä¸¤è€…çš†å¯ã€‚ ä¾‹å¦‚ï¼Œä½ æƒ³ä»ICSé•œåƒä¸­åç¼–è¯‘Calculator.odexæ–‡ä»¶å¹¶ä¸”æ‰€æœ‰çš„framework odexæ–‡ä»¶å’ŒjaråŒ…éƒ½æ”¾åœ¨ä¸€ä¸ªåä¸ºframeworkçš„æ–‡ä»¶å¤¹ä¸­ï¼Œä½ å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ“ä½œï¼š 1baksmali -a 15 -x Calculator.odex -d framework -o Calculator åç¼–è¯‘Calculator.odexï¼Œå¹¶å°†ç”Ÿæˆçš„deodexed smaliæ–‡ä»¶æ”¾å…¥åä¸ºCalculatorçš„ç›®å½•ä¸­ã€‚ Troubleshooting(é—®é¢˜è§£å†³)Heap Spaceä½ å¯èƒ½é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜æ˜¯å®ƒæ˜¯å¦å·²ç”¨å®Œå †å†…å­˜ã€‚ è¯¥é”™è¯¯å¯èƒ½ç±»ä¼¼äºâ€œjava.lang.OutOfMemoryErrorï¼šJava heap spaceâ€ã€‚ è¦è§£å†³æ­¤é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨-Xmxå‚æ•°æ¥å¢åŠ å †å¤§å°ã€‚ å°è¯•å°†å…¶è®¾ç½®ä¸º512mã€‚ å½“ç„¶ï¼Œå¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥è¿›ä¸€æ­¥å¢åŠ å®ƒã€‚ å¦‚æœä½ ä½¿ç”¨wrapper scriptæ¥è°ƒç”¨baksmaliï¼Œåˆ™å¯ä»¥ä½¿ç”¨-JXmxã€‚ ä¾‹å¦‚ï¼š 1baksmali -JXmx512m -x blah.odex æˆ–è€…é€šè¿‡å¦‚ä¸‹æ–¹å¼ç›´æ¥è°ƒç”¨jaråŒ… 1java -Xmx512m -jar baksmali.jar -x blah.odex Registers(å¯„å­˜å™¨)ä»‹ç»åœ¨dalvikå­—èŠ‚ç ä¸­ï¼Œå¯„å­˜å™¨æ˜¯32ä½ï¼Œå¹¶ä¸”å¯ä»¥ä¿å­˜ä»»ä½•ç±»å‹çš„å€¼ã€‚ 2ä¸ªå¯„å­˜å™¨ç”¨äºä¿å­˜64ä½ç±»å‹ï¼ˆLongå’ŒDoubleï¼‰ã€‚ ç½®é¡¶æ–¹æ³•ä¸­å¯„å­˜å™¨æ•°é‡æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æŒ‡å®šæ–¹æ³•ä¸­æœ‰å¤šå°‘å¯ç”¨å¯„å­˜å™¨ã€‚ .registersæŒ‡ä»¤æŒ‡å®šæ–¹æ³•ä¸­å¯„å­˜å™¨çš„æ€»æ•°ï¼Œè€Œ.localsæŒ‡ä»¤æŒ‡å®šæ–¹æ³•ä¸­éå‚æ•°å¯„å­˜å™¨çš„æ•°é‡ã€‚ å¯„å­˜å™¨æ€»æ•°åŒ…æ‹¬ä¿å­˜æ–¹æ³•å‚æ•°æ‰€éœ€çš„å¯„å­˜å™¨ã€‚ æ–¹æ³•å‚æ•°å¦‚ä½•ä¼ é€’è‡³æ–¹æ³•è°ƒç”¨æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„å‚æ•°å°†ä¼šè¢«æ”¾ç½®åˆ°å€’æ•°çš„nä¸ªå¯„å­˜å™¨ä¸­ã€‚å¦‚æœæŸä¸ªæ–¹æ³•æœ‰2ä¸ªå‚æ•°ï¼Œ5ä¸ªå¯„å­˜å™¨ï¼ˆv0-v4ï¼‰ï¼Œæ­¤æ—¶å‚æ•°ä¼šè¢«æ”¾ç½®åˆ°æœ€åä¸¤ä¸ªå¯„å­˜å™¨ä¸­ï¼Œä¹Ÿå°±æ˜¯v3å’Œv4ã€‚å¯¹äºéstaticæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œéƒ½æ˜¯è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡ã€‚æ¯”å¦‚ï¼Œéstaticæ–¹æ³•LMyObject;-&gt;callMe(II)V.ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰2ä¸ªintå‹å‚æ•°ï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ªéšå‹çš„ LMyObject; å‚æ•°åœ¨ä¸¤ä¸ªæ•´å‹å‚æ•°ä¹‹å‰ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æœ‰3ä¸ªå‚æ•°ã€‚ å‡è®¾é€šè¿‡.registers 5 æŒ‡ä»¤æˆ–è€….local 2æŒ‡ä»¤(i.e. 2ä¸ªlocalå¯„å­˜å™¨å’Œ3ä¸ªå‚æ•°å¯„å­˜å™¨)æ¥æŒ‡å®šè¿™ä¸ªæ–¹æ³•æœ‰5ä¸ªå¯„å­˜å™¨(v0 - v4)ï¼Œå½“æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè°ƒç”¨æ­¤æ–¹æ³•çš„å¯¹è±¡(ä¹Ÿå°±æ˜¯ this å¼•ç”¨)å°†ä¼šè¢«æ”¾ç½®åˆ°v2å¯„å­˜å™¨ä¸­ï¼Œè€Œç¬¬ä¸€ä¸ªæ•´å‹å‚æ•°å°†ä¼šè¢«æ”¾ç½®åˆ°v3å¯„å­˜å™¨ä¸­ï¼Œç¬¬äºŒä¸ªæ•´å‹å‚æ•°ä¼šè¢«æ”¾ç½®åˆ°v4å¯„å­˜å™¨ä¸­ã€‚ å¯¹äºstaticæ–¹æ³•ï¼Œåªæ˜¯å°‘äº†ä¸€ä¸ªéšå‹å‚æ•°ï¼Œthisè€Œå·²ã€‚ Register names(å¯„å­˜å™¨åç§°)å¯¹äºå¯„å­˜å™¨ï¼Œæœ‰ä¸¤ç§å‘½åæ–¹æ¡ˆï¼šæ™®é€šçš„vå¼€å¤´å‘½åæ–¹æ¡ˆå’Œé’ˆå¯¹å‚æ•°å¯„å­˜å™¨çš„på¼€å¤´å‘½åæ–¹æ¡ˆã€‚æˆ‘ä»¬ç»§ç»­çœ‹ä¸Šé¢é‚£ä¸ªæœ‰3ä¸ªå‚æ•°ï¼Œ5ä¸ªå¯„å­˜å™¨çš„æ–¹æ³•ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼åˆ†åˆ«ç”¨ä¸¤ç§å‘½åæ–¹å¼æ¥è¡¨ç¤ºå¯„å­˜å™¨ã€‚ Local Param æ•°é‡ v0 ç¬¬ä¸€ä¸ªlocalå¯„å­˜å™¨ v1 ç¬¬äºŒä¸ªlocalå¯„å­˜å™¨ v2 p0 ç¬¬ä¸€ä¸ªå‚æ•°å¯„å­˜å™¨ v3 p1 ç¬¬äºŒä¸ªå‚æ•°å¯„å­˜å™¨ v4 p2 ç¬¬ä¸‰ä¸ªå‚æ•°å¯„å­˜å™¨ Motivation for introducing parameter registers(å¼•å…¥å‚æ•°å¯„å­˜å™¨çš„åŸå› )på¼€å¤´å‘½åæ–¹æ¡ˆçš„å¼•å…¥æ˜¯ä¸ºäº†è§£å†³å¤§å®¶åœ¨ç¼–è¾‘smaliè¿‡ç¨‹ä¸­çš„å…±åŒçƒ¦æ¼ã€‚æ¯”æ–¹è¯´ï¼Œä½ æƒ³æ·»åŠ ä¸€ä¸‹ä»£ç åˆ°ä¸€ä¸ªæœ‰å‡ ä¸ªå‚æ•°çš„æ–¹æ³•ï¼Œç„¶åä½ å‘ç°ï¼Œä½ éœ€è¦ä¸€ä¸ªé¢å¤–çš„å¯„å­˜å™¨ã€‚ä½ å¯èƒ½ä¼šæƒ³â€œè¿™ä¸æ˜¯å°é—®é¢˜å˜›ï¼Œåªéœ€è¦åœ¨.registersæŒ‡ä»¤ä¸ŠåŠ ä¸€ä¸ªä¸å°±å®Œäº‹äº†â€ã€‚ æ˜¾ç„¶ï¼Œé—®é¢˜ä¸å¯èƒ½é‚£ä¹ˆç®€å•ã€‚è®°ä½ä¸€ç‚¹ï¼Œæ–¹æ³•å‚æ•°æ˜¯å­˜æ”¾åœ¨å¯ç”¨å¯„å­˜å™¨ä¸­å€’æ•°çš„å‡ ä¸ªå¯„å­˜å™¨ä¸­ã€‚å¦‚æœä½ å¢åŠ å¯„å­˜å™¨çš„æ•°é‡ï¼Œä½ å°†ä¼šæ”¹å˜æ–¹æ³•å‚æ•°å­˜æ”¾çš„å¯„å­˜å™¨ã€‚å› æ­¤ï¼Œä½ å¿…é¡»æ›´æ”¹.registersæŒ‡ä»¤å¹¶é‡æ–°ç¼–å·æ¯ä¸ªå‚æ•°å¯„å­˜å™¨ã€‚ ä½†æ˜¯å¦‚æœåœ¨æ•´ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨på‘½åæ–¹æ¡ˆå¼•ç”¨å‚æ•°å¯„å­˜å™¨ï¼Œåˆ™å¯ä»¥è½»æ¾æ›´æ”¹æ–¹æ³•ä¸­çš„å¯„å­˜å™¨æ•°é‡ï¼Œè€Œæ— éœ€æ‹…å¿ƒé‡æ–°ç¼–å·ä»»ä½•ç°æœ‰å¯„å­˜å™¨ã€‚ æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œbaksmaliå°†ä½¿ç”¨å‚æ•°å¯„å­˜å™¨çš„på‘½åæ–¹æ¡ˆã€‚å¦‚æœç”±äºæŸç§åŸå› è¦ç¦ç”¨æ­¤å‘½ä»¤å¹¶å¼ºåˆ¶baksmaliå§‹ç»ˆä½¿ç”¨vå‘½åæ–¹æ¡ˆï¼Œåˆ™å¯ä»¥ä½¿ç”¨-p / - no-parameter-registersé€‰é¡¹ã€‚ Long/Doubleå€¼å¦‚å‰æ‰€è¿°ï¼ŒLongå’ŒDoubleç±»å‹ï¼ˆåˆ†åˆ«ä¸ºJå’ŒDï¼‰æ˜¯64ä½å€¼ï¼Œéœ€è¦2ä¸ªå¯„å­˜å™¨ã€‚åœ¨å¼•ç”¨æ–¹æ³•å‚æ•°æ—¶è¦è®°ä½è¿™ä¸€ç‚¹ã€‚æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªéstaticæ–¹æ³• 1LMyObject;-&gt;MyMethod(IJZ)V æ–¹æ³•å‚æ•°ç±»å‹ä¾æ¬¡æ˜¯ï¼šLMyObject;, int, long, boolã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦5ä¸ªå¯„å­˜å™¨æ¥å­˜æ”¾å‚æ•°ã€‚ Register Type p0 this p1 I p2,p3 J p4 Z SmaliBaksmali2.2v2.2ç‰ˆæœ¬åï¼Œsmailå’Œbaksmaliæœ‰äº†æ–°çš„è„šæ‰‹æ¶å·¥å…·ã€‚ 12baksmali disassemble app.apk -o appsmali assemble app -o classes.dex æ‰§è¡Œbaksmali help å’Œ smali help æŸ¥çœ‹å…¥é—¨å†…å®¹ã€‚ æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š ä½ å¯ä»¥æŠŠapkæˆ–è€…oatæ–‡ä»¶å½“æˆæ–‡ä»¶å¤¹ï¼Œå•ç‹¬æŒ‡å®šå…¶ä¸­çš„æ–‡ä»¶ä½œä¸ºå¯¹è±¡ï¼Œå°±åƒè¿™æ · baksmali disassemble app.apk/classes2.dexã€‚æ‰§è¡Œbaksmali help inputæŸ¥é˜…æ›´å¤šç›¸å…³ä¿¡æ¯ã€‚ deodexingæ—¶æŒ‡å®šbootclasspath/classpathçš„å‘½ä»¤é€‰é¡¹åšäº†å°çš„è°ƒæ•´ã€‚ç°åœ¨deodexing oat æ–‡ä»¶ï¼Œä¸€èˆ¬è¿™æ ·æ“ä½œadb pull /system/framework framework &amp;&amp; baksmali deodex app.odex -b framework/arm/boot.oat baksmailç°åœ¨åŒ…å«ä¸€ç³»åˆ—åˆ—ä¸¾dex/oat/apk æ–‡ä»¶å„ç§ç›¸å…³ä¿¡æ¯çš„å‘½ä»¤ baksmali list dex boot.oatåˆ—ä¸¾å‡ºoatæ–‡ä»¶ä¸­æ‰€æœ‰dexï¼ˆæ­¤å‘½ä»¤ä¹Ÿé€‚ç”¨äºapkæ–‡ä»¶ï¼‰ baksmali list classes app.apkåˆ—ä¸¾apk/dexç­‰æ–‡ä»¶ä¸­çš„æ‰€æœ‰ç±» baksmali list methods app.apk | wc -lè·å–å½“å‰dexæ–‡ä»¶ä¸­çš„æ–¹æ³•æ•° V2.2æ”¯æŒåœ¨Nougatç‰ˆæœ¬ä¸Šè§£ç oatæ–‡ä»¶ï¼Œå¹¶åŒ…å«ä¸€äº›é’ˆå¯¹Marshmallowç‰ˆæœ¬çš„é”™è¯¯ä¿®æ­£ åœ¨dexlib2ç­‰æ–‡ä»¶ä¸­æœ‰ä¸€äº›é‡å¤§çš„APIæ›´æ”¹ã€‚å› æ­¤ï¼Œå¦‚æœä½ æ‰“ç®—å°†å·¥å…·å‡çº§åˆ°dexlib2 v2.2ï¼Œä½ å¯èƒ½éœ€è¦èŠ±ç‚¹äº‹ä»¶å»è§£å†³ä¸€äº›é—®é¢˜ SmaliBaksmali2.0smali/baksmali 2.0ç‰ˆæœ¬æ˜¯ä¸‹ä¸€ä¸ªé‡å¤§æ›´æ–°ç‰ˆæœ¬ï¼Œä¸»è¦å°±æ˜¯dexlibçš„æ›´æ–°ã€‚å½“å‰æ­£å¤„äºæµ‹è¯•é˜¶æ®µï¼Œå¦‚æœæƒ³ä½“éªŒä¸€ä¸‹ï¼Œå¯ä»¥è‡ªè¡Œå‰å¾€ä¸‹è½½ç•Œé¢ä¸‹è½½2.0b1 jaræ–‡ä»¶ã€‚ è¿™å¯¹ä½ æ„å‘³ç€ä»€ä¹ˆï¼Ÿå¤§éƒ¨åˆ†å†…å®¹å¯¹ä½ æ²¡æœ‰å½±å“ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å®ƒè¿è¡Œæ›´å¿«å¹¶ä¸”ä½¿ç”¨æ›´å°‘çš„å†…å­˜ã€‚ ä½†æ˜¯ï¼Œä¸‹é¢è¿™å‡ ç‚¹ä½ è¿˜æ˜¯éœ€è¦ç¨å¾®æ³¨æ„ä¸€ä¸‹ã€‚ Multithreading(å¤šçº¿ç¨‹)smaliå’Œbaksmaliç°åœ¨æ˜¯å¤šçº¿ç¨‹çš„ï¼é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä½¿ç”¨å¯ç”¨çš„CPUæ•°ï¼Œæœ€å¤šä¸º6ã€‚ä½ å¯ä»¥ä½¿ç”¨-jé€‰é¡¹è¿›è¡Œè®¾ç½®ã€‚ä¸ºäº†åœ¨å…·æœ‰å¤šçº¿ç¨‹çš„smaliä¸­è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæœ€å¥½ç¨å¾®æé«˜å†…å­˜ã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨smali wrapper scriptï¼Œåˆ™å¯ä»¥é€šè¿‡æ·»åŠ -JXmx512mé€‰é¡¹æ‰‹åŠ¨æ‰§è¡Œæ­¤æ“ä½œã€‚ 1smali -JXmx512m out -o classes.dex å½“ç„¶ï¼Œä½ å¯ä»¥ä½¿ç”¨é»˜è®¤åªä½512mçš„smali wrapper script Language Changes(è¯­è¨€æ”¹åŠ¨)æˆ‘åˆ©ç”¨ä¸€æ¬¡é‡å¤§ä¿®è®¢çš„æœºä¼šæ¥è°ƒæ•´è¯­è¨€æœ¬èº«çš„ä¸€äº›å†…å®¹ã€‚ .parameter -&gt; .param12345.method parameters(IILjava/lang/String;)V .parameter .parameter .parameter stringParameter... å˜æˆ 123.method parameters(IILjava/lang/String;)V .param p3, \"stringParameter\"... .parameteræŒ‡ä»¤ç°åœ¨ä¸º.paramï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ä¸.localæŒ‡ä»¤ç±»ä¼¼ã€‚ .paramæŒ‡ä»¤ä¸æ˜¯æŒ‰é¡ºåºå°†.parameterä¿¡æ¯ä¸æ¯ä¸ªå‚æ•°åŒ¹é…ï¼Œè€Œæ˜¯ä½¿ç”¨registerå‚æ•°æŒ‡å®šä¸ä¹‹å…³è”çš„å‚æ•°ã€‚ .array-data changes123456.array-data 0x4 0x0t 0x0t 0x80t 0x0t 0x0t 0x0t 0x40t 0x0t 0x0t 0x0t 0x20t 0x0t 0x0t 0x0t 0x10t 0x0t.end array-data å˜æˆ 123456.array-data 4 0x800000 0x400000 0x200000 0x100000.end array-data .array-dataä¸­çš„æ¯ä¸ªæ•°å­—ç°åœ¨éƒ½æ˜¯å®ƒè‡ªå·±çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„è¯­æ³•ï¼Œå®ƒä¼šè¿æ¥æ¯ä¸ªæ•°å­—çš„little-endianç¼–ç ï¼Œç„¶åå°†å®Œæ•´çš„è¿æ¥å­—èŠ‚æ•°ç»„é‡æ–°è§£é‡Šä¸ºn-byte little-endianåºç¼–ç å…ƒç´ ã€‚ const/high16 and const-wide/high1612const/high16 v0, 0x1234const-wide/high16 v0, 0x1234 å˜æˆ 12const/high16 v0, 0x12340000const-wide/high16 v0, 0x1234000000000000 æ›´æ”¹äº†* / high16æŒ‡ä»¤çš„è¯­æ³•ï¼Œä»¥ä¾¿å®ƒä½¿ç”¨åŠ è½½åˆ°å¯„å­˜å™¨ä¸­çš„å®é™…å€¼ï¼Œè€Œä¸ä»…ä»…æ˜¯å­˜å‚¨åœ¨æŒ‡ä»¤ä¸­çš„16ä½ã€‚ ä¹Ÿå°±æ˜¯è¯´æŒ‡å®šé™¤äº†é¡¶éƒ¨16ä½ä»¥å¤–çš„ä½ä¸ºé0æ˜¯é”™è¯¯çš„ã€‚ä¾‹å¦‚const/high16 v0, 0x12340001å°†ä¼šæ˜¯é”™è¯¯çš„ã€‚ smalideasmalideaæ˜¯ä¸€ä¸ªé’ˆå¯¹Intellij IDEAä»¥åŠAndroid Studio çš„smaliè¯­è¨€æ’ä»¶ã€‚ Download(ä¸‹è½½)å½“å‰ä¸ºalphaç‰ˆæœ¬ï¼ŒæŒç»­å¼€å‘ä¸­ã€‚ Features(ç‰¹æ€§)å½“å‰èƒ½åŠ› è¯­æ³•é«˜äº®/è¯­æ³•é”™è¯¯ å­—èŠ‚ç çº§è°ƒè¯• æ–­ç‚¹ æŒ‡ä»¤çº§å•æ­¥è°ƒè¯• ç»™ä»»æ„å¯„å­˜å™¨æ·»åŠ watcher è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå®Œå…¨javaé£æ ¼è¡¨è¾¾å¼æœ¬åœ°çª—å£æ”¯æŒç­‰ è·³è½¬åˆ°å®šä¹‰å¤„ æŸ¥æ‰¾å¼•ç”¨ é‡å‘½å åœ¨javaä»£ç ä¸­å¼•ç”¨smaliç±»(ä½†æ˜¯å½“å‰è¿˜ä¸èƒ½çœŸæ­£è¢«ç¼–è¯‘) é—®é¢˜æŠ¥å‘Š - ä»é”™è¯¯å¯¹è¯æ¡†è½»æ¾åˆ›å»ºæ–°çš„githubé—®é¢˜ è®¡åˆ’èƒ½åŠ› è‡ªåŠ¨è¡¥å…¨ï¼ˆæŒ‡ä»¤åç§°ï¼Œç±»å/æ–¹æ³•å/å˜é‡åç­‰ç­‰ï¼‰ çº¯Smaliå·¥ç¨‹ç¼–è¯‘ å¥å£®æ€§é”™è¯¯æ£€æµ‹ï¼ˆå¦‚ï¼Œå…¨å­—èŠ‚ç æ£€æµ‹ï¼‰ æµç•…åœ°é¡¹ç›®å¯¼å…¥è¿‡ç¨‹ è‡ªåŠ¨æ£€æµ‹æºç›®å½• é€‰æ‹©SDK APKä½œä¸ºæ–°é¡¹ç›®å¯¼å…¥å¼•å¯¼ æ·»åŠ â€œSmali Classâ€åˆ°â€œNewâ€¦â€èœå•ä¸­ åœ¨â€œlocalsâ€çª—æ ¼ä¸­æ˜¾ç¤ºå…·æœ‰å€¼çš„æ‰€æœ‰å¯„å­˜å™¨ â€œwatchâ€çª—æ ¼ä¸­è®¾ç½®å¯„å­˜å™¨çš„å€¼ æœ‰æ½œåŠ›åŠŸèƒ½ smali+javaæ··åˆå·¥ç¨‹ç¼–è¯‘ â€œå¼•å…¥æ–°å¯„å­˜å™¨â€ å¯¼å…¥æˆ–è€…deodexè®¾å¤‡frameworkä½œä¸ºæ–°æ¨¡å—æˆ–è€…ä½œä¸ºsdk å…¬å¼€å¯„å­˜å™¨ç±»å‹åˆ†ææ•°æ® éšæ—¶æ˜¾ç¤ºå¯„å­˜å™¨çš„é¢„æœŸç±»å‹ å¯»æ‰¾å¯„å­˜å™¨è®¾å€¼ä½ç½® å®‰è£… ä¸‹è½½æœ€æ–°smalidea zip æ–‡ä»¶ åœ¨IDEAæˆ–è€…Android Studioä¸­â€œSettings-&gt;Pluginsâ€ä¸­â€Install plugin from diskâ€ â€œApplyâ€å¹¶ä¸”é‡å¯ è°ƒè¯•æ³¨æ„ï¼šå•æŒ‡ä»¤å•æ­¥è°ƒè¯•åœ¨ IDEA 14.1åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ(Android Studioæ˜¯åŸºäºIDEAçš„ï¼Œæ‰€ä»¥ç±»ä¼¼)ã€‚è€Œæ­¤ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæ‰§è¡Œå•æ­¥è°ƒè¯•çš„æ—¶å€™ï¼Œå›è°ƒè½¬åˆ°ä¸‹ä¸€ä¸ª.lineæŒ‡ä»¤ï¼Œè€Œä¸æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ ä½¿ç”¨baksmaliåç¼–è¯‘ä¸€ä¸ªåº”ç”¨åˆ°â€srcâ€æ–‡ä»¶å¤¹ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªæ–°å·¥ç¨‹çš„æºæ–‡ä»¶å¤¹ã€‚baksmali d myapp.apk -o ~/projects/myapp/src IDEAä¸­ï¼Œå¯¼å…¥æ–°é¡¹ç›®ï¼Œé€‰æ‹©åˆšæ‰çš„æ–°å·¥ç¨‹ç›®å½•~/projects/myapp åœ¨å¯¼å…¥é¡¹ç›®æ—¶ä½¿ç”¨â€œCreate project from existing sourcesâ€é€‰é¡¹ é¡¹ç›®å¯¼å…¥å®Œæˆåï¼Œå³é”®srcæ–‡ä»¶å¤¹ï¼Œâ€Mark Directory As-&gt;Sources Rootâ€ æ‰“å¼€é¡¹ç›®è®¾ç½®ç•Œé¢ï¼Œé€‰æ‹©æˆ–è€…åˆ›å»ºåˆé€‚çš„JDK åœ¨è®¾å¤‡ä¸Šå®‰è£…å¯åŠ¨æ­¤åº”ç”¨ è¿è¡ŒDDMSï¼Œæ‰¾åˆ°å¯¹åº”çš„åº”ç”¨è¿›ç¨‹ åœ¨IDEAä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„â€œRemoteâ€è°ƒè¯•é…ç½®(Run-&gt;Edit Configurations)ï¼Œå¹¶æ”¹å˜è°ƒè¯•ç«¯å£è‡³8700 Run -&gt; Debug å½“æ–­ç‚¹è¢«è§¦å‘æ—¶ï¼Œåº”ç”¨ç¨‹åºå°†ä¼šæš‚åœï¼Œæ­¤æ—¶ä½ å¯ä»¥å•æ­¥ï¼Œæ·»åŠ watchç­‰ æˆ–è€… åœ¨Android Studio3.2ä¸‹è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š ä½¿ç”¨baksmaliåç¼–è¯‘ä¸€ä¸ªåº”ç”¨åˆ°â€srcâ€æ–‡ä»¶å¤¹ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªæ–°å·¥ç¨‹çš„æºæ–‡ä»¶å¤¹ã€‚baksmali d myapp.apk -o ~/projects/myapp/src åœ¨Android Studioä¸­ï¼Œå…³é—­å½“å‰é¡¹ç›®ï¼Œæ‰§è¡Œâ€œOpen an existing Android Studio projectâ€ é¡¹ç›®åˆ›å»ºå®Œæˆåï¼Œå³é”®srcæ–‡ä»¶å¤¹ï¼Œâ€Mark Directory As-&gt;Sources Rootâ€ ç¡®ä¿åº”ç”¨AndroidManifest.xmlä¸­â€œandroid:debuggable=â€trueâ€ã€‚æ‰“å¼€â€œUSBè°ƒè¯•â€å¹¶ä¸”åœ¨â€œå¼€å‘è€…é€‰é¡¹â€ä¸­ä½¿ç”¨â€œé€‰æ‹©å¾…è°ƒè¯•åº”ç”¨â€ å¯åŠ¨åº”ç”¨ç¨‹åºå¹¶å°†JDWPæœåŠ¡è½¬å‘åˆ°localhostï¼Œadb forward tcp:8700 jdwp:$(timeout 0.5 adb jdwp | tail -n 1) åœ¨Android Studioä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„â€œRemoteâ€è°ƒè¯•é…ç½®(Run-&gt;Edit Configurations)ï¼Œå¹¶æ”¹å˜è°ƒè¯•ç«¯å£è‡³8700 åœ¨Android Studioä¸­ï¼Œ Run -&gt; Debug å½“æ–­ç‚¹è¢«è§¦å‘æ—¶ï¼Œåº”ç”¨ç¨‹åºå°†ä¼šæš‚åœï¼Œæ­¤æ—¶ä½ å¯ä»¥å•æ­¥ï¼Œæ·»åŠ watchç­‰ TypesMethodsAndField(ç±»å‹ï¼Œæ–¹æ³•å’Œå­—æ®µ)ç±»å‹dalvikå­—èŠ‚ç æœ‰ä¸¤ä¸ªä¸»è¦çš„ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚å¼•ç”¨å¯¹è±¡æŒ‡çš„æ˜¯å¯¹è±¡ï¼Œæ•°ç»„ç­‰åŸºç¡€ç±»å‹å¤–çš„æ‰€æœ‰ç±»å‹ã€‚æ¯ä¸ªåŸºæœ¬ç±»å‹éƒ½ç”±å•ä¸ªå­—æ¯ä»£è¡¨ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘æƒ³å‡ºæ¥çš„ç‚¹å­ï¼Œä»–ä»¬çœŸçœŸå®å®åœ°ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨åœ¨dexæ–‡ä»¶ä¸­ã€‚å®ƒä»¬åœ¨ dex-format.html æ–‡æ¡£ä¸­è¢«æ˜ç¡®çš„æŒ‡å‡ºæ¥è¿‡(Androidæºç ä»“ä¸­dalvik/docs/dex-format.html)ã€‚ V void - åªèƒ½ç”¨äºè¿”å›ç±»å‹ Z boolean B byte S short C char I int J long(64bits) F float D double(64bits) Objectåˆ™æ˜¯ä»¥Lpackage/name/ObjectName;çš„å½¢å¼å‡ºç°ï¼ŒLè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œpackage/name/æŒ‡ä»£åŒ…åï¼ŒObjectNameä¸ºå½“å‰å¯¹è±¡ç±»å‹åç§°ï¼Œ:ä½œä¸ºå¯¹è±¡çš„ç»“å°¾ã€‚è¿™ç­‰ä»·äºjavaçš„package.name.ObjectNameï¼Œä»¥Stringè¿™ä¸ªå…·ä½“çš„ç±»å‹ä¸ºä¾‹å­ï¼ŒLjava/lang/String;ç­‰ä»·äºjava.lang.Stringã€‚ Arrays(æ•°å­—)åˆ™æ˜¯ä»¥[Içš„å½¢å¼å‡ºç°ï¼Œè¿™æŒ‡ä»£çš„æ˜¯ä¸€ä¸ªintç±»å‹ä¸€ç»´æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯javaä¸­int[]ã€‚è‡³äºå¤šç»´æ•°ç»„ï¼Œåªéœ€è¦åœ¨å‰é¢æ·»åŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ª[å­—ç¬¦ã€‚[[I=int[][]ï¼Œ[[[I=int[][][](æ³¨æ„ï¼Œæ•°å­—çš„æœ€å¤§ç»´åº¦ä¸º255)ã€‚ å¯¹è±¡æ•°æ®ï¼Œå¦‚[Ljava/lang/String;é“ç†å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ã€‚ æ–¹æ³•æ–¹æ³•æ€»æ˜¯ä»¥éå¸¸è¯¦ç»†çš„å½¢å¼æŒ‡å®šï¼ŒåŒ…æ‹¬æ–¹æ³•çš„ç±»å‹ï¼Œæ–¹æ³•åç§°ï¼Œå‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹ã€‚è™šæ‹Ÿæœºéœ€è¦æ‰€æœ‰è¿™äº›ä¿¡æ¯æ‰èƒ½æ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•ï¼Œå¹¶èƒ½å¤Ÿå¯¹å­—èŠ‚ç æ‰§è¡Œé™æ€åˆ†æï¼ˆç”¨äºéªŒè¯/ä¼˜åŒ–ç›®çš„ï¼‰ã€‚ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š 1Lpackage/name/ObjectName;-&gt;MethodName(III)Z ä¸Šé¢è¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒLpackage/name/ObjectName;è¡¨ç¤ºç±»å‹ï¼ŒMethodNameè¡¨ç¤ºæ–¹æ³•åï¼Œ(III)Zä¸­IIIè¡¨ç¤ºå‚æ•°ç±»å‹ï¼ˆ3ä¸ªintå‹ï¼‰ï¼ŒZè¡¨ç¤ºæ–¹æ³•çš„è¿”å›ç±»å‹ï¼ˆboolç±»å‹ï¼‰ã€‚æ–¹æ³•å‚æ•°ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°åˆ—å‡ºï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰åˆ†éš”ç¬¦ã€‚ä¸‹é¢æœ‰ä¸€ä¸ªæ›´å¤æ‚çš„ç¤ºä¾‹ï¼š 1method(I[[IILjava/lang/String;[Ljava/lang/Object;)Ljava/lang/String; ç­‰ä»·äº 1String method(int, int[][], int, String, Object[]) å­—æ®µå­—æ®µåŒæ ·æ€»æ˜¯ä»¥è¯¦ç»†å½¢å¼æŒ‡å®šï¼ŒåŒ…æ‹¬åŒ…å«å­—æ®µçš„ç±»å‹ï¼Œå­—æ®µåç§°å’Œå­—æ®µç±»å‹ã€‚åŒæ ·ï¼Œè¿™äº›ä¿¡æ¯ä¹Ÿæ˜¯ä¸ºäº†å¸®åŠ©è™šæ‹Ÿæœºèƒ½å¤Ÿæ‰¾åˆ°æ­£ç¡®çš„å­—æ®µï¼Œä»¥åŠå¯¹å­—èŠ‚ç æ‰§è¡Œé™æ€åˆ†æã€‚ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š 1Lpackage/name/ObjectName;-&gt;FieldName:Ljava/lang/String; è¿™åº”è¯¥æ˜¯ä¸è¨€è‡ªæ˜çš„ - å®ƒä»¬åˆ†åˆ«æ˜¯åŒ…åï¼Œå­—æ®µåå’Œå­—æ®µç±»å‹ã€‚ UnresolvableOdexInstructionï¼ˆæš‚æ—¶æ— æ³•è§£å†³çš„OdexæŒ‡ä»¤ï¼‰è¯´æ˜åœ¨deodexingè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨baksmaliäº§ç”Ÿçš„ä¸€äº›smaliæ–‡ä»¶ä¸­ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°baksmaliç”¨ä¸€ä¸ªthrowæˆ–å…¶ä»–ä¸œè¥¿æ›¿æ¢odexedæŒ‡ä»¤çš„ä¸€äº›æƒ…å†µï¼Œå…¶ä¸­çš„æ³¨é‡Šå¦‚â€œReplaced unresolvable optimized instruction with a throwâ€ã€‚ è¯¦æƒ…æ¯”å¦‚ï¼Œä¸‹é¢è¿™æ®µjavaä»£ç ï¼š 12Object blah = null;blah.toString(); ç›¸å¯¹åº”çš„Smaliä»£ç ä¸ºï¼š 12const v0, 0invoke-virtual {v0}, Ljava/lang/Object;-&gt;toString(); è¿™å½“ç„¶ä¼šå¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸ - ä½†å®ƒæ˜¯æœ‰æ•ˆçš„ä»£ç ã€‚åœ¨å®è·µä¸­ï¼Œè¿™äº›æ¡ˆä¾‹æ›´åŠ éšè”½ã€‚ å½“ä»£ç è¢«odexedæ—¶ï¼Œinvoke-virtualæŒ‡ä»¤å°†è¢«ä¸€ä¸ªinvoke-virtual-quickæŒ‡ä»¤æ›¿æ¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12const v0, 0invoke-virtual-quick {v0), vtable@7 å…¶ä¸­vtable @ 7æ˜¯æŒ‡å‘Objectæ˜¯æŠ½è±¡æ–¹æ³•è¡¨ä¸­toString()æ–¹æ³•çš„ç´¢å¼•ã€‚ ä½†è¯·æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç å¹¶æ²¡æœ‰æåˆ°è¯¥æ–¹æ³•æ‰€åœ¨çš„ç±»ã€‚ç”±äºv0å§‹ç»ˆä¸ºnullï¼Œå¹¶ä¸”æˆ‘ä»¬åªæœ‰vtableç´¢å¼•ï¼Œå› æ­¤baksmaliä¸å¯èƒ½çŸ¥é“è¦æŸ¥çœ‹å“ªä¸ªç±»ã€‚æ‰€ä»¥ï¼Œä¸å¯èƒ½deodex è¿™æ¡æŒ‡ä»¤ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°½é‡å¯¹å…¶è¿›è¡Œå¤„ç†ï¼šç”¨å…·æœ‰å®Œå…¨ç›¸åŒæ•ˆæœçš„å†…å®¹æ¥æ›¿æ¢è¿™æ¡æŒ‡ä»¤ã€‚è®°ä½v0å§‹ç»ˆä¸ºnullï¼Œæ‰€ä»¥é€šè¿‡å®ƒè°ƒç”¨ä»»ä½•æ–¹æ³•éƒ½ä¼šå¯¼è‡´ç©ºæŒ‡é’ˆã€‚æ‰€ä»¥Samliå°±ä½¿ç”¨åŒæ ·ä¼šæŠ›å‡ºç©ºæŒ‡é’ˆçš„å†…å®¹æ¥æ›¿æ¢è¿™æ¡æ— æ³•è§£å†³çš„odexæŒ‡ä»¤ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œç´§éšä¸Šé¢è¿™äº›æ— æ³•è§£å†³çš„odexæŒ‡ä»¤çš„codeï¼Œç”±äºæ°¸è¿œæ— æ³•æ‰§è¡Œè€Œæˆä¸ºäº†å†—ä½™ä»£ç ï¼ˆé™¤éæœ‰å…¶ä»–åˆ†æ”¯å¯ä»¥è®¿é—®åˆ°å®ƒä»¬ï¼‰ã€‚æˆ–è€…åœ¨ä¸€äº›å…¶ä»–æƒ…å†µä¸‹ï¼Œä»£ç ä¾èµ–çš„æ˜¯ä¸€ä¸ªæˆ‘ä»¬æ— æ³•è§£å†³çš„odexæŒ‡ä»¤æ–¹æ³•ç»“æœï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†ä»£ç ä¹Ÿæ˜¯ä¸å¯èƒ½è¢«deodexçš„ï¼Œå› ä¸ºï¼Œè¿™éƒ¨åˆ†ä»£ç æ— æ³•è¢«è®¿é—®åˆ°ï¼Œå…¨è¢«ç§»é™¤æˆ–è€…æ³¨é‡Šæ‰äº†ã€‚ å› æ­¤ï¼Œç®€è€Œè¨€ä¹‹ï¼Œè¿™äº›æƒ…å†µä¸åº”å½±å“å­—èŠ‚ç çš„è¯­ä¹‰/åŠŸèƒ½ã€‚å½“ä½ çœ‹åˆ°â€œreplaced unresolvable optimized instructionâ€ï¼Œä¸å¿…å¤§æƒŠå°æ€ªã€‚Baksmaliå¯¹è¿™éƒ¨åˆ†å‘¢æ—¥ç”¨çš„å¤„ç†ä¸å½±å“ä»£ç åŠŸèƒ½/è¯­ä¹‰ï¼ˆå¦‚æœå¯¹åŠŸèƒ½/è¯­ä¹‰é€ æˆäº†å½±å“ï¼Œé‚£å°±æ˜¯baksmaliçš„bugï¼‰ã€‚ ç›®å‰ï¼Œå­˜åœ¨ä¸æ­¤ç›¸å…³çš„å·²çŸ¥é—®é¢˜ï¼Œå…¶ä¸­å¦‚æœtryå—ä¸­çš„æ‰€æœ‰ä»£ç éƒ½è¢«æ³¨é‡Šæ‰ï¼Œå› ä¸ºå®ƒä¾èµ–ä¸€ä¸ªæ— æ³•è§£æçš„odexæŒ‡ä»¤ï¼Œåˆ™ï¼ˆç©ºï¼‰tryå—ä¿ç•™åœ¨å…¶ä¸­ï¼Œå¹¶ä¸”å½“å®‰è£…åˆ°è®¾å¤‡ä¸Šæ—¶ï¼Œç©º tryå—ä¼šå¯¼è‡´dalvikæ‹’ç»dexæ–‡ä»¶ã€‚","link":"/2019/03/20/ã€ŠAndroid å®‰å…¨ï¼ˆäºŒï¼‰ã€‹Smaliè¯­æ³•åŸºç¡€/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ EventBus ç”¨æ³•è¯¦è§£ï¼ˆè¯‘æ–‡ï¼‰","text":"ä»‹ç»EventBusæ˜¯ä¸€ä¸ªä½¿ç”¨å‘å¸ƒè€…/è®¢é˜…è€…æ¨¡å¼ å¹¶ä¸”ä½è€¦åˆçš„Androidå¼€æºåº“ï¼Œã€‚ EventBusåªéœ€å‡ è¡Œä»£ç å³å¯å®ç°ä¸­å¤®é€šä¿¡è§£è€¦ç±»ï¼šç®€åŒ–ä»£ç ï¼Œåˆ é™¤ä¾èµ–å…³ç³»ï¼ŒåŠ å¿«åº”ç”¨ç¨‹åºå¼€å‘é€Ÿåº¦ã€‚ ä¼˜åŠ¿ ç®€åŒ–ç»„ä»¶é€šä¿¡ è§£è€¦äº‹ä»¶å‘é€ç«¯å’Œæ¥æ”¶ç«¯ åœ¨Activity,Fragmentå’Œåå¤©çº¿ç¨‹ä¹‹é—´è¿è¡Œè‰¯å¥½ é¿å…å¤æ‚ä¸”æ˜“å‡ºé”™çš„ä¾èµ–é—®é¢˜å’Œç”Ÿå‘½å‘¨æœŸé—®é¢˜ è¿è¡Œé€Ÿåº¦å¿«ã€‚ä¸ºäº†é«˜æ€§èƒ½ä¸“é—¨åšè¿‡ä¼˜åŒ– jaråŒ…å°ï¼ˆ&lt;50Kï¼‰ åœ¨å®è·µä¸­å·²é€šè¿‡100,000,000æ¬¡å®‰è£…çš„åº”ç”¨ç¨‹åºè¯æ˜ å…·æœ‰æŒ‡å®šåˆ†å‘çº¿ç¨‹å’Œç”¨æˆ·ä¼˜å…ˆçº§ç­‰é«˜çº§ç‰¹æ€§ ç‰¹æ€§ ç®€å•ä½†å¼ºå¤§ï¼šEventBusæ˜¯ä¸€ä¸ªå¾®å°çš„åº“ï¼Œå…·æœ‰è¶…çº§å®¹æ˜“å­¦ä¹ çš„APIã€‚ç„¶è€Œï¼Œæ‚¨çš„è½¯ä»¶æ¶æ„å¯èƒ½å› ç»„ä»¶è§£è€¦è€Œå—ç›Šï¼šè®¢é˜…è€…åœ¨ä½¿ç”¨äº‹ä»¶æ—¶ä¸ç”¨å…³å¿ƒè¿™ä¸ªäº‹ä»¶æ˜¯è°å‘é€çš„ã€‚ å¤§é‡éªŒè¯ï¼šEventBusæ˜¯æœ€å¸¸ç”¨çš„Androidåº“ä¹‹ä¸€ï¼šæˆåƒä¸Šä¸‡çš„åº”ç”¨ç¨‹åºä½¿ç”¨EventBusï¼Œå…¶ä¸­ä¸ä¹éå¸¸å—æ¬¢è¿çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬è®¤ä¸ºå·®ä¸å¤šæœ‰åäº¿åº”ç”¨ç¨‹åºä½¿ç”¨EventBusã€‚ é«˜æ€§èƒ½ï¼šAndroidç³»ç»Ÿä¸Šï¼Œæ€§èƒ½å°¤ä¸ºé‡è¦ã€‚ EventBusè¢«é’ˆå¯¹æ€§çš„åšäº†å¤§é‡çš„åˆ†æå’Œä¼˜åŒ–;EventBuså¯èƒ½æ˜¯è¿™ç±»å¼€æºåº“ä¸­é€Ÿåº¦æœ€å¿«çš„ è§£å†³æ–¹æ¡ˆã€‚ åŸºäºAPIçš„ä¾¿æ·æ³¨è§£ï¼ˆä¸ç‰ºç‰²æ€§èƒ½ï¼‰ï¼šåªéœ€å°†@Subscribeæ³¨è§£æ·»åŠ è®¢é˜…æ–¹æ³•å³å¯ã€‚ç”±äºæ„å»ºçš„æ—¶å€™èŠ±è´¹äº†æ—¶é—´æ¥å»ºç«‹æ³¨è§£çš„ç´¢å¼•ï¼Œæ‰€ä»¥EventBusä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶é—´æ‰§è¡Œæ³¨é‡Šåå°„ï¼Œæ³¨è§£åå°„çš„æ–¹å¼åœ¨Androidä¸Šç›¸å½“æ…¢ã€‚ Androidä¸»çº¿ç¨‹å‘é€ï¼šå½“ä¸UIäº¤äº’æ—¶ï¼ŒEventBuså¯ä»¥åœ¨ä¸»çº¿ç¨‹ä¸­ä¼ é€’äº‹ä»¶ï¼Œè€Œä¸ç”¨å»å…³å¿ƒäº‹ä»¶æ˜¯ä»å¦‚ä½•å‘å¸ƒçš„ã€‚ åå°çº¿ç¨‹å‘é€ï¼šå¦‚æœæ‚¨çš„è®¢é˜…è€…é•¿æ—¶é—´è¿è¡Œä»»åŠ¡ï¼ŒEventBusä¹Ÿå¯ä»¥ä½¿ç”¨åå°çº¿ç¨‹æ¥é¿å…UIé˜»å¡ã€‚ äº‹ä»¶å’Œè®¢é˜…è€…ç»§æ‰¿ï¼šåœ¨EventBusä¸­ï¼Œé¢å‘å¯¹è±¡çš„èŒƒä¾‹é€‚ç”¨äºäº‹ä»¶å’Œè®¢é˜…è€…ç±»ã€‚è®©æˆ‘ä»¬å‡è®¾äº‹ä»¶ç±»Aæ˜¯Bçš„çˆ¶ç±»ã€‚ç±»å‹Bçš„å‘å¸ƒäº‹ä»¶ä¹Ÿå°†è¢«å‘å¸ƒåˆ°å¯¹Aæ„Ÿå…´è¶£çš„è®¢é˜…è€…ã€‚ç±»ä¼¼åœ°ï¼Œè€ƒè™‘è®¢é˜…ç±»çš„ç»§æ‰¿ã€‚ é›¶é…ç½®ï¼šæ‚¨å¯ä»¥ä»ä»£ç ä¸­çš„ä»»ä½•åœ°æ–¹ç«‹å³ä½¿ç”¨é»˜è®¤çš„EventBuså®ä¾‹ã€‚ å¯é…ç½®ï¼šè¦æ ¹æ®éœ€è¦è°ƒæ•´EventBusï¼Œå¯ä»¥ä½¿ç”¨æ„å»ºå™¨æ¨¡å¼è°ƒæ•´å…¶è¡Œä¸ºã€‚ æ·»åŠ EventBusåˆ°å·¥ç¨‹EventBusåœ¨JCenterå’ŒMaven Centralä¸Šå¯ç”¨ï¼Œå› æ­¤åªéœ€å°†ä¾èµ–é¡¹æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚ Gradle 1compile 'org.greenrobot:eventbus:3.0.0' Maven 12345&lt;dependency&gt; &lt;groupId&gt;org.greenrobot&lt;/groupId&gt; &lt;artifactId&gt;eventbus&lt;/artifactId&gt; &lt;version&gt;3.0.0&lt;/version&gt;&lt;/dependency&gt; jaråŒ… å¼€å§‹ä½¿ç”¨EventBusä¸€ã€ç®€å•çš„ä¸‰æ­¥æ•™ä½ ä½¿ç”¨EvnetBuså®šä¹‰äº‹ä»¶äº‹ä»¶æ˜¯çº¯Javaå¯¹è±¡ï¼Œæ²¡æœ‰å…¶ä»–çš„ç‰¹æ®Šè¦æ±‚ 12345678public class MessageEvent { public final String message; public MessageEvent(String message) { this.message = message; }} å‡†å¤‡è®¢é˜…è€…è®¢é˜…è€…éœ€è¦å®ç°åœ¨äº‹ä»¶å‘å¸ƒæ—¶å°†è¢«è°ƒç”¨çš„äº‹ä»¶å¤„ç†æ–¹æ³•ï¼ˆä¹Ÿç§°ä¸ºâ€œè®¢é˜…æ–¹æ³•â€ï¼‰ã€‚ è¿™äº›è®¢é˜…æ–¹æ³•å°†ç”¨@Subscribeæ³¨é‡Šå®šä¹‰ã€‚æ³¨æ„ï¼Œä½¿ç”¨EventBus 3å¯ä»¥è‡ªç”±é€‰æ‹©æ–¹æ³•åï¼ˆæ²¡æœ‰åƒEventBus 2ä¸­çš„å‘½åçº¦å®šï¼‰ã€‚ 1234567891011// This method will be called when a MessageEvent is posted (in the UI thread for Toast)@Subscribe(threadMode = ThreadMode.MAIN)public void onMessageEvent(MessageEvent event) { Toast.makeText(getActivity(), event.message, Toast.LENGTH_SHORT).show();}// This method will be called when a SomeOtherEvent is posted@Subscribepublic void handleSomethingElse(SomeOtherEvent event) { doSomethingWith(event);} è®¢é˜…è€…è¿˜éœ€è¦å‘æ€»çº¿æ³¨å†Œå’Œæ³¨é”€ã€‚ åªæœ‰è®¢é˜…è€…æ³¨å†Œåï¼Œä»–ä»¬æ‰ä¼šæ”¶åˆ°äº‹ä»¶ã€‚ åœ¨Androidçš„åœ¨æ´»åŠ¨å’Œç‰‡æ®µä¸­ï¼Œé€šå¸¸åº”è¯¥æ ¹æ®å…¶ç”Ÿå‘½å‘¨æœŸè¿›è¡Œæ³¨å†Œã€‚ å¯¹äºå¤§å¤šæ•°æƒ…å†µä¸‹åœ¨onStartä¸­æ³¨å†Œï¼Œåœ¨onStopä¸­é”€æ¯å°±OKäº†ã€‚ å‘å¸ƒäº‹ä»¶åœ¨ä»£ç çš„ä»»æ„åœ°æ–¹å‘å¸ƒäº‹ä»¶ï¼Œæ‰€æœ‰ä¸å½“å‰äº‹ä»¶åŒ¹é…ä¸”æ³¨å†Œè¿‡çš„è®¢é˜…è€…éƒ½å°†ä¼šæ”¶åˆ°äº‹ä»¶ã€‚ 1EventBus.getDefault().post(new MessageEvent(\"Hello everyone!\")); äºŒã€ä¼ é€’çº¿ç¨‹EventBuså¯ä»¥ä¸ºä½ å¤„ç†çº¿ç¨‹ï¼šäº‹ä»¶å¯ä»¥å‘å¸ƒåœ¨ä¸åŒäºå‘å¸ƒçº¿ç¨‹çš„çº¿ç¨‹ä¸­ã€‚äº‹ä»¶å¯ä»¥å‘å¸ƒåœ¨å’Œå‘å¸ƒçº¿ç¨‹ä¸åŒçš„çº¿ç¨‹é‡Œã€‚ä¸€ä¸ªæ™®éçš„åœºæ™¯å°±æ˜¯å¤„ç†UIçš„å˜åŒ–ã€‚åœ¨Androidç³»ç»Ÿä¸­ï¼ŒUIæ›´æ”¹å¿…é¡»åœ¨UIï¼ˆä¸»ï¼‰çº¿ç¨‹ä¸­å®Œæˆã€‚å¦ä¸€æ–¹é¢ï¼Œç½‘ç»œæˆ–è€…ä»»ä½•è€—æ—¶çš„ä»»åŠ¡ï¼Œéƒ½ä¸å…è®¸åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œã€‚EventBuså¸®åŠ©ä½ å¤„ç†è¿™äº›ä»»åŠ¡å¹¶ä¸”ä¸UIçº¿ç¨‹åŒæ­¥ï¼ˆæ— éœ€æ·±å…¥äº†è§£çº¿ç¨‹è½¬æ¢ï¼Œä½¿ç”¨AsyncTaskç­‰ï¼‰ã€‚ åœ¨EventBusä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å››ä¸ªThreadModeä¸­çš„ä¸€ä¸ªæ¥å®šä¹‰å°†è°ƒç”¨äº‹ä»¶å¤„ç†æ–¹æ³•çš„çº¿ç¨‹ã€‚ ThreadMode: POSTINGè®¢é˜…è€…å°†ä¼šåœ¨äº‹ä»¶å‘å¸ƒçš„çº¿ç¨‹ä¸­è¢«è°ƒç”¨ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚äº‹ä»¶çš„ä¼ é€’æ˜¯åŒæ­¥å®Œæˆçš„ï¼Œä¸€æ—¦äº‹ä»¶å‘å¸ƒå®Œæˆï¼Œæ‰€æœ‰çš„è®¢é˜…è€…éƒ½å°†ä¼šè¢«è°ƒç”¨ã€‚ç”±äºå®Œå…¨é¿å…äº†çº¿ç¨‹åˆ‡æ¢ï¼Œè¿™ç§æ¨¡å¼çš„å¼€é”€æ˜¯æœ€å°çš„ã€‚æ‰€ä»¥ï¼Œé’ˆå¯¹é‚£äº›ä¸éœ€è¦ä¸»çº¿ç¨‹å¹¶ä¸”èƒ½åœ¨å¾ˆçŸ­æ—¶é—´å†…å®Œæˆçš„ç®€å•ä»»åŠ¡ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹çš„äº‹ä»¶å¤„ç†æ–¹æ³•å¿…é¡»å¿«é€Ÿè¿”å›ï¼Œé¿å…é˜»å¡å‘å¸ƒäº‹ä»¶çš„çº¿ç¨‹ï¼Œå› ä¸ºè¿™ä¸ªçº¿ç¨‹æœ‰å¯èƒ½æ˜¯ä¸»çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼š 123456// Called in the same thread (default)// ThreadMode is optional here@Subscribe(threadMode = ThreadMode.POSTING)public void onMessage(MessageEvent event) { log(event.message);} ThreadMode: MAINè®¢é˜…è€…å°†åœ¨Androidçš„ä¸»çº¿ç¨‹ï¼ˆæœ‰æ—¶ç§°ä¸ºUIçº¿ç¨‹ï¼‰ä¸­è°ƒç”¨ã€‚ å¦‚æœå‘å¸ƒçº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹ï¼Œåˆ™å°†ç›´æ¥è°ƒç”¨äº‹ä»¶å¤„ç†æ–¹æ³•ï¼ˆä¸ThreadMode.POSTINGæè¿°çš„åŒæ­¥ï¼‰ã€‚ ä½¿ç”¨æ­¤æ¨¡å¼çš„äº‹ä»¶å¤„ç†ç¨‹åºå¿…é¡»å¿«é€Ÿè¿”å›ï¼Œä»¥é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼š 12345// Called in Android UI's main thread@Subscribe(threadMode = ThreadMode.MAIN)public void onMessage(MessageEvent event) {textField.setText(event.message);} ThreadMode: BACKGROUNDè®¢é˜…è€…å°†åœ¨åå°çº¿ç¨‹ä¸­è°ƒç”¨ã€‚ å¦‚æœå‘å¸ƒçº¿ç¨‹ä¸æ˜¯ä¸»çº¿ç¨‹ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºæ–¹æ³•å°†ç›´æ¥åœ¨å‘å¸ƒçº¿ç¨‹ä¸­è°ƒç”¨ã€‚ å¦‚æœå‘å¸ƒçº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹ï¼ŒEventBusä½¿ç”¨å•ä¸ªåå°çº¿ç¨‹æ¥æŒ‰é¡ºåºä¼ é€’æ‰€æœ‰äº‹ä»¶ã€‚ ä½¿ç”¨æ­¤æ¨¡å¼çš„äº‹ä»¶å¤„ç†æ–¹æ³•åº”å°½å¿«è¿”å›ä»¥é¿å…é˜»å¡åå°çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼š 12345// Called in the background thread@Subscribe(threadMode = ThreadMode.BACKGROUND)public void onMessage(MessageEvent event){ saveToDisk(event.message);} ThreadMode: ASYNCäº‹ä»¶å¤„ç†æ–¹æ³•åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­è°ƒç”¨ã€‚ è¿™ä¸ªçº¿ç¨‹æ€»æ˜¯ç‹¬ç«‹äºå‘å¸ƒçº¿ç¨‹å’Œä¸»çº¿ç¨‹ã€‚ è¿™ç§æ¨¡å¼ä¸‹ï¼Œå‘å¸ƒäº‹ä»¶ä¸ä¼šç­‰å¾…äº‹ä»¶å¤„ç†æ–¹æ³•çš„æ‰§è¡Œç»“æœã€‚ å¦‚æœäº‹ä»¶å¤„ç†æ–¹æ³•çš„æ‰§è¡Œéœ€è¦ä¸€äº›æ—¶é—´ï¼Œåˆ™åº”è¯¥ä½¿ç”¨æ­¤æ¨¡å¼ï¼Œå¦‚ç½‘ç»œè®¿é—®ã€‚ é¿å…åŒæ—¶è§¦å‘å¤§é‡é•¿æ—¶é—´è¿è¡Œçš„å¼‚æ­¥å¤„ç†æ–¹æ³•ä»¥é™åˆ¶å¹¶å‘çº¿ç¨‹çš„æ•°é‡ã€‚ EventBusä½¿ç”¨çº¿ç¨‹æ± æ¥æœ‰æ•ˆåœ°é‡ç”¨å·²å®Œæˆä»»åŠ¡çš„çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼š 12345// Called in a separate thread@Subscribe(threadMode = ThreadMode.ASYNC)public void onMessage(MessageEvent event){ backend.send(event.message);} ä¸‰ã€é…ç½®é€šè¿‡EventBusBuilderï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®EventBusçš„å„ä¸ªæ–¹é¢ã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯å¦‚ä½•æ„å»ºä¸€ä¸ªå½“å‘é€çš„äº‹ä»¶æ²¡æœ‰è®¢é˜…è€…æ—¶ä¸æŠ¥å¼‚å¸¸çš„EventBus 1234EventBus eventBus = EventBus.builder() .logNoSubscriberMessages(false) .sendNoSubscriberEvent(false) .build(); å¦å¤–ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œå¦‚ä½•æ„å»ºä¸€ä¸ªåœ¨è®¢é˜…è€…æ’é™¤å¼‚å¸¸æ—¶æŠ¥é”™çš„EventBus 1EventBus eventBus = EventBus.builder().throwSubscriberException(true).build(); æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒEventBusæ•è·ä»è®¢é˜…è€…æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¹¶å‘é€ä¸å¼ºåˆ¶è¦æ±‚å¤„ç†çš„SubscriberExceptionEventã€‚ ä½¿ç”¨EventBus.getDefault()æ˜¯ä¸€ç§ä»åº”ç”¨ç¨‹åºçš„ä»»ä½•ä½ç½®è·å–å…±äº«EventBuså®ä¾‹çš„ç®€å•æ–¹æ³•ã€‚ EventBusBuilderè¿˜å…è®¸ä½¿ç”¨æ–¹æ³•installDefaultEventBus()é…ç½®æ­¤é»˜è®¤å®ä¾‹ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥é…ç½®é»˜è®¤çš„EventBuså®ä¾‹æ¥é‡æ–°æŠ›å‡ºåœ¨è®¢é˜…æ–¹æ³•ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚ ä½†æ˜¯è®©æˆ‘ä»¬åªå¯¹DEBUGæ„å»ºï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå´©æºƒçš„åº”ç”¨ç¨‹åºå¼‚å¸¸ 1EventBus.builder().throwSubscriberException(BuildConfig.DEBUG).installDefaultEventBus(); æ³¨æ„ï¼šåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨é»˜è®¤EventBuså®ä¾‹ä¹‹å‰ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ã€‚ åç»­è°ƒç”¨installDefaultEventBus()å°†æŠ›å‡ºå¼‚å¸¸ã€‚ è¿™å¯ç¡®ä¿åº”ç”¨ç¨‹åºä¸­çš„è¡Œä¸ºä¸€è‡´ã€‚ æ‚¨çš„åº”ç”¨ç¨‹åºç±»æ˜¯åœ¨ä½¿ç”¨ä¹‹å‰é…ç½®é»˜è®¤EventBuså®ä¾‹çš„ä¸é”™åœ°æ–¹ã€‚ å››ã€ç²˜æ€§äº‹ä»¶ä¸€äº›äº‹ä»¶æºå¸¦åœ¨äº‹ä»¶å‘å¸ƒä¹‹åæ„Ÿå…´è¶£çš„ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œäº‹ä»¶è¡¨ç¤ºæŸäº›åˆå§‹åŒ–å®Œæˆã€‚ æˆ–è€…å¦‚æœæ‚¨æœ‰ä¸€äº›ä¼ æ„Ÿå™¨æˆ–ä½ç½®æ•°æ®ï¼Œå¹¶ä¸”æƒ³è¦ä¿æŒæœ€è¿‘çš„å€¼ã€‚ è€Œä¸æ˜¯å®ç°è‡ªå·±çš„ç¼“å­˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ç²˜æ€§äº‹ä»¶ã€‚ æ‰€ä»¥EventBusä¿æŒå†…å­˜ä¸­æŸä¸ªç±»å‹çš„æœ€åä¸€ä¸ªç²˜æ€§äº‹ä»¶ã€‚ ç„¶åç²˜æ€§äº‹ä»¶å¯ä»¥ä¼ é€’ç»™è®¢é˜…è€…æˆ–æ˜ç¡®åœ°æŸ¥è¯¢ã€‚ å› æ­¤ï¼Œæ‚¨ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šçš„é€»è¾‘æ¥è€ƒè™‘å·²æœ‰çš„æ•°æ® ç²˜æ€§ç¤ºä¾‹ä¸‹é¢è¡¨ç¤ºï¼Œä¸€ä¸ªç²˜æ€§äº‹ä»¶å‘å¸ƒäº†ä¸€æ®µæ—¶é—´ä»¥å‰ï¼š 1EventBus.getDefault().postSticky(new MessageEvent(\"Hello everyone!\")); ç°åœ¨ä¸€ä¸ªæ–°çš„æ´»åŠ¨å¼€å§‹ã€‚ åœ¨æ³¨å†ŒæœŸé—´ï¼Œæ‰€æœ‰ç²˜æ€§è®¢é˜…è€…æ–¹æ³•å°†ç«‹å³è·å¾—å…ˆå‰å‘å¸ƒçš„ç²˜æ€§äº‹ä»¶ï¼š 1234567891011121314151617@Overridepublic void onStart() { super.onStart(); EventBus.getDefault().register(this);} // UI updates must run on MainThread@Subscribe(sticky = true, threadMode = ThreadMode.MAIN)public void onEvent(MessageEvent event) { textField.setText(event.message);} @Overridepublic void onStop() { EventBus.getDefault().unregister(this); super.onStop();} æ‰‹åŠ¨è·å–å’Œåˆ é™¤ç²˜æ€§äº‹ä»¶å¦‚ä½ æ‰€è§ï¼Œæœ€åä¸€ä¸ªç²˜æ€§äº‹ä»¶åœ¨æ³¨å†Œæ—¶è‡ªåŠ¨ä¼ é€’ç»™åŒ¹é…çš„è®¢é˜…è€…ã€‚ ä½†æœ‰æ—¶æ‰‹åŠ¨æ£€æŸ¥ç²˜æ€§äº‹ä»¶å¯èƒ½ä¼šæ›´æ–¹ä¾¿ã€‚ å¦å¤–ï¼Œå¯èƒ½éœ€è¦ç§»é™¤ï¼ˆæ¶ˆè´¹ï¼‰ç²˜æ€§äº‹ä»¶æ‰èƒ½ä½¿å¾—å®ƒä»¬ä¸å†è¢«é€’é€ã€‚ ä¾‹ï¼š 1234567MessageEvent stickyEvent = EventBus.getDefault().getStickyEvent(MessageEvent.class);// Better check that an event was actually posted beforeif(stickyEvent != null) { // \"Consume\" the sticky event EventBus.getDefault().removeStickyEvent(stickyEvent); // Now do something with it} æ–¹æ³•removeStickyEventæ˜¯é‡è½½çš„ï¼šå½“ä½ ä¼ å…¥ç±»æ—¶ï¼Œå®ƒå°†è¿”å›å…ˆå‰æŒæœ‰çš„ç²˜æ€§äº‹ä»¶ã€‚ ä½¿ç”¨è¿™ä¸ªå˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹è¿›å‰é¢çš„ä¾‹å­ï¼š 12345MessageEvent stickyEvent = EventBus.getDefault().removeStickyEvent(MessageEvent.class);// Better check that an event was actually posted beforeif(stickyEvent != null) { // Now do something with it} äº”ã€ä¼˜å…ˆçº§å’Œäº‹ä»¶å–æ¶ˆå°½ç®¡EventBusçš„å¤§å¤šæ•°ç”¨ä¾‹ä¸éœ€è¦ä¼˜å…ˆçº§æˆ–äº‹ä»¶å–æ¶ˆï¼Œä½†åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹å®ƒä»¬å¯èƒ½æ´¾ä¸Šç”¨åœºã€‚ ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨å¤„äºå‰å°ï¼Œåˆ™äº‹ä»¶å¯ä»¥è§¦å‘ä¸€äº›UIé€»è¾‘ï¼Œä½†å¦‚æœåº”ç”¨å½“å‰å¯¹ç”¨æˆ·ä¸å¯è§ï¼Œåˆ™äº‹ä»¶å¯ä»¥ä¸åŒåœ°ååº”ã€‚ è®¢é˜…è€…ä¼˜å…ˆçº§ä½ å¯ä»¥é€šè¿‡åœ¨æ³¨å†ŒæœŸé—´ä¸ºè®¢é˜…è€…æä¾›ä¼˜å…ˆçº§æ¥æ›´æ”¹äº‹ä»¶ä¼ é€’çš„é¡ºåºã€‚ 1234@Subscribe(priority = 1);public void onEvent(MessageEvent event) { ...} åœ¨ç›¸åŒçš„ä¼ é€’çº¿ç¨‹ï¼ˆThreadModeï¼‰ä¸­ï¼Œè¾ƒé«˜ä¼˜å…ˆçº§çš„è®¢é˜…è€…å°†åœ¨å…¶ä»–ä¼˜å…ˆçº§è¾ƒä½çš„è®¢é˜…è€…ä¹‹å‰æ¥æ”¶äº‹ä»¶ã€‚ é»˜è®¤ä¼˜å…ˆçº§ä¸º0ã€‚æ³¨æ„ï¼šä¼˜å…ˆçº§ä¸å½±å“ä¸åŒçº¿ç¨‹æ¨¡å¼çš„è®¢é˜…è€…ä¹‹é—´çš„ä¼ é€’é¡ºåºï¼ å–æ¶ˆäº‹ä»¶ä¼ é€ä½ å¯ä»¥é€šè¿‡ä»è®¢é˜…è€…çš„äº‹ä»¶å¤„ç†æ–¹æ³•è°ƒç”¨cancelEventDeliveryï¼ˆObject eventï¼‰æ¥å–æ¶ˆäº‹ä»¶ä¼ é€’è¿‡ç¨‹ã€‚ ä»»ä½•å…¶ä»–æ´»åŠ¨ä¼ é€å°†è¢«å–æ¶ˆï¼Œåç»­è®¢é˜…è€…å°†ä¸ä¼šæ”¶åˆ°æ´»åŠ¨ã€‚ 12345678// Called in the same thread (default)@Subscribepublic void onEvent(MessageEvent event){ // Process the event ... // Prevent delivery to other subscribers EventBus.getDefault().cancelEventDelivery(event) ;} äº‹ä»¶é€šå¸¸ç”±æ›´é«˜ä¼˜å…ˆçº§çš„è®¢é˜…è€…å–æ¶ˆã€‚ å–æ¶ˆä»…é™äºåœ¨å‘å¸ƒçº¿ç¨‹ï¼ˆThreadMode.PostThreadï¼‰ä¸­è¿è¡Œçš„äº‹ä»¶å¤„ç†æ–¹æ³•ã€‚ å…­ã€è®¢é˜…è€…ç´¢å¼•è®¢é˜…è€…ç´¢å¼•æ˜¯EventBus 3çš„ä¸€ä¸ªæ–°åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯é€‰çš„ä¼˜åŒ–ï¼Œä»¥åŠ é€Ÿåˆå§‹è®¢é˜…è€…æ³¨å†Œã€‚ è®¢é˜…è€…ç´¢å¼•å¯ä»¥åœ¨æ„å»ºæ—¶é€šè¿‡EventBusæ³¨è§£åˆ›å»ºã€‚ å› ä¸ºä¸éœ€è¦ä½¿ç”¨ç´¢å¼•ï¼Œä¸ºäº†æ›´å¥½çš„æ€§èƒ½å»ºè®®åœ¨Androidä¸Šä½¿ç”¨ã€‚ ç´¢å¼•å‰ææ¡ä»¶æ³¨æ„ï¼Œåªæœ‰@Subscriberæ–¹æ³•å¯ä»¥ç´¢å¼•ï¼Œå…¶ä¸­è®¢é˜…è€…å’Œäº‹ä»¶ç±»æ˜¯publicçš„ã€‚ æ­¤å¤–ï¼Œç”±äºJavaçš„æ³¨é‡Šå¤„ç†æœ¬èº«çš„æŠ€æœ¯é™åˆ¶ï¼Œ@Subscribeæ³¨é‡Šä¸èƒ½åœ¨åŒ¿åç±»ä¸­è¯†åˆ«ã€‚ å½“EventBusä¸èƒ½ä½¿ç”¨ç´¢å¼•æ—¶ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨å›é€€åˆ°åå°„ã€‚ å› æ­¤ï¼Œå®ƒä»ç„¶å¯ä»¥å·¥ä½œï¼Œåªæ˜¯æœ‰ç‚¹æ…¢ã€‚ å¦‚ä½•ç”Ÿæˆç´¢å¼• ä½¿ç”¨æ³¨è§£å¦‚æœä½ ä¸ä½¿ç”¨Android Gradleæ’ä»¶ç‰ˆæœ¬2.2.0æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨é…ç½®ä¸android-aptã€‚è¦å¯ç”¨ç´¢å¼•ç”Ÿæˆï¼Œéœ€è¦ä½¿ç”¨annotationProcessorå±æ€§å°†EventBusæ³¨é‡Šå¤„ç†å™¨æ·»åŠ åˆ°æ„å»ºä¸­ã€‚ è¿˜è¦è®¾ç½®å‚æ•°eventBusIndexæ¥æŒ‡å®šè¦ç”Ÿæˆçš„ç´¢å¼•çš„å®Œå…¨é™å®šç±»ã€‚ ä¾‹å¦‚ï¼Œå°†ä»¥ä¸‹éƒ¨åˆ†æ·»åŠ åˆ°Gradleæ„å»ºè„šæœ¬ä¸­ï¼š 1234567891011121314android { defaultConfig { javaCompileOptions { annotationProcessorOptions { arguments = [ eventBusIndex : 'com.example.myapp.MyEventBusIndex' ] } } }} dependencies { compile 'org.greenrobot:eventbus:3.0.0' annotationProcessor 'org.greenrobot:eventbus-annotation-processor:3.0.1'} ä½¿ç”¨android-aptå¦‚æœä¸Šè¿°æ–¹æ³•ä¸é€‚ç”¨äºä½ ï¼Œä½ å¯ä»¥ä½¿ç”¨android-apt Gradleæ’ä»¶æ·»åŠ EventBusæ³¨é‡Šå¤„ç†å™¨åˆ°ä½ çš„æ„å»ºä¸­ã€‚ å°†ä»¥ä¸‹éƒ¨åˆ†æ·»åŠ åˆ°Gradleæ„å»ºè„šæœ¬ä¸­ï¼š 123456789101112131415161718buildscript { dependencies { classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8' }}apply plugin: 'com.neenbedankt.android-apt'dependencies { compile 'org.greenrobot:eventbus:3.0.0' apt 'org.greenrobot:eventbus-annotation-processor:3.0.1'}apt { arguments { eventBusIndex \"com.example.myapp.MyEventBusIndex\" }} ä¸‹æ¬¡æ„å»ºé¡¹ç›®æ—¶ï¼ˆæ²¡æœ‰é”™è¯¯ï¼‰ï¼Œå°†ä¸ºæ‚¨ç”Ÿæˆç”±eventBusIndexæŒ‡å®šçš„ç±»ã€‚ ç„¶åå½“è®¾ç½®EventBusé€šè¿‡å®ƒåƒè¿™æ ·ï¼š 1EventBus eventBus = EventBus.builder().addIndex(new MyEventBusIndex()).build(); æˆ–è€…ï¼Œå¦‚æœæ‚¨æƒ³åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨é»˜è®¤å®ä¾‹ï¼š 123EventBus.builder().addIndex(new MyEventBusIndex()).installDefaultEventBus();// Now the default instance uses the given index. Use it like this:EventBus eventBus = EventBus.getDefault(); ç´¢å¼•ä½ çš„å¼€æºåº“ä½ å¯ä»¥å°†ç›¸åŒçš„åŸåˆ™åº”ç”¨äºä½œä¸ºåº“ï¼ˆè€Œä¸æ˜¯æœ€ç»ˆåº”ç”¨ç¨‹åºï¼‰çš„ä¸€éƒ¨åˆ†çš„ä»£ç ã€‚ è¿™æ ·ï¼Œæ‚¨å¯èƒ½æœ‰å¤šä¸ªç´¢å¼•ç±»ï¼Œæ‚¨å¯ä»¥åœ¨EventBusè®¾ç½®æœŸé—´æ·»åŠ æ‰€æœ‰ç´¢å¼•ç±»ï¼Œä¾‹å¦‚ï¼š 123EventBus eventBus = EventBus.builder() .addIndex(new MyEventBusAppIndex()) .addIndex(new MyEventBusLibIndex()).build(); ä¸ƒã€ProGuardProGuardæ¨¡ç³Šæ–¹æ³•åç§°å¹¶å¯èƒ½åˆ é™¤ä¸è¢«è°ƒç”¨çš„æ–¹æ³•ï¼ˆæ­»ä»£ç åˆ é™¤ï¼‰ã€‚ å› ä¸ºSubscriberæ–¹æ³•ä¸æ˜¯ç›´æ¥è°ƒç”¨ï¼ŒProGuardå‡å®šå®ƒä»¬æœªè¢«ä½¿ç”¨ã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨å¯ç”¨ProGuardç¼©å‡ï¼Œæ‚¨å¿…é¡»å‘Šè¯‰Proguardä¿ç•™è¿™äº›Subscriberæ–¹æ³•ã€‚ åœ¨ProGuardé…ç½®æ–‡ä»¶ï¼ˆproguard.cfgï¼‰ä¸­ä½¿ç”¨ä»¥ä¸‹è§„åˆ™ä»¥é˜²æ­¢è®¢é˜…è€…è¢«åˆ é™¤ï¼š 12345678910-keepattributes *Annotation*-keepclassmembers class ** { @org.greenrobot.eventbus.Subscribe &lt;methods&gt;;}-keep enum org.greenrobot.eventbus.ThreadMode { *; } # Only required if you use AsyncExecutor-keepclassmembers class * extends org.greenrobot.eventbus.util.ThrowableFailureEvent { &lt;init&gt;(java.lang.Throwable);} æ³¨æ„ï¼šæ— è®ºæ˜¯å¦ä½¿ç”¨è®¢æˆ·ç´¢å¼•ï¼Œæ‚¨éƒ½éœ€è¦æ­¤é…ç½®ã€‚ å…«ã€AsyncExecutorAsyncExecutorAsyncExecutorå°±åƒä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä½†æ˜¯å…·æœ‰å¤±è´¥ï¼ˆå¼‚å¸¸ï¼‰å¤„ç†ã€‚ å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ŒAsyncExecutorä¼šå°†è¿™äº›å¼‚å¸¸åŒ…è£…åœ¨äº‹ä»¶ä¸­ï¼Œå¹¶è‡ªåŠ¨å‘å¸ƒã€‚ å…è´£å£°æ˜ï¼šAsyncExecutoræ˜¯ä¸€ä¸ªéæ ¸å¿ƒå®ç”¨ç¨‹åºç±»ã€‚ å®ƒå¯èƒ½ä¼šåœ¨åå°çº¿ç¨‹ä¸­ä¿å­˜ä¸€äº›é”™è¯¯å¤„ç†ä»£ç ï¼Œä½†å®ƒä¸æ˜¯ä¸€ä¸ªæ ¸å¿ƒçš„EventBusç±»ã€‚ é€šå¸¸ï¼Œè°ƒç”¨AsyncExecutor.createï¼ˆï¼‰åˆ›å»ºä¸€ä¸ªå®ä¾‹å¹¶å°†å…¶ä¿å­˜åœ¨åº”ç”¨ç¨‹åºèŒƒå›´ä¸­ã€‚ ç„¶åæ‰§è¡ŒæŸäº›ä¸œè¥¿ï¼Œå®ç°RunnableExæ¥å£å¹¶å°†å…¶ä¼ é€’ç»™AsyncExecutorçš„executeæ–¹æ³•ã€‚ ä¸Runnableä¸åŒï¼ŒRunnableExå¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ å¦‚æœRunnableExå®ç°æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒå°†è¢«æ•è·å¹¶è¢«åŒ…è£…åˆ°ThrowableFailureEventä¸­ï¼Œè¿™å°†è¢«å‘å¸ƒã€‚ æ‰§è¡Œéƒ¨åˆ†ç¤ºä¾‹ï¼š 12345678910AsyncExecutor.create().execute( new AsyncExecutor.RunnableEx() { @Override public void run() throws LoginException { // No need to catch any Exception (here: LoginException) remote.login(); EventBus.getDefault().postSticky(new LoggedInEvent()); } }); æ¥æ”¶éƒ¨åˆ†ç¤ºä¾‹ï¼š 123456789@Subscribe(threadMode = ThreadMode.MAIN)public void handleLoginEvent(LoggedInEvent event) { // do something}@Subscribe(threadMode = ThreadMode.MAIN)public void handleFailureEvent(ThrowableFailureEvent event) { // do something} AsyncExecutor Builderå¦‚æœè¦è‡ªå®šä¹‰AsyncExecutorå®ä¾‹ï¼Œè¯·è°ƒç”¨é™æ€æ–¹æ³•AsyncExecutor.builderï¼ˆï¼‰ã€‚ å®ƒå°†è¿”å›ä¸€ä¸ªæ„å»ºå™¨ï¼Œæ‚¨å¯ä»¥è‡ªå®šä¹‰EventBuså®ä¾‹ï¼Œçº¿ç¨‹æ± å’Œå¤±è´¥äº‹ä»¶çš„ç±»ã€‚ å¦ä¸€ä¸ªå®šåˆ¶é€‰é¡¹æ˜¯æ‰§è¡ŒèŒƒå›´ï¼Œå®ƒæä¾›æ•…éšœäº‹ä»¶ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œå¤±è´¥äº‹ä»¶å¯èƒ½ä»…ä¸ç‰¹å®šçš„Activityå®ä¾‹æˆ–ç±»ç›¸å…³ã€‚ å¦‚æœæ‚¨çš„è‡ªå®šä¹‰å¤±è´¥äº‹ä»¶ç±»å®ç°äº†HasExecutionScopeæ¥å£ï¼ŒAsyncExecutorå°†è‡ªåŠ¨è®¾ç½®æ‰§è¡ŒèŒƒå›´ã€‚ åƒè¿™æ ·ï¼Œæ‚¨çš„è®¢é˜…è€…å¯ä»¥æŸ¥è¯¢å¤±è´¥äº‹ä»¶çš„æ‰§è¡ŒèŒƒå›´ï¼Œå¹¶æ ¹æ®å®ƒåšå‡ºååº”ã€‚ åŸæ–‡å‡ºå¤„ç¿»è¯‘åŸæ–‡ï¼šhttp://greenrobot.org/eventbus/","link":"/2017/02/14/ã€ŠAndroidå¼€æºåº“ã€‹ EventBus ç”¨æ³•è¯¦è§£ï¼ˆè¯‘æ–‡ï¼‰/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 1","text":"1. åŸºç¡€å…¥é—¨1.1 æ·»åŠ ä¾èµ–Gradle å·¥ç¨‹æ·»åŠ ä¾èµ– (æ¨èä½¿ç”¨)é¡¹ç›®çº§build.gradleä¸­æ·»åŠ : 12345allprojects { repositories { maven { url &quot;https://jitpack.io&quot; } }} Appä¸‹çš„ build.gradleä¸­æ·»åŠ : 123dependencies { compile &apos;com.github.PhilJay:MPAndroidChart:v3.0.2&apos;} Mavenpom.xmlä¸­æ·»åŠ å¦‚ä¸‹repositories: 1234&lt;repository&gt; &lt;id&gt;jitpack.io&lt;/id&gt; &lt;url&gt;https://jitpack.io&lt;/url&gt;&lt;/repository&gt; pom.xmlä¸­æ·»åŠ å¦‚ä¸‹dependencies 12345&lt;dependency&gt; &lt;groupId&gt;com.github.PhilJay&lt;/groupId&gt; &lt;artifactId&gt;MPAndroidChart&lt;/artifactId&gt; &lt;version&gt;v3.0.2&lt;/version&gt;&lt;/dependency&gt; ç›´æ¥ä½¿ç”¨JaråŒ…æ–‡ä»¶ä¸‹è½½æœ€æ–°çš„.jaråŒ…ï¼Œæ‹·è´ä¸‹è½½çš„æ–‡ä»¶åˆ°ä½ çš„Androidé¡¹ç›®libsæ–‡ä»¶å¤¹ä¸‹ç„¶åå¼€å§‹ä½¿ç”¨è¿™ä¸ªå¼€æºåº“ã€‚æ‹·è´æ•´ä¸ªå·¥ç¨‹ä½¿ç”¨git clone https://github.com/PhilJay/MPAndroidChart.git å‘½ä»¤ä¸‹è½½æ•´ä¸ªå·¥ç¨‹ï¼Œè¿™ä¸ªå·¥ç¨‹åŒ…å«sampleå’ŒMPChartLibåº“ï¼Œç„¶åä½ å¯ä»¥å°†è¿™ä¸ªåº“å¼•å…¥åˆ°ä½ çš„Android Studioå·¥ç¨‹æˆ–è€…æ˜¯Eclipseå·¥ç¨‹ã€‚ 1.2 åˆ›å»ºViewè¦ä½¿ç”¨LineChart, BarChart, ScatterChart, CandleStickChart, PieChart, BubbleChart æˆ–è€… RadarChartï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆåœ¨å¸ƒå±€XMLæ–‡ä»¶ä¸­å®šä¹‰å®ƒ ï¼š 1234&lt;com.github.mikephil.charting.charts.LineChart android:id=&quot;@+id/chart&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; /&gt; ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨Fragmentï¼ŒActivityæˆ–è€…å…¶ä»–èƒ½æ‹¿åˆ°å®ƒçš„åœ°æ–¹å–åˆ°å¯¹è±¡ï¼š 12// in this example, a LineChart is initialized from xml LineChart chart = (LineChart) findViewById(R.id.chart); æˆ–è€…æˆ‘ä»¬ç›´æ¥åœ¨ä»£ç ä¸­åˆ›å»ºChartç„¶åæŠŠå®ƒæ·»åŠ åˆ°å¸ƒå±€ä¸­å»ï¼š 123456// programmatically create a LineChart LineChart chart = new LineChart(Context); // get a layout defined in xml RelativeLayout rl = (RelativeLayout) findViewById(R.id.relativeLayout); rl.add(chart); // add the programmatically created chart 1.3 æ·»åŠ æ•°æ®å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªchartå®ä¾‹åï¼Œä½ å¯ä»¥ç”Ÿæˆä¸€äº›æ•°æ®ç„¶åæŠŠå®ƒåŠ å…¥åˆ°å›¾è¡¨ä¸­å»ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä»¥LineChartä¸ºä¾‹ï¼Œå¯¹LineChartè€Œè¨€ï¼ŒEntryç±»ä»£è¡¨æœ‰Xå’ŒYå€¼çš„å›¾è¡¨ä¸­çš„ä¸€ä¸ªæ¡ç›®ã€‚å¯¹äºå…¶ä»–çš„Chartç±»å‹ï¼Œå¦‚BarChartï¼Œä½ å¯ä»¥ä½¿ç”¨BarEntryä½œä¸ºæ•°æ®æ¡ç›®ã€‚ä¸ºäº†ç»™ä½ çš„å›¾è¡¨æ·»åŠ æ•°æ®ï¼Œä½ éœ€è¦æƒ³ä¸‹é¢è¿™æ ·å°†ä½ çš„æ•°æ®å°è£…æˆEntryï¼š 123456789YourData[] dataObjects = ...;List&lt;Entry&gt; entries = new ArrayList&lt;Entry&gt;();for (YourData data : dataObjects) { // turn your data into Entry objects entries.add(new Entry(data.getValueX(), data.getValueY())); } ä¸‹ä¸€æ­¥ï¼Œä½ éœ€è¦å°†List&lt; Entry&gt;æ·»åŠ åˆ°LineDataSetå¯¹è±¡ä¸­ã€‚DataSetå¯¹è±¡åŒ…å«å±äºä¸€ç»„çš„æ•°æ®ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°æ®æœ‰è‡ªå·±ç‹¬ç«‹çš„é£æ ¼ã€‚å¦‚ä¸‹â€œLabelâ€åªæœ‰æè¿°ç›®çš„å¦‚æœè®¾ç½®enabledçš„è¯ï¼Œå®ƒå°†ä¼šåœ¨Legendä¸­æ˜¾ç¤ºå‡ºæ¥ã€‚ 123LineDataSet dataSet = new LineDataSet(entries, &quot;Label&quot;); // add entries to datasetdataSet.setColor(...);dataSet.setValueTextColor(...); // styling, ... æœ€åä¸€æ­¥ï¼Œæ·»åŠ LineDataSetåˆ°LineDataä¸­ï¼ŒLineDataåŒ…å«å¯¹åº”Chartä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ›´æ·±å…¥çš„å®šåˆ¶æ•°æ®çš„æ˜¾ç¤ºé£æ ¼ã€‚åœ¨åˆ›å»ºäº†æ•°æ®ä¹‹åæˆ‘ä»¬å°†å…¶åŠ å…¥åˆ°chartä¸­ç„¶ååˆ·æ–°ä¸€ä¸‹ã€‚ 123LineData lineData = new LineData(dataSet);chart.setData(lineData);chart.invalidate(); // refresh ä¸Šé¢è¿™äº›éƒ½æ˜¯å¾ˆåŸºæœ¬çš„è®¾ç½®å’Œä½¿ç”¨ã€‚æ›´ç»†èŠ‚çš„ä»‹ç»è¯·æŸ¥é˜…setting Dataç« èŠ‚â€”- ç»“åˆç¤ºä¾‹çš„ä¸ºä½ è®²è§£å¦‚ä½•ç»™å„å¼å„æ ·çš„å›¾è¡¨æ·»åŠ æ•°æ®ã€‚ 1.4 æ ·å¼æƒ³è¦äº†è§£chartå’Œæ•°æ®çš„è®¾ç½®å’Œæ ·å¼ï¼Œè¯·æŸ¥é˜…settings &amp; stylingç« èŠ‚ã€‚å¯¹äºå„ç§ç±»å‹çš„æ•°æ®å’Œæ ·å¼ï¼Œè¯·æŸ¥é˜…specific settings &amp; styling wikié¡µé¢ã€‚ 2. Chartäº¤äº’MPAndroidChartå…è®¸ç”¨æˆ·å®Œæˆè‡ªå®šä¹‰äºChart Viewçš„è§¦æ‘¸æˆ–è€…æ˜¯æ‰‹åŠ¿äº‹ä»¶ï¼Œå¹¶ä¸”é€šè¿‡å›è°ƒæ–¹æ³•å“åº”äº¤äº’ã€‚ 2.1 å¯ç”¨ï¼ç¦ç”¨äº¤äº’ æ–¹æ³• ä½œç”¨ setTouchEnabled(boolean enabled) å¯ç”¨æˆ–è€…ç¦ç”¨è§¦æ‘¸äº¤äº’ setDragEnabled(boolean enabled) å¯ç”¨æˆ–è€…ç¦ç”¨æ‹–æ‹½äº¤äº’ setScaleEnabled(boolean enabled) å¯ç”¨æˆ–è€…ç¦ç”¨ç¼©æ”¾äº¤äº’ï¼ˆXè½´å’ŒYè½´ï¼‰ setScaleXEnabled(boolean enabled) å¯ç”¨æˆ–è€…ç¦ç”¨Xè½´ç¼©æ”¾äº¤äº’ setScaleYEnabled(boolean enabled) å¯ç”¨æˆ–è€…ç¦ç”¨Yè½´ç¼©æ”¾äº¤äº’ setPinchZoom(boolean enabled) è®¾ç½®ä¸ºtrueï¼Œåˆ™å¯ä»¥ä½¿ç”¨æç¼©æ”¾ï¼Œå¦åˆ™Xè½´Yè½´å°†ä¼šåˆ†å¼€ç¼©æ”¾ setDoubleTapToZoomEnabled(boolean enabled) è®¾ç½®ä¸ºfalseï¼ŒåŒå‡»æ”¾å¤§åŠŸèƒ½å°†ä¼šè¢«ç¦ç”¨ *** ### 2.2 å›¾è¡¨Flingå’Œå‡é€Ÿï¼ˆé’ˆå¯¹æ»‘åŠ¨æ“ä½œï¼‰ æ–¹æ³• ä½œç”¨ â€”â€“ â€”â€“ setDragDecelerationEnabled(boolean enabled) å¦‚æœè®¾ç½®ä¸ºtrueï¼Œæ»‘åŠ¨æ“ä½œå®Œæˆåå›¾è¡¨è¿˜ä¼šç»§ç»­æ»šåŠ¨ã€‚é»˜è®¤å€¼ä¸ºtrue setDragDecelerationFrictionCoef(float coef) å‡é€Ÿæ‘©æ“¦ç³»æ•°åœ¨[0; 1]é—´éš”ï¼Œè¾ƒé«˜çš„å€¼è¡¨ç¤ºé€Ÿåº¦å°†ç¼“æ…¢é™ä½ï¼Œä¾‹å¦‚ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œå®ƒå°†ç«‹å³åœæ­¢ã€‚ 1æ˜¯æ— æ•ˆå€¼ï¼Œå°†è‡ªåŠ¨è½¬æ¢ä¸º0.9999ã€‚ ** ### 2.3 é«˜äº®å€¼ å¦‚ä½•é€šè¿‡ç‚¹å‡»æ‰‹åŠ¿é«˜äº®æ•°æ®æ¡ç›®ï¼Œè¯·æŸ¥é˜…highlighting section **** ### 2.4 æ‰‹åŠ¿å›è°ƒ OnChartGestureListeneræ¥å£å¯ä»¥è®©æˆ‘ä»¬å®šä¹‰æ‰‹åŠ¿å“åº”äº‹ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667public interface OnChartGestureListener { /** * Callbacks when a touch-gesture has started on the chart (ACTION_DOWN) * * @param me * @param lastPerformedGesture */ void onChartGestureStart(MotionEvent me, ChartTouchListener.ChartGesture lastPerformedGesture); /** * Callbacks when a touch-gesture has ended on the chart (ACTION_UP, ACTION_CANCEL) * * @param me * @param lastPerformedGesture */ void onChartGestureEnd(MotionEvent me, ChartTouchListener.ChartGesture lastPerformedGesture); /** * Callbacks when the chart is longpressed. * * @param me */ public void onChartLongPressed(MotionEvent me); /** * Callbacks when the chart is double-tapped. * * @param me */ public void onChartDoubleTapped(MotionEvent me); /** * Callbacks when the chart is single-tapped. * * @param me */ public void onChartSingleTapped(MotionEvent me); /** * Callbacks then a fling gesture is made on the chart. * * @param me1 * @param me2 * @param velocityX * @param velocityY */ public void onChartFling(MotionEvent me1, MotionEvent me2, float velocityX, float velocityY); /** * Callbacks when the chart is scaled / zoomed via pinch zoom gesture. * * @param me * @param scaleX scalefactor on the x-axis * @param scaleY scalefactor on the y-axis */ public void onChartScale(MotionEvent me, float scaleX, float scaleY); /** * Callbacks when the chart is moved / translated via drag gesture. * * @param me * @param dX translation distance on the x-axis * @param dY translation distance on the y-axis */ public void onChartTranslate(MotionEvent me, float dX, float dY);} ç®€å•åœ°åœ¨ç±»ä¸­å®ç°ä¸Šé¢è¿™ä¸ªæ¥å£ï¼Œç„¶åè®¾ç½®åˆ°å¯¹åº”çš„chartå¯¹è±¡ 1chart.setOnChartGestureListener(this); 3. é«˜äº®æœ¬èŠ‚é‡ç‚¹ä»‹ç»é€šè¿‡ç‚¹å‡»æ‰‹åŠ¿å’ŒåŸºäºç‰ˆæœ¬v3.0.0ä»¥ç¼–ç¨‹æ–¹å¼çªå‡ºæ˜¾ç¤ºå›¾è¡¨ä¸­çš„æ¡ç›®çš„ä¸»é¢˜ã€‚ 3.1 å¯ç”¨ï¼ç¦ç”¨é«˜äº® æ–¹æ³• ä½œç”¨ setHighlightPerDragEnabled(boolean enabled) åœ¨å›¾è¡¨ä¸Šå°†å…¶è®¾ç½®ä¸ºtrueï¼Œä»¥ä¾¿åœ¨å®Œå…¨ç¼©å°æ—¶åœ¨å›¾è¡¨ä¸Šæ‹–åŠ¨æ—¶çªå‡ºæ˜¾ç¤ºã€‚ é»˜è®¤å€¼ï¼štrue setHighlightPerTapEnabled(boolean enabled) åœ¨å›¾è¡¨ä¸Šå°†å…¶è®¾ç½®ä¸ºfalseå¯é˜²æ­¢ç‚¹å‡»æ‰‹åŠ¿çªå‡ºæ˜¾ç¤ºå€¼ã€‚ ä»ç„¶å¯ä»¥é€šè¿‡æ‹–åŠ¨æˆ–ä»¥ç¼–ç¨‹æ–¹å¼çªå‡ºæ˜¾ç¤ºå€¼ã€‚ é»˜è®¤å€¼ï¼štrue setMaxHighlightDistance(float distanceDp) è®¾ç½®æœ€å¤§é«˜äº®è·ç¦»(dp)ã€‚ å›¾è¡¨ä¸Šæ¡ç›®å¤§äºè¿™ä¸ªè·ç¦»ä¸ä¼šè§¦å‘é«˜äº®ã€‚ é»˜è®¤å€¼ï¼š500dp é™¤æ­¤ä¹‹å¤–ï¼Œå•ç‹¬çš„DataSetä¹Ÿèƒ½é…ç½®é«˜äº®ï¼š 123456dataSet.setHighlightEnabled(true); // allow highlighting for DataSet// set this to false to disable the drawing of highlight indicator (lines)dataSet.setDrawHighlightIndicators(true); dataSet.setHighlightColor(Color.BLACK); // color for highlight indicator// and more... 3.2 ä»£ç å®ç°é«˜äº® æ–¹æ³• ä½œç”¨ highlightValue(float x, int dataSetIndex, boolean callListener) çªå‡ºæ˜¾ç¤ºç»™å®šDataSetä¸­æŒ‡å®šxä½ç½®çš„å€¼ã€‚ dataSetIndexä¸º-1æ—¶æ’¤æ¶ˆæ‰€æœ‰é«˜äº®ã€‚ callListenerå†³å®šäº†æ˜¯å¦è°ƒç”¨é€‰æ‹©ç›‘å¬å™¨ã€‚ highlightValue(Highlight high, boolean callListener) çªå‡ºæ˜¾ç¤ºç”±æä¾›çš„é«˜å…‰å¯¹è±¡è¡¨ç¤ºçš„å€¼ã€‚ æä¾›nullä»¥æ’¤é”€æ‰€æœ‰çªå‡ºæ˜¾ç¤ºã€‚ callListenerå†³å®šäº†æ˜¯å¦è°ƒç”¨é€‰æ‹©ç›‘å¬å™¨ã€‚ highlightValues(Highlight[] highs) çªå‡ºæ˜¾ç¤ºhighsä»£è¡¨çš„é«˜å…‰å¯¹è±¡è¡¨ç¤ºçš„å€¼ã€‚æä¾›nullæˆ–è€…æ˜¯ç©ºæ•°ç»„å–æ¶ˆæ‰€æœ‰é«˜äº® getHighlighted() ä»¥highlight[]çš„å½¢å¼è¿”å›åŒ…å«æ‰€æœ‰é«˜å…‰æ¡ç›®ä¿¡æ¯ï¼ŒXåæ ‡ï¼ŒDateSetç´¢å¼• ***** ### 3.3 é€‰æ‹©å›è°ƒ å¼€æºåº“æä¾›äº†å¤§é‡ç”¨æ¥å¤„ç†äº¤äº’çš„ç›‘å¬å™¨ã€‚OnChartValueSelectedListeneræ˜¯å…¶ä¸­ä¸€ä¸ªï¼Œç”¨æ¥å¤„ç†é€šè¿‡è§¦æ‘¸é«˜äº®æ•°æ®æ¡ç›®æ—¶å¤„ç†å›è°ƒï¼š 1234567891011121314public interface OnChartValueSelectedListener { /** * Called when a value has been selected inside the chart. * * @param e The selected Entry. * @param h The corresponding highlight object that contains information * about the highlighted position */ public void onValueSelected(Entry e, Highlight h); /** * Called when nothing has been selected or an &quot;un-select&quot; has been made. */ public void onNothingSelected();} åœ¨éœ€è¦æ¥å—å›è°ƒçš„ç±»ä¸­å®ç°ä¸Šé¢è¿™ä¸ªæ¥å£ï¼Œç„¶åå°†ç›‘å¬å™¨è®¾ç½®åˆ°Chartå³å¯ 1chart.setOnChartValueSelectedListener(this); 3.4 Highlightç±»Hightlightç±»ä»£è¡¨ä¸€ä¸ªé«˜äº®æ¡ç›®çš„æ‰€æœ‰æ•°æ®ï¼Œå¦‚é«˜äº®æ¡ç›®æœ¬èº«ï¼Œå®ƒçš„DataSetï¼Œå®ƒåœ¨ç•Œé¢ä¸Šçš„ç»˜åˆ¶ä½ç½®ç­‰ç­‰ã€‚è¿™ä¸ªç±»å¯ä»¥ç”¨æ¥å¾—åˆ°å½“å‰é«˜äº®æ¡ç›®çš„ä¿¡æ¯ï¼Œæˆ–è€…ç”¨æ¥å‘Šè¯‰Chartï¼Œéœ€è¦é«˜äº®å“ªäº›æ¡ç›®ã€‚ä¸ºäº†å®ç°è¿™äº›ç›®çš„ï¼ŒHighlightç±»æä¾›äº†ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼š 12345/** constructor for standard highlight */public Highlight(float x, int dataSetIndex) { ... }/** constructor for stacked BarEntry highlight */public Highlight(float x, int dataSetIndex, int stackIndex) { ... } é€šè¿‡æ„é€ å‡½æ•°ä½ å¯ä»¥åˆ›å»ºHightlightå¯¹è±¡ï¼Œç„¶åé€šè¿‡ä»£ç çš„æ–¹å¼å®ç°é«˜äº®ï¼š 1234// highlight the entry and x-position 50 in the first (0) DataSetHighlight highlight = new Highlight(50f, 0); chart.highlightValue(highlight, false); // highlight this value, don&apos;t call listener 3.5 è‡ªå®šä¹‰é«˜äº®å™¨æ‰€æœ‰ä»¥é«˜äº®æ‰‹åŠ¿å½¢å¼æ˜¾ç¤ºçš„ç”¨æˆ·è¾“å…¥éƒ½ç”±é»˜è®¤çš„ChartHighlighterç±»è¿›è¡Œå†…éƒ¨å¤„ç†ã€‚ ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¯ä»¥ç”¨è‡ªå®šä¹‰å®ç°æ›¿æ¢é»˜è®¤çš„highligherï¼š æ–¹æ³• ä½œç”¨ setHighlighter(ChartHighlighter highlighter) è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰é«˜äº®å™¨æ¥å¤„ç†æ‰€æœ‰å›¾è¡¨ä¸Šçš„é«˜äº®äº‹ä»¶ã€‚ä½ çš„è‡ªå®šä¹‰é«˜äº®å™¨å¿…é¡»ç»§æ‰¿ChartHighlighterç±» *** ## 4. è½´ è¯¥wikié¡µé¢é‡ç‚¹ä»‹ç»AxisBaseç±»ï¼ŒXAxisï¼ˆXAxisï¼‰å’ŒYAxisï¼ˆYAxisï¼‰çš„åŸºç¡€ç±»ã€‚ åœ¨v2.0.0ä¸­å¼•å…¥ ä¸‹é¢æåˆ°çš„ä»¥ä¸‹æ–¹æ³•éƒ½å¯ä»¥åº”ç”¨äºä¸¤ä¸ªè½´ã€‚ è½´ç±»å…è®¸ç‰¹å®šçš„æ ·å¼ï¼ŒåŒ…æ‹¬ä»¥ä¸‹ç»„ä»¶/éƒ¨ä»¶ï¼ˆå¯ä»¥åŒ…æ‹¬ï¼‰ï¼šæ ‡ç­¾ï¼ˆä»¥å‚ç›´ï¼ˆyè½´ï¼‰æˆ–æ°´å¹³ï¼ˆxè½´ï¼‰å¯¹é½ç»˜åˆ¶ï¼‰ï¼Œå…¶ä¸­åŒ…å«è½´æè¿°å€¼ æ‰€è°“çš„â€œè½´çº¿â€è¢«ç›´æ¥ç»˜åˆ¶åœ¨æ ‡ç­¾é™„è¿‘å¹¶ä¸æ ‡ç­¾å¹³è¡Œ â€œç½‘æ ¼çº¿â€ï¼Œå„è‡ªæºè‡ªæ°´å¹³æ–¹å‘çš„è½´æ ‡ç­¾ é™åˆ¶çº¿ï¼Œå…è®¸å‘ˆç°ç‰¹æ®Šä¿¡æ¯ï¼Œå¦‚è¾¹ç•Œæˆ–çº¦æŸ 4.1 æ§åˆ¶è½´çº¿ç»˜åˆ¶ï¼ˆå“ªäº›éƒ¨åˆ†éœ€è¦ç»˜åˆ¶ï¼‰ æ–¹æ³• ä½œç”¨ setEnabled(boolean enabled) è®¾ç½®è½´å¯ç”¨æˆ–ç¦ç”¨ã€‚ å¦‚æœç¦ç”¨ï¼Œæ— è®ºä»»ä½•å…¶ä»–è®¾ç½®å¦‚ä½•ï¼Œéƒ½ä¸ä¼šç»˜åˆ¶è½´çš„ä»»ä½•éƒ¨åˆ† setDrawLabels(boolean enabled) å°†å…¶è®¾ç½®ä¸ºtrueå¯ä»¥ç»˜åˆ¶è½´çš„æ ‡ç­¾ã€‚ setDrawAxisLine(boolean enabled) å¦‚æœæ²¿ç€è½´ï¼ˆè½´çº¿ï¼‰çš„çº¿åº”è¯¥è¢«ç»˜åˆ¶ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºtrueã€‚ setDrawGridLines(boolean enabled) å°†å…¶è®¾ç½®ä¸ºtrueå¯ä»¥ç»˜åˆ¶è½´çš„ç½‘æ ¼çº¿ã€‚ **** ### 4.2 è‡ªå®šä¹‰è½´çš„èŒƒå›´ï¼ˆæœ€å°å€¼ï¼æœ€å¤§å€¼ï¼‰ æ–¹æ³• ä½œç”¨ â€”â€” â€”â€” setAxisMaximum(float max) è®¾ç½®æ­¤è½´çš„è‡ªå®šä¹‰æœ€å¤§å€¼ã€‚ å¦‚æœè®¾ç½®ï¼Œæ­¤å€¼å°†ä¸ä¼šæ ¹æ®æä¾›çš„æ•°æ®è‡ªåŠ¨è®¡ç®—. resetAxisMaximum() è°ƒç”¨æ­¤æ–¹æ³•æ¥æ’¤é”€å…ˆå‰è®¾ç½®çš„æœ€å¤§å€¼ã€‚ é€šè¿‡è¿™æ ·åšï¼Œä½ å°†å†æ¬¡å…è®¸è½´è‡ªåŠ¨è®¡ç®—å®ƒçš„æœ€å¤§å€¼ã€‚ setAxisMinimum(float min) è®¾ç½®æ­¤è½´çš„è‡ªå®šä¹‰æœ€å°å€¼ã€‚ å¦‚æœè®¾ç½®ï¼Œæ­¤å€¼å°†ä¸ä¼šæ ¹æ®æä¾›çš„æ•°æ®è‡ªåŠ¨è®¡ç®— resetAxisMinimum() è°ƒç”¨æ­¤æ–¹æ³•æ¥æ’¤é”€å…ˆå‰è®¾ç½®çš„æœ€å°å€¼ã€‚ é€šè¿‡è¿™æ ·åšï¼Œä½ å°†å†æ¬¡å…è®¸è½´è‡ªåŠ¨è®¡ç®—å®ƒçš„æœ€å°å€¼ã€‚ setStartAtZero(boolean enabled) å·²å¼ƒç”¨ - è¯·ä½¿ç”¨setAxisMinValueï¼ˆâ€¦ï¼‰æˆ–setAxisMaxValueï¼ˆâ€¦ï¼‰ setInverted(boolean enabled) å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™è¯¥è½´å°†è¢«åè½¬ï¼Œè¿™æ„å‘³ç€æœ€é«˜å€¼å°†åœ¨åº•éƒ¨ï¼Œæœ€ä½å€¼åœ¨é¡¶éƒ¨ setSpaceTop(float percent) è®¾ç½®å›¾è¡¨ä¸­æœ€é«˜å€¼çš„é¡¶éƒ¨é—´è·ï¼ˆä»¥æ€»è½´çš„ç™¾åˆ†æ¯”è¡¨ç¤ºï¼‰ä¸è½´ä¸Šçš„æœ€é«˜å€¼ç›¸æ¯”è¾ƒ setSpaceBottom(float percent) è®¾ç½®å›¾è¡¨ä¸­æœ€ä½å€¼çš„åº•éƒ¨é—´è·ï¼ˆä»¥æ€»è½´èŒƒå›´çš„ç™¾åˆ†æ¯”è¡¨ç¤ºï¼‰ä¸è½´ä¸Šçš„æœ€ä½å€¼ç›¸æ¯”è¾ƒ. setShowOnlyMinMax(boolean enabled) å¦‚æœå¯ç”¨ï¼Œè¯¥è½´å°†ä»…æ˜¾ç¤ºå…¶æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ è¿™å°†å¿½ç•¥/è¦†ç›–å®šä¹‰çš„æ ‡ç­¾è®¡æ•°ï¼ˆå¦‚æœä¸å¼ºåˆ¶ï¼‰. setLabelCount(int count, boolean force) è®¾ç½®yè½´çš„æ ‡ç­¾æ•°é‡ã€‚ è¯·æ³¨æ„ï¼Œè¿™ä¸ªæ•°å­—ä¸æ˜¯å›ºå®šçš„ï¼ˆå¦‚æœforce == falseï¼‰ï¼Œå¹¶ä¸”åªèƒ½è¿‘ä¼¼ã€‚ å¦‚æœå¼ºåˆ¶å¯ç”¨ï¼ˆtrueï¼‰ï¼Œåˆ™ç»˜åˆ¶ç²¾ç¡®çš„æŒ‡å®šæ ‡ç­¾è®¡æ•° - è¿™å¯èƒ½å¯¼è‡´è½´ä¸Šçš„æ•°å­—ä¸å‡åŒ€ã€‚ setPosition(YAxisLabelPosition pos) è®¾ç½®ç»˜åˆ¶è½´æ ‡ç­¾çš„ä½ç½®ã€‚ INSIDE_CHARTæˆ–OUTSIDE_CHARTã€‚ setGranularity(float gran) è®¾ç½®yè½´å€¼ä¹‹é—´çš„æœ€å°é—´éš”ã€‚ è¿™å¯ä»¥ç”¨äºåœ¨æ”¾å¤§åˆ°ä¸ºè½´è®¾ç½®çš„å°æ•°ä½æ•°ä¸å†å…è®¸åŒºåˆ†ä¸¤ä¸ªè½´å€¼çš„ç‚¹æ—¶é¿å…é‡å¤å€¼ã€‚ setGranularityEnabled(boolean enabled) å¯ç”¨åœ¨æ”¾å¤§æ—¶é™åˆ¶yè½´é—´éš”çš„ç²’åº¦ç‰¹å¾ã€‚é»˜è®¤å€¼ï¼šfalse ***** ### 4.3 æ ·å¼/ä¿®æ”¹è½´ æ–¹æ³• ä½œç”¨ â€”â€” â€”â€” setTextColor(int color) è®¾ç½®è½´æ ‡ç­¾çš„æ–‡å­—é¢œè‰². setTextSize(float size) è®¾ç½®è½´æ ‡ç­¾çš„æ–‡å­—å¤§å°(dp) setTypeface(Typeface tf) è®¾ç½®è½´æ ‡ç­¾çš„å­—ä½“ setGridColor(int color) è®¾ç½®è½´ç½‘æ ¼çº¿çš„é¢œè‰² setGridLineWidth(float width) è®¾ç½®è½´ç½‘æ ¼çº¿çš„å®½åº¦ setAxisLineColor(int color) è®¾ç½®è½´çº¿çš„é¢œè‰² setAxisLineWidth(float width) è®¾ç½®è½´çº¿çš„å®½åº¦ enableGridDashedLine(float lineLength, float spaceLength, float phase) ä½¿ç½‘æ ¼çº¿ä»¥è™šçº¿æ¨¡å¼ç»˜åˆ¶ï¼Œä¾‹å¦‚â€- - - - - -â€ã€‚ â€œlineLengthâ€æ§åˆ¶çº¿æ®µçš„é•¿åº¦ï¼Œâ€œspaceLengthâ€æ§åˆ¶çº¿é—´çš„ç©ºé—´ï¼Œâ€œphaseâ€æ§åˆ¶èµ·ç‚¹ã€‚ *** ### 4.4 æ ¼å¼åŒ–è½´å€¼ å¯¹äºæ ¼å¼åŒ–è½´å€¼ï¼Œå¯ä»¥ä½¿ç”¨IAxisValueFormatteræ¥å£ï¼Œä½ å¯ä»¥ä½¿ç”¨axis.setValueFormatter(IAxisValueFormatter formatter)æ–¹æ³•å°†è‡ªå®šä¹‰æ ¼å¼è®¾ç½®åˆ°è½´ï¼Œå…·ä½“è¯·æŸ¥é˜…here **** ### 4.5 é™åˆ¶å€¼ ä¸¤ä¸ªè½´éƒ½æ”¯æŒæ‰€è°“çš„LimitLineï¼Œå…è®¸æä¾›ç‰¹æ®Šä¿¡æ¯ï¼Œå¦‚è¾¹ç•Œæˆ–çº¦æŸã€‚ æ·»åŠ åˆ°YAxisçš„LimitLinesåœ¨æ°´å¹³æ–¹å‘ç»˜åˆ¶ï¼Œå¹¶ä¸”åœ¨æ·»åŠ åˆ°XAxisæ—¶åœ¨å‚ç›´æ–¹å‘ç»˜åˆ¶ã€‚ ä¸‹é¢ä»‹ç»å¦‚ä½•ä»è½´ä¸­æ·»åŠ å’Œåˆ é™¤LimitLinesï¼š æ–¹æ³• ä½œç”¨ â€”â€“ â€”â€” addLimitLine(LimitLine l) ç»™è½´æ·»åŠ ä¸€æ¡LimitLine removeLimitLine(LimitLine l) ç§»é™¤è½´ä¸Šä¸€æ¡æŒ‡å®šçš„LimitLine è¿˜æœ‰å¾ˆå¤šæ·»åŠ ï¼ç§»é™¤çš„æ–¹æ³• setDrawLimitLinesBehindData(boolean enabled) å…è®¸æ§åˆ¶LimitLineså’Œå®é™…æ•°æ®ä¹‹é—´çš„zé¡ºåºã€‚ å¦‚æœå°†æ­¤è®¾ç½®ä¸ºtrueï¼Œåˆ™LimitLineå°†åœ¨å®é™…æ•°æ®ä¹‹åç»˜åˆ¶ï¼Œå¦åˆ™åœ¨é¡¶éƒ¨ã€‚ é»˜è®¤å€¼ï¼šfalse é™åˆ¶çº¿ï¼ˆLimitLineç±»ï¼‰ï¼ˆæ­£å¦‚åç§°å¯èƒ½æŒ‡ç¤ºçš„ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çº¿æ¡ä¸ºç”¨æˆ·æä¾›é™„åŠ ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œä½ çš„å›¾è¡¨å¯èƒ½ä¼šæ˜¾ç¤ºç”¨æˆ·ä½¿ç”¨åº”ç”¨ç¨‹åºè®°å½•çš„å„ç§è¡€å‹æµ‹é‡ç»“æœã€‚ ä¸ºäº†é€šçŸ¥ç”¨æˆ·è¶…è¿‡140 mmHgçš„æ”¶ç¼©å‹è¢«è®¤ä¸ºæ˜¯å¥åº·é£é™©ï¼Œæ‚¨å¯ä»¥åœ¨140å¤„æ·»åŠ LimitLineæ¥æä¾›è¯¥ä¿¡æ¯ã€‚ 4.6 ç¤ºä¾‹ä»£ç 12345678910YAxis leftAxis = chart.getAxisLeft();LimitLine ll = new LimitLine(140f, &quot;Critical Blood Pressure&quot;);ll.setLineColor(Color.RED);ll.setLineWidth(4f);ll.setTextColor(Color.BLACK);ll.setTextSize(12f);// .. and more styling optionsleftAxis.addLimitLine(ll); 5. Xè½´XAxisæ˜¯AxisBaseçš„å­ç±»ï¼Œå®ƒç»§æ‰¿äº†è®¸å¤šæ ·å¼å’Œæ–¹æ³•ã€‚XAxisç±»ï¼ˆåœ¨2.0.0ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ç§°ä¸º XLabelsï¼‰ï¼Œæ˜¯ä¸æ¨ªè½´æœ‰å…³çš„æ‰€æœ‰æ•°æ®å’Œä¿¡æ¯å®¹å™¨ã€‚ æ¯ä¸ªLine-ï¼ŒBar-ï¼ŒScatter-ï¼ŒCandleStick-å’ŒRadarChartéƒ½æœ‰ä¸€ä¸ªXAxiså¯¹è±¡ã€‚XAxisç±»å…è®¸ç‰¹å®šçš„æ ·å¼ï¼ŒåŒ…æ‹¬ä»¥ä¸‹ç»„ä»¶ï¼ˆå¯ä»¥åŒ…æ‹¬ï¼‰ä»¥ä¸‹ç»„ä»¶/éƒ¨ä»¶ï¼š æ‰€è°“çš„â€œè½´çº¿â€è¢«ç›´æ¥ç»˜åˆ¶åœ¨æ ‡ç­¾é™„è¿‘å¹¶ä¸æ ‡ç­¾å¹³è¡Œ â€œç½‘æ ¼çº¿â€ï¼Œå„è‡ªæºäºå‚ç›´æ–¹å‘çš„è½´æ ‡ç­¾ é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–XAxiså®ä¾‹ï¼š 1XAxis xAxis = chart.getXAxis(); 5.1 è‡ªå®šä¹‰XAxis æ–¹æ³• ä½œç”¨ setLabelRotationAngle(float angle) è®¾ç½®ç»˜åˆ¶xè½´æ ‡ç­¾çš„è§’åº¦ï¼ˆä»¥åº¦ä¸ºå•ä½ï¼‰ setPosition(XAxisPosition pos) è®¾ç½®XAxisä½ç½®ã€‚ åœ¨TOPï¼ŒBOTTOMï¼ŒBOTH_SIDEDï¼ŒTOP_INSIDEæˆ–BOTTOM_INSIDEä¹‹é—´è¿›è¡Œé€‰æ‹© *** ### 5.2 ç¤ºä¾‹ä»£ç  123456789XAxis xAxis = chart.getXAxis();xAxis.setPosition(XAxisPosition.BOTTOM);xAxis.setTextSize(10f);xAxis.setTextColor(Color.RED);xAxis.setDrawAxisLine(true);xAxis.setDrawGridLines(false);// set a custom value formatterxAxis.setValueFormatter(new MyCustomFormatter()); // and more... 6. YAxisYAxisæ˜¯AxisBaseçš„å­ç±»ã€‚ è¿™ä¸ªwikiåªæè¿°äº†YAxisï¼Œè€Œä¸æ˜¯çˆ¶ç±»ã€‚ YAxisç±»ï¼ˆåœ¨2.0.0ç‰ˆæœ¬çš„ä¸­ç§°ä¸ºYLabelsï¼‰ï¼Œæ˜¯ä¸å‚ç›´è½´ç›¸å…³çš„æ‰€æœ‰æ•°æ®å’Œä¿¡æ¯å®¹å™¨ã€‚ æ¯ä¸ªLine-ï¼ŒBar-ï¼ŒScatteræˆ–CandleStickChartéƒ½æœ‰ä¸€ä¸ªå·¦å’Œå³YAxiså¯¹è±¡ï¼Œåˆ†åˆ«è´Ÿè´£å·¦è½´æˆ–å³è½´ã€‚ RadarChartåªæœ‰ä¸€ä¸ªYAxisã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå›¾è¡¨çš„ä¸¤ä¸ªè½´éƒ½è¢«å¯ç”¨ï¼Œå¹¶å°†è¢«ç»˜åˆ¶ã€‚é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–YAxiså®ä¾‹ï¼š 123456YAxis leftAxis = chart.getAxisLeft();YAxis rightAxis = chart.getAxisRight();YAxis leftAxis = chart.getAxis(AxisDependency.LEFT);YAxis yAxis = radarChart.getYAxis(); // this method radarchart only åœ¨è¿è¡Œæ—¶ï¼Œä½¿ç”¨public AxisDependency getAxisDependencyï¼ˆï¼‰æ¥ç¡®å®šæ­¤è½´è¡¨ç¤ºçš„å›¾è¡¨çš„è¾¹ã€‚ æ‰€æœ‰ä¼šå½±å“åˆ°è½´æ•°å€¼èŒƒå›´çš„è‡ªå®šä¹‰è®¾ç½®éƒ½éœ€è¦åœ¨è®¾ç½®å›¾è¡¨æ•°æ®ä¹‹å‰å®Œæˆã€‚ 6.1 Axis Dependencyæ ¹æ®é»˜è®¤å€¼ï¼Œæ·»åŠ åˆ°å›¾è¡¨çš„æ‰€æœ‰æ•°æ®éƒ½ä¼šä¸å›¾è¡¨çš„å·¦ä¾§YAxiså¯¹åº”ã€‚ å¦‚æœæ²¡æœ‰è¿›ä¸€æ­¥æŒ‡å®šå’Œå¯ç”¨ï¼Œåˆ™å³ä¾§çš„YAxisè¢«è°ƒæ•´ä¸ºä¸å·¦è½´ç›¸åŒçš„åˆ»åº¦ã€‚ å¦‚æœä½ çš„å›¾è¡¨éœ€è¦æ”¯æŒä¸åŒçš„è½´åˆ»åº¦ï¼Œåˆ™å¯ä»¥é€šè¿‡è®¾ç½®æ•°æ®åº”è¯¥å¯¹åº”çš„è½´æ¥å®ç°ã€‚ è¿™å¯ä»¥é€šè¿‡æ›´æ”¹DataSetå¯¹è±¡çš„AxisDependencyæ¥å®ç°ï¼š 12LineDataSet dataSet = ...; // get a datasetdataSet.setAxisDependency(AxisDependency.RIGHT); è®¾ç½®æ­¤é¡¹å°†æ›´æ”¹ä½ çš„æ•°æ®å¯¹åº”çš„è½´ã€‚ 6.2 é›¶çº¿é™¤äº†æ²¿YAxisä¸Šçš„æ¯ä¸ªå€¼æ°´å¹³ä½ç½®çš„ç½‘æ ¼çº¿ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ‰€è°“çš„é›¶çº¿ï¼Œå®ƒåœ¨è½´ä¸Šçš„é›¶ï¼ˆ0ï¼‰å€¼å¤„ç»˜åˆ¶ï¼Œå¹¶ä¸”ä¸ç½‘æ ¼çº¿ç›¸ä¼¼ï¼Œä½†å¯ä»¥å•ç‹¬é…ç½®ã€‚|æ–¹æ³•|ä½œç”¨||â€”â€”|â€”â€”||setDrawZeroLine(boolean enabled)|å¯ç”¨ / ç¦ç”¨ é›¶çº¿ã€‚||setZeroLineWidth(float width)|è®¾ç½®é›¶çº¿çš„å®½åº¦ã€‚||setZeroLineColor(int color)|è®¾ç½®é›¶çº¿çš„é¢œè‰²|é›¶çº¿ç¤ºä¾‹ä»£ç ï¼š 1234567// data has AxisDependency.LEFTYAxis left = mChart.getAxisLeft();left.setDrawLabels(false); // no axis labelsleft.setDrawAxisLine(false); // no axis lineleft.setDrawGridLines(false); // no grid linesleft.setDrawZeroLine(true); // draw a zero linemChart.getAxisRight().setEnabled(false); // no right axis ä¸Šè¿°ä»£ç ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚ ä¸ç»˜åˆ¶è½´å€¼ï¼Œä¸ç»˜åˆ¶ç½‘æ ¼çº¿æˆ–è½´çº¿ï¼Œåªç»˜åˆ¶é›¶çº¿ã€‚ 6.3 æ›´å¤šç¤ºä¾‹ä»£ç 12345678910YAxis yAxis = mChart.getAxisLeft();yAxis.setTypeface(...); // set a different fontyAxis.setTextSize(12f); // set the text sizeyAxis.setAxisMinimum(0f); // start at zeroyAxis.setAxisMaximum(100f); // the axis maximum is 100yAxis.setTextColor(Color.BLACK);yAxis.setValueFormatter(new MyValueFormatter());yAxis.setGranularity(1f); // interval 1yAxis.setLabelCount(6, true); // force 6 labels//... and more","link":"/2017/06/10/ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 1/"},{"title":"ã€ŠAndroid å¼€æºåº“ã€‹ FlycoTabLayout ä»å¤´åˆ°è„š","text":"ç®€ä»‹FlycoTabLayoutï¼Œæ˜¯ä¸€ä¸ªæ¯”GoogleåŸç”ŸTabLayout åŠŸèƒ½æ›´å¼ºå¤§çš„TabLayoutåº“ã€‚ç›®å‰æœ‰3ç§TabLayoutï¼š SlidingTabLayout CommonTabLayout SegmentTabLayout å…·ä½“ä»‹ç»å’Œä½¿ç”¨æ–¹æ³•å‚è€ƒå¼€æºåº“çš„Wiki å®˜æ–¹ç¤ºä¾‹ï¼š æºç åˆ†æ å…±æœ‰å±æ€§åç§° æ ¼å¼ æè¿° tl_indicator_color color è®¾ç½®æ˜¾ç¤ºå™¨é¢œè‰² tl_indicator_height dimension è®¾ç½®æ˜¾ç¤ºå™¨é«˜åº¦ tl_indicator_margin_left dimension è®¾ç½®æ˜¾ç¤ºå™¨margin,å½“indicator_widthå¤§äº0,æ— æ•ˆ tl_indicator_margin_top dimension è®¾ç½®æ˜¾ç¤ºå™¨margin,å½“indicator_widthå¤§äº0,æ— æ•ˆ tl_indicator_margin_right dimension è®¾ç½®æ˜¾ç¤ºå™¨margin,å½“indicator_widthå¤§äº0,æ— æ•ˆ tl_indicator_margin_bottom dimension è®¾ç½®æ˜¾ç¤ºå™¨margin,å½“indicator_widthå¤§äº0,æ— æ•ˆ tl_indicator_corner_radius dimension è®¾ç½®æ˜¾ç¤ºå™¨åœ†è§’å¼§åº¦ tl_divider_color color è®¾ç½®åˆ†å‰²çº¿é¢œè‰² tl_divider_width dimension è®¾ç½®åˆ†å‰²çº¿å®½åº¦ tl_divider_padding dimension è®¾ç½®åˆ†å‰²çº¿çš„paddingTopå’ŒpaddingBottom tl_tab_padding dimension è®¾ç½®tabçš„paddingLeftå’ŒpaddingRight tl_tab_space_equal boolean è®¾ç½®tabå¤§å°ç­‰åˆ† tl_tab_width dimension è®¾ç½®tabå›ºå®šå¤§å° tl_textsize dimension è®¾ç½®å­—ä½“å¤§å° tl_textSelectColor color è®¾ç½®å­—ä½“é€‰ä¸­é¢œè‰² tl_textUnselectColor color è®¾ç½®å­—ä½“æœªé€‰ä¸­é¢œè‰² tl_textBold boolean è®¾ç½®å­—ä½“åŠ ç²— tl_textAllCaps boolean è®¾ç½®å­—ä½“å…¨å¤§å†™ 1. SlidingTabLayout1.1 ç‰¹æœ‰å±æ€§ ç‰¹æœ‰å±æ€§ æ ¼å¼ æè¿° tl_indicator_width dimension è®¾ç½®æ˜¾ç¤ºå™¨å›ºå®šå®½åº¦ tl_indicator_gravity enum è®¾ç½®æ˜¾ç¤ºå™¨ä¸Šæ–¹(TOP)è¿˜æ˜¯ä¸‹æ–¹(BOTTOM),åªå¯¹å¸¸è§„æ˜¾ç¤ºå™¨æœ‰ç”¨ tl_indicator_style enum è®¾ç½®æ˜¾ç¤ºå™¨ä¸ºå¸¸è§„(NORMAL)æˆ–ä¸‰è§’å½¢(TRIANGLE)æˆ–èƒŒæ™¯è‰²å—(BLOCK) tl_indicator_width_equal_title boolean è®¾ç½®æ˜¾ç¤ºå™¨ä¸æ ‡é¢˜ä¸€æ ·é•¿(only for SlidingTabLayout) tl_underline_color color è®¾ç½®ä¸‹åˆ’çº¿é¢œè‰² tl_underline_height dimension è®¾ç½®ä¸‹åˆ’çº¿é«˜åº¦ tl_underline_gravity enum è®¾ç½®ä¸‹åˆ’çº¿ä¸Šæ–¹(TOP)è¿˜æ˜¯ä¸‹æ–¹(BOTTOM) 1.2 ç±»ç»“æ„1.2.1 æ„é€ æ–¹æ³•ç¬¬ä¸€ä¸ªè°ƒç”¨ç¬¬äºŒä¸ªï¼Œç¬¬äºŒä¸ªè°ƒç”¨ç¬¬ä¸‰ä¸ªï¼Œç¬¬ä¸‰ä¸ªè·å–è‡ªå®šä¹‰å±æ€§å€¼ã€‚ 123456789101112131415161718192021222324252627public SlidingTabLayout(Context context, AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); setFillViewport(true);//è®¾ç½®æ»šåŠ¨è§†å›¾æ˜¯å¦å¯ä»¥ä¼¸ç¼©å…¶å†…å®¹ä»¥å¡«å……è§†å£ setWillNotDraw(false);//é‡å†™onDrawæ–¹æ³•,éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥æ¸…é™¤flag setClipChildren(false);//ä¸é™åˆ¶childåœ¨å…¶èŒƒå›´å†…ç»˜åˆ¶ setClipToPadding(false);//æ»šåŠ¨æ—¶childå¯ä»¥ç»˜åˆ¶åˆ°paddingåŒºåŸŸ this.mContext = context; mTabsContainer = new LinearLayout(context);//tabå®¹å™¨ addView(mTabsContainer);//æ·»åŠ åˆ°HorizontalScrollViewä¸­ obtainAttributes(context, attrs);//è·å–è‡ªå®šä¹‰å±æ€§ï¼Œå¸¸ç”¨çš„æ–¹æ³•ï¼ŒTypedArrayè®°å¾—å›æ”¶ //è·å–layout_heightå±æ€§çš„å€¼ï¼Œè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæºœï¼Œä¹‹å‰æ²¡è§è¿‡ String height = attrs.getAttributeValue(\"http://schemas.android.com/apk/res/android\", \"layout_height\"); //é’ˆå¯¹heightåšå¤„ç† if (height.equals(ViewGroup.LayoutParams.MATCH_PARENT + \"\")) { } else if (height.equals(ViewGroup.LayoutParams.WRAP_CONTENT + \"\")) { } else { int[] systemAttrs = {android.R.attr.layout_height}; TypedArray a = context.obtainStyledAttributes(attrs, systemAttrs); //è·å–é«˜åº¦ mHeight = a.getDimensionPixelSize(0, ViewGroup.LayoutParams.WRAP_CONTENT); a.recycle(); }} 1.2.2 ViewPager æ–¹æ³• æè¿° setViewPager(ViewPager vp) è®¾ç½®ViewPagerå†…å®¹ public void setViewPager(ViewPager vp, String[] titles) è®¾ç½®ViewPagerå†…å®¹å’Œæ ‡ç­¾é¡µçš„æ ‡é¢˜ 12345678910111213/** å…³è”ViewPager */public void setViewPager(ViewPager vp) { if (vp == null || vp.getAdapter() == null) { throw new IllegalStateException(\"ViewPager or ViewPager adapter can not be NULL !\"); } /*æœ¬åœ°èµ‹å€¼*/ this.mViewPager = vp; /*é‡æ–°ç»‘å®šOnPageChangeListener*/ this.mViewPager.removeOnPageChangeListener(this); this.mViewPager.addOnPageChangeListener(this); /*viewpagerå˜åŒ–ï¼Œtabé¡µå“åº”å¤„ç†å¤„ç†*/ notifyDataSetChanged();} 123456789101112131415/** æ›´æ–°æ•°æ® */public void notifyDataSetChanged() { mTabsContainer.removeAllViews();//æ¸…ç©ºtab this.mTabCount = mTitles == null ? mViewPager.getAdapter().getCount() : mTitles.size();//è·å–tabæ•°é‡ï¼Œä¼˜å…ˆçº§mTitles &gt; ViewPagerçš„é»˜è®¤æ ‡é¢˜ /*æ·»åŠ tab*/ View tabView; for (int i = 0; i &lt; mTabCount; i++) { tabView = View.inflate(mContext, R.layout.layout_tab, null); CharSequence pageTitle = mTitles == null ? mViewPager.getAdapter().getPageTitle(i) : mTitles.get(i); addTab(i, pageTitle.toString(), tabView); } //æ›´æ–°é€‰ä¸­æœªé€‰ä¸­çŠ¶æ€æ›´æ–°tab updateTabStyles();} 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/** åˆ›å»ºå¹¶æ·»åŠ tab */ private void addTab(final int position, String title, View tabView) { //è®¾ç½®æ ‡é¢˜ TextView tv_tab_title = (TextView) tabView.findViewById(R.id.tv_tab_title); if (tv_tab_title != null) { if (title != null) tv_tab_title.setText(title); } //ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œä¸ViewPagerè”åŠ¨ tabView.setOnClickListener(new OnClickListener() { @Override public void onClick(View v) { int position = mTabsContainer.indexOfChild(v); if (position != -1) { if (mViewPager.getCurrentItem() != position) { if (mSnapOnTabClick) { // transition immediately mViewPager.setCurrentItem(position, false); } else { //smoothly scroll to mViewPager.setCurrentItem(position); } if (mListener != null) { //è‡ªå®šä¹‰tabç‚¹å‡»äº‹ä»¶å¤„ç† mListener.onTabSelect(position); } } else { if (mListener != null) { //è‡ªå®šä¹‰Reselectäº‹ä»¶å¤„ç† mListener.onTabReselect(position); } } } } }); /** æ¯ä¸€ä¸ªTabçš„å¸ƒå±€å‚æ•°ï¼ŒmTabSpaceEqual å±æ€§æ§åˆ¶æ˜¯å¦å‡åˆ† */ LinearLayout.LayoutParams lp_tab = mTabSpaceEqual ? new LinearLayout.LayoutParams(0, LayoutParams.MATCH_PARENT, 1.0f) : new LinearLayout.LayoutParams( LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT); if (mTabWidth &gt; 0) { lp_tab = new LinearLayout.LayoutParams((int) mTabWidth, LayoutParams.MATCH_PARENT); } //æ·»åŠ åˆ°Tabå®¹å™¨ mTabsContainer.addView(tabView, position, lp_tab); } 123456789101112131415161718192021private void updateTabStyles() { //éå†è®¾ç½®æ ‡é¢˜é€‰ä¸­é¢œè‰²ï¼Œæœªé€‰ä¸­é¢œè‰²ï¼Œå­—ä½“å¤§å°ï¼Œå¤§å°å†™ï¼Œç²—ä½“å­— for (int i = 0; i &lt; mTabCount; i++) { View v = mTabsContainer.getChildAt(i); TextView tv_tab_title = (TextView) v.findViewById(R.id.tv_tab_title); if (tv_tab_title != null) { tv_tab_title.setTextColor(i == mCurrentTab ? mTextSelectColor : mTextUnselectColor); tv_tab_title.setTextSize(TypedValue.COMPLEX_UNIT_PX, mTextsize); tv_tab_title.setPadding((int) mTabPadding, 0, (int) mTabPadding, 0); if (mTextAllCaps) { tv_tab_title.setText(tv_tab_title.getText().toString().toUpperCase()); } if (mTextBold == TEXT_BOLD_BOTH) { tv_tab_title.getPaint().setFakeBoldText(true); } else if (mTextBold == TEXT_BOLD_NONE) { tv_tab_title.getPaint().setFakeBoldText(false); } } }} æ–¹æ³• æè¿° setViewPager(ViewPager vp, String[] titles, FragmentActivity fa, ArrayList&lt; Fragment &gt; fragments) è®¾ç½®ViewPagerï¼Œæ ‡é¢˜å†…å®¹ï¼ŒFragmentActivityå’Œç”¨äºæ˜¾ç¤ºçš„Fragment,ç”¨æ¥è®¾ç½®ViewPagerçš„Adapter 123456789101112131415161718/** å…³è”ViewPager,ç”¨äºè¿é€‚é…å™¨éƒ½ä¸æƒ³è‡ªå·±å®ä¾‹åŒ–çš„æƒ…å†µ */public void setViewPager(ViewPager vp, String[] titles, FragmentActivity fa, ArrayList&lt;Fragment&gt; fragments) { if (vp == null) { throw new IllegalStateException(\"ViewPager can not be NULL !\"); } if (titles == null || titles.length == 0) { throw new IllegalStateException(\"Titles can not be EMPTY !\"); } this.mViewPager = vp; /*é€šè¿‡ä¼ å…¥çš„å‚æ•°æ„å»ºFragmentPagerAdapterï¼Œè®¾ç½®åˆ°ViewPager*/ this.mViewPager.setAdapter(new InnerPagerAdapter(fa.getSupportFragmentManager(), fragments, titles)); this.mViewPager.removeOnPageChangeListener(this); this.mViewPager.addOnPageChangeListener(this); notifyDataSetChanged();} çœ‹ä¸‹è¿™ä¸ªå†…éƒ¨çš„InnerPagerAdapter,é™æ€Fragment,ä¸é”€æ¯é‡å»ºï¼Œåªæ›´æ–°æ•°æ®å†…å®¹ã€‚ 123456789101112131415161718192021222324252627282930313233343536class InnerPagerAdapter extends FragmentPagerAdapter { private ArrayList&lt;Fragment&gt; fragments = new ArrayList&lt;&gt;(); private String[] titles; public InnerPagerAdapter(FragmentManager fm, ArrayList&lt;Fragment&gt; fragments, String[] titles) { super(fm); this.fragments = fragments; this.titles = titles; } @Override public int getCount() { return fragments.size(); } @Override public CharSequence getPageTitle(int position) { return titles[position]; } @Override public Fragment getItem(int position) { return fragments.get(position); } @Override public void destroyItem(ViewGroup container, int position, Object object) { // è¦†å†™destroyItemå¹¶ä¸”ç©ºå®ç°,è¿™æ ·æ¯ä¸ªFragmentä¸­çš„è§†å›¾å°±ä¸ä¼šè¢«é”€æ¯ // super.destroyItem(container, position, object); } @Override public int getItemPosition(Object object) { return PagerAdapter.POSITION_NONE; }} æ–¹æ³• æè¿° onPageScrolled(int position, float positionOffset, int positionOffsetPixels) é¡µé¢æ»šåŠ¨ï¼Œpositionä¸ºå½“å‰ä½ç½®ï¼ŒpositionOffsetèŒƒå›´[0,1),ä»å½“å‰åˆ°ä¸‹ä¸€é¡µï¼ŒpositionOffsetPixelsä»å½“å‰ä½ç½®æ»šåŠ¨çš„offset,å•ä½px onPageSelected(int position) é€‰ä¸­ä½ç½® onPageScrollStateChanged(int state) æ»šåŠ¨çŠ¶æ€æ”¹å˜ SCROLL_STATE_IDLE(pagerå¤„äºç©ºé—²çŠ¶æ€)SCROLL_STATE_DRAGGING( pagerå¤„äºæ­£åœ¨æ‹–æ‹½ä¸­)SCROLL_STATE_SETTLING(pageræ­£åœ¨è‡ªåŠ¨æ²‰é™ï¼Œç›¸å½“äºæ¾æ‰‹åï¼Œpageræ¢å¤åˆ°ä¸€ä¸ªå®Œæ•´pagerçš„è¿‡ç¨‹) 1234567891011121314151617181920212223@Overridepublic void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { /** * position:å½“å‰Viewçš„ä½ç½® * mCurrentPositionOffset:å½“å‰Viewçš„åç§»é‡æ¯”ä¾‹.[0,1) */ this.mCurrentTab = position; this.mCurrentPositionOffset = positionOffset; /*æ ‡ç­¾æ æ ¹æ®ViewPagerçš„æ»šåŠ¨çŠ¶æ€è”åŠ¨ï¼Œæ»šåŠ¨åˆ°å¯¹åº”ä½ç½®*/ scrollToCurrentTab(); /*è§¦å‘é‡ç»˜*/ invalidate();}@Overridepublic void onPageSelected(int position) { /*æ ¹æ®ViewPageré€‰ä¸­çŠ¶æ€è°ƒæ•´æ ‡ç­¾é¡µçš„é€‰ä¸­çŠ¶æ€*/ updateTabSelection(position);}@Overridepublic void onPageScrollStateChanged(int state) {} 1234567891011121314151617181920212223242526/** HorizontalScrollViewæ»šåˆ°å½“å‰tab,å¹¶ä¸”å±…ä¸­æ˜¾ç¤º */ private void scrollToCurrentTab() { if (mTabCount &lt;= 0) { return; } int offset = (int) (mCurrentPositionOffset * mTabsContainer.getChildAt(mCurrentTab).getWidth()); /**å½“å‰Tabçš„left+å½“å‰Tabçš„Widthä¹˜ä»¥positionOffset*/ int newScrollX = mTabsContainer.getChildAt(mCurrentTab).getLeft() + offset; if (mCurrentTab &gt; 0 || offset &gt; 0) { /**HorizontalScrollViewç§»åŠ¨åˆ°å½“å‰tab,å¹¶å±…ä¸­*/ newScrollX -= getWidth() / 2 - getPaddingLeft(); calcIndicatorRect(); newScrollX += ((mTabRect.right - mTabRect.left) / 2); } if (newScrollX != mLastScrollX) { mLastScrollX = newScrollX; /** scrollToï¼ˆint x,int yï¼‰:x,yä»£è¡¨çš„ä¸æ˜¯åæ ‡ç‚¹,è€Œæ˜¯åç§»é‡ * x:è¡¨ç¤ºç¦»èµ·å§‹ä½ç½®çš„xæ°´å¹³æ–¹å‘çš„åç§»é‡ * y:è¡¨ç¤ºç¦»èµ·å§‹ä½ç½®çš„yå‚ç›´æ–¹å‘çš„åç§»é‡ */ scrollTo(newScrollX, 0); } } 123456789101112131415/*æ ¹æ®æ˜¯å¦é€‰ä¸­è®¾ç½®å­—ä½“é¢œè‰²å’Œç²—ä½“*/private void updateTabSelection(int position) { for (int i = 0; i &lt; mTabCount; ++i) { View tabView = mTabsContainer.getChildAt(i); final boolean isSelect = i == position; TextView tab_title = (TextView) tabView.findViewById(R.id.tv_tab_title); if (tab_title != null) { tab_title.setTextColor(isSelect ? mTextSelectColor : mTextUnselectColor); if (mTextBold == TEXT_BOLD_WHEN_SELECT) { tab_title.getPaint().setFakeBoldText(isSelect); } } }} 1.2.3 Tabç›¸å…³ æ–¹æ³• æè¿° addNewTab(String title) æä¾›ç»™å¤–éƒ¨ä½¿ç”¨çš„æ–°å¢tabçš„æ–¹æ³• 123456789101112public void addNewTab(String title) { View tabView = View.inflate(mContext, R.layout.layout_tab, null); if (mTitles != null) { mTitles.add(title); } CharSequence pageTitle = mTitles == null ? mViewPager.getAdapter().getPageTitle(mTabCount) : mTitles.get(mTabCount); addTab(mTabCount, pageTitle.toString(), tabView); this.mTabCount = mTitles == null ? mViewPager.getAdapter().getCount() : mTitles.size(); updateTabStyles();} æ–¹æ³• æè¿° setCurrentTab(int currentTab) è·³è½¬åˆ°æŒ‡å®štab,æ˜¯å¦å¹³æ»‘çš„æ»šåŠ¨è¿‡å»ç”±ç³»ç»Ÿæ§åˆ¶ setCurrentTab(int currentTab, boolean smoothScroll) è·³è½¬åˆ°åˆ¶æŒ‡å®štab, smoothScrollæ§åˆ¶æ˜¯å¦å¹³æ»‘çš„æ»šåŠ¨è¿‡å» 12345678910public void setCurrentTab(int currentTab) { this.mCurrentTab = currentTab; mViewPager.setCurrentItem(currentTab);}public void setCurrentTab(int currentTab, boolean smoothScroll) { this.mCurrentTab = currentTab; mViewPager.setCurrentItem(currentTab, smoothScroll);} 1.2.4 Getterå’ŒSetterä¸åšèµ˜è¿° 1.2.5 MsgViewç›¸å…³ï¼ˆæœªè¯»ä¿¡æ¯ï¼‰ æ–¹æ³• æè¿° showMsg(int position, int num) æ˜¾ç¤ºæœªè¯»æ¶ˆæ¯ï¼Œpositionä¸ºtabä½ç½®ï¼Œnumå°äºç­‰äº0æ˜¾ç¤ºçº¢ç‚¹,numå¤§äº0æ˜¾ç¤ºæ•°å­— showDot(int position) æ˜¾ç¤ºæœªè¯»çº¢ç‚¹ï¼Œ positionä¸ºtabä½ç½® hideMsg(int position) éšè—æœªè¯»æ¶ˆæ¯ï¼Œ positionä¸ºtabä½ç½® setMsgMargin(int position, float leftPadding, float bottomPadding) è®¾ç½®æœªè¯»æ¶ˆæ¯åç§»,åŸç‚¹ä¸ºæ–‡å­—çš„å³ä¸Šè§’.å½“æ§ä»¶é«˜åº¦å›ºå®š,æ¶ˆæ¯æç¤ºä½ç½®æ˜“æ§åˆ¶,æ˜¾ç¤ºæ•ˆæœä½³ getMsgView(int position) å½“å‰ç±»åªæä¾›äº†å°‘è®¸è®¾ç½®æœªè¯»æ¶ˆæ¯å±æ€§çš„æ–¹æ³•,å¯ä»¥é€šè¿‡è¯¥æ–¹æ³•è·å–MsgViewå¯¹è±¡ä»è€Œå„ç§è®¾ç½® 2. CommonTabLayout2.1 ç‰¹æœ‰å±æ€§ ç‰¹æœ‰å±æ€§ æ ¼å¼ æè¿° tl_indicator_width dimension è®¾ç½®æ˜¾ç¤ºå™¨å›ºå®šå®½åº¦ tl_indicator_gravity enum è®¾ç½®æ˜¾ç¤ºå™¨ä¸Šæ–¹(TOP)è¿˜æ˜¯ä¸‹æ–¹(BOTTOM),åªå¯¹å¸¸è§„æ˜¾ç¤ºå™¨æœ‰ç”¨ tl_indicator_style enum è®¾ç½®æ˜¾ç¤ºå™¨ä¸ºå¸¸è§„(NORMAL)æˆ–ä¸‰è§’å½¢(TRIANGLE)æˆ–èƒŒæ™¯è‰²å—(BLOCK) tl_indicator_anim_enable boolean è®¾ç½®æ˜¾ç¤ºå™¨æ”¯æŒåŠ¨ç”»(only for CommonTabLayout) tl_indicator_anim_duration integer è®¾ç½®æ˜¾ç¤ºå™¨åŠ¨ç”»æ—¶é—´(only for CommonTabLayout) tl_indicator_bounce_enable boolean è®¾ç½®æ˜¾ç¤ºå™¨æ”¯æŒåŠ¨ç”»å›å¼¹æ•ˆæœ(only for CommonTabLayout) tl_underline_color color è®¾ç½®ä¸‹åˆ’çº¿é¢œè‰² tl_underline_height dimension è®¾ç½®ä¸‹åˆ’çº¿é«˜åº¦ tl_underline_gravity enum è®¾ç½®ä¸‹åˆ’çº¿ä¸Šæ–¹(TOP)è¿˜æ˜¯ä¸‹æ–¹(BOTTOM) tl_iconWidth dimension è®¾ç½®iconå®½åº¦(ä»…æ”¯æŒCommonTabLayout) tl_iconHeight dimension è®¾ç½®iconé«˜åº¦(ä»…æ”¯æŒCommonTabLayout) tl_iconVisible boolean è®¾ç½®iconæ˜¯å¦å¯è§(ä»…æ”¯æŒCommonTabLayout) tl_iconGravity enum è®¾ç½®iconæ˜¾ç¤ºä½ç½®,å¯¹åº”Gravityä¸­å¸¸é‡å€¼,å·¦ä¸Šå³ä¸‹(ä»…æ”¯æŒCommonTabLayout)ï¼ŒLEFTï¼ŒRIGHTï¼ŒTOPï¼ŒBOTTOM tl_iconMargin dimension è®¾ç½®iconä¸æ–‡å­—é—´è·(ä»…æ”¯æŒCommonTabLayout) 2.2 åŒºåˆ«äºSlidingTabLayout ä¸ä¾èµ–äºViewPagerï¼Œå¯ä»¥ä¸å…¶ä»–ç»„ä»¶æ­é… æ”¯æŒè‡ªå®šä¹‰Tabæ ·å¼ï¼Œä¸»è¦ä½“ç°åœ¨å¸¸ç”¨çš„å›¾æ ‡+æ–‡å­—çš„å½¢å¼ã€‚ SlidingTabLayoutç»§æ‰¿HorizontalScrollViewè€ŒCommonTabLayoutç»§æ‰¿FrameLayout 2.3 ç±»ç»“æ„2.3.1 æ„é€ æ–¹æ³•ä¸SlidingTabLayoutå®ç°ç±»ä¼¼ï¼Œè·å–çš„å±æ€§å€¼ä¸å¤ªä¸€æ ·è€Œå·²ã€‚å¤šå‡ºä¸€ä¸ªåŠ¨ç”»çš„å†…å®¹ï¼Œç‚¹å‡»æŸä¸€ä¸ªTabåï¼Œindicatorçš„ç§»åŠ¨åŠ¨ç”»æ•ˆæœ 12mValueAnimator = ValueAnimator.ofObject(new PointEvaluator(), mLastP, mCurrentP);mValueAnimator.addUpdateListener(this); 2.3.2 åŠ¨ç”»ç›¸å…³12345678910111213141516171819class IndicatorPoint { public float left; public float right;}private IndicatorPoint mCurrentP = new IndicatorPoint();private IndicatorPoint mLastP = new IndicatorPoint();class PointEvaluator implements TypeEvaluator&lt;IndicatorPoint&gt; { @Override public IndicatorPoint evaluate(float fraction, IndicatorPoint startValue, IndicatorPoint endValue) { float left = startValue.left + fraction * (endValue.left - startValue.left); float right = startValue.right + fraction * (endValue.right - startValue.right); IndicatorPoint point = new IndicatorPoint(); point.left = left; point.right = right; return point; }} 1234567891011121314151617@Overridepublic void onAnimationUpdate(ValueAnimator animation) { View currentTabView = mTabsContainer.getChildAt(this.mCurrentTab); IndicatorPoint p = (IndicatorPoint) animation.getAnimatedValue(); mIndicatorRect.left = (int) p.left; mIndicatorRect.right = (int) p.right; if (mIndicatorWidth &lt; 0) { //indicatorWidthå°äº0æ—¶,åŸjpardogo's PagerSlidingTabStrip } else {//indicatorWidthå¤§äº0æ—¶,åœ†è§’çŸ©å½¢ä»¥åŠä¸‰è§’å½¢ float indicatorLeft = p.left + (currentTabView.getWidth() - mIndicatorWidth) / 2; mIndicatorRect.left = (int) indicatorLeft; mIndicatorRect.right = (int) (mIndicatorRect.left + mIndicatorWidth); } invalidate();} 2.3.3 Tabç›¸å…³ æ–¹æ³• æè¿° setTabData(ArrayList&lt; CustomTabEntity&gt; tabEntitys) è®¾ç½®tab entity setTabData(ArrayList&lt; CustomTabEntity&gt; tabEntitys, FragmentActivity fa, int containerViewId, ArrayList&lt; Fragment&gt; fragments) å…³è”æ•°æ®æ”¯æŒåŒæ—¶åˆ‡æ¢fragments notifyDataSetChanged() æ›´æ–°æ•°æ® setCurrentTab(int currentTab) è®¾ç½®å½“å‰tab 1234567891011public void setTabData(ArrayList&lt;CustomTabEntity&gt; tabEntitys) { if (tabEntitys == null || tabEntitys.size() == 0) { throw new IllegalStateException(\"TabEntitys can not be NULL or EMPTY !\"); } this.mTabEntitys.clear(); /*è®¾ç½®tabæ ‡ç­¾*/ this.mTabEntitys.addAll(tabEntitys); /*æ›´æ–°æ•°æ®*/ notifyDataSetChanged();} 12345678910111213141516171819202122232425/** æ›´æ–°æ•°æ® */public void notifyDataSetChanged() { /*æ¸…ç©ºå®¹å™¨ä¸­çš„tab*/ mTabsContainer.removeAllViews(); this.mTabCount = mTabEntitys.size(); View tabView; /*æ ¹æ®å›¾æ ‡çš„gravityæ„å»ºä¸åŒçš„tabæ ·å¼ï¼Œå›¾æ ‡æ”¯æŒä¸Šä¸‹å·¦å³*/ for (int i = 0; i &lt; mTabCount; i++) { if (mIconGravity == Gravity.LEFT) { tabView = View.inflate(mContext, R.layout.layout_tab_left, null); } else if (mIconGravity == Gravity.RIGHT) { tabView = View.inflate(mContext, R.layout.layout_tab_right, null); } else if (mIconGravity == Gravity.BOTTOM) { tabView = View.inflate(mContext, R.layout.layout_tab_bottom, null); } else { tabView = View.inflate(mContext, R.layout.layout_tab_top, null); } /*iæ·»åŠ åˆ°tag,ä½†ä»è¿™ä¸ªç±»çš„æ–¹æ³•ä¸Šçœ‹ï¼Œè¿™ä¸€æ­¥æ²¡æœ‰ä»€ä¹ˆå¿…è¦ï¼Œå› ä¸ºaddTabä¼šä¼ å…¥i,addTabä¸­ç›´æ¥ä½¿ç”¨iå°±å¥½ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨å¤–éƒ¨æ‹¿åˆ°tabView,å°±å¯ä»¥ç›´æ¥æŒ‡å¯¼å®ƒçš„position,ä¸ç”¨å¾ªç¯éå†ï¼Œè¿˜æ˜¯æŒºæ–¹ä¾¿çš„*/ tabView.setTag(i); /*æ·»åŠ tab*/ addTab(i, tabView); } /*æ ¹æ®é€‰ä¸­æœªé€‰ä¸­çŠ¶æ€æ›´æ–°tabæ˜¾ç¤ºæ•ˆæœ*/ updateTabStyles();} 123456789101112131415161718192021222324252627282930313233343536373839/** åˆ›å»ºå¹¶æ·»åŠ tab */private void addTab(final int position, View tabView) { /*è®¾ç½®æ–‡æœ¬å†…å®¹ï¼Œtitle*/ TextView tv_tab_title = (TextView) tabView.findViewById(R.id.tv_tab_title); tv_tab_title.setText(mTabEntitys.get(position).getTabTitle()); /*è®¾ç½®å›¾æ ‡å†…å®¹ï¼Œæ·»åŠ æœªé€‰ä¸­å†…å®¹ï¼Œåé¢æ ¹æ®é€‰ä¸­æœªé€‰ä¸­é‡æ–°åˆ·ä¸€æ¬¡å›¾ç‰‡*/ ImageView iv_tab_icon = (ImageView) tabView.findViewById(R.id.iv_tab_icon); iv_tab_icon.setImageResource(mTabEntitys.get(position).getTabUnselectedIcon()); /*è®¾ç½®tabViewçš„ç‚¹å‡»äº‹ä»¶*/ tabView.setOnClickListener(new OnClickListener() { @Override public void onClick(View v) { /*å‰é¢è®¾ç½®çš„tab,ä¹Ÿå°±æ˜¯position*/ int position = (Integer) v.getTag(); if (mCurrentTab != position) { /*è®¾ç½®å½“å‰tab*/ setCurrentTab(position); //æœ‰OnTabSelectListeneråˆ™æ‰§è¡Œå¯¹åº”çš„å¤„ç† if (mListener != null) { mListener.onTabSelect(position); } } else { if (mListener != null) { mListener.onTabReselect(position); } } } }); /** æ¯ä¸€ä¸ªTabçš„å¸ƒå±€å‚æ•° ï¼Œæ ¹æ®æ˜¯å¦å‡åˆ†è®¾ç½®ä¸åŒçš„å¸ƒå±€ï¼Œè‹¥å®½åº¦ä¸ä¸º0ï¼Œåˆ™è®¾ç½®å®½åº¦*/ LinearLayout.LayoutParams lp_tab = mTabSpaceEqual ? new LinearLayout.LayoutParams(0, LayoutParams.MATCH_PARENT, 1.0f) : new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT); if (mTabWidth &gt; 0) { lp_tab = new LinearLayout.LayoutParams((int) mTabWidth, LayoutParams.MATCH_PARENT); } mTabsContainer.addView(tabView, position, lp_tab);} 12345678910111213141516171819202122232425262728293031323334353637383940414243/*å’ŒSlidingTabLayoutç›¸ä¼¼ï¼Œå¤šäº†ä¸€ä¸ªå›¾æ ‡çš„å¤„ç†*/private void updateTabStyles() { for (int i = 0; i &lt; mTabCount; i++) { View tabView = mTabsContainer.getChildAt(i); tabView.setPadding((int) mTabPadding, 0, (int) mTabPadding, 0); TextView tv_tab_title = (TextView) tabView.findViewById(R.id.tv_tab_title); tv_tab_title.setTextColor(i == mCurrentTab ? mTextSelectColor : mTextUnselectColor); tv_tab_title.setTextSize(TypedValue.COMPLEX_UNIT_PX, mTextsize);// tv_tab_title.setPadding((int) mTabPadding, 0, (int) mTabPadding, 0); if (mTextAllCaps) { tv_tab_title.setText(tv_tab_title.getText().toString().toUpperCase()); } if (mTextBold == TEXT_BOLD_BOTH) { tv_tab_title.getPaint().setFakeBoldText(true); } else if (mTextBold == TEXT_BOLD_NONE) { tv_tab_title.getPaint().setFakeBoldText(false); } ImageView iv_tab_icon = (ImageView) tabView.findViewById(R.id.iv_tab_icon); if (mIconVisible) { iv_tab_icon.setVisibility(View.VISIBLE); CustomTabEntity tabEntity = mTabEntitys.get(i); iv_tab_icon.setImageResource(i == mCurrentTab ? tabEntity.getTabSelectedIcon() : tabEntity.getTabUnselectedIcon()); LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams( mIconWidth &lt;= 0 ? LinearLayout.LayoutParams.WRAP_CONTENT : (int) mIconWidth, mIconHeight &lt;= 0 ? LinearLayout.LayoutParams.WRAP_CONTENT : (int) mIconHeight); if (mIconGravity == Gravity.LEFT) { lp.rightMargin = (int) mIconMargin; } else if (mIconGravity == Gravity.RIGHT) { lp.leftMargin = (int) mIconMargin; } else if (mIconGravity == Gravity.BOTTOM) { lp.topMargin = (int) mIconMargin; } else { lp.bottomMargin = (int) mIconMargin; } iv_tab_icon.setLayoutParams(lp); } else { iv_tab_icon.setVisibility(View.GONE); } }} å¦å¤–ä¸€ä¸ªsetTabData 123456/** å…³è”æ•°æ®æ”¯æŒåŒæ—¶åˆ‡æ¢fragments */public void setTabData(ArrayList&lt;CustomTabEntity&gt; tabEntitys, FragmentActivity fa, int containerViewId, ArrayList&lt;Fragment&gt; fragments) { /*æ‹¿åˆ°ä¸€ä¸ªmFragmentChangeManager ï¼Œåé¢setCurrentTabçš„æ—¶å€™ ï¼Œå¦‚æœè¿™ä¸ªå€¼ä¸ä¸ºç©ºï¼Œæ ¹æ®è¿™ä¸ªæ¥åˆ‡æ¢fragment,å®ç°ä¸€ç§ç±»ä¼¼FragmentPagerAdapterçš„æ•ˆæœ*/ mFragmentChangeManager = new FragmentChangeManager(fa.getSupportFragmentManager(), containerViewId, fragments); setTabData(tabEntitys);} 12345678910111213141516public void setCurrentTab(int currentTab) { mLastTab = this.mCurrentTab; this.mCurrentTab = currentTab; /*éå†æ›´æ–°tabé€‰ä¸­æœªé€‰ä¸­çŠ¶æ€*/ updateTabSelection(currentTab); /*å¦‚æœmFragmentChangeManager ä¸ä¸ºç©ºï¼Œå°±æ ¹æ®å½“å‰é€‰ä¸­çš„tabæ˜¾ç¤ºå¯¹åº”çš„Fragment*/ if (mFragmentChangeManager != null) { mFragmentChangeManager.setFragments(currentTab); } /*indicatoråŠ¨ç”»æ•ˆæœï¼Œè®¡ç®—åé‡ç»˜*/ if (mIndicatorAnimEnable) { calcOffset(); } else { invalidate(); }} 2.3.4 FragmentChangeManager 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class FragmentChangeManager { private FragmentManager mFragmentManager; private int mContainerViewId; /** Fragmentåˆ‡æ¢æ•°ç»„ */ private ArrayList&lt;Fragment&gt; mFragments; /** å½“å‰é€‰ä¸­çš„Tab */ private int mCurrentTab; /*æ„é€ æ–¹æ³•ï¼ŒsetTabDataçš„æ—¶å€™çœ‹åˆ°è¿‡*/ public FragmentChangeManager(FragmentManager fm, int containerViewId, ArrayList&lt;Fragment&gt; fragments) { this.mFragmentManager = fm; this.mContainerViewId = containerViewId; this.mFragments = fragments; initFragments(); } /** åˆå§‹åŒ–fragments */ private void initFragments() { for (Fragment fragment : mFragments) { mFragmentManager.beginTransaction().add(mContainerViewId, fragment).hide(fragment).commit(); } setFragments(0); } /** ç•Œé¢åˆ‡æ¢æ§åˆ¶,CommonTabLayoutä¸­çš„setCurrentTabæ–¹æ³•å¯ä»¥æ§åˆ¶*/ public void setFragments(int index) { for (int i = 0; i &lt; mFragments.size(); i++) { FragmentTransaction ft = mFragmentManager.beginTransaction(); Fragment fragment = mFragments.get(i); if (i == index) { ft.show(fragment); } else { ft.hide(fragment); } ft.commit(); } mCurrentTab = index; } public int getCurrentTab() { return mCurrentTab; } public Fragment getCurrentFragment() { return mFragments.get(mCurrentTab); }} 2.3.5 Getter,Setterä»¥åŠMsgViewå…ˆå…³Getterå’ŒSetteræ–¹æ³•æ˜¯å±æ€§å€¼çš„è·å–å’Œè®¾ç½®ï¼ŒMsgViewç›¸å…³æ–¹æ³•å’ŒSlidingTabLayoutæ¯”è¾ƒç›¸ä¼¼ã€‚ 3. SegmentTabLayout3.1 ç‰¹æœ‰å±æ€§ ç‰¹æœ‰å±æ€§ æ ¼å¼ æè¿° tl_indicator_anim_enable boolean è®¾ç½®æ˜¾ç¤ºå™¨æ”¯æŒåŠ¨ç”» tl_indicator_anim_duration integer è®¾ç½®æ˜¾ç¤ºå™¨åŠ¨ç”»æ—¶é—´ tl_indicator_bounce_enable boolean è®¾ç½®æ˜¾ç¤ºå™¨æ”¯æŒåŠ¨ç”»å›å¼¹æ•ˆæœ tl_bar_color color è®¾ç½®æ•´ä½“é¢œè‰² tl_bar_stroke_color color è®¾ç½®è¾¹æ¡†é¢œè‰² tl_bar_stroke_width dimension è®¾ç½®è¾¹æ¡†ç²—ç»† 3.2 åŒºåˆ«äºCommonTabLayout ä¸æ”¯æŒå›¾æ ‡ï¼Œä½†æ˜¯å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„CommonTabLayout. 3.3 ç±»ç»“æ„æ•´ä½“æ¥è¯´ï¼Œå†…å®¹åŸºæœ¬ä¸Šå’ŒCommonTabLayoutï¼Œåªæ˜¯å°‘äº†Iconçš„å¯¹åº”å¤„ç†ï¼Œå¤šå‡ºçš„æ˜¯Segmentæ ·å¼çš„å¤„ç†ã€‚ 4. MsgView4.1 è‡ªå®šä¹‰å±æ€§ å±æ€§å€¼ æ ¼å¼ æè¿° mv_backgroundColor color åœ†è§’çŸ©å½¢èƒŒæ™¯è‰² mv_cornerRadius dimension åœ†è§’å¼§åº¦,å•ä½dp mv_strokeWidth dimension è¾¹æ¡†ç²—ç»†ï¼Œå•ä½dp mv_strokeColor color åœ†è§’è¾¹æ¡†é¢œè‰² mv_isRadiusHalfHeight boolean åœ†è§’å¼§åº¦æ˜¯é«˜åº¦ä¸€åŠ mv_isWidthHeightEqual boolean åœ†è§’çŸ©å½¢å®½é«˜ç›¸ç­‰,å–è¾ƒå®½é«˜ä¸­å¤§å€¼ 4.2 ç±»ç»“æ„ é¡¹ç›®ä½¿ç”¨ä¸ªäººé¡¹ç›®Gank.io Android å®¢æˆ·ç«¯ä¸­ä½¿ç”¨æ•ˆæœ,åº•éƒ¨ä½¿ç”¨çš„CommonTabLayoutï¼Œé¡¶éƒ¨ä½¿ç”¨çš„æ˜¯SlidingTabLayoutã€‚æ•´ä½“è€Œè¨€ï¼Œæ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒFlycoTabLayoutè¿˜æ˜¯å¾ˆå®ç”¨çš„ã€‚","link":"/2017/04/19/ã€ŠAndroid å¼€æºåº“ã€‹ FlycoTabLayout ä»å¤´åˆ°è„š/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 2","text":"7. å¡«å……æ•°æ®è¿™ä¸€ç« èŠ‚å°†è®²è§£ç»™å„å¼å„æ ·çš„å›¾è¡¨è®¾ç½®æ•°æ®çš„æ–¹æ³•ã€‚ 7.1 LineChartï¼ˆçº¿å½¢å›¾ï¼‰æƒ³ç»™å›¾è¡¨æ·»åŠ æ•°æ®ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š 1public void setData(ChartData data) { ... } åŸºç±»ChartDataå›Šæ‹¬æ‰€æœ‰å›¾è¡¨åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚é’ˆå¯¹ä¸åŒçš„å›¾è¡¨ï¼Œæœ‰ä¸åŒçš„ChartDataçš„å­ç±»æ¥ä¸ºå¯¹åº”çš„å›¾è¡¨è®¾ç½®æ•°æ®ï¼Œä¾‹å¦‚é’ˆå¯¹LineChartï¼Œä½ å¯ä»¥ä½¿ç”¨LineDataã€‚åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œä½ å¯ä»¥ä¼ é€’List&lt;? extends IDataSet&gt;ä½œä¸ºè¦æ˜¾ç¤ºçš„å€¼ã€‚ä»ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä½•ä½¿ç”¨LineDataç»™LineChartè®¾ç½®æ•°æ®ï¼š 12345/** List constructor */public LineData(List&lt;ILineDataSet&gt; sets) { ... }/** Constructor with one or multiple ILineDataSet objects */public LineData(ILineDataSet...) { ... } é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯DataSet?ä¸ºä»€ä¹ˆä½ éœ€è¦ä½¿ç”¨åˆ°å®ƒå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ã€‚ä¸€ä¸ªDataSetä»£è¡¨åœ¨å›¾è¡¨ä¸­æ˜¾ç¤ºçš„ä¸€ç»„æ•°æ®æ¡ç›®ã€‚å®ƒçš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†å°†åŒä¸€ä¸ªå›¾è¡¨ä¸­çš„ä¸åŒç»„æ•°æ®åœ¨é€»è¾‘ä¸Šåˆ†ç¦»å¼€ï¼Œè¿™æ ·å­çœ‹ä¸Šå»æ›´æ¸…æ™°ã€‚é’ˆå¯¹ä¸åŒçš„å›¾è¡¨ï¼Œå­˜åœ¨ä¸åŒçš„DataSetçš„å­ç±»ï¼ˆä¾‹å¦‚ï¼ŒLineDataSetï¼‰ï¼Œå®ƒä»¬éƒ½æœ‰ç€è‡ªå·±çš„æ ·å¼ã€‚ æ¯”å¦‚è¯´ï¼Œä½ æƒ³åœ¨ä¸€ä¸ªçº¿å½¢å›¾ä¸­å±•ç¤ºä¸¤å®¶å…¬å¸ä¸€å¹´ä¸­å››ä¸ªå­£åº¦çš„æ”¶å…¥ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®åˆ›å»ºä¸¤ä¸ªä¸åŒçš„LineDataSetï¼ˆå¯¹åº”ä¸¤ä¸ªå…¬å¸ï¼‰ï¼Œæ¯ä¸ªLineDataSetåŒ…å«å››ä¸ªå­£åº¦çš„å€¼ï¼ˆä¸€å¹´å››ä¸ªå­£åº¦ï¼‰ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªLineDataSetï¼Œç„¶ååŒ…å«ä¸¤ä¸ªå…¬å¸8ä¸ªå­£åº¦çš„å€¼ã€‚ é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºLineDataSet: 1public LineDataSet(List&lt;Entry&gt; entries, String label) { ... } ä»æ„é€ æ–¹æ³•å¯ä»¥çœ‹å‡ºï¼ŒLineDataSetåˆ›å»ºçš„æ—¶å€™éœ€è¦ä¸€ä¸ªList&lt; Entry&gt;å’Œä¸€ä¸ªç”¨äºæè¿°LineDataSetçš„Stringï¼Œè¿™ä¸ªStringä¹Ÿæ˜¯åœ¨å›¾ä¾‹ä¸Šæ˜¾ç¤ºçš„æ ‡ç­¾ã€‚ æ­¤å¤–ï¼Œæ­¤æ ‡ç­¾å¯ç”¨äºåœ¨åŒ…å«å…¶ä»–LineDataSetçš„LineDataå¯¹è±¡ä¸­æŸ¥æ‰¾è¯¥LineDataSetã€‚ Entryåˆ—è¡¨åŒ…å«å›¾è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ã€‚ä¸€ä¸ªEntryå¯¹è±¡ï¼Œå®é™…ä¸Šå°±æ˜¯å¯¹ä¸€ä¸ªå«æœ‰Xå€¼å’ŒYå€¼å¾—æ•°æ®æ¡ç›®çš„å°è£…ã€‚ 1public Entry(float x, float y) { ... } ç»¼ä¸Šï¼ˆä¸¤å®¶å…¬å¸ä¸€å¹´å†…å­£åº¦æ”¶å…¥çš„ä¾‹å­ï¼‰ï¼šé¦–å…ˆï¼Œåˆ›å»º List&lt; Entry&gt;æ¥å­˜æ”¾æ•°æ®å€¼ï¼š 12List&lt;Entry&gt; valsComp1 = new ArrayList&lt;Entry&gt;();List&lt;Entry&gt; valsComp2 = new ArrayList&lt;Entry&gt;(); ç„¶åï¼Œä½¿ç”¨Entryå¯¹è±¡å¡«å†™åˆ—è¡¨ã€‚ ç¡®ä¿æ¡ç›®å¯¹è±¡åŒ…å«xè½´çš„æ­£ç¡®ç´¢å¼•ã€‚ ï¼ˆå½“ç„¶ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¾ªç¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ªç¯çš„è®¡æ•°å™¨å˜é‡å¯ä»¥æ˜¯xè½´ä¸Šçš„ç´¢å¼•ï¼‰ã€‚ 1234567891011Entry c1e1 = new Entry(0f, 100000f); // 0 == quarter 1valsComp1.add(c1e1);Entry c1e2 = new Entry(1f, 140000f); // 1 == quarter 2 ...valsComp1.add(c1e2);// and so on ...Entry c2e1 = new Entry(0f, 130000f); // 0 == quarter 1valsComp2.add(c2e1);Entry c2e2 = new Entry(1f, 115000f); // 1 == quarter 2 ...valsComp2.add(c2e2);//... List&lt; Entry&gt;æå®šä¹‹åï¼Œåˆ›å»ºLineDataSetå¯¹è±¡ï¼š 1234LineDataSet setComp1 = new LineDataSet(valsComp1, &quot;Company 1&quot;);setComp1.setAxisDependency(AxisDependency.LEFT);LineDataSet setComp2 = new LineDataSet(valsComp2, &quot;Company 2&quot;);setComp2.setAxisDependency(AxisDependency.LEFT); é€šè¿‡è°ƒç”¨setAxisDependencyï¼ˆâ€¦ï¼‰ï¼ŒæŒ‡å®šDataSetå¯¹åº”çš„è½´ã€‚ æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªIDataSetsåˆ—è¡¨å¹¶æ„å»ºChartDataå¯¹è±¡ï¼š 12345678// use the interface ILineDataSetList&lt;ILineDataSet&gt; dataSets = new ArrayList&lt;ILineDataSet&gt;();dataSets.add(setComp1);dataSets.add(setComp2);LineData data = new LineData(dataSets);mLineChart.setData(data);mLineChart.invalidate(); // refresh åœ¨è°ƒç”¨invalidate()ä¹‹åï¼Œå›¾è¡¨å°†ä¼šåˆ·æ–°ï¼Œæˆ‘ä»¬æä¾›çš„æ•°æ®å°†ä¼šè¢«ç»˜åˆ¶å‡ºæ¥ã€‚ å¦‚æœæˆ‘ä»¬è¦ä¸ºxè½´æ·»åŠ æ›´å¤šçš„æè¿°æ€§å€¼ï¼ˆè€Œä¸æ˜¯ä¸åŒå­£åº¦çš„0åˆ°3çš„æ•°å­—ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨IAxisValueFormatteræ¥å£æ¥å®ç°ã€‚ æ­¤æ¥å£å…è®¸åœ¨XAxisä¸Šç»˜åˆ¶çš„å€¼è‡ªå®šä¹‰æ ·å¼ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ ¼å¼åŒ–ç¨‹åºå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112131415161718// the labels that should be drawn on the XAxisfinal String[] quarters = new String[] { &quot;Q1&quot;, &quot;Q2&quot;, &quot;Q3&quot;, &quot;Q4&quot; };IAxisValueFormatter formatter = new IAxisValueFormatter() { @Override public String getFormattedValue(float value, AxisBase axis) { return quarters[(int) value]; } // we don&apos;t draw numbers, so no decimal digits needed @Override public int getDecimalDigits() { return 0; }};XAxis xAxis = mLineChart.getXAxis();xAxis.setGranularity(1f); // minimum axis-step (interval) is 1xAxis.setValueFormatter(formatter); å…³äºIAxisValueFormatter æ¥å£çš„æ›´å¤šä½¿ç”¨æ–¹æ³•ï¼Œè¯·æŸ¥é˜…IAxisValueFormatter ä¸Šé¢ç¤ºä¾‹çš„è¿è¡Œç»“æœå¤§è‡´å¦‚ä¸‹ ç»™BarChartï¼ŒScatterChartï¼ŒBubbleChartå’ŒCandleStickChartè®¾ç½®æ•°æ®çš„æ–¹æ³•ç±»ä¼¼äºLineChartã€‚ ä¸€ä¸ªç‰¹æ®Šæƒ…å†µæ˜¯é’ˆå¯¹å¤šç»„æ•°æ®çš„BarChartï¼Œè¿™ä¸ªåé¢ä¼šè¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚ 7.1.1 æ•°æ®é¡ºåºè¯·æ³¨æ„ï¼Œæœ¬å¼€æºåº“ä¸æ”¯æŒXè½´éå‡åºçš„Entryç»„æˆçš„LineDataSetçš„ç»˜åˆ¶ã€‚ä»¥æœªæ’åºçš„æ–¹å¼æ·»åŠ æ¡ç›®å¯èƒ½ä¼šå¯¼è‡´æ­£ç¡®çš„ç»˜åˆ¶ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´æ„å¤–çš„ç»“æœã€‚ Entryå¯¹è±¡åˆ—è¡¨å¯ä»¥æ‰‹åŠ¨æ’åºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨EntryXComparatorï¼š 12List&lt;Entry&gt; entries = ...;Collections.sort(entries, new EntryXComparator()); å› ä¸ºæœ¬åº“ä½¿ç”¨äº†äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œæ‰€ä»¥åªèƒ½åœ¨æ’å¥½åºåçš„åˆ—è¡¨æ•°æ®ä¸Šå·¥ä½œã€‚ 7.2 BarChart(æŸ±å½¢å›¾)BarChartä¸Šè®¾ç½®æ•°æ®çš„æ–¹å¼å’ŒLineChartå¾ˆç›¸ä¼¼ã€‚ä¸»è¦çš„å·®åˆ«æ˜¯ç”¨äºè®¾ç½®çš„æ•°æ®å¯¹è±¡ä»Entryå˜æˆäº†BarEntryã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒBarChartè¿˜æ”¯æŒæ›´å¤šçš„æ ·å¼ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç»™BarChartå¡«å……æ•°æ®çš„ä¾‹å­ï¼š 12345678910List&lt;BarEntry&gt; entries = new ArrayList&lt;&gt;();entries.add(new BarEntry(0f, 30f));entries.add(new BarEntry(1f, 80f));entries.add(new BarEntry(2f, 60f));entries.add(new BarEntry(3f, 50f)); // gap of 2fentries.add(new BarEntry(5f, 70f));entries.add(new BarEntry(6f, 60f));BarDataSet set = new BarDataSet(entries, &quot;BarDataSet&quot;); åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œåˆ›å»ºäº†äº”ä¸ªBarEntryå¯¹è±¡å¹¶å°†å…¶æ·»åŠ åˆ°BarDataSetä¸­ã€‚ è¯·æ³¨æ„ï¼Œåœ¨ç¬¬å››ä¸ªåˆ°ç¬¬äº”ä¸ªæ¡ç›®ä¹‹é—´çš„xä½ç½®ä¸Šå­˜åœ¨â€œ2â€çš„å·®è·ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ªå·®è·ç”¨äºè§£é‡ŠBarChartä¸­éå¸¸ä¸é”™çš„å®šä½æ–¹å¼ã€‚ æœ¬æ•™ç¨‹æœ«å°¾çš„æˆªå›¾å°†æ˜¾ç¤ºç»™å®šæ•°æ®çš„ç»“æœBarChartï¼Œåé¢ä¼šçœ‹åˆ°ã€‚ ç„¶åä¸‹ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ªBarDataå¯¹è±¡ï¼š 12345BarData data = new BarData(set);data.setBarWidth(0.9f); // set custom bar widthchart.setData(data);chart.setFitBars(true); // make the x-axis fit exactly all barschart.invalidate(); // refresh åœ¨ä¸Šè¿°ä»£ç ç‰‡æ®µä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªBarDataå¯¹è±¡ã€‚ å½“åˆ›å»ºå›¾è¡¨çš„BarEntryå¯¹è±¡æ—¶ï¼Œæ¯ä¸ªæŸ±å½¢ä¹‹é—´çš„é—´éš”æ˜¯1f(ä»¥ä¸­å¿ƒä¸ºèµ·ç‚¹ç»ˆç‚¹)ã€‚ é€šè¿‡å°†æŸ±å½¢å®½åº¦è®¾ç½®ä¸º0.9fï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªæŸ±å½¢ä¹‹é—´æœ‰æ•ˆåœ°åˆ›å»ºä¸€ä¸ª0.1fçš„ç©ºé—´ã€‚ setFitBarsï¼ˆtrueï¼‰è°ƒç”¨ä¼šå‘Šè¯‰å›¾è¡¨è°ƒæ•´å®ƒçš„xè½´å€¼çš„èŒƒå›´ï¼Œä»¥ç²¾ç¡®åœ°é€‚åˆæ‰€æœ‰çš„æŸ±å½¢ï¼Œå¹¶ä¸”åœ¨ä¸¤è¾¹ä¸ä¼šæœ‰æŸ±å½¢æ–­å±‚ã€‚ åˆ›å»ºBarDataå¯¹è±¡åï¼Œæˆ‘ä»¬å°†å…¶è®¾ç½®åˆ°å›¾è¡¨ä¸­å¹¶è¿›è¡Œåˆ·æ–°ã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š 7.3 Grouped BarChart(åˆ†ç»„æŸ±å½¢å›¾)ä»v3.0.0ç‰ˆæœ¬å¼€å§‹ï¼ŒMPAndroidChartå¼€å§‹æ”¯æŒæ˜¾å¼åˆ†ç»„çš„æŸ±å½¢å›¾ï¼Œæˆ–è€…ç”¨æˆ·è‡ªå®šä¹‰ï¼Œè¿™ç§æƒ…å†µä¸‹ç”¨æˆ·å¯ä»¥é€šè¿‡æ”¹å˜Xåæ ‡å°†æŸ±å½¢å›¾æ”¾åœ¨å›¾è¡¨çš„ä»»ä½•ä½ç½®ã€‚æœ¬èŠ‚å°†é‡ç‚¹ä»‹ç»æ˜¾å¼åˆ†ç»„çš„BarChartï¼Œè¿™æ„å‘³ç€å¼€æºåº“ä¼šå¸®ä½ å¤„ç†æŸ±çŠ¶å›¾çš„xä½ç½®ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011121314YourData[] group1 = ...;YourData[] group2 = ...;List&lt;BarEntry&gt; entriesGroup1 = new ArrayList&lt;&gt;();List&lt;BarEntry&gt; entriesGroup2 = new ArrayList&lt;&gt;();// fill the listsfor(int i = 0; i &lt; group1.length; i++) { entriesGroup1.add(new BarEntry(i, group1.getValue())); entriesGroup2.add(new BarEntry(i, group2.getValue()));}BarDataSet set1 = new BarDataSet(entriesGroup1, &quot;Group 1&quot;);BarDataSet set2 = new BarDataSet(entriesGroup2, &quot;Group 2&quot;); è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æœ‰ä¸¤ç»„æŸ±çŠ¶å›¾ï¼Œæ¯ç»„ç”±ä¸€ä¸ªBarDataSetè¡¨ç¤ºã€‚ åœ¨æ˜¾å¼åˆ†ç»„çš„æƒ…å†µä¸‹ï¼Œæ¡ç›®çš„å®é™…xä½ç½®å¹¶ä¸é‡è¦ï¼Œå®ƒå°†ä¼šæ ¹æ®æ¡ç›®åˆ—è¡¨ä¸­BarEntryçš„ä½ç½®æ‰§è¡Œåˆ†ç»„ï¼š 12345678910float groupSpace = 0.06f;float barSpace = 0.02f; // x2 datasetfloat barWidth = 0.45f; // x2 dataset// (0.02 + 0.45) * 2 + 0.06 = 1.00 -&gt; interval per &quot;group&quot;BarData data = new BarData(set1, set2);data.setBarWidth(barWidth); // set the width of each barbarChart.setData(data);barChart.groupBars(1980f, groupSpace, barSpace); // perform the &quot;explicit&quot; groupingbarChart.invalidate(); // refresh åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼ŒBarDataSetå¯¹è±¡è¢«æ·»åŠ åˆ°BarChartã€‚ groupBarsï¼ˆâ€¦ï¼‰æ–¹æ³•æ‰§è¡Œä¸¤ä¸ªBarDataSetå¯¹è±¡çš„åˆ†ç»„ã€‚ è¯¥æ–¹æ³•é‡‡ç”¨ä»¥ä¸‹å‚æ•°ï¼š 1public void groupBars(float fromX, float groupSpace, float barSpace) { ... } fromXå‚æ•°ç¡®å®šXAxisä¸Šåˆ†ç»„æ¡ç›®å¼€å§‹çš„ä½ç½®ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ºâ€œ1980â€ï¼‰ï¼ŒgroupSpaceç¡®å®šæ¯ç»„æ¡ç›®ä¹‹é—´ç•™ä¸‹çš„ç©ºé—´ï¼ŒbarSpaceç¡®å®šç»„ä¸­å•ä¸ªæ¡ç›®ä¹‹é—´çš„ç©ºé—´ã€‚ åŸºäºè¿™äº›å‚æ•°ï¼ŒgroupBarsï¼ˆâ€¦ï¼‰æ–¹æ³•å°†XAxisä¸Šçš„æ¯ä¸ªæ çš„ä½ç½®æ›´æ”¹ä¸ºåˆ†ç»„çš„å¤–è§‚ï¼Œä¿ç•™å„ä¸ªBarEntryå¯¹è±¡çš„é¡ºåºã€‚ æ¯ä¸ªç»„åœ¨XAxisä¸Šçš„â€œé—´éš”â€ï¼ˆå ç”¨ç©ºé—´ï¼‰ä¹Ÿç”±groupSpaceã€barSpacä»¥åŠbarWidthå®šä¹‰ã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š å½“ç„¶ï¼Œåˆ†ç»„çš„BarChartä¹Ÿå¯ä»¥åœ¨ä¸ä½¿ç”¨groupBarsï¼ˆâ€¦ï¼‰æ–¹æ³•çš„æƒ…å†µä¸‹å®ç°ï¼Œåªéœ€é€šè¿‡æ‰‹åŠ¨çš„æ–¹å¼å°†å„ä¸ªæ¡ç›®ç›´æ¥å®šä½åˆ°XAxisä¸Šå³å¯ã€‚ ä¸ºäº†ç¡®ä¿XAxisçš„æ ‡ç­¾ä½äºä¸Šè¿°å±å¹•æˆªå›¾ä¸Šæ‰€ç¤ºçš„ä¸­é—´ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨setCenterAxisLabelsï¼ˆâ€¦ï¼‰æ–¹æ³•ï¼š 12XAxis xAxis = chart.getXAxis();xAxis.setCenterAxisLabels(true); 7.4 Stacked BarChart(å †ç§¯æŸ±å½¢å›¾)å †ç§¯æŸ±å½¢å›¾çš„ä½¿ç”¨æ–¹å¼å’Œæ­£å¸¸æŸ±å½¢å›¾çš„ä½¿ç”¨æ–¹å¼åŸºæœ¬ç›¸åŒã€‚æœ‰ç‚¹å·®å¼‚çš„æ˜¯BarEntryçš„åˆ›å»ºæ–¹å¼ä¸å¤ªä¸€æ ·ï¼Œåœ¨å †å æŸ±å½¢å›¾çš„ä½¿ç”¨ä¸­ï¼Œéœ€è¦ä½¿ç”¨åˆ°BarEntryçš„å¦ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼š 1public BarEntry(float x, float [] yValues) { ... } è¿™ä¸ªæ„é€ æ–¹æ³•å…è®¸ä¼ å…¥å¤šä¸ªyValuesï¼Œä»£è¡¨æ¯ä¸ªå †ç§¯çš„æŸ±å½¢å›¾çš„å€¼ã€‚ä¸‹é¢æœ‰ä¸ªä¾‹å­ï¼š 1BarEntry stackedEntry = new BarEntry(0f, new float[] { 10, 20, 30 }); è¿™ä¸ªBarEntryç”±3ä¸ªå †ç§¯çš„å€¼ç»„æˆï¼Œé«˜åº¦åˆ†åˆ«æ˜¯10,20,30 7.5 PieChart(é¥¼å›¾)ä¸å…¶ä»–å›¾è¡¨ç±»å‹ä¸åŒï¼ŒPieChartä»¥PieEntryå¯¹è±¡çš„å½¢å¼è·å–æ•°æ®ã€‚PieEntryçš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š 1public PieEntry(float value, String label) { ... } æ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºåœ¨PieChartä¸­ç»˜åˆ¶ä¸ºé¥¼å›¾çš„å®é™…â€œå€¼â€ï¼Œç¬¬äºŒä¸ªå‚æ•°â€œlabelâ€ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ç»˜åˆ¶çš„é‚£éƒ¨åˆ†é¥¼çš„æè¿°ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011List&lt;PieEntry&gt; entries = new ArrayList&lt;&gt;();entries.add(new PieEntry(18.5f, &quot;Green&quot;));entries.add(new PieEntry(26.7f, &quot;Yellow&quot;));entries.add(new PieEntry(24.0f, &quot;Red&quot;));entries.add(new PieEntry(30.8f, &quot;Blue&quot;));PieDataSet set = new PieDataSet(entries, &quot;Election Results&quot;);PieData data = new PieData(set);pieChart.setData(data);pieChart.invalidate(); // refresh PieEntryå¯¹è±¡ä¸éœ€è¦ä¿å­˜xä½ç½®çš„å€¼ï¼Œå› ä¸ºå›¾è¡¨ä¸­æ˜¾ç¤ºçš„PieEntryå¯¹è±¡çš„é¡ºåºç”±å…¶åœ¨æ¡ç›®åˆ—è¡¨ä¸­çš„é¡ºåºç¡®å®šã€‚æ·»åŠ ä¸€ä¸‹æ ·å¼è®¾ç½®ä¹‹åï¼Œä¸Šé¢çš„ä¾‹å­å°†å¾—åˆ°ä¸‹é¢çš„é¥¼å›¾ï¼š 7.6 RadarChartæš‚æ— ä»‹ç» 7.7 CombinedChartæš‚æ— ä»‹ç» 8. è®¾ç½®é¢œè‰²ä»V1.4.0ç‰ˆæœ¬å¼€å§‹ï¼Œåœ¨ä¹‹å‰ç‰ˆæœ¬ä¸Šè´Ÿè´£è®¾ç½®é¢œè‰²çš„ColorTemplate ä¸å†è¢«éœ€è¦ã€‚ä½†æ˜¯ï¼Œä¸€äº›é¢„å®šä¹‰çš„é¢œè‰²å€¼ä¾ç„¶ä¿å­˜åœ¨è¿™ä¸ªç±»ä¸­ï¼ˆä¾‹å¦‚ï¼ŒColorTemplate.VORDIPLOM_COLORSï¼‰ï¼Œå¹¶ä¸”æä¾›ä¾¿åˆ©çš„æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬å°†é¢œè‰²èµ„æºè½¬æ¢æˆçœŸæ­£çš„é¢œè‰²ã€‚é€šè¿‡ç»™DataSetç›´æ¥æŒ‡å®šé¢œè‰²æ¥ä»£æ›¿ColorTemplateï¼ŒåŒæ—¶ä½ å¯ä»¥ç»™æ¯ä¸ªDataSetåˆ†åˆ«è®¾è®¡æ ·å¼ã€‚ åœ¨ä¸‹é¢è¿™ä¸ªç®€å•çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„LineDataSetåˆ†åˆ«ä»£è¡¨ä¸¤å®¶å…¬å¸ä¸€å¹´å†…å››ä¸ªå­£åº¦çš„æ”¶å…¥ï¼Œæˆ‘ä»¬ç»™æ¯ä¸ªå…¬å¸çš„æ•°æ®åˆ†åˆ«è®¾ç½®ä¸åŒçš„é¢œè‰²ã€‚ â€œCompany 1â€ä½¿ç”¨å››ä¸­ä¸åŒçš„çº¢è‰² â€œCompany 2â€ä½¿ç”¨å››ä¸­ä¸åŒçš„ç»¿è‰² ä»£ç å¦‚ä¸‹ï¼š 123456LineDataSet setComp1 = new LineDataSet(valsComp1, &quot;Company 1&quot;); // sets colors for the dataset, resolution of the resource name to a &quot;real&quot; color is done internally setComp1.setColors(new int[] { R.color.red1, R.color.red2, R.color.red3, R.color.red4 }, Context); LineDataSet setComp2 = new LineDataSet(valsComp2, &quot;Company 2&quot;); setComp2.setColors(new int[] { R.color.green1, R.color.green2, R.color.green3, R.color.green4 }, Context); é™¤äº†ä¸Šé¢è¿™ä¸ªæ–¹æ³•å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šç»™DataSetè®¾ç½®é¢œè‰²çš„æ–¹æ³•ã€‚å…·ä½“å¦‚ä¸‹ï¼š|æ–¹æ³•|ä½œç”¨||â€”â€“|â€”â€”||setColors(int [] colors, Context c)|è®¾ç½®DataSetçš„é¢œè‰²ã€‚å½“æ•°æ®æ¡ç›®è¶…è¿‡é¢œè‰²æ•°ç»„çš„å¤§å°æ—¶ï¼Œé¢œè‰²å°†ä¼šè¢«é‡å¤ä½¿ç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨new int[] { R.color.red, R.color.green, â€¦ }æ¥ä¸ºè¿™ä¸ªæ–¹æ³•æä¾›é¢œè‰²æ•°ç»„ï¼Œå®é™…ä¸Šï¼Œå†…éƒ¨æ˜¯é€šè¿‡ getResources().getColor(â€¦)æ¥è§£æä½ ä¼ å…¥çš„å‚æ•°çš„||setColors(int [] colors)|è®¾ç½®DataSetçš„é¢œè‰²ã€‚å½“æ•°æ®æ¡ç›®è¶…è¿‡é¢œè‰²æ•°ç»„çš„å¤§å°æ—¶ï¼Œé¢œè‰²å°†ä¼šè¢«é‡å¤ä½¿ç”¨ã€‚ç¡®ä¿é¢œè‰²æ˜¯é€šè¿‡getResources().getColor(â€¦)åè·å–çš„å€¼ï¼Œä¹Ÿå°±æ˜¯é¢œè‰²çš„16è¿›åˆ¶å€¼||setColors(ArrayList&lt; Integer&gt; colors)|è®¾ç½®DataSetçš„é¢œè‰²ã€‚å½“æ•°æ®æ¡ç›®è¶…è¿‡é¢œè‰²æ•°ç»„çš„å¤§å°æ—¶ï¼Œé¢œè‰²å°†ä¼šè¢«é‡å¤ä½¿ç”¨ã€‚ç¡®ä¿é¢œè‰²æ˜¯é€šè¿‡getResources().getColor(â€¦)åè·å–çš„å€¼ï¼Œä¹Ÿå°±æ˜¯é¢œè‰²çš„16è¿›åˆ¶å€¼||setColor(int color)|ç»™DataSetè®¾ç½®ä¸€ä¸ªå”¯ä¸€çš„é¢œè‰²å€¼ã€‚å®é™…ä¸Šï¼Œå†…éƒ¨ä¹Ÿæ˜¯ä½¿ç”¨ä¸€ä¸ªæ•°ç»„ï¼Œåªæ˜¯æ•°ç»„ä¸­çš„é¢œè‰²æ˜¯ä¸€æ ·çš„è€Œå·²| ColorTemplateç¤ºä¾‹ï¼š 12LineDataSet set = new LineDataSet(...);set.setColors(ColorTemplate.VORDIPLOM_COLORS); å¦‚æœæ²¡æœ‰ç»™DataSetè®¾ç½®é¢œè‰²ï¼Œæˆ‘ä»¬å°†ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚ 9. æ ¼å¼åŒ–æ•°æ®å€¼(IValueFormatter)V1.6.2ç‰ˆæœ¬å¼•å…¥ï¼ŒV2.1.4ç‰ˆæœ¬ä¼˜åŒ– IValueFormatteræ¥å£å…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ ¼å¼åŒ–ç±»æ¥å°†å›¾è¡¨ä¸­çš„æ•°æ®æŒ‰ç…§ä¸€ç§ç‰¹å®šçš„æ–¹å¼æ ¼å¼åŒ–åå†è¿›è¡Œç»˜åˆ¶ã€‚ ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»ï¼Œå®ç°IValueFormatteræ¥å£ï¼Œç„¶ååœ¨getFormattedValue(â€¦)æ–¹æ³•ä¸­ï¼Œè¿”å›ä½ å¸Œæœ›åœ¨å›¾è¡¨ä¸­ç»˜åˆ¶çš„å†…å®¹ã€‚ 1234567891011121314public class MyValueFormatter implements IValueFormatter { private DecimalFormat mFormat; public MyValueFormatter() { mFormat = new DecimalFormat(&quot;###,###,##0.0&quot;); // use one decimal } @Override public String getFormattedValue(float value, Entry entry, int dataSetIndex, ViewPortHandler viewPortHandler) { // write your logic here return mFormat.format(value) + &quot; $&quot;; // e.g. append a dollar-sign }} ç„¶åï¼Œå°†æ ¼å¼åŒ–ç¨‹åºè®¾ç½®åˆ°ChartDataæˆ–è€…DataSetï¼š 12345// usage on whole data objectlineData.setValueFormatter(new MyValueFormatter());// usage on individual dataset objectlineDataSet.setValueFormatter(new MyValueFormatter()); 9.1 é¢„å®šä¹‰çš„Formatter Formatter ä»‹ç» LargeNumberFormatter ç”¨äºæ ¼å¼åŒ–å¤§äº1000çš„æ•°å­—ã€‚â€1.000â€-&gt;â€1kâ€, â€œ1.000.000â€-&gt;â€1mâ€ (million), â€œ1.000.000.000â€-&gt;â€1bâ€ (billion)ç­‰ç­‰ PercentFormatter ç”¨äºæ˜¾ç¤ºä¿ç•™ä¸€ä½å°æ•°çš„ç™¾åˆ†æ•°ï¼Œåœ¨é¥¼å›¾ä¸­ç”¨çš„æ¯”è¾ƒå¤šã€‚50-&gt;50.0% StackedValueFormatter ä¸ºå †ç§¯æŸ±å½¢å›¾è®¾ç½®çš„æ ¼å¼åŒ–ç¨‹åºã€‚å¯ä»¥æ˜ç¡®æŒ‡å‡ºæ˜¯éœ€è¦ç»˜åˆ¶æ‰€æœ‰çš„å †ç§¯å€¼è¿˜æ˜¯åªç»˜åˆ¶é¡¶éƒ¨å€¼ **** **** ## 10. æ ¼å¼åŒ–è½´å€¼(AxisValueFormatter) v3.0.0ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œç”¨äºæ ¼å¼åŒ–Xè½´å’ŒYè½´ä¸Šçš„æ˜¾ç¤ºå€¼ã€‚ 10.1 åˆ›å»ºFormatterè½´å€¼è‡ªå®šä¹‰æ ¼å¼åªéœ€è¦ä¸€æ­¥ï¼šåˆ›å»ºå®ç°IAxisValueFormatter æ¥å£çš„è‡ªå®šä¹‰æ ¼å¼ç±»ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™ä¸ªä¾‹å­ä¸­ï¼Œå°†è½´å€¼æ ¼å¼åŒ–ä¸º1ä¸ºå°æ•°ã€‚ 1234567891011121314151617181920public class MyYAxisValueFormatter implements IAxisValueFormatter { private DecimalFormat mFormat; public MyAxisValueFormatter() { // format values to 1 decimal digit mFormat = new DecimalFormat(&quot;###,###,##0.0&quot;); } @Override public String getFormattedValue(float value, AxisBase axis) { // &quot;value&quot; represents the position of the label on the axis (x or y) return mFormat.format(value) + &quot; $&quot;; } /** this is only needed if numbers are returned, else return 0 */ @Override public int getDecimalDigits() { return 1; }} ä¸‹é¢è¿™ä¸ªä¾‹å­å±•ç¤ºå¦‚ä½•å°†ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„å±•ç¤ºåˆ°è½´ä¸Šï¼š 123456789101112131415161718public class MyXAxisValueFormatter implements IAxisValueFormatter { private String[] mValues; public MyXAxisValueFormatter(String[] values) { this.mValues = values; } @Override public String getFormattedValue(float value, AxisBase axis) { // &quot;value&quot; represents the position of the label on the axis (x or y) return mValues[(int) value]; } /** this is only needed if numbers are returned, else return 0 */ @Override public int getDecimalDigits() { return 0; }} 10.2 è®¾ç½®Formatteråˆ›å»ºå®ŒFormatterä¹‹åï¼Œè®¾ç½®åˆ°å¯¹åº”çš„è½´ï¼š 1234567YAxis left = chart.getAxisLeft();left.setValueFormatter(new MyYAxisValueFormatter());String[] values = new String[] { ... };XAxis xAxis = chart.getXAxis();xAxis.setValueFormatter(new MyXAxisValueFormatter(values)); ç°åœ¨è½´ä¸Šå°†ç»˜åˆ¶Formatteræä¾›çš„æ•°æ®ï¼Œè€Œéé»˜è®¤çš„æ•°æ®æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ 10.3 é™åˆ¶é—´éš”å¦‚æœä½ ä½¿ç”¨åŸºäºæ•°ç»„ç´¢å¼•çš„æ ¼å¼åŒ–ç¨‹åºï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ï¼Œå°†è½´çš„æœ€å°é—´éš”é™åˆ¶ä¸ºâ€œ1â€æ˜¯æœ‰æ„ä¹‰çš„ï¼š 1axis.setGranularity(1f); // restrict interval to 1 (minimum) è¿™å°†é˜²æ­¢æ ¼å¼åŒ–ç¨‹åºç»˜åˆ¶é‡å¤çš„è½´æ ‡ç­¾ï¼ˆç”±è½´é—´éš”&lt;1ï¼‰å¼•èµ·ã€‚ åªè¦å›¾è¡¨çš„â€œç¼©æ”¾çº§åˆ«â€è¶³å¤Ÿé«˜ï¼Œå®ƒå°†åœæ­¢é‡æ–°è®¡ç®—æ›´å°çš„é—´éš”ã€‚ 10.4 é¢„å®šä¹‰Formatter Formatter ä»‹ç» LargeNumberFormatter ç”¨äºæ ¼å¼åŒ–å¤§äº1000çš„æ•°å­—ã€‚â€1.000â€-&gt;â€1kâ€, â€œ1.000.000â€-&gt;â€1mâ€ (million), â€œ1.000.000.000â€-&gt;â€1bâ€ (billion)ç­‰ç­‰ PercentFormatter ç”¨äºæ˜¾ç¤ºä¿ç•™ä¸€ä½å°æ•°çš„ç™¾åˆ†æ•°ï¼Œåœ¨é¥¼å›¾ä¸­ç”¨çš„æ¯”è¾ƒå¤šã€‚50-&gt;50.0% ***** ### 10.5 ç¤ºä¾‹Formatters DayAxisValueFormatterï¼Œè¯¥æ ¼å¼åŒ–ç¨‹åºå°†æä¾›çš„å€¼è½¬æ¢ä¸ºæ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¹æ®æ¯”ä¾‹æ”¹å˜å­—ç¬¦ä¸²ã€‚ ***** ### 10.6 ä¹‹å‰çš„Formatter åœ¨v3.0.0ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œé’ˆå¯¹Xè½´å’ŒYè½´åˆ†åˆ«å­˜åœ¨ä¸¤ä¸ªFormatter,å…·ä½“è¯·æŸ¥é˜…ï¼š XAxisValueFormatter YAxisValueFormatter 11. åŸºæœ¬è®¾ç½®/æ ·å¼æœ¬èŠ‚é‡ç‚¹ä»‹ç»é€‚ç”¨äºæœ¬åº“ä¸­æ‰€æœ‰å›¾è¡¨ç±»å‹çš„åŸºæœ¬è®¾ç½®å’Œæ ·å¼ã€‚ 11.1 åˆ·æ–° æ–¹æ³• ä½¿ç”¨ invalidate() è°ƒç”¨è¯¥æ–¹æ³•åï¼Œå›¾è¡¨å°†ä¼šè¢«åˆ·æ–°(é‡ç»˜)ï¼Œä»è€Œä½¿æˆ‘ä»¬çš„ä¿®æ”¹åœ¨å›¾è¡¨ä¸Šç”Ÿæ•ˆ notifyDataSetChanged() è®©å›¾è¡¨çŸ¥é“åº•å±‚æ•°æ®å‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦é‡æ–°è¿›è¡Œæ‰€æœ‰çš„å¿…éœ€è®¡ç®—(ä½ç§»,å›¾ä¾‹,æœ€å¤§å€¼,æœ€å°å€¼ç­‰ç­‰)ã€‚åœ¨åŠ è½½åŠ¨æ€æ•°æ®çš„æ—¶å€™è¿™ä¸ªæ˜¯å¾ˆæœ‰å¿…è¦çš„ *** ### 11.2 æ—¥å¿— æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€”- setLogEnabled(boolean enabled) è®¾ç½®ä¸ºtrue,æ‰“å¼€å›¾è¡¨çš„æ—¥å¿—è¾“å‡ºã€‚æ‰“å¼€æ—¥å¿—å¯¹æ€§èƒ½æœ‰å½±å“ï¼Œæ²¡å¿…è¦çš„è¯æœ€å¥½ä¿æŒå…³é—­ ** ### 11.3 åŸºæœ¬å›¾è¡¨æ ·å¼ ä¸‹é¢æ˜¯ä¸€äº›å’Œé£æ ¼ç›¸å…³çš„æ–¹æ³•ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å›¾è¡¨å¯¹è±¡ä¸Šä½¿ç”¨ï¼š æ–¹æ³• ä½¿ç”¨ â€”â€“ â€”â€”- setBackgroundColor(int color) è®¾ç½®æ•´ä¸ªå›¾è¡¨çš„èƒŒæ™¯é¢œè‰²ï¼Œä¹Ÿå¯ä»¥é€šè¿‡xmlæ–‡ä»¶è®¾ç½® setDescription(String desc) è®¾ç½®åœ¨å›¾è¡¨å³ä¸‹è§’æ˜¾ç¤ºçš„æè¿°æ–‡å­— setDescriptionColor(int color) è®¾ç½®æè¿°æ–‡å­—çš„é¢œè‰² setDescriptionPosition(float x, float y) è®¾ç½®æè¿°æ–‡å­—æ˜¾ç¤ºçš„ä½ç½® setDescriptionTypeface(Typeface t) è®¾ç½®æè¿°æ–‡å­—å­—ä½“ setDescriptionTextSize(float size) è®¾ç½®æè¿°æ–‡å­—çš„å­—ä½“å¤§å°ï¼ˆpxï¼‰, æœ€å°6f, æœ€å¤§16f. setNoDataText(String text) è®¾ç½®å›¾è¡¨ä¸­æ²¡æœ‰æ•°æ®æ—¶æ˜¾ç¤ºçš„æ–‡å­—. setDrawGridBackground(boolean enabled) è®¾ç½®ä¸ºtrueä¹‹åï¼Œå›¾è¡¨ç»˜åˆ¶åŒºåŸŸåé¢çš„çŸ©å½¢ä¼šè¢«ç»˜åˆ¶ setGridBackgroundColor(int color) è®¾ç½®è¦ç»˜åˆ¶çš„ç½‘æ ¼èƒŒæ™¯çš„é¢œè‰²ã€‚ setDrawBorders(boolean enabled) å¯ç”¨/ç¦ç”¨ç»˜åˆ¶å›¾è¡¨è¾¹æ¡†ï¼ˆå›¾è¡¨å‘¨å›´çš„çº¿ï¼‰. setBorderColor(int color) è®¾ç½®å›¾è¡¨è¾¹æ¡†çš„é¢œè‰² setBorderWidth(float width) è®¾ç½®å›¾è¡¨è¾¹æ¡†çº¿çš„å®½åº¦(dp) setMaxVisibleValueCount(int count) è®¾ç½®å›¾è¡¨ä¸Šæœ€å¤§å¯è§ç»˜åˆ¶å€¼æ ‡ç­¾çš„æ•°é‡ã€‚ è¿™ä»…åœ¨å¯ç”¨setDrawValuesï¼ˆï¼‰æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚ 12. ç‰¹å®šå›¾è¡¨è®¾ç½®å’Œæ ·å¼12.1 Line-, Bar-, Scatter-, Candle- &amp; BubbleChart(æ¡å½¢å›¾ï¼ŒæŸ±å½¢å›¾ï¼Œæ•£åˆ—å›¾ï¼Œèœ¡çƒ›å›¾å’Œæ°”æ³¡å›¾) æ–¹æ³• ä½¿ç”¨ setAutoScaleMinMaxEnabled(boolean enabled) æŒ‡ç¤ºæ˜¯å¦å¯ç”¨yè½´ä¸Šçš„è‡ªåŠ¨ç¼©æ”¾çš„æ ‡å¿—ã€‚ å¦‚æœå¯ç”¨ï¼Œåªè¦è§†å£æ›´æ”¹ï¼Œyè½´å°±ä¼šè‡ªåŠ¨è°ƒæ•´åˆ°å½“å‰xè½´èŒƒå›´çš„æœ€å°å’Œæœ€å¤§yå€¼ã€‚ è¿™å¯¹äºæ˜¾ç¤ºè´¢åŠ¡æ•°æ®çš„å›¾è¡¨å°¤å…¶æœ‰ç”¨ã€‚ é»˜è®¤å€¼ï¼šfalse setKeepPositionOnRotation(boolean enabled) è®¾ç½®æ–¹å‘æ›´æ”¹åå›¾è¡¨æ˜¯å¦åº”ä¿æŒå…¶ä½ç½®ï¼ˆç¼©æ”¾/æ»šåŠ¨ï¼‰ã€‚ é»˜è®¤å€¼ï¼šfalse *** ### 12.2 BarChart(æŸ±å½¢å›¾) æ–¹æ³• ä½¿ç”¨ â€”â€” â€”â€”â€”- setDrawValueAboveBar(boolean enabled) è®¾ç½®ä¸ºtrue,æ‰€æœ‰æ¡ç›®çš„å€¼å°†ä¼šç»˜åˆ¶åœ¨æ¡ç›®çš„ä¸Šæ–¹ï¼Œè€Œä¸æ˜¯é¡¶éƒ¨çš„ä¸‹é¢ setDrawBarShadow(boolean enabled) å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™åœ¨æ¯ä¸ªæ¡ä¹‹åç»˜åˆ¶ä¸€ä¸ªæŒ‡ç¤ºæœ€å¤§å€¼çš„ç°è‰²åŒºåŸŸã€‚ æ‰“å¼€è¿™ä¸ªå¼€å…³å°†ä¼šæ˜¯æ€§èƒ½ä¸‹é™40% setDrawValuesForWholeStack(boolean enabled) å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™å †å æ¡çš„æ‰€æœ‰å€¼éƒ½æ˜¯å•ç‹¬ç»˜åˆ¶çš„ï¼Œè€Œä¸ä»…ä»…æ˜¯å®ƒä»¬çš„æ€»å’Œ. setDrawHighlightArrow(boolean enabled) è®¾ç½®ä¸ºtrueåï¼Œè‹¥å–å€¼é«˜äº®ï¼Œå°†ä¼šåœ¨æ¯ä¸ªé«˜äº®çš„æ¡ç›®ä¸Šç»˜åˆ¶ä¸€ä¸ªç®­å¤´ **** ### 12.3 PieChart(é¥¼å›¾) æ–¹æ³• ä½¿ç”¨ â€”â€” â€”â€”â€”- setDrawSliceText(boolean enabled) å°†å…¶è®¾ç½®ä¸ºtrueå¯å°†xå€¼æ–‡æœ¬ç»˜åˆ¶åˆ°é¥¼å›¾åˆ‡ç‰‡ä¸­ setUsePercentValues(boolean enabled) å¦‚æœå¯ç”¨æ­¤åŠŸèƒ½ï¼Œåˆ™å›¾è¡¨ä¸­çš„å€¼å°†ä»¥ç™¾åˆ†æ¯”ç»˜åˆ¶ï¼Œè€Œä¸æ˜¯ä»¥åŸå§‹å€¼ç»˜åˆ¶ã€‚æä¾›ç»™ValueFormatterçš„å€¼å°†ä¼šä»¥ç™¾åˆ†æ¯”çš„å½¢å¼ setCenterText(SpannableString text) è®¾ç½®ç»˜åˆ¶åœ¨é¥¼å›¾ä¸­å¿ƒçš„æ–‡å­—ï¼Œè¿‡é•¿çš„æ–‡å­—ä¼šè¢«è‡ªåŠ¨å¤„ç†ä»¥å…å»¶ä¼¸åˆ°é¥¼å›¾åˆ‡ç‰‡ä¸­ã€‚ setCenterTextRadiusPercent(float percent) è®¾ç½®ä¸­å¿ƒæ–‡æœ¬è¾¹ç•Œæ¡†çš„çŸ©å½¢åŠå¾„ï¼Œä»¥é¥¼å­”é»˜è®¤å€¼çš„ç™¾åˆ†æ¯”ä¸º1.fï¼ˆ100ï¼…ï¼‰ setHoleRadius(float percent) è®¾ç½®é¥¼å›¾ä¸­å¿ƒç©ºæ´çš„åŠå¾„ï¼Œé»˜è®¤æ˜¯æ•´ä¸ªé¥¼å›¾åŠå¾„çš„ä¸€åŠä¹Ÿå°±æ˜¯50% setTransparentCircleRadius(float percent) è®¾ç½®é¥¼å›¾ä¸­å­”æ—è¾¹çš„é€æ˜åœ†çš„åŠå¾„ï¼Œæœ€å¤§åŠå¾„çš„ç™¾åˆ†æ¯”ï¼ˆmax =æ•´ä¸ªå›¾çš„åŠå¾„ï¼‰ï¼Œé»˜è®¤å€¼55ï¼… - &gt;è¡¨ç¤ºé»˜è®¤å€¼æ¯”ä¸­å¿ƒå­”å¤§5ï¼… setTransparentCircleColor(int color) è®¾ç½®é€æ˜åœ†åœˆçš„é¢œè‰² setTransparentCircleAlpha(int alpha) è®¾ç½®é€æ˜åœ†åœˆçš„é€æ˜å€¼ setMaxAngle(float maxangle) è®¾ç½®ç”¨äºè®¡ç®—é¥¼å½¢åœ†çš„æœ€å¤§è§’åº¦ã€‚ 360fæ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„PieChartï¼Œ180fç»“æœæ˜¯ä¸€ä¸ªåŠé¥¼å›¾ã€‚ é»˜è®¤å€¼ï¼š360f **** ### 12.4 RadarChart(é›·è¾¾å›¾) æ–¹æ³• ä½¿ç”¨ â€”â€” â€”â€”â€”- setSkipWebLineCount(int count) å…è®¸è·³è¿‡æ¥è‡ªå›¾è¡¨ä¸­å¿ƒçš„ç½‘é¡µçº¿ã€‚ ç‰¹åˆ«æœ‰ç”¨ï¼Œå¦‚æœæœ‰å¾ˆå¤šè¡Œã€‚","link":"/2017/06/12/ã€ŠAndroidå¼€æºåº“ã€‹ MPAndroidChart Wiki(è¯‘æ–‡)ï½Part 2/"},{"title":"ã€ŠAndroidå¼€æºåº“ã€‹Picasso","text":"1. å‰è¨€æœ€è¿‘é¡¹ç›®å¼€å‘ä¸­ä½¿ç”¨åˆ°æ¥Picassoï¼Œå¹¶ä¸”ç¢°åˆ°äº†ä¸€ä¸ªéƒ¨åˆ†å›¾ç‰‡æ— æ³•åŠ è½½çš„é—®é¢˜ï¼Œä½¿ç”¨Glideå¯ä»¥æ­£å¸¸åŠ è½½ï¼Œä½¿ç”¨æœ€æ–°çš„Picasso3.0.0-SNAPSHOTç‰ˆæœ¬ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œæœ€åä½¿ç”¨Picassoè‡ªå¸¦çš„å¼‚å¸¸ç›‘å¬è·å–å †æ ˆï¼Œå¹¶ä¸”åœ¨Githubä¸­æ‰¾åˆ°çš„åŒæ ·çš„é—®é¢˜ï¼Œå…·ä½“æŸ¥é˜…ï¼š https://github.com/square/picasso/issues/1514 æ‰€ä»¥ï¼Œæƒ³è¯¦ç»†çš„çœ‹çœ‹Picassoçš„è¯¦ç»†ç”¨æ³•å’Œmasteråˆ†æ”¯ä¸Šçš„æºä»£ç ã€‚ 2. åŸºæœ¬ä»‹ç»Picasso æ˜¯Square å…¬å¸å¼€æºçš„Android ç«¯çš„å›¾ç‰‡åŠ è½½å’Œç¼“å­˜æ¡†æ¶ã€‚å›¾ç‰‡çš„åŠ è½½æ˜¯ä¸€ä¸ªä»¤äººå¾ˆå¤´ç–¼çš„é—®é¢˜ï¼Œå› ä¸ºæ¶‰åŠçš„å†…å®¹æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ï¼Œæœ¬åœ°å­˜å‚¨ï¼Œå›¾ç‰‡ç¼“å­˜ï¼Œå›¾ç‰‡å›æ”¶ç­‰ç­‰ï¼Œå¤„ç†ä¸å¥½å¯èƒ½ä¼šå‡ºç°å›¾ç‰‡å˜å½¢å†…å­˜æ³„æ¼ç­‰ä»¤å¼€å‘è€…ç„¦å¤´çƒ‚é¢çš„é—®é¢˜ï¼Œä½†æ˜¯Picassoå¸®æˆ‘ä»¬åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚ï¼š å¤„ç†Adapter ä¸­ImageViewçš„å›æ”¶å’Œå–æ¶ˆä¸‹è½½ã€‚ ä½¿ç”¨æœ€å°çš„å†…å­˜ æ¥åšå¤æ‚çš„å›¾ç‰‡å˜æ¢ã€‚æ¯”å¦‚é«˜æ–¯æ¨¡ç³Šï¼Œåœ†è§’ã€åœ†å½¢ç­‰å¤„ç†ã€‚ è‡ªåŠ¨å¸®æˆ‘ä»¬ç¼“å­˜å›¾ç‰‡ã€‚å†…å­˜å’Œç£ç›˜ç¼“å­˜ 3. åŸºæœ¬ä½¿ç”¨ä»¥Android Studioä¸ºå¼€å‘ç¯å¢ƒï¼Œä»¥Gradleä¸ºæ„å»ºå·¥å…·ï¼Œå…¶ä»–çš„æœ¬æ–‡ä¸åšä»‹ç»ã€‚ 3.1 æ·»åŠ ä¾èµ–1compile 'com.squareup.picasso:picasso:2.5.2' 3.2 æ··æ·†1-dontwarn com.squareup.okhttp.** 3.3 åŠ è½½å›¾ç‰‡1234567891011/* ç½‘ç»œå›¾ç‰‡ */Picasso.with(context).load(\"http://i.imgur.com/DvpvklR.png\").into(imageView);/* å›¾ç‰‡èµ„æº */Picasso.with(context).load(R.drawable.landing_screen).into(imageView1);/* æœ¬åœ°å›¾ç‰‡*/Picasso.with(context).load(\"file:///android_asset/DvpvklR.png\").into(imageView2);/* æœ¬åœ°å›¾ç‰‡æ–‡ä»¶ */Picasso.with(context).load(new File(...)).into(imageView3); 3.3.1 Picasso.with(Context context)12345678910111213141516171819202122232425262728/** * The global default {@link Picasso} instance. * &lt;p&gt; * This instance is automatically initialized with defaults that are suitable to most * implementations. * &lt;ul&gt; * &lt;li&gt;LRU memory cache of 15% the available application RAM&lt;/li&gt; * &lt;li&gt;Disk cache of 2% storage space up to 50MB but no less than 5MB. (Note: this is only * available on API 14+ &lt;em&gt;or&lt;/em&gt; if you are using a standalone library that provides a disk * cache on all API levels like OkHttp)&lt;/li&gt; * &lt;li&gt;Three download threads for disk and network access.&lt;/li&gt; * &lt;/ul&gt; * &lt;p&gt; * If these settings do not meet the requirements of your application you can construct your own * with full control over the configuration by using {@link Picasso.Builder} to create a * {@link Picasso} instance. You can either use this directly or by setting it as the global * instance with {@link #setSingletonInstance}. */public static Picasso with(Context context) { if (singleton == null) { synchronized (Picasso.class) { if (singleton == null) { singleton = new Builder(context).build(); } } } return singleton;} æ„é€ ä¸€ä¸ªé»˜è®¤çš„Picassoå•ä¾‹ï¼Œå¦‚æœæ³¨é‡Šä¸­çš„ä¸€äº›åŸºæœ¬é…ç½®éœ€æ±‚æ— æ³•æ»¡è¶³ä½ ï¼Œä½ å¯ä»¥ä½¿ç”¨Picasso.Builderæ¥æ„é€ è‡ªå·±çš„Picassoå®ä¾‹ã€‚ 3.3.2 load()å¾ˆæ˜¾ç„¶ï¼Œå››ä¸ªloadæ–¹æ³•ï¼Œä¸åŒçš„å…¥å‚ï¼Œç›¸åŒç±»å‹çš„è¿”å›å€¼ã€‚é’ˆå¯¹ä¸åŒçš„å›¾ç‰‡æ¥æºï¼Œæ‰§è¡Œä¸åŒçš„åŠ è½½æ–¹å¼ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273/** * Start an image request using the specified URI. * &lt;p&gt; * Passing {@code null} as a {@code uri} will not trigger any request but will set a placeholder, * if one is specified. * * @see #load(File) * @see #load(String) * @see #load(int) */ public RequestCreator load(Uri uri) { return new RequestCreator(this, uri, 0); } /** * Start an image request using the specified path. This is a convenience method for calling * {@link #load(Uri)}. * &lt;p&gt; * This path may be a remote URL, file resource (prefixed with {@code file:}), content resource * (prefixed with {@code content:}), or android resource (prefixed with {@code * android.resource:}. * &lt;p&gt; * Passing {@code null} as a {@code path} will not trigger any request but will set a * placeholder, if one is specified. * * @see #load(Uri) * @see #load(File) * @see #load(int) * @throws IllegalArgumentException if {@code path} is empty or blank string. */ public RequestCreator load(String path) { if (path == null) { return new RequestCreator(this, null, 0); } if (path.trim().length() == 0) { throw new IllegalArgumentException(\"Path must not be empty.\"); } return load(Uri.parse(path)); } /** * Start an image request using the specified image file. This is a convenience method for * calling {@link #load(Uri)}. * &lt;p&gt; * Passing {@code null} as a {@code file} will not trigger any request but will set a * placeholder, if one is specified. * &lt;p&gt; * Equivalent to calling {@link #load(Uri) load(Uri.fromFile(file))}. * * @see #load(Uri) * @see #load(String) * @see #load(int) */ public RequestCreator load(File file) { if (file == null) { return new RequestCreator(this, null, 0); } return load(Uri.fromFile(file)); } /** * Start an image request using the specified drawable resource ID. * * @see #load(Uri) * @see #load(String) * @see #load(File) */ public RequestCreator load(int resourceId) { if (resourceId == 0) { throw new IllegalArgumentException(\"Resource ID must not be zero.\"); } return new RequestCreator(this, null, resourceId); } æ¯ä¸€ä¸ªload()æ–¹æ³•éƒ½æ˜¯åˆ›å»ºä¸€ä¸ªRequestCreatorå®ä¾‹ï¼Œload(File file)å’Œload(String path)æœ€åéƒ½æ˜¯é€šè¿‡è½¬æ¢æˆload(Uri uri)çš„æ–¹å¼å®ç°åŠ è½½ã€‚è€ŒRequestCreatorçš„æ„é€ æ–¹æ³•ä¸­ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯Picassoå®ä¾‹ï¼Œä¸€ä¸ªæ˜¯uriï¼Œä¸€ä¸ªæ˜¯resourceIdï¼Œé€šè¿‡åä¸¤ä¸ªå‚æ•°è¦†ç›–æ‰€æœ‰çš„åŠ è½½åœºæ™¯ã€‚ 12345678RequestCreator(Picasso picasso, Uri uri, int resourceId) { if (picasso.shutdown) { throw new IllegalStateException( \"Picasso instance already shut down. Cannot submit new requests.\"); } this.picasso = picasso; this.data = new Request.Builder(uri, resourceId, picasso.defaultBitmapConfig);} 3.3.3 into()RequestCreatorä¸­å¾ˆå¤šæ–¹æ³•éƒ½æ˜¯æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°çš„ã€‚å…ˆçœ‹into()æ–¹æ³• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224/** * Asynchronously fulfills the request into the specified {@link Target}. In most cases, you * should use this when you are dealing with a custom {@link android.view.View View} or view * holder which should implement the {@link Target} interface. * &lt;p&gt; * Implementing on a {@link android.view.View View}: * &lt;blockquote&gt;&lt;pre&gt; * public class ProfileView extends FrameLayout implements Target { * {@literal @}Override public void onBitmapLoaded(Bitmap bitmap, LoadedFrom from) { * setBackgroundDrawable(new BitmapDrawable(bitmap)); * } * * {@literal @}Override public void onBitmapFailed() { * setBackgroundResource(R.drawable.profile_error); * } * * {@literal @}Override public void onPrepareLoad(Drawable placeHolderDrawable) { * frame.setBackgroundDrawable(placeHolderDrawable); * } * } * &lt;/pre&gt;&lt;/blockquote&gt; * Implementing on a view holder object for use inside of an adapter: * &lt;blockquote&gt;&lt;pre&gt; * public class ViewHolder implements Target { * public FrameLayout frame; * public TextView name; * * {@literal @}Override public void onBitmapLoaded(Bitmap bitmap, LoadedFrom from) { * frame.setBackgroundDrawable(new BitmapDrawable(bitmap)); * } * * {@literal @}Override public void onBitmapFailed() { * frame.setBackgroundResource(R.drawable.profile_error); * } * * {@literal @}Override public void onPrepareLoad(Drawable placeHolderDrawable) { * frame.setBackgroundDrawable(placeHolderDrawable); * } * } * &lt;/pre&gt;&lt;/blockquote&gt; * &lt;p&gt; * &lt;em&gt;Note:&lt;/em&gt; This method keeps a weak reference to the {@link Target} instance and will be * garbage collected if you do not keep a strong reference to it. To receive callbacks when an * image is loaded use {@link #into(android.widget.ImageView, Callback)}. */public void into(Target target) { long started = System.nanoTime(); checkMain(); if (target == null) { throw new IllegalArgumentException(\"Target must not be null.\"); } if (deferred) { throw new IllegalStateException(\"Fit cannot be used with a Target.\"); } if (!data.hasImage()) { picasso.cancelRequest(target); target.onPrepareLoad(setPlaceholder ? getPlaceholderDrawable() : null); return; } Request request = createRequest(started); String requestKey = createKey(request); if (shouldReadFromMemoryCache(memoryPolicy)) { Bitmap bitmap = picasso.quickMemoryCacheCheck(requestKey); if (bitmap != null) { picasso.cancelRequest(target); target.onBitmapLoaded(bitmap, MEMORY); return; } } target.onPrepareLoad(setPlaceholder ? getPlaceholderDrawable() : null); Action action = new TargetAction(picasso, target, request, memoryPolicy, networkPolicy, errorDrawable, requestKey, tag, errorResId); picasso.enqueueAndSubmit(action);}/** * Asynchronously fulfills the request into the specified {@link RemoteViews} object with the * given {@code viewId}. This is used for loading bitmaps into a {@link Notification}. */public void into(RemoteViews remoteViews, int viewId, int notificationId, Notification notification) { long started = System.nanoTime(); if (remoteViews == null) { throw new IllegalArgumentException(\"RemoteViews must not be null.\"); } if (notification == null) { throw new IllegalArgumentException(\"Notification must not be null.\"); } if (deferred) { throw new IllegalStateException(\"Fit cannot be used with RemoteViews.\"); } if (placeholderDrawable != null || placeholderResId != 0 || errorDrawable != null) { throw new IllegalArgumentException( \"Cannot use placeholder or error drawables with remote views.\"); } Request request = createRequest(started); String key = createKey(request, new StringBuilder()); // Non-main thread needs own builder. RemoteViewsAction action = new NotificationAction(picasso, request, remoteViews, viewId, notificationId, notification, memoryPolicy, networkPolicy, key, tag, errorResId); performRemoteViewInto(action);}/** * Asynchronously fulfills the request into the specified {@link RemoteViews} object with the * given {@code viewId}. This is used for loading bitmaps into all instances of a widget. */public void into(RemoteViews remoteViews, int viewId, int[] appWidgetIds) { long started = System.nanoTime(); if (remoteViews == null) { throw new IllegalArgumentException(\"remoteViews must not be null.\"); } if (appWidgetIds == null) { throw new IllegalArgumentException(\"appWidgetIds must not be null.\"); } if (deferred) { throw new IllegalStateException(\"Fit cannot be used with remote views.\"); } if (placeholderDrawable != null || placeholderResId != 0 || errorDrawable != null) { throw new IllegalArgumentException( \"Cannot use placeholder or error drawables with remote views.\"); } Request request = createRequest(started); String key = createKey(request, new StringBuilder()); // Non-main thread needs own builder. RemoteViewsAction action = new AppWidgetAction(picasso, request, remoteViews, viewId, appWidgetIds, memoryPolicy, networkPolicy, key, tag, errorResId); performRemoteViewInto(action);}/** * Asynchronously fulfills the request into the specified {@link ImageView}. * &lt;p&gt; * &lt;em&gt;Note:&lt;/em&gt; This method keeps a weak reference to the {@link ImageView} instance and will * automatically support object recycling. */public void into(ImageView target) { into(target, null);}/** * Asynchronously fulfills the request into the specified {@link ImageView} and invokes the * target {@link Callback} if it's not {@code null}. * &lt;p&gt; * &lt;em&gt;Note:&lt;/em&gt; The {@link Callback} param is a strong reference and will prevent your * {@link android.app.Activity} or {@link android.app.Fragment} from being garbage collected. If * you use this method, it is &lt;b&gt;strongly&lt;/b&gt; recommended you invoke an adjacent * {@link Picasso#cancelRequest(android.widget.ImageView)} call to prevent temporary leaking. */public void into(ImageView target, Callback callback) { long started = System.nanoTime(); checkMain(); if (target == null) { throw new IllegalArgumentException(\"Target must not be null.\"); } if (!data.hasImage()) { picasso.cancelRequest(target); if (setPlaceholder) { setPlaceholder(target, getPlaceholderDrawable()); } return; } if (deferred) { if (data.hasSize()) { throw new IllegalStateException(\"Fit cannot be used with resize.\"); } int width = target.getWidth(); int height = target.getHeight(); if (width == 0 || height == 0) { if (setPlaceholder) { setPlaceholder(target, getPlaceholderDrawable()); } picasso.defer(target, new DeferredRequestCreator(this, target, callback)); return; } data.resize(width, height); } Request request = createRequest(started); String requestKey = createKey(request); if (shouldReadFromMemoryCache(memoryPolicy)) { Bitmap bitmap = picasso.quickMemoryCacheCheck(requestKey); if (bitmap != null) { picasso.cancelRequest(target); setBitmap(target, picasso.context, bitmap, MEMORY, noFade, picasso.indicatorsEnabled); if (picasso.loggingEnabled) { log(OWNER_MAIN, VERB_COMPLETED, request.plainId(), \"from \" + MEMORY); } if (callback != null) { callback.onSuccess(); } return; } } if (setPlaceholder) { setPlaceholder(target, getPlaceholderDrawable()); } Action action = new ImageViewAction(picasso, target, request, memoryPolicy, networkPolicy, errorResId, errorDrawable, requestKey, tag, callback, noFade); picasso.enqueueAndSubmit(action);} å¯ä»¥çœ‹åˆ°5ä¸ªinto()æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°Picassoå¸¸ç”¨çš„æ˜¯ç›´æ¥å¾€ImageViewï¼Œä½†æ˜¯å®ƒçš„åŠŸèƒ½è¿œè¿œä¸æ­¢å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°Targetæ¥å£æ¥å®ç°è‡ªå®šä¹‰çš„å›¾ç‰‡å¤„ç†ï¼Œå¯ä»¥ç”¨æ¥è®¾èƒŒæ™¯ï¼Œå¯ä»¥ç”¨æ¥å¡«å……å¸ƒå±€ï¼Œå¯æ‰©å±•æ€§å¾ˆå¼ºï¼Œä¹Ÿæ”¯æŒRemoteViewã€‚è€Œæˆ‘ä»¬å¸¸ç”¨çš„ 123public void into(ImageView target) { into(target, null);} è½¬åˆ°æœ‰Callbackçš„æ‰§è¡Œæ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å¸¦æœ‰å›è°ƒçš„intoæ–¹æ³•æ¥æ‰§è¡Œå›¾ç‰‡åŠ è½½æˆåŠŸæˆ–è€…å¤±è´¥åçš„äº‹ä»¶å¤„ç†ã€‚ 1234567891011121314public interface Callback { void onSuccess(); void onError(); public static class EmptyCallback implements Callback { @Override public void onSuccess() { } @Override public void onError() { } }} çœ‹ä¸‹public void into(ImageView target, Callback callback)è¿™ä¸ªæ–¹æ³•ï¼š checkMain() åˆ¤æ–­æ˜¯å¦ä¸ºä¸»è¿›ç¨‹ éç©ºæ£€æŸ¥ã€‚åˆ¤æ–­targetæ˜¯å¦ä¸ºç©ºï¼Œuri æˆ–è€… resourceIdæ˜¯å¦ä¸ºç©ºï¼› deferredæ˜¯å¦ä¸ºtrueã€‚è¿™ä¸ªå’Œæ˜¯å¦è°ƒç”¨fitæ–¹æ³•æœ‰å…³ã€‚ç”±äºfitæ–¹æ³•æ˜¯è®©å›¾ç‰‡é€‚åº”ImageViewçš„å¤§å°ï¼Œæ‰€ä»¥éœ€è¦ImageViewå¤§å°æ˜ç¡®ä¹‹åæ‰æ‰§è¡Œè¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦å»¶è¿Ÿæ‰§è¡Œã€‚ åˆ›å»ºRequestå’ŒrequestKey æ˜¯å¦åœ¨CacheæŸ¥æ‰¾è¯¥å›¾ç‰‡ï¼Œé€šè¿‡requestKeyï¼Œè¿™ä¸ªKeyçš„æ„å»ºè¿‡ç¨‹å’Œå¾ˆå¤šå†…å®¹æœ‰å…³ç³»ã€‚ è®¾ç½®å ä½å›¾ç‰‡ æ„å»ºActionå¹¶æäº¤ ä»¥ä¸Šå°±æ˜¯å›¾ç‰‡åŠ è½½çš„ä¸»è¦è¿‡ç¨‹ã€‚ 4. è¿›é˜¶ç”¨æ³•(é“¾å¼ä½¿ç”¨)ä¸»è¦ä»‹ç»ä¸€ä¸‹Picassoçš„å…¶ä»–ç”¨æ³• 4.1 noPlaceholder()ä¸è®¾ç½®å ä½å›¾ç‰‡ï¼Œä¸èƒ½äºplaceHolderåŒæ—¶ä½¿ç”¨ 1234567891011121314151617/** * Explicitly opt-out to having a placeholder set when calling {@code into}. * &lt;p&gt; * By default, Picasso will either set a supplied placeholder or clear the target * {@link ImageView} in order to ensure behavior in situations where views are recycled. This * method will prevent that behavior and retain any already set image. */public RequestCreator noPlaceholder() { if (placeholderResId != 0) { throw new IllegalStateException(\"Placeholder resource already set.\"); } if (placeholderDrawable != null) { throw new IllegalStateException(\"Placeholder image already set.\"); } setPlaceholder = false; return this;} 4.2 placeholder()è®¾ç½®å ä½å›¾ç‰‡ 123456789101112131415161718/** * A placeholder drawable to be used while the image is being loaded. If the requested image is * not immediately available in the memory cache then this resource will be set on the target * {@link ImageView}. */public RequestCreator placeholder(int placeholderResId) { if (!setPlaceholder) { throw new IllegalStateException(\"Already explicitly declared as no placeholder.\"); } if (placeholderResId == 0) { throw new IllegalArgumentException(\"Placeholder image resource invalid.\"); } if (placeholderDrawable != null) { throw new IllegalStateException(\"Placeholder image already set.\"); } this.placeholderResId = placeholderResId; return this;} 4.3 error()è®¾ç½®åŠ è½½å‡ºé”™æ—¶çš„å›¾ç‰‡ 1234567891011121314151617181920212223/** An error drawable to be used if the request image could not be loaded. */public RequestCreator error(int errorResId) { if (errorResId == 0) { throw new IllegalArgumentException(\"Error image resource invalid.\"); } if (errorDrawable != null) { throw new IllegalStateException(\"Error image already set.\"); } this.errorResId = errorResId; return this;}/** An error drawable to be used if the request image could not be loaded. */public RequestCreator error(Drawable errorDrawable) { if (errorDrawable == null) { throw new IllegalArgumentException(\"Error image may not be null.\"); } if (errorResId != 0) { throw new IllegalStateException(\"Error image already set.\"); } this.errorDrawable = errorDrawable; return this;} 4.4 tag()è®¾ç½®tagï¼Œæ–¹ä¾¿åç»­pauseï¼Œcancelï¼Œæˆ–è€…resumeã€‚è¿™ä¸ªåº”è¯¥ç”¨çš„æ¯”è¾ƒå°‘ï¼Œæœ‰å¯èƒ½é€šè¿‡tagæ¥cancelä¸€ä¸‹ã€‚ 12345678910111213141516171819202122232425262728/** * Assign a tag to this request. Tags are an easy way to logically associate * related requests that can be managed together e.g. paused, resumed, * or canceled. * &lt;p&gt; * You can either use simple {@link String} tags or objects that naturally * define the scope of your requests within your app such as a * {@link android.content.Context}, an {@link android.app.Activity}, or a * {@link android.app.Fragment}. * * &lt;strong&gt;WARNING:&lt;/strong&gt;: Picasso will keep a reference to the tag for * as long as this tag is paused and/or has active requests. Look out for * potential leaks. * * @see Picasso#cancelTag(Object) * @see Picasso#pauseTag(Object) * @see Picasso#resumeTag(Object) */public RequestCreator tag(Object tag) { if (tag == null) { throw new IllegalArgumentException(\"Tag invalid.\"); } if (this.tag != null) { throw new IllegalStateException(\"Tag already set.\"); } this.tag = tag; return this;} 4.5 fit() &amp; unfit()è°ƒæ•´å›¾ç‰‡å¤§å°æ¥é€‚é…targetçš„è¾¹ç•Œï¼Œè¿™ä¸ªä¼šå¯¼è‡´å›¾ç‰‡çš„åŠ è½½è¿‡ç¨‹åœ¨ImageViewå¸ƒå±€ç¡®å®šä¹‹åè¿›è¡Œã€‚ 12345678910111213141516/** * Attempt to resize the image to fit exactly into the target {@link ImageView}'s bounds. This * will result in delayed execution of the request until the {@link ImageView} has been laid out. * &lt;p&gt; * &lt;em&gt;Note:&lt;/em&gt; This method works only when your target is an {@link ImageView}. */public RequestCreator fit() { deferred = true; return this;}/** Internal use only. Used by {@link DeferredRequestCreator}. */RequestCreator unfit() { deferred = false; return this;} 4.6 resizeDimen() &amp; resize()è°ƒæ•´å›¾ç‰‡å¤§å°ã€‚ 12345678910111213/** Resize the image to the specified dimension size. */public RequestCreator resizeDimen(int targetWidthResId, int targetHeightResId) { Resources resources = picasso.context.getResources(); int targetWidth = resources.getDimensionPixelSize(targetWidthResId); int targetHeight = resources.getDimensionPixelSize(targetHeightResId); return resize(targetWidth, targetHeight);}/** Resize the image to the specified size in pixels. */public RequestCreator resize(int targetWidth, int targetHeight) { data.resize(targetWidth, targetHeight); return this;} 4.7 centerCrop() &amp; centerInside()centerCropï¼šå……æ»¡ImageViewå±…ä¸­è£å‰ªcenterInsideï¼š å®Œæ•´æ˜¾ç¤ºå›¾ç‰‡ä½†æ˜¯å¯èƒ½æ— æ³•å……æ»¡ImageView 123456789101112131415161718/** * Crops an image inside of the bounds specified by {@link #resize(int, int)} rather than * distorting the aspect ratio. This cropping technique scales the image so that it fills the * requested bounds and then crops the extra. */public RequestCreator centerCrop() { data.centerCrop(); return this;}/** * Centers an image inside of the bounds specified by {@link #resize(int, int)}. This scales * the image so that both dimensions are equal to or less than the requested bounds. */public RequestCreator centerInside() { data.centerInside(); return this;} 4.8 onlyScaleDown()å½“è°ƒç”¨äº†resize æ–¹æ³•é‡æ–°è®¾ç½®å›¾ç‰‡å°ºå¯¸çš„æ—¶å€™ï¼Œè°ƒç”¨onlyScaleDown æ–¹æ³•ï¼Œåªæœ‰å½“åŸå§‹å›¾ç‰‡çš„å°ºå¯¸å¤§äºæˆ‘ä»¬æŒ‡å®šçš„å°ºå¯¸æ—¶ï¼Œresizeæ‰èµ·ä½œç”¨ã€‚ 12345678/** * Only resize an image if the original image size is bigger than the target size * specified by {@link #resize(int, int)}. */public RequestCreator onlyScaleDown() { data.onlyScaleDown(); return this;} 4.9 rotate()æ—‹è½¬å›¾ç‰‡è§’åº¦ï¼Œå¯æŒ‡å®šæ—‹è½¬ä¸­å¿ƒç‚¹ 1234567891011/** Rotate the image by the specified degrees. */public RequestCreator rotate(float degrees) { data.rotate(degrees); return this;}/** Rotate the image by the specified degrees around a pivot point. */public RequestCreator rotate(float degrees, float pivotX, float pivotY) { data.rotate(degrees, pivotX, pivotY); return this;} 4.10 config()è®¾ç½®å›¾ç‰‡Bitmapæ ¼å¼ï¼Œå¦‚ALPHA_8ï¼ŒARGB_4444ï¼ŒARGB_8888ï¼ŒHARDWAREï¼ŒRGBA_F16ï¼ŒRGB_565ç­‰ç­‰ã€‚ 12345678910/** * Attempt to decode the image using the specified config. * &lt;p&gt; * Note: This value may be ignored by {@link BitmapFactory}. See * {@link BitmapFactory.Options#inPreferredConfig its documentation} for more details. */public RequestCreator config(Bitmap.Config config) { data.config(config); return this;} 4.11 stableKey()è®¾ç½®å›ºå®šKey 12345678/** * Sets the stable key for this request to be used instead of the URI or resource ID when * caching. Two requests with the same value are considered to be for the same resource. */public RequestCreator stableKey(String stableKey) { data.stableKey(stableKey); return this;} 4.12 priority()è®¾ç½®ä¼˜å…ˆçº§ï¼Œè¿™ä¸ªå¯¹å›¾ç‰‡è¯·æ±‚çš„æ‰§è¡Œé¡ºåºæœ‰å½±å“ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§å‡ä¸ºNORMAL 1234567891011/** * Set the priority of this request. * &lt;p&gt; * This will affect the order in which the requests execute but does not guarantee it. * By default, all requests have {@link Priority#NORMAL} priority, except for * {@link #fetch()} requests, which have {@link Priority#LOW} priority by default. */public RequestCreator priority(Priority priority) { data.priority(priority); return this;} 4.13 transform()æ·»åŠ è‡ªå®šä¹‰Transformationï¼Œæ–¹ä¾¿æ‰§è¡Œå›¾å½¢è½¬æ¢ã€‚æ›´å¤štransformationè¯·ç§»æ­¥picasso-transformations 12345678910111213141516171819/** * Add a custom transformation to be applied to the image. * &lt;p&gt; * Custom transformations will always be run after the built-in transformations. */// TODO show example of calling resize after a transform in the javadocpublic RequestCreator transform(Transformation transformation) { data.transform(transformation); return this;}/** * Add a list of custom transformations to be applied to the image. * &lt;p&gt; * Custom transformations will always be run after the built-in transformations. */public RequestCreator transform(List&lt;? extends Transformation&gt; transformations) { data.transform(transformations); return this;} 4.14 memoryPolicy()æŒ‡å®šmemoryPolicyã€‚NO_CACHEï¼ŒNO_STORENO_CACHEï¼šè¡¨ç¤ºå¤„ç†è¯·æ±‚çš„æ—¶å€™è·³è¿‡æ£€æŸ¥å†…å­˜ç¼“å­˜NO_STORE: è¡¨ç¤ºè¯·æ±‚æˆåŠŸä¹‹åï¼Œç»“æœä¸å­˜åˆ°å†…å­˜ã€‚ 12345678910111213141516171819202122/** * Specifies the {@link MemoryPolicy} to use for this request. You may specify additional policy * options using the varargs parameter. */public RequestCreator memoryPolicy(MemoryPolicy policy, MemoryPolicy... additional) { if (policy == null) { throw new IllegalArgumentException(\"Memory policy cannot be null.\"); } this.memoryPolicy |= policy.index; if (additional == null) { throw new IllegalArgumentException(\"Memory policy cannot be null.\"); } if (additional.length &gt; 0) { for (MemoryPolicy memoryPolicy : additional) { if (memoryPolicy == null) { throw new IllegalArgumentException(\"Memory policy cannot be null.\"); } this.memoryPolicy |= memoryPolicy.index; } } return this;} 4.15 networkPolicy()æŒ‡å®šNetworkPolicyã€‚NO_CACHEï¼ŒNO_STOREï¼ŒOFFLINENO_CACHE: è¡¨ç¤ºå¤„ç†è¯·æ±‚çš„æ—¶å€™è·³è¿‡å¤„ç†ç£ç›˜ç¼“å­˜NO_STORE: è¡¨ç¤ºè¯·æ±‚æˆåŠŸåï¼Œç»“æœä¸ç¼“å­˜åˆ°Diskã€‚OFFLINE: å¼ºåˆ¶è¿™æ¬¡è¯·æ±‚ä»ç¼“å­˜ä¸­è·å–ç»“æœï¼Œä¸ä¼šå‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œä¸ç®¡ç¼“å­˜ä¸­èƒ½å¦è·å–åˆ°ç»“æœã€‚ 12345678910111213141516171819202122/** * Specifies the {@link NetworkPolicy} to use for this request. You may specify additional policy * options using the varargs parameter. */public RequestCreator networkPolicy(NetworkPolicy policy, NetworkPolicy... additional) { if (policy == null) { throw new IllegalArgumentException(\"Network policy cannot be null.\"); } this.networkPolicy |= policy.index; if (additional == null) { throw new IllegalArgumentException(\"Network policy cannot be null.\"); } if (additional.length &gt; 0) { for (NetworkPolicy networkPolicy : additional) { if (networkPolicy == null) { throw new IllegalArgumentException(\"Network policy cannot be null.\"); } this.networkPolicy |= networkPolicy.index; } } return this;} 4.16 noFade()å»æ‰é»˜è®¤çš„å›¾ç‰‡åŠ è½½è¿‡ç¨‹ä¸­çš„æ¸å…¥æ•ˆæœ 12345/** Disable brief fade in of images loaded from the disk cache or network. */public RequestCreator noFade() { noFade = true; return this;} 5. å…¶ä»–ç”¨æ³• 5.1 get()åŒæ­¥æ–¹æ³•ï¼Œè·å–Bitmapã€‚æ‰€ä»¥ä¸è¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œæ­¤æ“ä½œç”¨æ³•ï¼š 12345try { Bitmap bitmap = Picasso.with(this).load(URL).get();} catch (IOException e) { e.printStackTrace();} æºç å®ç°ï¼š 1234567891011121314151617181920212223/** * Synchronously fulfill this request. Must not be called from the main thread. * &lt;p&gt; * &lt;em&gt;Note&lt;/em&gt;: The result of this operation is not cached in memory because the underlying * {@link Cache} implementation is not guaranteed to be thread-safe. */ public Bitmap get() throws IOException { long started = System.nanoTime(); checkNotMain(); if (deferred) { throw new IllegalStateException(\"Fit cannot be used with get.\"); } if (!data.hasImage()) { return null; } Request finalData = createRequest(started); String key = createKey(finalData, new StringBuilder()); Action action = new GetAction(picasso, finalData, memoryPolicy, networkPolicy, tag, key); return forRequest(picasso, picasso.dispatcher, picasso.cache, picasso.stats, action).hunt(); } 5.2 fetch()æ¯«æ— ç»“æœçš„è·å–å›¾ç‰‡ï¼Œä¹Ÿæ²¡æœ‰ç›®æ ‡ï¼Œä¹Ÿæ²¡æœ‰è¿”å›bitmapï¼Œéš¾é“åªæ˜¯ä¸ºäº†æš–åœºï¼Ÿè€ƒè™‘åˆ°Picassoæœ‰ç¼“å­˜æœºåˆ¶ï¼Œè¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æœ‰ä¸€ç‚¹ä»·å€¼çš„ï¼Œæå‰åŠ è½½æ”¾åˆ°ç¼“å­˜ï¼Œåé¢åŠ è½½é€Ÿåº¦ä¼šæ›´å¿«ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839/** * Asynchronously fulfills the request without a {@link ImageView} or {@link Target}, * and invokes the target {@link Callback} with the result. This is useful when you want to warm * up the cache with an image. * &lt;p&gt; * &lt;em&gt;Note:&lt;/em&gt; The {@link Callback} param is a strong reference and will prevent your * {@link android.app.Activity} or {@link android.app.Fragment} from being garbage collected * until the request is completed. */public void fetch(Callback callback) { long started = System.nanoTime(); if (deferred) { throw new IllegalStateException(\"Fit cannot be used with fetch.\"); } if (data.hasImage()) { // Fetch requests have lower priority by default. if (!data.hasPriority()) { data.priority(Priority.LOW); } Request request = createRequest(started); String key = createKey(request, new StringBuilder()); Bitmap bitmap = picasso.quickMemoryCacheCheck(key); if (bitmap != null) { if (picasso.loggingEnabled) { log(OWNER_MAIN, VERB_COMPLETED, request.plainId(), \"from \" + MEMORY); } if (callback != null) { callback.onSuccess(); } } else { Action action = new FetchAction(picasso, request, memoryPolicy, networkPolicy, tag, key, callback); picasso.submit(action); } }} 6. è‡ªå®šä¹‰Picassoé»˜è®¤ä½¿ç”¨Picasso.with(context)å¯ä»¥å¿«é€Ÿçš„æ„å»ºPicassoå®ä¾‹ï¼Œä½†æ˜¯Picassoæ”¯æŒæ‰©å±•è‡ªå®šä¹‰Picassoï¼Œä¹Ÿå°±æ˜¯ä¸€äº›é»˜è®¤çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ¥è°ƒæ§ã€‚ å¯ä»¥çœ‹åˆ°Picasso.Builderæ–¹æ³•å­˜åœ¨å¾ˆå¤šå¯é…ç½®çš„å†…å®¹ï¼Œdownloader, executor, memoryCache,listenerç­‰ç­‰éƒ½æ˜¯å¯ä»¥è‡ªå·±è®¾ç½®çš„ï¼Œé…ç½®å®Œæˆåè°ƒç”¨builder()æ–¹æ³•å³å¯è¿”å›Picassoå®ä¾‹ã€‚è¿˜å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è®¾ç½®å…¨å±€Picassoå®ä¾‹ã€‚ 12345678910111213/** * Set the global instance returned from {@link #with}. * &lt;p&gt; * This method must be called before any calls to {@link #with} and may only be called once. */public static void setSingletonInstance(Picasso picasso) { synchronized (Picasso.class) { if (singleton != null) { throw new IllegalStateException(\"Singleton instance already exists.\"); } singleton = picasso; }} 7. ç±»å›¾è¯·é€‚å½“æ”¾å¤§åæŸ¥çœ‹ã€‚ 8. ä¸»è¦æµç¨‹å›¾è¯·é€‚å½“æ”¾å¤§åæŸ¥çœ‹ã€‚","link":"/2017/10/08/ã€ŠAndroidå¼€æºåº“ã€‹Picasso/"},{"title":"ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 MediaScanner","text":"å‰è¨€ MediaScanneræ˜¯Androidç³»ç»Ÿä¸­é’ˆå¯¹åª’ä½“æ–‡ä»¶çš„æ‰«æè¿‡ç¨‹ï¼Œå°†å‚¨å­˜ç©ºé—´ä¸­çš„åª’ä½“æ–‡ä»¶é€šè¿‡æ‰«æçš„æ–¹å¼éå†å¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œç„¶åé€šè¿‡MediaProvideræä¾›æ¥å£ä½¿ç”¨ï¼Œåœ¨Androidå¤šåª’ä½“ä¸­å æœ‰å¾ˆé‡è¦çš„ä½ç½®ã€‚ æºç ä½ç½® packages\\providers\\mediaprovider frameworks\\base\\media\\java\\android\\media frameworks\\av\\media\\libmedia frameworks\\base\\media\\jni frameworks\\av\\media\\libstagefright æ‰«æè¿‡ç¨‹ MediaScannerReceiver.java (packages\\providers\\mediaprovider\\src\\com\\android\\providers\\media) MediaScannerReceiverç»§æ‰¿BroadcastReceiver,åœ¨AndroidManifest.xmlé™æ€æ³¨å†Œ 1234567891011121314151617&lt;receiver android:name=\"MediaScannerReceiver\"&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.BOOT_COMPLETED\" /&gt; &lt;/intent-filter&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.MEDIA_MOUNTED\" /&gt; &lt;data android:scheme=\"file\" /&gt; &lt;/intent-filter&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.MEDIA_UNMOUNTED\" /&gt; &lt;data android:scheme=\"file\" /&gt; &lt;/intent-filter&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.MEDIA_SCANNER_SCAN_FILE\" /&gt; &lt;data android:scheme=\"file\" /&gt; &lt;/intent-filter&gt; &lt;/receiver&gt; å¯ä»¥çœ‹åˆ°ï¼Œå½“æ¥æ”¶åˆ° android.intent.action.BOOT_COMPLETED android.intent.action.MEDIA_MOUNTED android.intent.action.MEDIA_UNMOUNTED android.intent.action.MEDIA_SCANNER_SCAN_FILEå¹¿æ’­çš„æ—¶å€™ï¼ŒMediaScannerReceiverä¸­çš„onReceiver()æ–¹æ³•å°†ä¼šæ‰§è¡Œ 123456789101112131415161718192021222324252627282930313233343536public void onReceive(Context context, Intent intent) { final String action = intent.getAction(); final Uri uri = intent.getData(); if (Intent.ACTION_BOOT_COMPLETED.equals(action)) { // Scan both internal and external storage scan(context, MediaProvider.INTERNAL_VOLUME); scan(context, MediaProvider.EXTERNAL_VOLUME); } else { if (uri.getScheme().equals(\"file\")) { // handle intents related to external storage String path = uri.getPath(); String externalStoragePath = Environment.getExternalStorageDirectory().getPath(); String legacyPath = Environment.getLegacyExternalStorageDirectory().getPath(); try { path = new File(path).getCanonicalPath(); } catch (IOException e) { Log.e(TAG, \"couldn't canonicalize \" + path); return; } if (path.startsWith(legacyPath)) { path = externalStoragePath + path.substring(legacyPath.length()); } Log.d(TAG, \"action: \" + action + \" path: \" + path); if (Intent.ACTION_MEDIA_MOUNTED.equals(action)) { // scan whenever any volume is mounted scan(context, MediaProvider.EXTERNAL_VOLUME); } else if (Intent.ACTION_MEDIA_SCANNER_SCAN_FILE.equals(action) &amp;&amp; path != null &amp;&amp; path.startsWith(externalStoragePath + \"/\")) { scanFile(context, path); } } } } onReceiveræ–¹æ³•ä¸­ï¼Œä¼šæ‰§è¡Œåˆ°scan()æˆ–è€…æ˜¯scanFile()æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹æ•´ä¸ªå·ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹å…·ä½“çš„æ–‡ä»¶ï¼Œä»ä¼ å…¥çš„å‚æ•°å¯ä»¥çœ‹å‡ºçœ‰ç›®ï¼Œscanä¼ å…¥çš„æ˜¯å·åï¼ŒscanFileä¼ å…¥çš„æ˜¯æ–‡ä»¶è·¯å¾„ã€‚é€šè¿‡æ¥æ”¶å¹¿æ’­å¯åŠ¨æ‰«æï¼Œç„¶è€Œä¸ç®¡æ˜¯scanè¿˜æ˜¯scanFileéƒ½æ˜¯ä»¥startServiceçš„æ–¹å¼å¯åŠ¨MediaScannerServiceã€‚ 12345678910111213private void scan(Context context, String volume) { Bundle args = new Bundle(); args.putString(\"volume\", volume); context.startService( new Intent(context, MediaScannerService.class).putExtras(args));}private void scanFile(Context context, String path) { Bundle args = new Bundle(); args.putString(\"filepath\", path); context.startService( new Intent(context, MediaScannerService.class).putExtras(args));} åˆ†åˆ«ä¼ å…¥å·åæˆ–è€…æ–‡ä»¶è·¯å¾„ã€‚ MediaScannerService.java (packages\\providers\\mediaprovider\\src\\com\\android\\providers\\media) MediaScannerServiceçœ‹ä¸‹AndroidManifest.xmlæ–‡ä»¶ä¸­å®šä¹‰ 12345&lt;service android:name=\"MediaScannerService\" android:exported=\"true\"&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.media.IMediaScannerService\" /&gt; &lt;/intent-filter&gt;&lt;/service&gt; ç»§æ‰¿Serviceï¼Œå®ç°Runnableæ¥å£ï¼Œé¦–å…ˆæ‰§è¡ŒonCreate()æ–¹æ³• 12345678910111213public void onCreate(){ PowerManager pm = (PowerManager)getSystemService(Context.POWER_SERVICE); mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, TAG); StorageManager storageManager = (StorageManager)getSystemService(Context.STORAGE_SERVICE); mExternalStoragePaths = storageManager.getVolumePaths(); // Start up the thread running the service. Note that we create a // separate thread because the service normally runs in the process's // main thread, which we don't want to block. Thread thr = new Thread(null, this, \"MediaScannerService\"); thr.start();} è¿™é‡Œä¼šå•ç‹¬å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ï¼Œç„¶åèµ°åˆ°onStartCommand() 12345678910111213141516171819202122232425public int onStartCommand(Intent intent, int flags, int startId){ while (mServiceHandler == null) { synchronized (this) { try { wait(100); } catch (InterruptedException e) { } } } if (intent == null) { Log.e(TAG, \"Intent is null in onStartCommand: \", new NullPointerException()); return Service.START_NOT_STICKY; } Message msg = mServiceHandler.obtainMessage(); msg.arg1 = startId; msg.obj = intent.getExtras(); mServiceHandler.sendMessage(msg); // Try again later if we are killed before we can finish scanning. return Service.START_REDELIVER_INTENT;} è¿™é‡Œå…ˆç­‰å¾…mServiceHandleråˆ›å»ºå®Œæˆï¼Œç„¶åé€šè¿‡handler messageæœºåˆ¶ä¼ é€’æ¶ˆæ¯ç»™handlerå¤„ç†ï¼Œè¿™é‡Œçš„mServiceHandleråˆ›å»ºè¿‡ç¨‹æ˜¯åœ¨run(ï¼‰æ–¹æ³•ä¸­ 12345678910111213public void run(){ // reduce priority below other background threads to avoid interfering // with other services at boot time. Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND + Process.THREAD_PRIORITY_LESS_FAVORABLE); Looper.prepare(); mServiceLooper = Looper.myLooper(); mServiceHandler = new ServiceHandler(); Looper.loop();} ç”±äºè¿™ä¸ªæ˜¯å•ç‹¬çš„çº¿ç¨‹ï¼Œæ— æ³•ä¿è¯åœ¨å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œhandlerå·²ç»åˆ›å»ºå®Œæˆï¼Œæ‰€ä»¥éœ€è¦ç­‰å¾…handlerçš„åˆ›å»º çœ‹ä¸‹è¿™ä¸ªå¤„ç†æ¶ˆæ¯çš„handler 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950private final class ServiceHandler extends Handler{ @Override public void handleMessage(Message msg) { Bundle arguments = (Bundle) msg.obj; String filePath = arguments.getString(\"filepath\"); try { if (filePath != null) { IBinder binder = arguments.getIBinder(\"listener\"); IMediaScannerListener listener = (binder == null ? null : IMediaScannerListener.Stub.asInterface(binder)); Uri uri = null; try { uri = scanFile(filePath, arguments.getString(\"mimetype\")); } catch (Exception e) { Log.e(TAG, \"Exception scanning file\", e); } if (listener != null) { listener.scanCompleted(filePath, uri); } } else { String volume = arguments.getString(\"volume\"); String[] directories = null; if (MediaProvider.INTERNAL_VOLUME.equals(volume)) { // scan internal media storage directories = new String[] { Environment.getRootDirectory() + \"/media\", Environment.getOemDirectory() + \"/media\", }; } else if (MediaProvider.EXTERNAL_VOLUME.equals(volume)) { // scan external storage volumes directories = mExternalStoragePaths; } if (directories != null) { if (false) Log.d(TAG, \"start scanning volume \" + volume + \": \" + Arrays.toString(directories)); scan(directories, volume); if (false) Log.d(TAG, \"done scanning volume \" + volume); } } } catch (Exception e) { Log.e(TAG, \"Exception in handleMessage\", e); } stopSelf(msg.arg1); }}; åˆ†åˆ«æ‰§è¡Œscanå’ŒscanFileæ–¹æ³• 123456789101112131415161718192021222324252627282930private void scan(String[] directories, String volumeName) { Uri uri = Uri.parse(\"file://\" + directories[0]); // don't sleep while scanning mWakeLock.acquire(); try { ContentValues values = new ContentValues(); values.put(MediaStore.MEDIA_SCANNER_VOLUME, volumeName); Uri scanUri = getContentResolver().insert(MediaStore.getMediaScannerUri(), values); sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_STARTED, uri)); try { if (volumeName.equals(MediaProvider.EXTERNAL_VOLUME)) { openDatabase(volumeName); } MediaScanner scanner = createMediaScanner(); scanner.scanDirectories(directories, volumeName); } catch (Exception e) { Log.e(TAG, \"exception in MediaScanner.scan()\", e); } getContentResolver().delete(scanUri, null, null); } finally { sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_FINISHED, uri)); mWakeLock.release(); }} 12345678910111213private Uri scanFile(String path, String mimeType) { String volumeName = MediaProvider.EXTERNAL_VOLUME; openDatabase(volumeName); MediaScanner scanner = createMediaScanner(); try { // make sure the file path is in canonical form String canonicalPath = new File(path).getCanonicalPath(); return scanner.scanSingleFile(canonicalPath, volumeName, mimeType); } catch (Exception e) { Log.e(TAG, \"bad path \" + path + \" in scanFile()\", e); return null; }} ä¸¤è€…éƒ½æ˜¯ä¼šé€šè¿‡createMediaScanneråˆ›å»ºMediaScannerå¯¹è±¡ï¼Œç„¶åé€šè¿‡scanDirectoriesæˆ–è€…scanSingleFileæ¥å¯¹å·æˆ–è€…æ–‡ä»¶è¿›è¡Œæ‰«æï¼Œä¸‹é¢æˆ‘ä»¬å°±åªé’ˆå¯¹scanDirectoriesè¿›è¡Œåˆ†æã€‚ MediaScanner.java (base\\media\\java\\android\\media) 1234567891011121314151617181920212223242526272829303132333435363738394041424344public void scanDirectories(String[] directories, String volumeName) { try { long start = System.currentTimeMillis(); initialize(volumeName);//åˆå§‹åŒ–æ•°æ®åº“ä¸­çš„ä¸€äº›å†…å®¹ prescan(null, true); //é¢„æ‰«æ long prescan = System.currentTimeMillis(); //è®¡ç®—é¢„æ‰«ææ—¶é—´ if (ENABLE_BULK_INSERTS) { // create MediaInserter for bulk inserts mMediaInserter = new MediaInserter(mMediaProvider, mPackageName, 500); } for (int i = 0; i &lt; directories.length; i++) { processDirectory(directories[i], mClient); //æ‰«æç›®å½• } if (ENABLE_BULK_INSERTS) { // flush remaining inserts mMediaInserter.flushAll(); mMediaInserter = null; } long scan = System.currentTimeMillis(); postscan(directories); long end = System.currentTimeMillis(); if (false) { Log.d(TAG, \" prescan time: \" + (prescan - start) + \"ms\\n\"); Log.d(TAG, \" scan time: \" + (scan - prescan) + \"ms\\n\"); Log.d(TAG, \"postscan time: \" + (end - scan) + \"ms\\n\"); Log.d(TAG, \" total time: \" + (end - start) + \"ms\\n\"); } } catch (SQLException e) { // this might happen if the SD card is removed while the media scanner is running Log.e(TAG, \"SQLException in MediaScanner.scan()\", e); } catch (UnsupportedOperationException e) { // this might happen if the SD card is removed while the media scanner is running Log.e(TAG, \"UnsupportedOperationException in MediaScanner.scan()\", e); } catch (RemoteException e) { Log.e(TAG, \"RemoteException in MediaScanner.scan()\", e); } finally { releaseResources(); } } è¿™é‡Œé¢æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªå†…å®¹ï¼Œä¸€ä¸ªæ˜¯prescanï¼Œä¸€ä¸ªæ˜¯processDirectory å…ˆçœ‹çœ‹prescan 1234567891011121314151617181920212223242526272829303132333435363738394041424344Uri limitUri = mFilesUri.buildUpon().appendQueryParameter(\"limit\", \"1000\").build(); //æŸ¥è¯¢æ¡æ•°ä¸º1000æ¡mWasEmptyPriorToScan = true;while (true) { selectionArgs[0] = \"\" + lastId; if (c != null) { c.close(); c = null; } c = mMediaProvider.query(mPackageName, limitUri, FILES_PRESCAN_PROJECTION, where, selectionArgs, MediaStore.Files.FileColumns._ID, null); if (c == null) { break; } int num = c.getCount(); if (num == 0) { break; } mWasEmptyPriorToScan = false; while (c.moveToNext()) { long rowId = c.getLong(FILES_PRESCAN_ID_COLUMN_INDEX); String path = c.getString(FILES_PRESCAN_PATH_COLUMN_INDEX); int format = c.getInt(FILES_PRESCAN_FORMAT_COLUMN_INDEX); long lastModified = c.getLong(FILES_PRESCAN_DATE_MODIFIED_COLUMN_INDEX); lastId = rowId; //æŸ¥è¯¢id,è·¯å¾„ï¼Œæ ¼å¼å’Œæœ€åä¿®æ”¹æ—¶é—´ // Only consider entries with absolute path names. // This allows storing URIs in the database without the // media scanner removing them. if (path != null &amp;&amp; path.startsWith(\"/\")) { boolean exists = false; try { exists = Os.access(path, android.system.OsConstants.F_OK); } catch (ErrnoException e1) { } ...... } } } }} è¿™é‡Œä¸»è¦å°±æ˜¯æ³¨æ„ä¸‹æœ€åä¿®æ”¹æ—¶é—´ï¼Œåé¢æ‰«æçš„è¿‡ç¨‹ä¸­åº”è¯¥ä¼šç”¨åˆ°ã€‚ å†çœ‹ä¸‹processDirectory,nativeæ–¹æ³• android_media_MediaScanner.cpp (base\\media\\jni) 12345678910111213141516171819202122232425262728static voidandroid_media_MediaScanner_processDirectory( JNIEnv *env, jobject thiz, jstring path, jobject client){ ALOGV(\"processDirectory\"); MediaScanner *mp = getNativeScanner_l(env, thiz); if (mp == NULL) { jniThrowException(env, kRunTimeException, \"No scanner available\"); return; } if (path == NULL) { jniThrowException(env, kIllegalArgumentException, NULL); return; } const char *pathStr = env-&gt;GetStringUTFChars(path, NULL); if (pathStr == NULL) { // Out of memory return; } MyMediaScannerClient myClient(env, client); MediaScanResult result = mp-&gt;processDirectory(pathStr, myClient); if (result == MEDIA_SCAN_RESULT_ERROR) { ALOGE(\"An error occurred while scanning directory '%s'.\", pathStr); } env-&gt;ReleaseStringUTFChars(path, pathStr);} ä»MediaScanner.javaä¸€ç›´è·Ÿè¿‡æ¥ï¼Œå¿˜è®°äº†MediaScanner.javaä¸­æœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å®¹ 1234static { System.loadLibrary(\"media_jni\"); native_init();} è¿™é‡ŒåŠ è½½libmedia_jni.soå³ä¸Šé¢ä¼šç”¨åˆ°çš„android_media_MediaScanner.cppå°±æ˜¯å­˜åœ¨äºè¿™ä¸ªsoä¸­ï¼Œ 1private static native final void native_init(); 123456789101112131415static voidandroid_media_MediaScanner_native_init(JNIEnv *env){ ALOGV(\"native_init\"); jclass clazz = env-&gt;FindClass(kClassMediaScanner); //è¿™é‡ŒæŒ‡çš„æ˜¯static const char* const kClassMediaScanner =\"android/media/MediaScanner\";ä¹Ÿå°±æ˜¯åé¢ä¼šç”¨åˆ°çš„MediaScanner.cpp if (clazz == NULL) { return; } fields.context = env-&gt;GetFieldID(clazz, \"mNativeContext\", \"J\"); if (fields.context == NULL) { return; }} åœ¨åˆ›å»ºMediaScannerå¯¹è±¡çš„è¿‡ç¨‹ä¸­ 123456789101112131415 public MediaScanner(Context c) { native_setup(); mContext = c; mPackageName = c.getPackageName(); mBitmapOptions.inSampleSize = 1; mBitmapOptions.inJustDecodeBounds = true; setDefaultRingtoneFileNames(); mExternalStoragePath = Environment.getExternalStorageDirectory().getAbsolutePath(); mExternalIsEmulated = Environment.isExternalStorageEmulated(); //mClient.testGenreNameConverter(); }......private native final void native_setup();//nativeæ–¹æ³• 12345678910111213static voidandroid_media_MediaScanner_native_setup(JNIEnv *env, jobject thiz){ ALOGV(\"native_setup\"); MediaScanner *mp = new StagefrightMediaScanner;//è¿™é‡Œé‡‡ç”¨çš„æ˜¯StagefrightMediaScanner if (mp == NULL) { jniThrowException(env, kRunTimeException, \"Out of memory\"); return; } env-&gt;SetLongField(thiz, fields.context, (jlong)mp);//setæ“ä½œä¸€ä¸‹ï¼Œåé¢ä¼šç”¨åˆ°} å†å›åˆ°processDirectoryæ–¹æ³•ä¸­æ¥ï¼Œ MediaScanner *mp = getNativeScanner_l(env, thiz);æ‹¿åˆ°MediaScanerçš„cppå¯¹è±¡ MyMediaScannerClient myClient(env, client); //åˆ›å»ºMyMediaScannerClientå¯¹è±¡ï¼Œè€Œè¿™é‡Œä¼ å…¥çš„clientæ˜¯MediaScanner.javaä¸­çš„MyMediaScannerClientå¯¹è±¡ MediaScanResult result = mp-&gt;processDirectory(pathStr, myClient); //æ‰§è¡ŒprocessDirectoryæ–¹æ³•ï¼Œä¼ å…¥myClientå¯¹è±¡ è¿™æ ·ä¼ æ¥ä¼ å»æ— éå°±æ˜¯æƒ³ä¿å­˜ä¸‹å½“å‰çš„javaä¾§çš„ä¸€ä¸ªclient,åé¢ä¼šæœ‰å¦™ç”¨ï¼Ÿ StagefrightMediaScannerç»§æ‰¿MediaScannerï¼Œæ²¡æœ‰å®ç°processDirectoryæ–¹æ³•ï¼Œä½¿ç”¨çš„æ˜¯çˆ¶ç±»ä¸­çš„æ–¹æ³• 12345678MediaScanResult MediaScanner::processDirectory( const char *path, MediaScannerClient &amp;client) { ...... MediaScanResult result = doProcessDirectory(pathBuffer, pathRemaining, client, false); free(pathBuffer); return result;} 123456789101112MediaScanResult MediaScanner::doProcessDirectory( char *path, int pathRemaining, MediaScannerClient &amp;client, bool noMedia) { ...... while ((entry = readdir(dir))) { if (doProcessDirectoryEntry(path, pathRemaining, client, noMedia, entry, fileSpot) == MEDIA_SCAN_RESULT_ERROR) { result = MEDIA_SCAN_RESULT_ERROR; break; } }} 123456789101112131415161718192021222324252627282930313233MediaScanResult MediaScanner::doProcessDirectoryEntry( char *path, int pathRemaining, MediaScannerClient &amp;client, bool noMedia, struct dirent* entry, char* fileSpot) { ...... if (type == DT_DIR) { //å¦‚æœæ˜¯ç›®å½•ï¼Œç»§ç»­éå†å­èŠ‚ç‚¹ bool childNoMedia = noMedia; // set noMedia flag on directories with a name that starts with '.' // for example, the Mac \".Trashes\" directory if (name[0] == '.') childNoMedia = true; // report the directory to the client if (stat(path, &amp;statbuf) == 0) { status_t status = client.scanFile(path, statbuf.st_mtime, 0, true /*isDirectory*/, childNoMedia); if (status) { return MEDIA_SCAN_RESULT_ERROR; } } // and now process its contents strcat(fileSpot, \"/\"); MediaScanResult result = doProcessDirectory(path, pathRemaining - nameLength - 1, client, childNoMedia); if (result == MEDIA_SCAN_RESULT_ERROR) { return MEDIA_SCAN_RESULT_ERROR; } } else if (type == DT_REG) { //å¦‚æœæ˜¯æ™®é€šæ–‡ä»¶ï¼Œæ‰§è¡ŒscanFileæ“ä½œ stat(path, &amp;statbuf); status_t status = client.scanFile(path, statbuf.st_mtime, statbuf.st_size, false /*isDirectory*/, noMedia); ...... } è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œä½¿ç”¨çš„clientå°±æ˜¯ä¹‹å‰ä¼ å…¥çš„å‚æ•°ï¼Œæœ€ç»ˆä¼šè°ƒç”¨ä¼šMediaScanner.javaä¸­MyMediaScannerClientä¸­çš„scanFileæ–¹æ³• 123456public void scanFile(String path, long lastModified, long fileSize, boolean isDirectory, boolean noMedia) { // This is the callback funtion from native codes. // Log.v(TAG, \"scanFile: \"+path); doScanFile(path, null, lastModified, fileSize, isDirectory, false, noMedia);} 123456789101112131415161718192021222324252627public Uri doScanFile(String path, String mimeType, long lastModified, long fileSize, boolean isDirectory, boolean scanAlways, boolean noMedia) { ...... try { FileEntry entry = beginFile(path, mimeType, lastModified, fileSize, isDirectory, noMedia); //beginFileåˆ›å»ºFileEntry ...... // rescan for metadata if file was modified since last scan if (entry != null &amp;&amp; (entry.mLastModifiedChanged || scanAlways)) { if (noMedia) { result = endFile(entry, false, false, false, false, false); } else { ...... // we only extract metadata for audio and video files if (isaudio || isvideo) { processFile(path, mimeType, this);//å¤„ç†éŸ³é¢‘è§†é¢‘æ–‡ä»¶ } if (isimage) { processImageFile(path);//å¤„ç†å›¾ç‰‡æ–‡ä»¶ } result = endFile(entry, ringtones, notifications, alarms, music, podcasts); } ...... } ä¸‹é¢çœ‹ä¸‹éŸ³é¢‘æ–‡ä»¶çš„å¤„ç† processFile(path, mimeType, this)ï¼Œæ³¨æ„è¿™é‡Œä¼ å…¥çš„å‚æ•°æœ‰è·¯å¾„å’Œmimetype 1private native void processFile(String path, String mimeType, MediaScannerClient client); è·Ÿåˆ°android_media_MediaScanner.cpp 12MyMediaScannerClient myClient(env, client);MediaScanResult result = mp-&gt;processFile(pathStr, mimeTypeStr, myClient); ç„¶åè·Ÿåˆ° StagefrightMediaScanner.cpp (av\\include\\media\\stagefright) 1234567891011MediaScanResult StagefrightMediaScanner::processFile( const char *path, const char *mimeType, MediaScannerClient &amp;client) { ALOGV(\"processFile '%s'.\", path); client.setLocale(locale()); client.beginFile(); MediaScanResult result = processFileInternal(path, mimeType, client); client.endFile(); return result;} 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960MediaScanResult StagefrightMediaScanner::processFileInternal( const char *path, const char * /* mimeType */, MediaScannerClient &amp;client) { ...... sp&lt;MediaMetadataRetriever&gt; mRetriever(new MediaMetadataRetriever); //åˆ›å»ºè§£æå®ä¾‹ int fd = open(path, O_RDONLY | O_LARGEFILE); status_t status; if (fd &lt; 0) { //è®¾ç½®æ•°æ®æº // couldn't open it locally, maybe the media server can? status = mRetriever-&gt;setDataSource(NULL /* httpService */, path); } else { status = mRetriever-&gt;setDataSource(fd, 0, 0x7ffffffffffffffL); close(fd); } ...... const char *value; if ((value = mRetriever-&gt;extractMetadata(//è§£æå…ƒæ•°æ® METADATA_KEY_MIMETYPE)) != NULL) { status = client.setMimeType(value); if (status) { return MEDIA_SCAN_RESULT_ERROR; } } struct KeyMap { const char *tag; int key; }; static const KeyMap kKeyMap[] = { { \"tracknumber\", METADATA_KEY_CD_TRACK_NUMBER }, { \"discnumber\", METADATA_KEY_DISC_NUMBER }, { \"album\", METADATA_KEY_ALBUM }, { \"artist\", METADATA_KEY_ARTIST }, { \"albumartist\", METADATA_KEY_ALBUMARTIST }, { \"composer\", METADATA_KEY_COMPOSER }, { \"genre\", METADATA_KEY_GENRE }, { \"title\", METADATA_KEY_TITLE }, { \"year\", METADATA_KEY_YEAR }, { \"duration\", METADATA_KEY_DURATION }, { \"writer\", METADATA_KEY_WRITER }, { \"compilation\", METADATA_KEY_COMPILATION }, { \"isdrm\", METADATA_KEY_IS_DRM }, { \"width\", METADATA_KEY_VIDEO_WIDTH }, { \"height\", METADATA_KEY_VIDEO_HEIGHT }, }; static const size_t kNumEntries = sizeof(kKeyMap) / sizeof(kKeyMap[0]); for (size_t i = 0; i &lt; kNumEntries; ++i) { const char *value; if ((value = mRetriever-&gt;extractMetadata(kKeyMap[i].key)) != NULL) { status = client.addStringTag(kKeyMap[i].tag, value); if (status != OK) { return MEDIA_SCAN_RESULT_ERROR; } } } return MEDIA_SCAN_RESULT_OK;} è¿™é‡Œåˆ›å»ºçš„MediaMetadataRetrieverå¹¶ä¸æ˜¯MediaMetadataRetriveræœ¬èº«ï¼Œè€Œæ˜¯ä¸€ä¸ªä¹‹ç±»ï¼ŒStagefrightMetadataRetriverï¼Œä¸­é—´æœ‰ä¸€ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ã€‚ 123456789101112131415MediaMetadataRetriever::MediaMetadataRetriever(){ ALOGV(\"constructor\"); const sp&lt;IMediaPlayerService&gt;&amp; service(getService()); if (service == 0) { ALOGE(\"failed to obtain MediaMetadataRetrieverService\"); return; } sp&lt;IMediaMetadataRetriever&gt; retriever(service-&gt;createMetadataRetriever()); //åˆ›å»ºå…ƒæ•°æ®è§£æå¯¹è±¡ if (retriever == 0) { ALOGE(\"failed to create IMediaMetadataRetriever object from server\"); } mRetriever = retriever;//èµ‹å€¼ç»™mRetriver} è¿™é‡Œçš„serviceæ˜¯MediaPlayerServiceï¼Œè¿™é‡Œä½¿ç”¨çš„ä»£ç†ï¼Œå®ç°ç›´æ¥çœ‹MediaPlayerService.cppä¸­çš„å‡½æ•° 12345678sp&lt;IMediaMetadataRetriever&gt; MediaPlayerService::createMetadataRetriever(){ pid_t pid = IPCThreadState::self()-&gt;getCallingPid(); sp&lt;MetadataRetrieverClient&gt; retriever = new MetadataRetrieverClient(pid); //è¿™é‡Œåˆ›å»ºäº†MetadataRetrieverClientå¯¹è±¡ ALOGV(\"Create new media retriever from pid %d\", pid); return retriever;} MetadataRetrieverClient.cpp (av\\media\\libmediaplayerservice) 12345678MetadataRetrieverClient::MetadataRetrieverClient(pid_t pid){ ALOGV(\"MetadataRetrieverClient constructor pid(%d)\", pid); mPid = pid; mThumbnail = NULL; mAlbumArt = NULL; mRetriever = NULL;} æ˜¾ç„¶ä¸Šé¢åˆ›å»ºçš„ä¸œè¥¿åªæ˜¯ä¸€ä¸ªç©ºå£³ï¼Œç»§ç»­å¾€ä¸‹çœ‹ åœ¨processFileInternalå‡½æ•°ä¸­setDataSourceå‡½æ•°ä¸­åŒæ ·ä¼šè·Ÿåˆ° 1234567891011121314151617181920status_t MetadataRetrieverClient::setDataSource(int fd, int64_t offset, int64_t length){ ...... player_type playerType = MediaPlayerFactory::getPlayerType(NULL /* client */, fd, offset, length); //è·å–playertypeæ–¹ä¾¿åé¢é€‰æ‹©å¯¹åº”çš„å…ƒæ•°æ®è§£æå™¨ ALOGV(\"player type = %d\", playerType); sp&lt;MediaMetadataRetrieverBase&gt; p = createRetriever(playerType);//åˆ›å»ºå®é™…çš„metadataretriver if (p == NULL) { ::close(fd); return NO_INIT; } status_t status = p-&gt;setDataSource(fd, offset, length); if (status == NO_ERROR) mRetriever = p; ::close(fd); return status;} 12345678910111213141516171819202122232425static sp&lt;MediaMetadataRetrieverBase&gt; createRetriever(player_type playerType){ sp&lt;MediaMetadataRetrieverBase&gt; p; switch (playerType) { case STAGEFRIGHT_PLAYER: case NU_PLAYER: { p = new StagefrightMetadataRetriever;//è¿™é‡Œæ‰æ˜¯æˆ‘ä»¬å®é™…ä½¿ç”¨çš„MedadataRetriver break; } case SONIVOX_PLAYER: ALOGV(\"create midi metadata retriever\"); p = new MidiMetadataRetriever(); break; default: // TODO: // support for TEST_PLAYER ALOGE(\"player type %d is not supported\", playerType); break; } if (p == NULL) { ALOGE(\"failed to create a retriever object\"); } return p;} StagefrightMetadataRetriever.cpp (av\\media\\libstagefright) é‚£ä¹ˆç„¶åæ‰§è¡ŒsetDataSouce() 1234567// Warning caller retains ownership of the filedescriptor! Dup it if necessary.status_t StagefrightMetadataRetriever::setDataSource( int fd, int64_t offset, int64_t length) { ...... mExtractor = MediaExtractor::Create(mSource);//åˆ›å»ºåª’ä½“è§£æå™¨ ......} setDataSouce()æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ä¸ç”¨ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é’ˆå¯¹åœ¨çº¿åª’ä½“çš„ ç„¶åå°±æ˜¯åˆ›å»ºåª’ä½“è§£æå™¨ MediaExtractor.cpp (av\\media\\libstagefright) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455sp&lt;MediaExtractor&gt; MediaExtractor::Create( const sp&lt;DataSource&gt; &amp;source, const char *mime) { ...... //å¦‚æœMimetypeä¸ºnull,åŒ¹é…å‡ºæœ€ç¬¦åˆçš„mimetype if (mime == NULL) { float confidence; if (!source-&gt;sniff(&amp;tmp, &amp;confidence, &amp;meta)) { ALOGV(\"FAILED to autodetect media content.\"); return NULL; } mime = tmp.string(); ALOGV(\"Autodetected media content as '%s' with confidence %.2f\", mime, confidence); } ...... MediaExtractor *ret = NULL; //ä¸åŒçš„mimetypeå¯¹åº”ä¸åŒçš„extractor if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_MPEG4) || !strcasecmp(mime, \"audio/mp4\")) { ret = new MPEG4Extractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_AUDIO_MPEG)) { ret = new MP3Extractor(source, meta); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_AUDIO_AMR_NB) || !strcasecmp(mime, MEDIA_MIMETYPE_AUDIO_AMR_WB)) { ret = new AMRExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_AUDIO_FLAC)) { ret = new FLACExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_WAV)) { ret = new WAVExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_OGG)) { ret = new OggExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_MATROSKA)) { ret = new MatroskaExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_MPEG2TS)) { ret = new MPEG2TSExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_WVM)) { // Return now. WVExtractor should not have the DrmFlag set in the block below. return new WVMExtractor(source); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_AUDIO_AAC_ADTS)) { ret = new AACExtractor(source, meta); } else if (!strcasecmp(mime, MEDIA_MIMETYPE_CONTAINER_MPEG2PS)) { ret = new MPEG2PSExtractor(source); } if (ret != NULL) { if (isDrm) { ret-&gt;setDrmFlag(true); } else { ret-&gt;setDrmFlag(false); } } return ret;} é’ˆå¯¹mimetypeä¸ºç©ºçš„æƒ…å†µ DataSource.cpp (av\\media\\libstagefright) 1234567891011121314151617181920212223242526272829bool DataSource::sniff( String8 *mimeType, float *confidence, sp&lt;AMessage&gt; *meta) { *mimeType = \"\";//mimetype *confidence = 0.0f;//å¯ä¿¡åº¦ meta-&gt;clear(); { Mutex::Autolock autoLock(gSnifferMutex); if (!gSniffersRegistered) {//å¦‚æœæ²¡æœ‰å—…æ¢å™¨ç›´æ¥return return false; } } for (List&lt;SnifferFunc&gt;::iterator it = gSniffers.begin(); it != gSniffers.end(); ++it) { String8 newMimeType; float newConfidence; sp&lt;AMessage&gt; newMeta; if ((*it)(this, &amp;newMimeType, &amp;newConfidence, &amp;newMeta)) { if (newConfidence &gt; *confidence) { *mimeType = newMimeType; *confidence = newConfidence; *meta = newMeta; } } } //éå†æ‰€æœ‰çš„å—…æ¢å™¨ï¼Œæ‰¾åˆ°å¯ä¿¡åº¦æœ€é«˜çš„ return *confidence &gt; 0.0;} åˆ°è¿™é‡Œå¯¹åº”çš„mimetypeå’Œextractoréƒ½æ˜ç¡®äº†ï¼Œå†å›åˆ°StagefrightMediaScanner.cppä¸­processFileInternalå‡½æ•°ï¼Œæ‰§è¡Œå®Œäº†setDataSouceï¼Œæ‰§è¡ŒextractMetadataï¼Œä¾ç„¶æ˜¯è·Ÿåˆ°StagefrightMetadataRetriver.cppä¸­ 123456789101112131415161718const char *StagefrightMetadataRetriever::extractMetadata(int keyCode) { if (mExtractor == NULL) { return NULL; } if (!mParsedMetaData) { parseMetaData();//å¦‚æœæ²¡æœ‰è§£æï¼Œå°±è§£æä¸€ä¸‹ mParsedMetaData = true;//æ ‡è¯†ä¸€ä¸‹ï¼Œå·²ç»è§£æè¿‡äº† } ssize_t index = mMetaData.indexOfKey(keyCode); if (index &lt; 0) { return NULL; } return mMetaData.valueAt(index).string();//å¦‚æœè§£æè¿‡å°±ç›´æ¥æ”¾å›å¯¹åº”çš„å†…å®¹å³å¯} å†çœ‹ä¸‹parseMetaDataå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¯”è¾ƒé•¿ï¼Œä¸»è¦çœ‹ä¸‹ä¸€éƒ¨åˆ† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849static const Map kMap[] = { { kKeyMIMEType, METADATA_KEY_MIMETYPE, NULL }, { kKeyCDTrackNumber, METADATA_KEY_CD_TRACK_NUMBER, \"tracknumber\" }, { kKeyDiscNumber, METADATA_KEY_DISC_NUMBER, \"discnumber\" }, { kKeyAlbum, METADATA_KEY_ALBUM, \"album\" }, { kKeyArtist, METADATA_KEY_ARTIST, \"artist\" }, { kKeyAlbumArtist, METADATA_KEY_ALBUMARTIST, \"albumartist\" }, { kKeyAuthor, METADATA_KEY_AUTHOR, NULL }, { kKeyComposer, METADATA_KEY_COMPOSER, \"composer\" }, { kKeyDate, METADATA_KEY_DATE, NULL }, { kKeyGenre, METADATA_KEY_GENRE, \"genre\" }, { kKeyTitle, METADATA_KEY_TITLE, \"title\" }, { kKeyYear, METADATA_KEY_YEAR, \"year\" }, { kKeyWriter, METADATA_KEY_WRITER, \"writer\" }, { kKeyCompilation, METADATA_KEY_COMPILATION, \"compilation\" }, { kKeyLocation, METADATA_KEY_LOCATION, NULL },};static const size_t kNumMapEntries = sizeof(kMap) / sizeof(kMap[0]);//åˆ›å»ºå­—ç¬¦é›†æ¢æµ‹å™¨ï¼Œè¿™ä¸ªå†…å®¹æ˜¯Lç‰ˆæœ¬æ–°åŠ çš„å†…å®¹CharacterEncodingDetector *detector = new CharacterEncodingDetector();for (size_t i = 0; i &lt; kNumMapEntries; ++i) { const char *value; if (meta-&gt;findCString(kMap[i].from, &amp;value)) { if (kMap[i].name) { // add to charset detector detector-&gt;addTag(kMap[i].name, value);//åŠ å…¥æ¢æµ‹å™¨ } else { // directly add to output list mMetaData.add(kMap[i].to, String8(value)); } }}detector-&gt;detectAndConvert();//æ¢æµ‹å™¨ä¸­æ‰§è¡Œå­—ç¬¦é›†çš„æ¢æµ‹å’Œè½¬æ¢int size = detector-&gt;size();if (size) { for (int i = 0; i &lt; size; i++) { const char *name; const char *value; detector-&gt;getTag(i, &amp;name, &amp;value); for (size_t j = 0; j &lt; kNumMapEntries; ++j) { if (kMap[j].name &amp;&amp; !strcmp(kMap[j].name, name)) { mMetaData.add(kMap[j].to, String8(value));//æœ€åçš„æ•°æ®ä¿å­˜ } } }} æ­¤å‡½æ•°ä¸­å…¶ä»–çš„å†…å®¹ä¹Ÿæ˜¯è§£æä¸€äº›å…¶ä»–çš„å…ƒæ•°æ®æŠ¥ä¿å­˜ä¸‹æ¥ã€‚ å†å›åˆ°processFileInternalä¸­ï¼Œåœ¨è§£æå®Œå…ƒæ•°æ®ä¹‹å 123456789for (size_t i = 0; i &lt; kNumEntries; ++i) { const char *value; if ((value = mRetriever-&gt;extractMetadata(kKeyMap[i].key)) != NULL) { status = client.addStringTag(kKeyMap[i].tag, value); if (status != OK) { return MEDIA_SCAN_RESULT_ERROR; } }} å°†æ•°æ®ä¸€ä¸ªä¸€ä¸ªé€šè¿‡clientçš„addStringTagå¾€ä¸Šä¼ é€’ï¼Œè·Ÿä¸‹æ­¤è¿‡ç¨‹ MediaScannerClient.cpp (av\\media\\libmedia) 12345status_t MediaScannerClient::addStringTag(const char* name, const char* value){ handleStringTag(name, value); return OK;} æœ€åä¼šå›åˆ°MediaScanner.javaä¸­çš„handleStringTag() 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public void handleStringTag(String name, String value) { if (name.equalsIgnoreCase(\"title\") || name.startsWith(\"title;\")) { // Don't trim() here, to preserve the special \\001 character // used to force sorting. The media provider will trim() before // inserting the title in to the database. mTitle = value; } else if (name.equalsIgnoreCase(\"artist\") || name.startsWith(\"artist;\")) { mArtist = value.trim(); } else if (name.equalsIgnoreCase(\"albumartist\") || name.startsWith(\"albumartist;\") || name.equalsIgnoreCase(\"band\") || name.startsWith(\"band;\")) { mAlbumArtist = value.trim(); } else if (name.equalsIgnoreCase(\"album\") || name.startsWith(\"album;\")) { mAlbum = value.trim(); } else if (name.equalsIgnoreCase(\"composer\") || name.startsWith(\"composer;\")) { mComposer = value.trim(); } else if (mProcessGenres &amp;&amp; (name.equalsIgnoreCase(\"genre\") || name.startsWith(\"genre;\"))) { mGenre = getGenreName(value); } else if (name.equalsIgnoreCase(\"year\") || name.startsWith(\"year;\")) { mYear = parseSubstring(value, 0, 0); } else if (name.equalsIgnoreCase(\"tracknumber\") || name.startsWith(\"tracknumber;\")) { // track number might be of the form \"2/12\" // we just read the number before the slash int num = parseSubstring(value, 0, 0); mTrack = (mTrack / 1000) * 1000 + num; } else if (name.equalsIgnoreCase(\"discnumber\") || name.equals(\"set\") || name.startsWith(\"set;\")) { // set number might be of the form \"1/3\" // we just read the number before the slash int num = parseSubstring(value, 0, 0); mTrack = (num * 1000) + (mTrack % 1000); } else if (name.equalsIgnoreCase(\"duration\")) { mDuration = parseSubstring(value, 0, 0); } else if (name.equalsIgnoreCase(\"writer\") || name.startsWith(\"writer;\")) { mWriter = value.trim(); } else if (name.equalsIgnoreCase(\"compilation\")) { mCompilation = parseSubstring(value, 0, 0); } else if (name.equalsIgnoreCase(\"isdrm\")) { mIsDrm = (parseSubstring(value, 0, 0) == 1); } else if (name.equalsIgnoreCase(\"width\")) { mWidth = parseSubstring(value, 0, 0); } else if (name.equalsIgnoreCase(\"height\")) { mHeight = parseSubstring(value, 0, 0); } else { //Log.v(TAG, \"unknown tag: \" + name + \" (\" + mProcessGenres + \")\"); }} å¯¹åº”çš„æ•°æ®å·²ç»è¢«ä¼ é€’åˆ°äº†Javaä¾§ï¼Œå‰©ä¸‹çš„å°±æ¯”è¾ƒå¥½å¤„ç†äº† æœ¬æ–‡åªæ˜¯è·Ÿäº†ä¸€æ¡å¤§è‡´çš„ä»£ç æµç¨‹ï¼Œå…ˆåˆ°æ­¤ï¼Œåç»­æœ‰å¯èƒ½è¿˜è¦æ›´æ–°ä¸€ä¸‹ã€‚ æœ¬æ–‡ä¸­ä»£ç ä½¿ç”¨çš„æ˜¯Android5.1åŸå§‹ä»£ç ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€äº¤æµã€‚","link":"/2015/10/07/ã€ŠAndroid Framework ä¹‹è·¯ã€‹Android5.1 MediaScanner/"},{"title":"ã€ŠAndroid å¼€æºåº“ã€‹ GreenDAO ç”¨æ³•è¯¦è§£ï¼ˆè¯‘æ–‡ï¼‰","text":"ç®€ä»‹greenDAOæ˜¯ä¸€ä¸ªå¼€æºçš„Android ORMï¼Œä½¿SQLiteæ•°æ®åº“çš„å¼€å‘å†æ¬¡å˜å¾—æœ‰è¶£ã€‚ å®ƒå‡è½»äº†å¼€å‘äººå‘˜å¤„ç†åº•å±‚çš„æ•°æ®åº“éœ€æ±‚ï¼ŒåŒæ—¶èŠ‚çœå¼€å‘æ—¶é—´ã€‚ SQLiteæ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„å…³ç³»å‹æ•°æ®åº“ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œç¼–å†™SQLå’Œè§£ææŸ¥è¯¢ç»“æœä»ç„¶æ˜¯ç›¸å½“ä¹å‘³å’Œè€—æ—¶çš„ä»»åŠ¡ã€‚ greenDAOé€šè¿‡å°†Javaå¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“è¡¨ï¼ˆç§°ä¸ºORMï¼Œâ€œå¯¹è±¡/å…³ç³»æ˜ å°„â€ï¼‰æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚ è¿™æ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç®€å•çš„é¢å‘å¯¹è±¡çš„APIæ¥å­˜å‚¨ï¼Œæ›´æ–°ï¼Œåˆ é™¤å’ŒæŸ¥è¯¢Javaå¯¹è±¡ã€‚ ç‰¹æ€§ æœ€é«˜æ€§èƒ½ï¼ˆå¯èƒ½æ˜¯Androidä¸­æœ€å¿«çš„ORMï¼‰; æˆ‘ä»¬çš„benchmarks ä¹Ÿæ˜¯å¼€æºçš„ æ¶µç›–å…³ç³»å’Œè¿æ¥ä¸”æ˜“ç”¨çš„å¼ºå¤§API æœ€å°çš„å†…å­˜å¼€é”€ è¿·ä½ å¼€æºåº“ï¼ˆ&lt;100KBï¼‰ï¼Œé™ä½å·¥ç¨‹æ„å»ºæ—¶é—´åŒæ—¶é¿å…65kæ–¹æ³•é™åˆ¶ æ•°æ®åº“åŠ å¯†ï¼šgreenDAOæ”¯æŒSQLCipherä»¥ä¿è¯ç”¨æˆ·çš„æ•°æ®å®‰å…¨ å¼ºå¤§çš„ç¤¾åŒºï¼šè¶…è¿‡5000 GitHubæ˜Ÿæ˜Ÿè¡¨æ˜æˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ªå¼ºå¤§è€Œæ´»è·ƒçš„ç¤¾åŒº å¼€å§‹ä½¿ç”¨å…¥é—¨æœ¬æ•™ç¨‹å°†å¼•å¯¼ä½ å®Œæˆä¸€ä¸ªç®€å•çš„greenDAOç¤ºä¾‹é¡¹ç›®DaoExampleã€‚ å…‹éš†ä»£ç å¹¶è¿è¡Œå®ƒï¼Œæˆ–è€…ç›´æ¥åœ¨GitHubä¸ŠæŸ¥çœ‹æ–‡ä»¶ã€‚ DaoExampleæ˜¯ä¸€ä¸ªç®€å•åœ°ç”¨æ¥è®°ç¬”è®°çš„Androidåº”ç”¨ç¨‹åºã€‚ ä½ å¯ä»¥é€šè¿‡é”®å…¥ä¸€äº›æ–‡æœ¬æ¥æ·»åŠ æ–°ç¬”è®°ï¼Œå¹¶é€šè¿‡ç‚¹å‡»ç°æœ‰ç¬”è®°åˆ é™¤ç¬”è®°ã€‚ 1. Noteå®ä½“å’ŒDAOç±»ä¸€èµ·çœ‹ä¸‹ä»£ç ï¼šåœ¨srcæ–‡ä»¶å¤¹ä¸­ï¼Œä½ ä¼šå‘ç°ä¸€ä¸ªå®ä½“ç±»Note.javaã€‚ å®ƒè¢«æŒä¹…åŒ–åˆ°æ•°æ®åº“å¹¶åŒ…å«Noteçš„æ‰€æœ‰æ•°æ®ï¼Œå¦‚idï¼Œæ³¨é‡Šæ–‡æœ¬å’Œåˆ›å»ºæ—¥æœŸã€‚ 123456789101112@Entity(indexes = { @Index(value = \"text, date DESC\", unique = true)})public class Note { @Id private Long id; @NotNull private String text; private Date date; ... é€šå¸¸ï¼Œå®ä½“æ˜¯åœ¨æ•°æ®åº“ä¸­æŒä¹…åŒ–çš„ç±»ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡çš„ä¸€è¡Œï¼‰ã€‚ å®ä½“åŒ…å«æ˜ å°„åˆ°æ•°æ®åº“åˆ—çš„å±æ€§ã€‚ ç°åœ¨å¼€å§‹ç¼–è¯‘å·¥ç¨‹ï¼Œä¾‹å¦‚åœ¨Android Studioä¸­ä½¿ç”¨â€œBuild&gt; Make projectâ€ã€‚ è¿™å°†è§¦å‘greenDAOæ¥ç”ŸæˆDAOç±»ï¼Œä¾‹å¦‚NoteDao.javaï¼Œè¿™å°†å¸®åŠ©æˆ‘ä»¬å‘æ•°æ®åº“æ·»åŠ ç¬”è®°ã€‚ 2. æ’å…¥å’Œåˆ é™¤ç¬”è®°è¦å­¦ä¹ å¦‚ä½•æ·»åŠ ä¸€äº›ç¬”è®°ï¼Œè¯·çœ‹ä¸€ä¸‹NoteActivityç±»ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºæˆ‘ä»¬çš„Noteç±»å‡†å¤‡ä¸€ä¸ªDAOå¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨onCreateï¼ˆï¼‰ä¸­åšï¼š 123// get the note DAODaoSession daoSession = ((App) getApplication()).getDaoSession();noteDao = daoSession.getNoteDao(); å½“ç”¨æˆ·å•å‡»æ·»åŠ æŒ‰é’®æ—¶ï¼Œå°†è°ƒç”¨addNote()æ–¹æ³•ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„Noteå¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™DAO insert()æ–¹æ³•ï¼Œä»¥å°†å…¶æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼š 123Note note = new Note(null, noteText, comment, new Date());noteDao.insert(note);Log.d(\"DaoExample\", \"Inserted new note, ID: \" + note.getId()); æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºç¬”è®°çš„æ—¶å€™æ²¡æœ‰ä¼ é€’idã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®åº“å†³å®šnote idã€‚ DAOè´Ÿè´£åœ¨ä»æ’å…¥æ“ä½œè¿”å›ä¹‹å‰è‡ªåŠ¨è®¾ç½®æ–°çš„IDï¼ˆè¯·å‚é˜…æ—¥å¿—è¯­å¥ï¼‰ã€‚ åˆ é™¤ç¬”è®°ä¹Ÿå¾ˆç®€å•ï¼Œå‚è§NoteClickListenerï¼š 1noteDao.deleteByKey(id); ä½ å¯ä»¥æ¢ç´¢NoteDaoçš„å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚loadAllï¼ˆï¼‰å’Œupdateï¼ˆï¼‰ã€‚ 3. è®¾ç½®æ•°æ®åº“ä½ å·²ç»çœ‹åˆ°äº†DAOï¼Œä½†æ˜¯å¦‚ä½•åˆå§‹åŒ–greenDAOå’Œåº•å±‚æ•°æ®åº“å‘¢ï¼Ÿ é€šå¸¸ä½ éœ€è¦initä¸€ä¸ªDaoSessionï¼Œå®ƒé€šå¸¸åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­çš„Applicationç±»ä¸­æ‰§è¡Œä¸€æ¬¡ï¼š 123DevOpenHelper helper = new DevOpenHelper(this, \"notes-db\");Database db = helper.getWritableDb();daoSession = new DaoMaster(db).newSession(); ä½¿ç”¨ç”Ÿæˆçš„DaoMasterç±»æä¾›çš„å¸®åŠ©å™¨ç±»DevOpenHelperåˆ›å»ºæ•°æ®åº“ã€‚ å®ƒæ˜¯DaoMasterä¸­çš„OpenHelperç±»çš„ä¸€ä¸ªå®ç°ï¼Œå®ƒä¸ºä½ åˆ›å»ºæ‰€æœ‰æ•°æ®åº“ã€‚ å†ä¹Ÿä¸éœ€è¦ç¼–å†™â€œCREATE TABLEâ€è¯­å¥ã€‚ ç„¶åActivityå’ŒFragmentå¯ä»¥è°ƒç”¨getDaoSession()æ¥è®¿é—®æ‰€æœ‰å®ä½“DAOï¼Œå’Œæˆ‘ä»¬ä¹‹å‰åœ¨æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™ä¸€æ ·ã€‚ 4. æ‰©å±•å’Œæ·»åŠ å®ä½“ä¸ºäº†æ‰©å±•æˆ‘ä»¬çš„ç¬”è®°æˆ–åˆ›å»ºæ–°å®ä½“ï¼Œä½ åªéœ€ä¿®æ”¹æˆ–åˆ›å»ºJavaç±»ï¼Œå¹¶ä»¥ç›¸åŒçš„æ–¹å¼æ³¨è§£å®ƒä»¬ã€‚ ç„¶åé‡æ–°ç¼–è¯‘é¡¹ç›®ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…å»ºæ¨¡å®ä½“ã€‚(è¿™ä¸ªä¸‹é¢å·²ç»ç¿»è¯‘å‡ºæ¥) ä»‹ç»greenDAOæ˜¯Androidçš„å¯¹è±¡/å…³ç³»æ˜ å°„ï¼ˆORMï¼‰å·¥å…·ã€‚ å®ƒä¸ºå…³ç³»æ•°æ®åº“SQLiteæä¾›äº†ä¸€ä¸ªé¢å‘å¯¹è±¡çš„æ¥å£ã€‚åƒgreenDAOä¸€ç±»çš„ORMå·¥å…·ä¸ºä½ åšå¾ˆå¤šé‡å¤æ€§çš„ä»»åŠ¡ï¼Œæä¾›ç®€å•çš„æ•°æ®æ¥å£ã€‚ 1. Gradleæ’ä»¶å’ŒDAOä»£ç ç”Ÿæˆä¸ºäº†åœ¨ä½ çš„Androidé¡¹ç›®ä¸­ä½¿ç”¨greenDAOï¼Œä½ éœ€è¦æ·»åŠ greenDAO Gradleæ’ä»¶å¹¶æ·»åŠ greenDAOåº“ï¼š 123456789101112131415buildscript { repositories { mavenCentral() } dependencies { classpath 'org.greenrobot:greendao-gradle-plugin:3.2.1' }}apply plugin: 'com.android.application'apply plugin: 'org.greenrobot.greendao'dependencies { compile 'org.greenrobot:greendao:3.2.0'} ç„¶åè¿›è¡Œå®ä½“å»ºæ¨¡ä¹Ÿå°±æ˜¯åˆ›å»ºå®ä½“ï¼Œå¹¶ç¼–è¯‘é¡¹ç›®ï¼Œä¾‹å¦‚åœ¨Android Studioä¸­ä½¿ç”¨â€œBuild&gt; Make Projectâ€ã€‚ 2. æ ¸å¿ƒç±» ä¸€æ—¦é¡¹ç›®æ„å»ºå®Œæ¯•ï¼Œä½ å°±å¯ä»¥åœ¨Androidé¡¹ç›®ä¸­å¼€å§‹ä½¿ç”¨greenDAOäº†ã€‚ ä»¥ä¸‹æ ¸å¿ƒç±»æ˜¯greenDAOçš„åŸºæœ¬æ¥å£ï¼š DaoMasterï¼šä½¿ç”¨greenDAOçš„åˆ‡å…¥ç‚¹ã€‚ DaoMasterä¿å­˜æ•°æ®åº“å¯¹è±¡ï¼ˆSQLiteDatabaseï¼‰å¹¶ç®¡ç†ç‰¹å®šæ¨¡å¼çš„DAOç±»ï¼ˆè€Œä¸æ˜¯å¯¹è±¡ï¼‰ã€‚ å®ƒæœ‰é™æ€æ–¹æ³•æ¥åˆ›å»ºè¡¨æˆ–åˆ é™¤å®ƒä»¬ã€‚ å®ƒçš„å†…éƒ¨ç±»OpenHelperå’ŒDevOpenHelperéƒ½æ˜¯SQLiteOpenHelperçš„å®ç°ï¼Œç”¨æ¥åœ¨SQLiteæ•°æ®åº“ä¸­åˆ›å»ºæ¨¡å¼ã€‚ DaoSessionï¼šç®¡ç†ç‰¹å®šæ¨¡å¼çš„æ‰€æœ‰å¯ç”¨DAOå¯¹è±¡ï¼Œä½ å¯ä»¥ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªçš„getteræ–¹æ³•è·å–DAOå¯¹è±¡ã€‚ DaoSessionè¿˜ä¸ºå®ä½“æä¾›äº†ä¸€äº›é€šç”¨çš„æŒä¹…æ€§æ–¹æ³•ï¼Œå¦‚æ’å…¥ï¼ŒåŠ è½½ï¼Œæ›´æ–°ï¼Œåˆ·æ–°å’Œåˆ é™¤ã€‚ æœ€åï¼ŒDaoSessionå¯¹è±¡ä¹Ÿè·Ÿè¸ªidentity scopeã€‚ æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä¼šè¯æ–‡æ¡£ DAOï¼šæ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ï¼Œç”¨äºå®ä½“çš„æŒä¹…åŒ–å’ŒæŸ¥è¯¢ã€‚ å¯¹äºæ¯ä¸ªå®ä½“ï¼ŒgreenDAOä¼šç”Ÿæˆä¸€ä¸ªDAOã€‚ å®ƒæ¯”DaoSessionæ‹¥æœ‰æ›´å¤šçš„æŒä¹…åŒ–æ–¹æ³•ï¼Œä¾‹å¦‚ï¼šcountï¼ŒloadAllå’ŒinsertInTxã€‚ å®ä½“ï¼šå¯æŒä¹…åŒ–å¯¹è±¡ã€‚ é€šå¸¸ï¼Œå®ä½“æ˜¯ä½¿ç”¨æ ‡å‡†Javaå±æ€§ï¼ˆå¦‚POJOæˆ–JavaBeanï¼‰è¡¨ç¤ºæ•°æ®åº“è¡Œçš„å¯¹è±¡ã€‚ 3. æ ¸å¿ƒåˆå§‹åŒ–æœ€åï¼Œä»¥ä¸‹ä»£ç ç¤ºä¾‹è¯´æ˜äº†åˆå§‹åŒ–æ•°æ®åº“å’Œæ ¸å¿ƒgreenDAOç±»çš„ç¬¬ä¸€æ­¥ 1234567//åšä¸€æ¬¡ï¼Œä¾‹å¦‚åœ¨ä½ çš„Applicationç±»ä¸­helper = new DaoMaster.DevOpenHelperï¼ˆthisï¼Œâ€œnotes-dbâ€ï¼Œnullï¼‰;db = helper.getWritableDatabaseï¼ˆï¼‰;daoMaster = new DaoMasterï¼ˆdbï¼‰;daoSession = daoMaster.newSessionï¼ˆï¼‰;//åœ¨æ‚¨çš„æ´»åŠ¨/ç‰‡æ®µä¸­æ‰§è¡Œæ­¤æ“ä½œä»¥è·å–DAOnoteDao = daoSession.getNoteDaoï¼ˆï¼‰; è¯¥ç¤ºä¾‹å‡è®¾å­˜åœ¨ä¸€ä¸ªNoteå®ä½“ã€‚ æœ‰äº†å®ƒçš„DAOï¼ˆnoteDaoå¯¹è±¡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨è¿™ä¸ªç‰¹å®šå®ä½“çš„æŒä¹…åŒ–æ“ä½œã€‚ å®ä½“å»ºæ¨¡è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨greenDAOï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºåº”ç”¨ç¨‹åºä¸­æŒä¹…æ•°æ®çš„å®ä½“æ¨¡å‹ã€‚ ç„¶åï¼ŒåŸºäºæ­¤æ¨¡å‹ï¼ŒgreenDAOä¸ºDAOç±»ç”ŸæˆJavaä»£ç ã€‚æ¨¡å‹æœ¬èº«æ˜¯ä½¿ç”¨å¸¦æœ‰æ³¨è§£çš„Javaç±»å®šä¹‰çš„ã€‚è¦ä½¿ç”¨æ—§å¼ç”Ÿæˆå™¨åˆ›å»ºæ¨¡å¼ï¼Œè¯·å‚é˜…ç”Ÿæˆå™¨ã€‚ ä¸‹ä¾§çš„å›¾ç¤ºæè¿°äº†greenDAOæ‰€åŸºäºçš„å…ƒæ¨¡å‹ã€‚ 1. æ¨¡å¼æ— éœ€ä»»ä½•å…¶ä»–é…ç½®å°±å¯ä»¥å¼€å§‹ä½¿ç”¨greenDAO Gradleæ’ä»¶ã€‚ä½†æ˜¯ï¼Œè‡³å°‘åº”è¯¥åƒä¸‹é¢è¿™æ ·è®¾ç½®ä¸‹æ¨¡å¼ç‰ˆæœ¬ï¼š 12345678// In the build.gradle file of your app project:android {...} greendao { schemaVersion 2} æ­¤å¤–ï¼Œgreendaoé…ç½®å…ƒç´ æ”¯æŒä¸€ç³»åˆ—é…ç½®é€‰é¡¹ï¼š schemaVersionï¼šæ•°æ®åº“æ¨¡å¼çš„å½“å‰ç‰ˆæœ¬ã€‚ è¿™ç”±* OpenHelpersç±»ç”¨äºåœ¨æ¨¡å¼ç‰ˆæœ¬ä¹‹é—´è¿ç§»ã€‚ å¦‚æœæ›´æ”¹å®ä½“/æ•°æ®åº“æ¨¡å¼ï¼Œåˆ™å¿…é¡»å¢åŠ æ­¤å€¼ã€‚ é»˜è®¤å€¼ä¸º1ã€‚ daoPackageï¼šç”Ÿæˆçš„DAOï¼ŒDaoMasterå’ŒDaoSessionçš„åŒ…åç§°ã€‚ é»˜è®¤ä¸ºæºå®ä½“çš„åŒ…åç§°ã€‚ targetGenDirï¼šç”Ÿæˆçš„æºç åº”å­˜å‚¨åœ¨çš„ä½ç½®ã€‚ é»˜è®¤ä¸ºç”Ÿæˆç›®å½•ï¼ˆbuild / generated / source / greendaoï¼‰ä¸­ç”Ÿæˆçš„æºæ–‡ä»¶å¤¹ã€‚ generateTestsï¼šè®¾ç½®ä¸ºtrueä»¥è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ã€‚ targetGenDirTestsï¼šç”Ÿæˆçš„å•å…ƒæµ‹è¯•åº”å­˜å‚¨åœ¨çš„åŸºæœ¬ç›®å½•ã€‚ é»˜è®¤ä¸ºsrc / androidTest / javaã€‚ 2. å®ä½“å’Œæ³¨è§£greenDAO 3ä½¿ç”¨æ³¨è§£æ¥å®šä¹‰æ¨¡å¼å’Œå®ä½“ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 123456789101112@Entitypublic class User { @Id private Long id; private String name; @Transient private int tempUsageCount; // not persisted // getters and setters for id and user ...} @Entityæ³¨è§£å°†Javaç±»Userè½¬æ¢ä¸ºæ•°æ®åº“æ”¯æŒçš„å®ä½“ã€‚ è¿™ä¹Ÿå°†æŒ‡ç¤ºgreenDAOç”Ÿæˆå¿…è¦çš„ä»£ç ï¼ˆä¾‹å¦‚DAOï¼‰ã€‚ æ³¨æ„ï¼šä»…æ”¯æŒJavaç±»ã€‚ å¦‚æœä½ å–œæ¬¢å¦ä¸€ç§è¯­è¨€ï¼Œå¦‚Kotlinï¼Œä½ çš„å®ä½“ç±»ä»ç„¶å¿…é¡»æ˜¯Javaã€‚ 5. @Entity æ³¨è§£æ­£å¦‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­çœ‹åˆ°çš„ï¼Œ@Entityæ³¨è§£å°†Javaç±»æ ‡è®°ä¸ºgreenDAOçš„æŒä¹…åŒ–çš„å®ä½“ã€‚ è™½ç„¶é€šå¸¸æ²¡æœ‰ä»»ä½•é¢å¤–çš„å‚æ•°ï¼Œåœ¨ä½¿ç”¨@Entityçš„æ—¶å€™ä½ ä»ç„¶å¯ä»¥é…ç½®ä¸€äº›ç»†èŠ‚ï¼š 123456789101112131415161718192021222324252627282930313233@Entity( // If you have more than one schema, you can tell greenDAO // to which schema an entity belongs (pick any string as a name). schema = \"myschema\", // Flag to make an entity \"active\": Active entities have update, // delete, and refresh methods. active = true, // Specifies the name of the table in the database. // By default, the name is based on the entities class name. nameInDb = \"AWESOME_USERS\", // Define indexes spanning multiple columns here. indexes = { @Index(value = \"name DESC\", unique = true) }, // Flag if the DAO should create the database table (default is true). // Set this to false, if you have multiple entities mapping to one table, // or the table creation is done outside of greenDAO. createInDb = false, // Whether an all properties constructor should be generated. // A no-args constructor is always required. generateConstructors = true, // Whether getters and setters for properties should be generated if missing. generateGettersSetters = true)public class User { ...} æ³¨æ„ï¼Œå½“ä½¿ç”¨Gradleæ’ä»¶æ—¶ï¼Œç›®å‰ä¸æ”¯æŒå¤šä¸ªæ¨¡å¼ã€‚ æš‚æ—¶ï¼Œç»§ç»­ä½¿ç”¨ä½ çš„ç”Ÿæˆå™¨é¡¹ç›®ã€‚ 5. åŸºæœ¬å±æ€§12345678910111213141516@Entitypublic class User { @Id(autoincrement = true) private Long id; @Property(nameInDb = \"USERNAME\") private String name; @NotNull private int repos; @Transient private int tempUsageCount; ...} @Idæ³¨è§£é€‰æ‹©long / Longå±æ€§ä½œä¸ºå®ä½“IDã€‚ åœ¨æ•°æ®åº“æœ¯è¯­ä¸­ï¼Œå®ƒæ˜¯ä¸»é”®ã€‚ å‚æ•°autoincrementæ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œä½¿IDå€¼ä¸æ–­å¢åŠ ï¼ˆä¸é‡ç”¨æ—§å€¼ï¼‰ã€‚ @Propertyå…è®¸ä½ å®šä¹‰ä¸€ä¸ªå½“å‰å±æ€§æ˜ å°„åˆ°çš„æ•°æ®åº“åˆ—çš„éé»˜è®¤åç§°ã€‚ å¦‚æœä¸ºç©ºï¼ŒgreenDAOå°†ä»¥SQL-ishæ–¹å¼ä½¿ç”¨å­—æ®µåï¼ˆå¤§å†™å­—æ¯ï¼Œä¸‹åˆ’çº¿ä»£æ›¿é©¼å³°ï¼Œä¾‹å¦‚customNameå°†æˆä¸ºCUSTOM_NAMEï¼‰ã€‚ æ³¨æ„ï¼šå½“å‰åªèƒ½ä½¿ç”¨å†…è”å¸¸é‡æ¥æŒ‡å®šåˆ—åç§°ã€‚ @NotNullä½¿å±æ€§åœ¨æ•°æ®åº“ç«¯ä¸ºâ€œNOT NULLâ€åˆ—ã€‚ é€šå¸¸ï¼Œä½¿ç”¨@NotNullæ ‡è®°åŸå§‹ç±»å‹ï¼ˆlongï¼Œintï¼Œshortï¼Œbyteï¼‰ï¼ŒåŒæ—¶ä½¿ç”¨å°è£…ç±»ï¼ˆLongï¼ŒIntegerï¼ŒShortï¼ŒByteï¼‰å¯ä»¥ä½¿ç”¨ç©ºå€¼ã€‚ @Transientæ ‡è®°è¦ä»æŒä¹…æ€§ä¸­æ’é™¤çš„å±æ€§ã€‚ å°†å®ƒä»¬ç”¨äºä¸´æ—¶çŠ¶æ€ç­‰ã€‚æˆ–è€…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Javaä¸­çš„transientå…³é”®å­—ã€‚ 6. ä¸»é”®é™åˆ¶ç›®å‰ï¼Œå®ä½“å¿…é¡»å…·æœ‰longæˆ–Longå±æ€§ä½œä¸ºå…¶ä¸»é”®ã€‚ è¿™æ˜¯Androidå’ŒSQLiteçš„æ¨èåšæ³•ã€‚ è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·å°†ä½ çš„é”®å±æ€§å®šä¹‰ä¸ºå…¶ä»–å±æ€§ï¼Œä½†ä¸ºå…¶åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼š 12345@Idprivate Long id; @Index(unique = true)private String key; 7. å±æ€§ç´¢å¼•åœ¨å±æ€§ä¸­ä½¿ç”¨@Indexå¯ä¸ºç›¸åº”çš„æ•°æ®åº“åˆ—åˆ›å»ºæ•°æ®åº“ç´¢å¼•ã€‚ ä½¿ç”¨ä»¥ä¸‹å‚æ•°è‡ªå®šä¹‰ï¼š nameï¼šå¦‚æœä½ ä¸å–œæ¬¢greenDAOä¸ºç´¢å¼•ç”Ÿæˆçš„é»˜è®¤åç§°ï¼Œä½ å¯ä»¥åœ¨è¿™é‡ŒæŒ‡å®šä½ çš„åå­—ã€‚uniqueï¼šå‘ç´¢å¼•æ·»åŠ UNIQUEçº¦æŸï¼Œå¼ºåˆ¶æ‰€æœ‰å€¼æ˜¯å”¯ä¸€çš„ã€‚ 123456@Entitypublic class User { @Id private Long id; @Index(unique = true) private String name;} @Uniqueå‘æ•°æ®åº“åˆ—æ·»åŠ UNIQUEçº¦æŸã€‚ æ³¨æ„ï¼ŒSQLiteä¹Ÿéšå¼åœ°ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªç´¢å¼•ã€‚ 12345@Entitypublic class User { @Id private Long id; @Unique private String name;} 8. é»˜è®¤å€¼greenDAOå°è¯•ä½¿ç”¨åˆç†çš„é»˜è®¤å€¼ï¼Œä»¥ä¾¿å¼€å‘äººå‘˜æ¯ä¸ªéƒ½ä¸€ä¸€é…ç½®ã€‚ ä¾‹å¦‚ï¼Œæ•°æ®åº“ä¾§çš„è¡¨å’Œåˆ—åç§°æ´¾ç”Ÿè‡ªå®ä½“å’Œå±æ€§åç§°ã€‚ è€Œä¸æ˜¯åœ¨Javaä¸­ä½¿ç”¨çš„éª†é©¼æ¡ˆä¾‹æ ·å¼ï¼Œé»˜è®¤æ•°æ®åº“åç§°ä½¿ç”¨å¤§å†™ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ã€‚ ä¾‹å¦‚ï¼Œåä¸ºcreationDateçš„å±æ€§å°†æˆä¸ºæ•°æ®åº“åˆ—CREATION_DATE 9. å…³ç³»è¦äº†è§£å¦‚ä½•æ·»åŠ ä¸€å¯¹ä¸€å’Œå¤šå¯¹å¤šå…³ç³»ï¼Œè¯·å‚é˜…å…³ç³»(ä¸‹é¢å·²ç»ç¿»è¯‘) 10. è§¦å‘ç”Ÿæˆä¸€æ—¦å®ä½“æ¨¡å¼å°±ä½ï¼Œä½ å°±å¯ä»¥é€šè¿‡åœ¨IDEä¸­ä½¿ç”¨â€œMake projectâ€æ¥è§¦å‘ä»£ç ç”Ÿæˆè¿‡ç¨‹ã€‚ æˆ–è€…ç›´æ¥æ‰§è¡Œgreendao Gradleä»»åŠ¡ã€‚ å¦‚æœåœ¨æ›´æ”¹å®ä½“ç±»ä¹‹åé‡åˆ°é”™è¯¯ï¼Œè¯·å°è¯•é‡æ–°ç”Ÿæˆé¡¹ç›®ï¼Œä»¥ç¡®ä¿æ¸…é™¤æ—§ç”Ÿæˆçš„ç±»ã€‚ 11. ä¿®æ”¹ç”Ÿæˆçš„ä»£ç greenDAO 3ä¸­çš„å®ä½“ç±»ç”±å¼€å‘äººå‘˜åˆ›å»ºå’Œç¼–è¾‘ã€‚ ç„¶è€Œï¼Œåœ¨ä»£ç ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼ŒgreenDAOå¯èƒ½ä¼šå¢åŠ å®ä½“çš„æºä»£ç ã€‚ greenDAOå°†ä¸ºå®ƒåˆ›å»ºçš„æ–¹æ³•å’Œå­—æ®µæ·»åŠ ä¸€ä¸ª@Generatedæ³¨è§£ï¼Œä»¥é€šçŸ¥å¼€å‘äººå‘˜å¹¶é˜²æ­¢ä»»ä½•ä»£ç ä¸¢å¤±ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸å¿…å…³å¿ƒä½¿ç”¨@Generatedæ³¨è§£çš„ä»£ç ã€‚ ä½œä¸ºé¢„é˜²æªæ–½ï¼ŒgreenDAOä¸ä¼šè¦†ç›–ç°æœ‰ä»£ç ï¼Œå¹¶ä¸”å¦‚æœæ‰‹åŠ¨æ›´æ”¹ç”Ÿæˆçš„ä»£ç ä¼šå¼•å‘é”™è¯¯ï¼š 1234Error:Execution failed for task &apos;:app:greendao&apos;.&gt; Constructor (see ExampleEntity:21) has been changed after generation.Please either mark it with @Keep annotation instead of @Generated to keep it untouched,or use @Generated (without hash) to allow to replace it. æ­£å¦‚é”™è¯¯æ¶ˆæ¯æ‰€æš—ç¤ºçš„ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼š å°†æ›´æ”¹è¿˜åŸä¸ºä½¿ç”¨@Generatedæ³¨è§£çš„ä»£ç ã€‚ æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥å®Œå…¨åˆ é™¤æ›´æ”¹çš„æ„é€ å‡½æ•°æˆ–æ–¹æ³•ã€‚ å®ƒä»¬å°†ä¸ä¸‹ä¸€ä¸ªç‰ˆæœ¬é‡æ–°ç”Ÿæˆã€‚ ä½¿ç”¨@Keepæ³¨è§£æ›¿æ¢@Generatedæ³¨è§£ã€‚ è¿™å°†å‘Šè¯‰greenDAOæ°¸è¿œä¸è¦è§¦æ‘¸å¸¦æ³¨è§£çš„ä»£ç ã€‚ è¯·è®°ä½ï¼Œä½ çš„æ›´æ”¹å¯èƒ½ä¼šä¸­æ–­å®ä½“å’Œå…¶ä»–greenDAOä¹‹é—´çš„çº¦å®šã€‚ æ­¤å¤–ï¼Œæœªæ¥çš„greenDAOç‰ˆæœ¬å¯èƒ½æœŸæœ›ç”Ÿæˆçš„æ–¹æ³•ä¸­æœ‰ä¸åŒçš„ä»£ç ã€‚ æ‰€ä»¥ï¼Œè¦è°¨æ…ï¼ã€‚åŒæ—¶é‡‡ç”¨å•å…ƒæµ‹è¯•çš„æ–¹æ³•æ¥é¿å…éº»çƒ¦æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ 12. ä¿ç•™éƒ¨åˆ†ä¸å†æ”¯æŒæ—§ç‰ˆæœ¬çš„greenDAOä¸­ä½¿ç”¨çš„KEEPã€‚ ä½†æ˜¯ï¼Œå¦‚æœGradleæ’ä»¶æ£€æµ‹åˆ°KEEP FIELDSéƒ¨åˆ†ï¼Œå®ƒå°†è‡ªåŠ¨ä½¿ç”¨@Transientæ³¨é‡Šå­—æ®µã€‚ ä¹‹åï¼Œå¯èƒ½ä¼šåˆ é™¤å‘¨å›´çš„KEEP FIELDSæ³¨é‡Šã€‚ ä¼šè¯å’Œä¼šè¯çš„identity scopeï¼ˆç”Ÿæˆçš„ï¼‰DaoSessionç±»æ˜¯greenDAOçš„ä¸­å¿ƒæ¥å£ä¹‹ä¸€ã€‚ DaoSessionæä¾›å¼€å‘äººå‘˜è®¿é—®åŸºæœ¬å®ä½“æ“ä½œå’Œç›¸è¾ƒäºDAOçš„æ›´å®Œæ•´çš„æ“ä½œé›†åˆã€‚ æ­¤å¤–ï¼Œä¼šè¯è¿˜ç®¡ç†å®ä½“çš„identity scopeã€‚ 1. DaoMaster and DaoSessionå¦‚â€œå…¥é—¨â€éƒ¨åˆ†æ‰€è¿°ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªDaoMasterä»¥è·å–DaoSessionï¼š 12daoMaster = new DaoMaster(db);daoSession = daoMaster.newSession(); è¯·æ³¨æ„ï¼Œæ•°æ®åº“è¿æ¥å±äºDaoMasteréƒ¨åˆ†ï¼Œå› æ­¤å¤šä¸ªä¼šè¯æŒ‡çš„æ˜¯åŒä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›¸å½“å¿«åœ°åˆ›å»ºæ–°ä¼šè¯ã€‚ ä½†æ˜¯ï¼Œæ¯ä¸ªä¼šè¯å¾—åˆ†é…å­˜å‚¨ç©ºé—´ï¼Œç‰¹åˆ«æ˜¯å®ä½“çš„ä¼šè¯â€œç¼“å­˜â€ã€‚ 2. Identity scope å’Œä¼šè¯ç¼“å­˜å¦‚æœæœ‰ä¸¤ä¸ªæŸ¥è¯¢è¿”å›ç›¸åŒçš„æ•°æ®åº“å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨å¤šå°‘ä¸ªJavaå¯¹è±¡ï¼šä¸€ä¸ªæˆ–ä¸¤ä¸ªï¼Ÿ å®ƒå®Œå…¨å–å†³äºIdentity scopeã€‚ greenDAOä¸­çš„é»˜è®¤å€¼ï¼ˆè¡Œä¸ºæ˜¯å¯é…ç½®çš„ï¼‰æ˜¯å¤šä¸ªæŸ¥è¯¢è¿”å›å¯¹åŒä¸€Javaå¯¹è±¡çš„å¼•ç”¨ã€‚ ä¾‹å¦‚ï¼Œä»IDä¸º42çš„USERè¡¨ä¸­åŠ è½½Userå¯¹è±¡ä¼šä¸ºè¿™ä¸¤ä¸ªæŸ¥è¯¢è¿”å›ç›¸åŒçš„Javaå¯¹è±¡ã€‚ è¿™ç§æ–¹å¼çš„å‰¯ä½œç”¨æ˜¯æŸç§å®ä½“â€œç¼“å­˜â€ã€‚ å¦‚æœå®ä½“å¯¹è±¡åœ¨å†…å­˜ä¸­ä»ç„¶å­˜åœ¨ï¼ˆgreenDAOåœ¨è¿™é‡Œä½¿ç”¨å¼±å¼•ç”¨ï¼‰ï¼Œåˆ™ä¸ä¼šå†æ¬¡æ„é€ è¯¥å®ä½“ã€‚ æ­¤å¤–ï¼ŒgreenDAOä¸æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢ä»¥æ›´æ–°å®ä½“å€¼ã€‚ ç›¸åï¼Œå¯¹è±¡ä»ä¼šè¯é«˜é€Ÿç¼“å­˜â€œç«‹å³â€è¿”å›ï¼Œè¿™ä¸ªé€Ÿåº¦æ˜¯ç›¸å½“å¿«çš„ã€‚ 3. æ¸…é™¤identity scopeè¦æ¸…é™¤æ•´ä¸ªä¼šè¯çš„identity scopeï¼Œä»¥ä¾¿ä¸è¿”å›â€œç¼“å­˜â€å¯¹è±¡ï¼š 1daoSession.clear(); æ¸…é™¤å•ä¸ªDAOçš„identity scopeï¼š 12noteDao = daoSession.getNoteDao();noteDao.detachAll(); 4. æ¦‚å¿µæœ¬æ–‡æ¡£é¡µé¢å½“å‰ä¿¡æ¯æœ‰é™ã€‚ è¯·å‚è€ƒHibernateä¼šè¯ä»¥æŒæ¡ä¼šè¯å’Œidentiry scopeçš„å®Œæ•´æ¦‚å¿µã€‚ æŸ¥è¯¢å’ŒæŸ¥è¯¢æ„å»ºå™¨æŸ¥è¯¢è¿”å›ç¬¦åˆç‰¹å®šæ¡ä»¶çš„å®ä½“ã€‚ åœ¨greenDAOä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨åŸå§‹SQLæ¥åˆ¶å®šæŸ¥è¯¢ï¼Œæˆ–è€…ä½¿ç”¨QueryBuilder APIï¼Œç›¸å¯¹è€Œè¨€åè€…ä¼šæ›´å®¹æ˜“ã€‚ æ­¤å¤–ï¼ŒæŸ¥è¯¢æ”¯æŒæ‡’åŠ è½½ç»“æœï¼Œå½“åœ¨å¤§ç»“æœé›†ä¸Šæ“ä½œæ—¶ï¼Œå¯ä»¥èŠ‚çœå†…å­˜å’Œæ€§èƒ½ã€‚ 1. æŸ¥è¯¢æ„å»ºå™¨ç¼–å†™SQLå¯èƒ½å¾ˆå›°éš¾ï¼Œå¹¶ä¸”å®¹æ˜“å‡ºç°é”™è¯¯ï¼Œè¿™äº›é”™è¯¯ä»…åœ¨è¿è¡Œæ—¶è¢«å¯Ÿè§‰ã€‚ QueryBuilderç±»å…è®¸ä½ ä¸ºæ²¡æœ‰SQLçš„å®ä½“æ„å»ºè‡ªå®šä¹‰æŸ¥è¯¢ï¼Œå¹¶å¸®åŠ©åœ¨ç¼–è¯‘æ—¶æ£€æµ‹é”™è¯¯ã€‚ ç®€å•æ¡ä»¶ç¤ºä¾‹ï¼šæŸ¥è¯¢æ‰€æœ‰åä¸ºâ€œJoeâ€çš„ç”¨æˆ·ï¼ŒæŒ‰å§“æ°æ’åºï¼š 1234List&lt;User&gt; joes = userDao.queryBuilder() .where(Properties.FirstName.eq(\"Joe\")) .orderAsc(Properties.LastName) .list(); åµŒå¥—æ¡ä»¶ç¤ºä¾‹ï¼šè·å–1970å¹´10æœˆæˆ–ä¹‹åå‡ºç”Ÿçš„åä¸ºâ€œJoeâ€çš„ç”¨æˆ·ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·çš„ç”Ÿæ—¥ä½œä¸ºå¹´ï¼Œæœˆå’Œæ—¥çš„å•ç‹¬å±æ€§ã€‚ ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´æ­£å¼çš„æ–¹å¼è¡¨ç¤ºæ¡ä»¶ï¼šåå­—æ˜¯â€œJoeâ€ANDï¼ˆå‡ºç”Ÿå¹´ä»½å¤§äº1970å¹´æˆ–ï¼ˆå‡ºç”Ÿå¹´ä»½æ˜¯1970å¹´ï¼Œå‡ºç”Ÿå¹´ä»½ç­‰äºæˆ–å¤§äº10ï¼‰ï¼‰ï¼ˆ 10æœˆï¼Œ10æœˆï¼‰ã€‚ 12345QueryBuilder&lt;User&gt; qb = userDao.queryBuilder();qb.where(Properties.FirstName.eq(\"Joe\"),qb.or(Properties.YearOfBirth.gt(1970),qb.and(Properties.YearOfBirth.eq(1970), Properties.MonthOfBirth.ge(10))));List&lt;User&gt; youngJoes = qb.list(); 2. é™åˆ¶ï¼Œåç§»å’Œåˆ†é¡µæœ‰æ—¶å€™ï¼Œä½ åªéœ€è¦ä¸€ä¸ªæŸ¥è¯¢ç»“æœçš„å­é›†ï¼Œä¾‹å¦‚åœ¨ç”¨æˆ·ç•Œé¢ä¸­æ˜¾ç¤ºçš„å‰10ä¸ªå…ƒç´ ã€‚ å½“æ‹¥æœ‰å¤§é‡å®ä½“æ—¶ï¼Œè¿™æ˜¯éå¸¸æœ‰ç”¨çš„ï¼ˆèŠ‚çœèµ„æºçš„ï¼‰ï¼Œå¹¶ä¸”ä½ ä¹Ÿä¸èƒ½ä½¿ç”¨â€œwhereâ€è¯­å¥æ¥é™åˆ¶ç»“æœã€‚ QueryBuilder æœ‰å®šä¹‰é™åˆ¶å’Œåç§»çš„æ–¹æ³•ï¼š limitï¼ˆintï¼‰ï¼šé™åˆ¶æŸ¥è¯¢è¿”å›çš„ç»“æœæ•°ã€‚ offsetï¼ˆintï¼‰ï¼šç»“åˆlimitï¼ˆintï¼‰è®¾ç½®æŸ¥è¯¢ç»“æœçš„åç§»é‡ã€‚ å°†è·³è¿‡ç¬¬ä¸€ä¸ªåç§»ç»“æœï¼Œå¹¶ä¸”ç»“æœçš„æ€»æ•°å°†å—limitï¼ˆintï¼‰é™åˆ¶ã€‚ ä½ ä¸èƒ½ä½¿ç”¨offsetæ— é™åˆ¶ï¼ˆintï¼‰ã€‚ 3. ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹ä½œä¸ºå‚æ•°é€šå¸¸ï¼ŒgreenDAOä»¥é€æ˜æ–¹å¼æ˜ å°„æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œbooleanè¢«æ˜ å°„åˆ°INTEGERï¼Œå…·æœ‰0æˆ–1ä¸ªå€¼ï¼Œå¹¶ä¸”Dateè¢«æ˜ å°„åˆ°ï¼ˆlongï¼‰INTEGERå€¼ã€‚ è‡ªå®šä¹‰ç±»å‹æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼šåœ¨æ„å»ºæŸ¥è¯¢æ—¶ï¼Œæ€»æ˜¯å¿…é¡»ä½¿ç”¨æ•°æ®åº“å€¼ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨è½¬æ¢å™¨å°†æšä¸¾ç±»å‹æ˜ å°„åˆ°intå€¼ï¼Œåˆ™åº”åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨intå€¼ã€‚ 4. æŸ¥è¯¢å’ŒLazyListQueryç±»è¡¨ç¤ºå¯ä»¥å¤šæ¬¡æ‰§è¡Œçš„æŸ¥è¯¢ã€‚å½“ä½ ä½¿ç”¨QueryBuilderä¸­çš„ä¸€ä¸ªæ–¹æ³•æ¥è·å–ç»“æœï¼ˆå¦‚list()ï¼‰æ—¶ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­QueryBuilder å†…éƒ¨ä¼šä½¿ç”¨Query ç±»ã€‚å¦‚æœè¦å¤šæ¬¡è¿è¡ŒåŒä¸€ä¸ªæŸ¥è¯¢ï¼Œåº”è¯¥åœ¨QueryBuilder ä¸Šè°ƒç”¨build()æ¥åˆ›å»ºæŸ¥è¯¢è€Œå¹¶éæ‰§è¡Œå®ƒã€‚ greenDAOæ”¯æŒå”¯ä¸€ç»“æœï¼ˆ0æˆ–1ä¸ªç»“æœï¼‰å’Œç»“æœåˆ—è¡¨ã€‚å¦‚æœä½ æƒ³åœ¨Query ï¼ˆæˆ–QueryBuilder ï¼‰ä¸Šæœ‰å”¯ä¸€çš„ç»“æœè°ƒç”¨unique()ï¼Œè¿™å°†ä¸ºä½ æä¾›å•ä¸ªç»“æœæˆ–è€…åœ¨æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å®ä½“æ—¶è¿”å›nullã€‚å¦‚æœä½ çš„ç”¨ä¾‹ç¦æ­¢nullä½œä¸ºç»“æœï¼Œè°ƒç”¨uniqueOrThrow()å°†ä¿è¯è¿”å›ä¸€ä¸ªéç©ºçš„å®ä½“ï¼ˆå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªDaoExceptionï¼‰ã€‚ å¦‚æœå¸Œæœ›å¤šä¸ªå®ä½“ä½œä¸ºæŸ¥è¯¢ç»“æœï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ï¼š list()æ‰€æœ‰å®ä½“éƒ½åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ç»“æœé€šå¸¸æ˜¯ä¸€ä¸ªç®€å•çš„ArrayListã€‚æœ€æ–¹ä¾¿ä½¿ç”¨ã€‚ listLazy()å®ä½“æŒ‰éœ€åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä¸€æ—¦åˆ—è¡¨ä¸­çš„å…ƒç´ ç¬¬ä¸€æ¬¡è¢«è®¿é—®ï¼Œå®ƒå°†è¢«åŠ è½½å¹¶ç¼“å­˜ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚ä½¿ç”¨å®Œåå¿…é¡»å…³é—­ã€‚ listLazyUncached()ä¸€ä¸ªâ€œè™šæ‹Ÿâ€å®ä½“åˆ—è¡¨ï¼šå¯¹åˆ—è¡¨å…ƒç´ çš„ä»»ä½•è®¿é—®éƒ½å¯¼è‡´ä»æ•°æ®åº“åŠ è½½å…¶æ•°æ®ã€‚ä½¿ç”¨å®Œåå¿…é¡»å…³é—­ã€‚ listIterator()è®©æˆ‘ä»¬é€šè¿‡æŒ‰éœ€åŠ è½½æ•°æ®ï¼ˆlazilyï¼‰æ¥éå†ç»“æœã€‚æ•°æ®æœªç¼“å­˜ã€‚ä½¿ç”¨å®Œåå¿…é¡»å…³é—­ã€‚ æ–¹æ³•listLazy()ï¼ŒlistLazyUncached()å’ŒlistIterator()ä½¿ç”¨greenDAOçš„LazyListç±»ã€‚è¦æŒ‰éœ€åŠ è½½æ•°æ®ï¼Œå®ƒä¿å­˜å¯¹æ•°æ®åº“æ¸¸æ ‡çš„å¼•ç”¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¿…é¡»ç¡®ä¿å…³é—­æƒ°æ€§åˆ—è¡¨å’Œè¿­ä»£å™¨ï¼ˆé€šå¸¸åœ¨try / finallyå—ï¼‰ã€‚ æ¥è‡ªlistLazy()çš„ç¼“å­˜å»¶è¿Ÿåˆ—è¡¨å’ŒlistIterator()ä¸­çš„æƒ°æ€§è¿­ä»£å™¨åœ¨è®¿é—®æˆ–éå†æ‰€æœ‰å…ƒç´ åè‡ªåŠ¨å…³é—­æ¸¸æ ‡ã€‚å¦‚æœåˆ—è¡¨å¤„ç†è¿‡æ—©åœæ­¢,å¼€å‘è€…éœ€è¦è‡ªå·±è°ƒç”¨close()è¿›è¡Œå¤„ç† 5. å¤šæ¬¡æ‰§è¡ŒæŸ¥è¯¢ä½¿ç”¨QueryBuilderæ„å»ºæŸ¥è¯¢åï¼Œè¿™ä¸ªQueryå¯¹è±¡æ˜¯å¯ä»¥è¢«é‡å¤ä½¿ç”¨çš„ã€‚ è¿™æ¯”æ€»æ˜¯åˆ›å»ºæ–°çš„Queryå¯¹è±¡æ›´é«˜æ•ˆã€‚ å¦‚æœæŸ¥è¯¢å‚æ•°ä¸æ›´æ”¹ï¼Œä½ å¯ä»¥ç»§ç»­è°ƒç”¨åˆ—è¡¨/å”¯ä¸€ç»“æœç­‰æ–¹æ³•è¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚ ä½†æ˜¯ï¼Œå‚æ•°æ˜¯å¯ä»¥è¢«æ›´æ”¹çš„ï¼šé€šè¿‡è°ƒç”¨setParameteræ–¹æ³•æ¥æ›´æ”¹å‚æ•°ã€‚ å½“å‰ï¼Œé€šè¿‡åŸºäºé›¶çš„å‚æ•°ç´¢å¼•æ¥å¯»å€å„ä¸ªå‚æ•°ã€‚ ç´¢å¼•åŸºäºæˆ‘ä»¬ä¼ å…¥åˆ°QueryBuilderçš„é¡ºåºã€‚ ä¾‹å¦‚ï¼š 1234567891011// fetch users with Joe as a first name born in 1970Query&lt;User&gt; query = userDao.queryBuilder().where( Properties.FirstName.eq(\"Joe\"), Properties.YearOfBirth.eq(1970)).build();List&lt;User&gt; joesOf1970 = query.list(); // using the same Query object, we can change the parameters// to search for Marias born in 1977 later:query.setParameter(0, \"Maria\");query.setParameter(1, 1977);List&lt;User&gt; mariasOf1977 = query.list(); 6. åœ¨å¤šçº¿ç¨‹ä¸­æ‰§è¡ŒæŸ¥è¯¢å¦‚æœåœ¨å¤šä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨æŸ¥è¯¢ï¼Œåˆ™å¿…é¡»è°ƒç”¨forCurrentThreadï¼ˆï¼‰è·å–å½“å‰çº¿ç¨‹çš„Queryå®ä¾‹ã€‚ Queryå®ä¾‹ç»‘å®šåˆ°æ„å»ºæŸ¥è¯¢çš„é‚£ä¸ªçº¿ç¨‹ã€‚ ä½ å¯ä»¥å®‰å…¨åœ°è®¾ç½®Queryå¯¹è±¡çš„å‚æ•°ï¼Œä¸æ¶‰åŠåˆ°å…¶ä»–çº¿ç¨‹ã€‚ å¦‚æœä¸€ä¸ªçº¿ç¨‹å°è¯•ä¿®æ”¹æŸ¥è¯¢å‚æ•°æˆ–æ‰§è¡Œå·²ç»ç»‘å®šåˆ°å¦ä¸€ä¸ªçº¿ç¨‹çš„æŸ¥è¯¢ç»‘ï¼Œç³»ç»Ÿå°†æŠ›å‡ºå¼‚å¸¸ã€‚ ç”¨è¿™ç§æ–¹å¼ï¼Œä½ å°±ä¸å†éœ€è¦synchronizedè¯­å¥äº†ã€‚ å®é™…ä¸Šï¼Œä½ åº”è¯¥é¿å…é”å®šï¼Œå› ä¸ºå¦‚æœå¹¶å‘äº‹åŠ¡ä½¿ç”¨ç›¸åŒçš„Queryå¯¹è±¡ï¼Œè¿™å¯èƒ½å¯¼è‡´æ­»é”ã€‚ æ¯æ¬¡è°ƒç”¨forCurrentThread()æ—¶ï¼ŒæŸ¥è¯¢å‚æ•°å°†ä¼šè¢«è®¾ç½®æˆä½¿ç”¨æ„å»ºå™¨æ„å»ºæŸ¥è¯¢æ—¶çš„å‚æ•°ã€‚ 7. åŸå§‹æŸ¥è¯¢å¦‚æœQueryBuilderä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œæœ‰ä¸¤ç§æ–¹æ³•æ¥æ‰§è¡ŒåŸå§‹SQLå¹¶è¿”å›å®ä½“å¯¹è±¡ã€‚ ç¬¬ä¸€ç§ï¼Œé¦–é€‰çš„æ–¹æ³•æ˜¯ä½¿ç”¨QueryBuilderå’ŒWhereCondition.StringConditionã€‚ è¿™æ ·ï¼Œä½ å¯ä»¥å°†ä»»ä½•SQLç‰‡æ®µä½œä¸ºWHEREå­å¥ä¼ é€’ç»™æŸ¥è¯¢æ„å»ºå™¨ã€‚ ä»¥ä¸‹ä»£ç æ˜¯ä¸€ä¸ªç†è®ºç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•è¿è¡Œå­é€‰æ‹©ï¼ˆä½¿ç”¨è¿æ¥å°†æ˜¯æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼‰ï¼š 1234Query&lt;User&gt; query = userDao.queryBuilder().where( new StringCondition(\"_ID IN \" + \"(SELECT USER_ID FROM USER_MESSAGE WHERE READ_FLAG = 0)\")).build(); ç¬¬äºŒç§æ–¹æ³•ä¸ä½¿ç”¨QueryBuilderï¼Œ è€Œæ˜¯ä½¿ç”¨queryRawæˆ–queryRawCreateæ–¹æ³•ã€‚ å®ƒä»¬å…è®¸æ‚¨ä¼ é€’ä¸€ä¸ªåŸå§‹SQLå­—ç¬¦ä¸²ï¼Œå®ƒé™„åŠ åœ¨SELECTå’Œå®ä½“åˆ—ä¹‹åã€‚ è¿™æ ·ï¼Œä½ å¯ä»¥æœ‰ä»»ä½•WHEREå’ŒORDER BYå­å¥æ¥é€‰æ‹©å®ä½“ã€‚ å¯ä»¥ä½¿ç”¨åˆ«åTæ¥å¼•ç”¨å®ä½“è¡¨ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢ï¼Œè¯¥æŸ¥è¯¢ä½¿ç”¨è¿æ¥æ£€ç´¢åä¸ºâ€œadminâ€çš„ç»„çš„ç”¨æˆ·ï¼ˆåŒæ ·ï¼ŒgreenDAOæœ¬èº«æ”¯æŒè¿æ¥ï¼Œè¿™åªæ˜¯ä¸ºäº†æ¼”ç¤ºï¼‰ï¼š 123Query&lt;User&gt; query = userDao.queryRawCreate( \", GROUP G WHERE G.NAME=? AND T.GROUP_ID=G._ID\", \"admin\"); æ³¨æ„ï¼šå¯ä»¥ä½¿ç”¨ç”Ÿæˆçš„å¸¸é‡å¼•ç”¨è¡¨å’Œåˆ—åç§°ã€‚ è¿™æ˜¯å»ºè®®é¿å…æ‰“å­—é”™è¯¯ï¼Œå› ä¸ºç¼–è¯‘å™¨å°†æ£€æŸ¥åç§°ã€‚ åœ¨å®ä½“çš„DAOä¸­ï¼Œä½ å°†å‘ç°TABLENAMEåŒ…å«æ•°æ®åº“è¡¨çš„åç§°ï¼Œä»¥åŠä¸€ä¸ªå†…éƒ¨ç±»å±æ€§ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å±æ€§çš„å¸¸é‡ï¼ˆå­—æ®µcolumnNameï¼‰ã€‚ 8. åˆ é™¤æŸ¥è¯¢æ‰¹é‡åˆ é™¤ä¸ä¼šåˆ é™¤å•ä¸ªå®ä½“ï¼Œä½†æ˜¯æ‰€æœ‰å®ä½“éƒ½ç¬¦åˆä¸€äº›æ¡ä»¶ã€‚ è¦æ‰§è¡Œæ‰¹é‡åˆ é™¤ï¼Œè¯·åˆ›å»ºä¸€ä¸ªQueryBuilderï¼Œè°ƒç”¨å…¶buildDeleteï¼ˆï¼‰æ–¹æ³•ï¼Œå¹¶æ‰§è¡Œè¿”å›çš„DeleteQueryã€‚ ***APIçš„è¿™ä¸€éƒ¨åˆ†å¯ä»¥åœ¨å°†æ¥æ”¹å˜ï¼Œä¾‹å¦‚å¯ä»¥æ·»åŠ æ–¹ä¾¿çš„æ–¹æ³•ã€‚ è¯·æ³¨æ„ï¼Œæ‰¹é‡åˆ é™¤ç›®å‰ä¸å½±å“identity scopeä¸­çš„å®ä½“ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå·²åˆ é™¤çš„å®ä½“å…ˆå‰å·²ç¼“å­˜ï¼Œå¹¶é€šè¿‡å…¶IDï¼ˆåŠ è½½æ–¹æ³•ï¼‰è¿›è¡Œè®¿é—®ï¼Œåˆ™å¯ä»¥â€œå¤æ´»â€ã€‚ è¯·è€ƒè™‘ç«‹å³æ¸…é™¤èº«ä»½èŒƒå›´ï¼Œå¦‚æœè¿™å¯èƒ½ä¼šå¯¼è‡´ä½ çš„ç”¨ä¾‹çš„é—®é¢˜ã€‚*** 9. ç–‘éš¾è§£ç­”æŸ¥è¯¢æ‚¨çš„æŸ¥è¯¢ä¸è¿”å›é¢„æœŸç»“æœï¼Ÿ åœ¨QueryBuilderä¸Šå¯ç”¨SQLå’Œå‚æ•°è®°å½•æœ‰ä¸¤ä¸ªé™æ€æ ‡å¿—ï¼š 12QueryBuilder.LOG_SQL = true;QueryBuilder.LOG_VALUES = true; å½“è°ƒç”¨å…¶ä¸­ä¸€ä¸ªæ„å»ºæ–¹æ³•æ—¶ï¼Œå®ƒä»¬å°†è®°å½•ç”Ÿæˆçš„SQLå‘½ä»¤å’Œä¼ é€’çš„å€¼ï¼Œå¹¶å°†å®ƒä»¬ä¸å®é™…æ‰€éœ€çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚ æ­¤å¤–ï¼Œå®ƒå¯èƒ½æœ‰åŠ©äºå°†ç”Ÿæˆçš„SQLå¤åˆ¶åˆ°ä¸€äº›SQLiteæ•°æ®åº“æµè§ˆå™¨ï¼Œå¹¶çœ‹çœ‹å®ƒå¦‚ä½•æ‰§è¡Œã€‚ æŸ¥è¯¢æ„å»ºå™¨è¿æ¥è¡¨1. è¿æ¥éæ™®é€šæŸ¥è¯¢é€šå¸¸éœ€è¦å‡ ä¸ªå®ä½“ç±»å‹ï¼ˆè¡¨ï¼‰çš„æ•°æ®ã€‚ åœ¨SQLä¸–ç•Œä¸­ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨è¿æ¥æ¡ä»¶â€œè¿æ¥â€ä¸¤ä¸ªæˆ–å¤šä¸ªè¡¨æ¥å®ç°ã€‚ è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå®ä½“Userï¼Œå®ƒä¸Addresså®ä½“å…·æœ‰ä¸€å¯¹å¤šçš„å…³ç³»ã€‚ ç„¶åï¼Œæˆ‘ä»¬è¦æŸ¥è¯¢å±…ä½åœ¨â€œSesame Streetâ€ä¸Šçš„ç”¨æˆ·ï¼šæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ç”¨æˆ·IDä¸Userå®ä½“åŠ å…¥Addresså®ä½“ï¼Œå¹¶åœ¨Addresså®ä½“ä¸Šå®šä¹‰WHEREæ¡ä»¶ï¼š 1234QueryBuilder&lt;User&gt; queryBuilder = userDao.queryBuilder();queryBuilder.join(Address.class, AddressDao.Properties.userId) .where(AddressDao.Properties.Street.eq(\"Sesame Street\"));List&lt;User&gt; users = queryBuilder.list(); è¿æ¥éœ€è¦ç›®æ ‡å®ä½“ç±»ä½œä¸ºæ¯ä¸ªå®ä½“çš„å‚æ•°å’Œè¿æ¥å±æ€§ã€‚ åœ¨ç¤ºä¾‹ä¸­ï¼Œåªå®šä¹‰Addresså®ä½“çš„joinå±æ€§ï¼Œå› ä¸ºé»˜è®¤ä½¿ç”¨ä¸»é”®å±æ€§ã€‚ æ¢å¥è¯è¯´ï¼ŒæŸ¥è¯¢å¯¼è‡´ç”¨æˆ·å…·æœ‰UserIdç­‰äºUserå®ä½“IDå¹¶ä¸”è¿˜å…·æœ‰ç‰¹å®šè¡—é“çš„Addresså®ä½“ã€‚ 2. æŸ¥è¯¢æ„å»ºå™¨è¿æ¥APIç”±äºå¯ä»¥åœ¨ä½¿ç”¨ä¸»é”®å±æ€§æ—¶çœç•¥joinå±æ€§ï¼Œå› æ­¤QueryBuilderä¸­æä¾›äº†ä¸‰ç§é‡è½½çš„è¿æ¥æ–¹æ³•ï¼š 123456789101112131415161718192021/** * Expands the query to another entity type by using a JOIN. * The primary key property of the primary entity for * this QueryBuilder is used to match the given destinationProperty. */public &lt;J&gt; Join&lt;T, J&gt; join(Class&lt;J&gt; destinationEntityClass, Property destinationProperty) /** * Expands the query to another entity type by using a JOIN. * The given sourceProperty is used to match the primary * key property of the given destinationEntity. */public &lt;J&gt; Join&lt;T, J&gt; join(Property sourceProperty, Class&lt;J&gt; destinationEntityClass) /** * Expands the query to another entity type by using a JOIN. * The given sourceProperty is used to match the given * destinationProperty of the given destinationEntity. */public &lt;J&gt; Join&lt;T, J&gt; join(Property sourceProperty, Class&lt;J&gt; destinationEntityClass, Property destinationProperty) 3. é“¾å¼è¿æ¥æ­¤å¤–ï¼ŒgreenDAOå…è®¸è·¨å¤šä¸ªè¡¨è¿æ¥ã€‚ åœ¨è¿™é‡Œï¼Œä½¿ç”¨å¦ä¸€ä¸ªè¿æ¥å’Œç›®æ ‡å®ä½“å®šä¹‰è¿æ¥ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬ä¸€è¿æ¥çš„ç›®çš„å®ä½“å˜ä¸ºç¬¬äºŒè”æ¥çš„èµ·å§‹å®ä½“ã€‚ ç”¨äºé“¾æ¥è¿æ¥çš„QueryBuilder APIå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011/** * Expands the query to another entity type by using a JOIN. * The given sourceJoin's property is used to match the * given destinationProperty of the given destinationEntity. * Note that destination entity of the given join is used * as the source for the new join to add. In this way, * it is possible to compose complex \"join of joins\" across * several entities if required. */public &lt;J&gt; Join&lt;T, J&gt; join(Join&lt;?, T&gt; sourceJoin, Property sourceProperty, Class&lt;J&gt; destinationEntityClass, Property destinationProperty) è®©æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ä¸ªæœ‰ä¸‰ä¸ªå®ä½“çš„ä¾‹å­ï¼šåŸå¸‚ï¼Œå›½å®¶å’Œå¤§é™†ã€‚ å¦‚æœæˆ‘ä»¬è¦æŸ¥è¯¢æ¬§æ´²æ‰€æœ‰äººå£è‡³å°‘100ä¸‡çš„æ‰€æœ‰åŸå¸‚ï¼Œå®ƒå°†å¦‚ä¸‹æ‰€ç¤ºï¼š 123456QueryBuilder&lt;City&gt; qb = cityDao.queryBuilder().where(Properties.Population.ge(1000000));Join country = qb.join(Properties.CountryId, Country.class);Join continent = qb.join(country, CountryDao.Properties.ContinentId, Continent.class, ContinentDao.Properties.Id);continent.where(ContinentDao.Properties.Name.eq(\"Europe\"));List&lt;City&gt; bigEuropeanCities = qb.list(); 4. è‡ªè¿æ¥/æ ‘ç¤ºä¾‹è¿æ¥ä¹Ÿå¯ä»¥ä¸å¼•ç”¨å•ä¸ªå®ä½“çš„å…³ç³»ä¸€èµ·ä½¿ç”¨ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³æ‰¾åˆ°æ‰€æœ‰çš„äººï¼Œä»–çš„ç¥–çˆ¶çš„åå­—æ˜¯â€œæ—è‚¯â€ã€‚ è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå…·æœ‰æŒ‡å‘åŒä¸€ä¸ªå®ä½“çš„fatherIdå±æ€§çš„Personå®ä½“ã€‚ ç„¶åï¼ŒæŸ¥è¯¢æ„å»ºå¦‚ä¸‹ï¼š 12345QueryBuilder&lt;Person&gt; qb = personDao.queryBuilder();Join father = qb.join(Person.class, Properties.FatherId);Join grandfather = qb.join(father, Properties.FatherId, Person.class, Properties.Id);grandfather.where(Properties.Name.eq(\"Lincoln\"));List&lt;Person&gt; lincolnDescendants = qb.list(); å¦‚æ‚¨æ‰€è§ï¼Œè¿æ¥æ˜¯æ„å»ºè·¨å¤šä¸ªå®ä½“ç±»å‹æˆ–å…³ç³»çš„æŸ¥è¯¢çš„å¼ºå¤§å·¥å…·ã€‚ å®ä½“ä¹‹é—´çš„å…³ç³»ï¼ˆä¸€å¯¹å¤šï¼‰1. å…³ç³»æ•°æ®åº“è¡¨å¯ä»¥ä½¿ç”¨1ï¼š1,1ï¼šNæˆ–Nï¼šMå…³ç³»å½¼æ­¤ç›¸å…³ã€‚ å¦‚æœä½ åˆšæ¥è§¦æ•°æ®åº“å…³ç³»ï¼Œä½ éœ€è¦åœ¨æˆ‘ä»¬è®¨è®ºORMä¹‹å‰å¿«é€Ÿçš„æ¶è¡¥ä¸€ä¸‹ã€‚ è¿™é‡Œæœ‰ä¸€äº›å…³äºæ•°æ®åº“å…³ç³»çš„ç½‘ç»œé“¾æ¥ã€‚ç¬¬ä¸€ç¯‡ç¬¬äºŒç¯‡ç¬¬ä¸‰ç¯‡ åœ¨greenDAOä¸­ï¼Œå®ä½“ä½¿ç”¨ä¸€å¯¹ä¸€æˆ–ä¸€å¯¹å¤šå…³ç³»ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¦åœ¨greenDAOä¸­å»ºæ¨¡1ï¼šnå…³ç³»ï¼Œåˆ™å°†å…·æœ‰ä¸€å¯¹ä¸€å…³ç³»å’Œä¸€å¯¹å¤šå…³ç³»ã€‚ ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šå…³ç³»ä¸ä¼šå½¼æ­¤è¿æ¥ï¼Œå› æ­¤ä½ å¿…é¡»æ›´æ–°ä¸¤è€…ã€‚ 2. æ„å»ºä¸€å¯¹ä¸€å…³ç³»@ToOneæ³¨è§£å®šä¹‰ä¸å¦ä¸€ä¸ªå®ä½“ï¼ˆä¸€ä¸ªå®ä½“å¯¹è±¡ï¼‰çš„å…³ç³»ã€‚ å°†å…¶åº”ç”¨äºåŒ…å«å…¶ä»–å®ä½“å¯¹è±¡çš„å±æ€§ã€‚ åœ¨å†…éƒ¨ï¼ŒgreenDAOéœ€è¦ä¸€ä¸ªæŒ‡å‘ç”±joinPropertyå‚æ•°æŒ‡å®šçš„ç›®æ ‡å®ä½“çš„IDçš„é™„åŠ å±æ€§ã€‚ å¦‚æœæ­¤å‚æ•°ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªé™„åŠ åˆ—æ¥ä¿å­˜è¿™ä¸ªä¿¡æ¯ã€‚ 1234567891011121314@Entitypublic class Order { @Id private Long id; private long customerId; @ToOne(joinProperty = \"customerId\") private Customer customer;} @Entitypublic class Customer { @Id private Long id;} ä¸€å¯¹ä¸€å…³ç³»çš„getteræ–¹æ³•ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ä¸ºgetCustomer()ï¼‰åœ¨å…¶ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶å»¶è¿Ÿè§£æç›®æ ‡å®ä½“ã€‚ åç»­è°ƒç”¨å°†ç«‹å³è¿”å›å…ˆå‰è§£æçš„å¯¹è±¡ã€‚ æ³¨æ„ï¼Œå¦‚æœæ›´æ”¹å¤–é”®å±æ€§ï¼ˆè¿™é‡Œä¸ºcustomerIdï¼‰ï¼Œä¸‹ä¸€æ¬¡å¯¹getterï¼ˆgetCustomer()ï¼‰çš„è°ƒç”¨å°†è§£æå®ä½“ä»¥è·å–æ›´æ–°çš„IDã€‚ å¦å¤–ï¼Œå¦‚æœè®¾ç½®äº†ä¸€ä¸ªæ–°å®ä½“ï¼ˆsetCustomerï¼ˆï¼‰ï¼‰ï¼Œå¤–é”®å±æ€§ï¼ˆcustomerIdï¼‰ä¹Ÿå°†è¢«æ›´æ–°ã€‚ 123456789Customer customerA = user.getCustomer(); // change the customer iduser.setCustomerId(customerIdB);// or set a customer with a different iduser.setCustomer(customerB); customerB = user.getCustomer();assert(customerA.getId() != customerB.getId()); æ³¨æ„ï¼šè¦çƒ­åŠ è½½ä¸€å¯¹ä¸€å…³ç³»ï¼Œè¯·ä½¿ç”¨å®ä½“DAOç±»çš„loadDeepï¼ˆï¼‰å’ŒqueryDeepï¼ˆï¼‰ã€‚ è¿™å°†è§£æä¸å•ä¸ªæ•°æ®åº“æŸ¥è¯¢å…·æœ‰æ‰€æœ‰ä¸€å¯¹ä¸€å…³ç³»çš„å®ä½“ã€‚ å¦‚æœä½ æ€»æ˜¯è®¿é—®ç›¸å…³å®ä½“ï¼Œè¿™å°†æœ‰åŠ©äºæ€§èƒ½çš„æé«˜ã€‚ 2. æ„å»ºä¸€å¯¹å¤šå…³ç³»@ToManyå®šä¹‰ä¸ä¸€ç»„å…¶ä»–å®ä½“ï¼ˆå¤šä¸ªå®ä½“å¯¹è±¡ï¼‰çš„å…³ç³»ã€‚ å°†æ­¤åº”ç”¨äºè¡¨ç¤ºç›®æ ‡å®ä½“åˆ—è¡¨çš„å±æ€§ã€‚ å¼•ç”¨çš„å®ä½“å¿…é¡»æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§æŒ‡å‘æ‹¥æœ‰@ToManyçš„å®ä½“ã€‚ æœ‰ä¸‰ç§å¯èƒ½æ€§æ¥æŒ‡å®šå…³ç³»æ˜ å°„ï¼Œåªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªå³å¯ï¼š referencedJoinPropertyå‚æ•°ï¼šæŒ‡å®šç›®æ ‡å®ä½“ä¸­æŒ‡å‘æ­¤å®ä½“æ ‡è¯†çš„â€œå¤–é”®â€å±æ€§çš„åç§°ã€‚ 123456789101112131415@Entitypublic class Customer { @Id private Long id; @ToMany(referencedJoinProperty = \"customerId\") @OrderBy(\"date ASC\") private List&lt;Order&gt; orders;} @Entitypublic class Order { @Id private Long id; private Date date; private long customerId;} joinPropertieså‚æ•°ï¼šå¯¹äºæ›´å¤æ‚çš„å…³ç³»ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€åˆ—@JoinPropertyæ³¨è§£ã€‚ æ¯ä¸ª@JoinPropertyéœ€è¦åŸå§‹å®ä½“ä¸­çš„æºå±æ€§å’Œç›®æ ‡å®ä½“ä¸­çš„å¼•ç”¨å±æ€§ã€‚ 123456789101112131415161718@Entitypublic class Customer { @Id private Long id; @Unique private String tag; @ToMany(joinProperties = { @JoinProperty(name = \"tag\", referencedName = \"customerTag\") }) @OrderBy(\"date ASC\") private List&lt;Site&gt; orders;} @Entitypublic class Order { @Id private Long id; private Date date; @NotNull private String customerTag;} @JoinEntityï¼šå¦‚æœä½ æ­£åœ¨æ‰§è¡Œæ¶‰åŠå¦ä¸€ä¸ªè¿æ¥å®ä½“/è¡¨çš„Nï¼šMï¼ˆå¤šå¯¹å¤šï¼‰å…³ç³»ï¼Œè¯·åœ¨å±æ€§ä¸Šæ”¾ç½®æ­¤é™„åŠ æ³¨è§£ã€‚ 123456789101112131415161718192021222324@Entitypublic class Product { @Id private Long id; @ToMany @JoinEntity( entity = JoinProductsWithOrders.class, sourceProperty = \"productId\", targetProperty = \"orderId\" ) private List&lt;Order&gt; ordersWithThisProduct;} @Entitypublic class JoinProductsWithOrders { @Id private Long id; private Long productId; private Long orderId;} @Entitypublic class Order { @Id private Long id;} ä¸€æ—¦è¿è¡Œï¼Œæ’ä»¶å°†ç”Ÿæˆä¸€ä¸ªgetteræ¥è§£æè¢«å¼•ç”¨å®ä½“çš„åˆ—è¡¨ã€‚ ä¾‹å¦‚åœ¨å‰ä¸¤ç§æƒ…å†µä¸‹ï¼š 12// return all orders where customerId == customer.getId()List&lt;Order&gt; orders = customer.getOrders(); 3. è§£æå’Œæ›´æ–°å¯¹å¤šå…³ç³»å¤šå¯¹å¤šå…³ç³»åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸Šè§£ææ¯”è¾ƒæ…¢ï¼Œç„¶åå°†Listå¯¹è±¡ç¼“å­˜åœ¨å®ä½“ä¸­ã€‚ å› æ­¤ï¼Œåç»­é‡‡ç”¨getæ–¹æ³•è°ƒç”¨å°†ä¸ä¼šæŸ¥è¯¢æ•°æ®åº“ã€‚ æ›´æ–°å¤šå¯¹å¤šå…³ç³»éœ€è¦ä¸€äº›é¢å¤–çš„å·¥ä½œã€‚ å› ä¸ºç¼“å­˜äº†ä¸€å¯¹å¤šåˆ—è¡¨ï¼Œæ‰€ä»¥å½“å°†ç›¸å…³å®ä½“æ·»åŠ åˆ°æ•°æ®åº“æ—¶ï¼Œå®ƒä»¬ä¸ä¼šæ›´æ–°ã€‚ ä»¥ä¸‹ä»£ç è¯´æ˜äº†è¿™ç§è¡Œä¸ºï¼š 12345678910111213141516// get the current list of orders for a customerList&lt;Order&gt; orders1 = customer.getOrders(); // insert a new order for this customerOrder order = new Order();order.setCustomerId(customer.getId());daoSession.insert(order); // get the list of orders againList&lt;Order&gt; orders2 = customer.getOrders(); // the (cached) list of orders was not updated// orders1 has the same size as orders2assert(orders1.size() == orders2.size);// orders1 is the same object as orders2assert(orders1.equals(orders2)); å› æ­¤ï¼Œè¦æ·»åŠ æ–°çš„ç›¸å…³å®ä½“ï¼Œè¯·å°†å®ƒä»¬æ‰‹åŠ¨æ·»åŠ åˆ°æºå®ä½“çš„å¤šå¯¹å¤šåˆ—è¡¨ä¸­ï¼Œå¦‚ä¸‹ï¼š 1234567891011// get the to-many list before inserting the new entity// otherwise the new entity might be in the list twiceList&lt;Order&gt; orders = customer.getOrders();// create the new entityOrder newOrder = ...// set the foreign key propertynewOrder.setCustomerId(customer.getId());// persist the new entitydaoSession.insert(newOrder);// add it to the to-many listorders.add(newOrder); åŒæ ·ï¼Œä½ å¯ä»¥åˆ é™¤ç›¸å…³å®ä½“ï¼Œå¦‚ä¸‹ï¼š 12345List&lt;Order&gt; orders = customer.getOrders();// remove one of the orders from the databasedaoSession.delete(someOrder);// manually remove it from the to-many listorders.remove(someOrder); æ·»åŠ ï¼Œæ›´æ–°æˆ–åˆ é™¤è®¸å¤šç›¸å…³å®ä½“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é‡ç½®æ–¹æ³•æ¸…é™¤ç¼“å­˜çš„åˆ—è¡¨ã€‚ ç„¶åä¸‹ä¸€ä¸ªgetå°†é‡æ–°æŸ¥è¯¢ç›¸å…³å®ä½“ï¼š 123// clear any cached list of related orderscustomer.resetOrders();List&lt;Order&gt; orders = customer.getOrders(); 4. åŒå‘1ï¼šNå…³ç³»æœ‰æ—¶ä½ æƒ³åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå»ºç«‹1ï¼šNå…³ç³»ã€‚ åœ¨greenDAOä¸­ï¼Œä½ å¿…é¡»æ·»åŠ ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šå…³ç³»æ‰èƒ½å®ç°æ­¤ç›®çš„ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å®¢æˆ·å’Œè®¢å•å®ä½“çš„å®Œæ•´å»ºæ¨¡ï¼Œæˆ‘ä»¬ä¹‹å‰ç”¨ä½œç¤ºä¾‹ã€‚ è¿™æ¬¡ï¼Œæˆ‘ä»¬ä½¿ç”¨customerIdå±æ€§åˆ›å»ºä¸¤ä¸ªå…³ç³»ï¼š 123456789101112131415161718@Entitypublic class Customer { @Id private Long id; @ToMany(referencedJoinProperty = \"customerId\") @OrderBy(\"date ASC\") private List&lt;Order&gt; orders;} @Entitypublic class Order { @Id private Long id; private Date date; private long customerId; @ToOne(joinProperty = \"customerId\") private Customer customer;} è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè®¢å•å®ä½“ã€‚ ä½¿ç”¨è¿™ä¸¤ç§å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å®¢æˆ·å’Œå®¢æˆ·æ‰€åšçš„æ‰€æœ‰è®¢å•ï¼š 1List&lt;Order&gt; allOrdersOfCustomer = order.getCustomer().getOrders(); 5. ç¤ºä¾‹ï¼šå»ºæ¨¡æ ‘å…³ç³»æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨æŒ‡å‘è‡ªèº«çš„ä¸€å¯¹ä¸€å’Œå¤šå¯¹ä¸€å…³ç³»å»ºæ¨¡å®ä½“æ¥å»ºæ¨¡æ ‘å…³ç³»ï¼š 123456789101112@Entitypublic class TreeNode { @Id private Long id; private Long parentId; @ToOne(joinProperty = \"parentId\") private TreeNode parent; @ToMany(referencedJoinProperty = \"parentId\") private List&lt;TreeNode&gt; children;} ç”Ÿæˆçš„å®ä½“å…è®¸æ‚¨å¯¼èˆªå…¶çˆ¶çº§å’Œå­çº§ï¼š 12TreeNode parent = entity.getParent();List&lt;TreeNode&gt; children = entity.getChildren(); 6. æ›´å¤šç¤ºä¾‹æŸ¥çœ‹DaoExampleé¡¹ç›®ä»¥è·å–å®Œæ•´çš„Androidåº”ç”¨ç¤ºä¾‹ã€‚ æ­¤å¤–ï¼ŒDaoTestEntityAnnotationé¡¹ç›®é™„å¸¦äº†å‡ ä¸ªå…³ç³»æµ‹è¯•ã€‚ å…¶ä¸­ï¼Œé™¤äº†å…¶ä»–ç¤ºä¾‹å’Œæµ‹è¯•é¡¹ç›®ä¹‹å¤–ï¼Œå¯ä»¥ç”¨ä½œè¿›ä¸€æ­¥çš„ç¤ºä¾‹ã€‚ è‡ªå®šä¹‰ç±»å‹ï¼šå°†ç±»å’Œæšä¸¾æ˜ å°„åˆ°æ•°æ®åº“å€¼è‡ªå®šä¹‰ç±»å‹å…è®¸å®ä½“å…·æœ‰ä»»ä½•ç±»å‹çš„å±æ€§ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒgreenDAOæ”¯æŒä»¥ä¸‹ç±»å‹ 12345678910boolean, Booleanint, Integershort, Shortlong, Longfloat, Floatdouble, Doublebyte, Bytebyte[]StringDate 1. è½¬æ¢æ³¨è§£å’Œå±æ€§è½¬æ¢å™¨è¦æ·»åŠ å¯¹è‡ªå®šä¹‰ç±»å‹çš„æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨@Convertæ³¨é‡Šå°†å®ƒä»¬æ˜ å°„åˆ°å…¶ä¸­ä¸€ç§å—æ”¯æŒçš„ç±»å‹ã€‚ åŒæ—¶ä½ è¿˜éœ€è¦æä¾›PropertyConverterå®ç°ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰Colorç±»åœ¨å®ä½“ä¸­å®šä¹‰é¢œè‰²ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°æ•´æ•°ã€‚ æˆ–è€…ä½ å¯ä»¥å°†æµè¡Œçš„org.joda.time.DateTimeä»Joda Timeæ˜ å°„åˆ°Longã€‚ è¿™æ˜¯å°†æšä¸¾æ˜ å°„åˆ°æ•´æ•°çš„ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738@Entitypublic class User { @Id private Long id; @Convert(converter = RoleConverter.class, columnType = Integer.class) private Role role; public enum Role { DEFAULT(0), AUTHOR(1), ADMIN(2); final int id; Role(int id) { this.id = id; } } public static class RoleConverter implements PropertyConverter&lt;Role, Integer&gt; { @Override public Role convertToEntityProperty(Integer databaseValue) { if (databaseValue == null) { return null; } for (Role role : Role.values()) { if (role.id == databaseValue) { return role; } } return Role.DEFAULT; } @Override public Integer convertToDatabaseValue(Role entityProperty) { return entityProperty == null ? null : entityProperty.id; } }} æ³¨æ„ï¼šå¦‚æœä½ åœ¨å®ä½“ç±»ä¸­å®šä¹‰è‡ªå®šä¹‰ç±»å‹æˆ–è½¬æ¢å™¨ï¼Œå®ƒä»¬å¿…é¡»æ˜¯é™æ€çš„ã€‚ ä¸è¦å¿˜è®°æ­£ç¡®å¤„ç†ç©ºå€¼ - é€šå¸¸ï¼Œå¦‚æœè¾“å…¥ä¸ºnullï¼Œåˆ™åº”è¿”å›nullã€‚ è½¬æ¢å™¨çš„æ•°æ®åº“ç±»å‹æ„ä¹‰ä¸Šä¸æ˜¯SQLiteç±»å‹ï¼Œè€Œæ˜¯ç”±greenDAOæä¾›çš„åŸå§‹Javaç±»å‹ã€‚ å»ºè®®ä½¿ç”¨æ˜“äºè½¬æ¢çš„åŸºæœ¬ç±»å‹ï¼ˆintï¼Œlongï¼Œbyteæ•°ç»„ï¼ŒStringï¼Œâ€¦ï¼‰ã€‚ æ³¨æ„ï¼šä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼ŒgreenDAOå°†ä¸ºæ‰€æœ‰è½¬æ¢ä½¿ç”¨å•ä¸ªè½¬æ¢å™¨å®ä¾‹ã€‚ ç¡®ä¿è½¬æ¢å™¨é™¤äº†æ— å‚æ•°é»˜è®¤æ„é€ å‡½æ•°ä¹‹å¤–æ²¡æœ‰ä»»ä½•å…¶ä»–æ„é€ å‡½æ•°ã€‚ å¦å¤–ï¼Œä½¿å®ƒçº¿ç¨‹å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯èƒ½åœ¨å¤šä¸ªå®ä½“ä¸Šå¹¶å‘è°ƒç”¨ã€‚ 2. å¦‚ä½•æ­£ç¡®è½¬æ¢æšä¸¾æšä¸¾åœ¨åƒå®ä½“è¿™æ ·çš„æ•°æ®å¯¹è±¡ä¸­ä½¿å¾ˆå¸¸ç”¨çš„ã€‚ å½“æŒä¹…åŒ–æšä¸¾æ—¶ï¼Œæœ‰ä¸‹é¢å‡ ä¸ªä¸é”™çš„æ–¹æ³•ï¼š ä¸è¦æŒä¹…åŒ–æšä¸¾çš„åºå·æˆ–åç§°ï¼šä¸¤è€…éƒ½ä¸ç¨³å®šï¼Œå¹¶ä¸”å¾ˆæœ‰å¯èƒ½ä¸‹æ¬¡ç¼–è¾‘æšä¸¾å®šä¹‰çš„æ—¶å€™å°±å˜åŒ–äº†ã€‚ ä½¿ç”¨stable idsï¼šåœ¨ä½ çš„æšä¸¾ä¸­å®šä¹‰ä¸€ä¸ªä¿è¯ç¨³å®šçš„è‡ªå®šä¹‰å±æ€§ï¼ˆæ•´æ•°æˆ–å­—ç¬¦ä¸²ï¼‰ã€‚ ä½¿ç”¨å®ƒæ¥è¿›è¡ŒæŒä¹…æ€§æ˜ å°„ã€‚ æœªçŸ¥å€¼ï¼šå®šä¹‰ä¸€ä¸ªUNKNOWNæšä¸¾å€¼ã€‚ å®ƒå¯ä»¥ç”¨äºå¤„ç†ç©ºå€¼æˆ–æœªçŸ¥å€¼ã€‚ è¿™å°†å…è®¸ä½ å¤„ç†åƒæ—§çš„æšä¸¾å€¼è¢«åˆ é™¤è€Œä¸ä¼šå´©æºƒæ‚¨çš„åº”ç”¨ç¨‹åºçš„æƒ…å†µã€‚ 3. è‡ªå®šä¹‰ç±»å‹åœ¨æŸ¥è¯¢ä¸­çš„å¤„ç†QueryBuilderä¸çŸ¥é“è‡ªå®šä¹‰ç±»å‹ã€‚ æ‚¨å¿…é¡»å¯¹æŸ¥è¯¢ä½¿ç”¨åŸè¯­ç±»å‹ï¼ˆä¾‹å¦‚åœ¨WHEREå‚æ•°ä¸­ï¼‰ã€‚ è¿˜è¦æ³¨æ„ï¼Œåœ¨æ•°æ®åº“ä¸­å®Œæˆçš„æ“ä½œæ€»æ˜¯å¼•ç”¨åŸå§‹ç±»å‹ï¼Œä¾‹å¦‚åœ¨ORDER BYå­å¥ä¸­ã€‚ æ•°æ®åº“åŠ å¯†greenDAOæ”¯æŒåŠ å¯†çš„æ•°æ®åº“æ¥ä¿æŠ¤æ•æ„Ÿæ•°æ®ã€‚ è™½ç„¶è¾ƒæ–°ç‰ˆæœ¬çš„Androidæ”¯æŒæ–‡ä»¶ç³»ç»ŸåŠ å¯†ï¼Œä½†Androidæœ¬èº«å¹¶ä¸ä¸ºæ•°æ®åº“æ–‡ä»¶æä¾›åŠ å¯†ã€‚ å› æ­¤ï¼Œå¦‚æœæ”»å‡»è€…è·å¾—å¯¹æ•°æ®åº“æ–‡ä»¶çš„è®¿é—®ï¼ˆä¾‹å¦‚é€šè¿‡åˆ©ç”¨å®‰å…¨ç¼ºé™·æˆ–æ¬ºéª—æœ‰æ ¹çš„è®¾å¤‡çš„ç”¨æˆ·ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®è¯¥æ•°æ®åº“å†…çš„æ‰€æœ‰æ•°æ®ã€‚ ä½¿ç”¨å—å¯†ç ä¿æŠ¤çš„åŠ å¯†æ•°æ®åº“å¢åŠ äº†é¢å¤–çš„å®‰å…¨å±‚ã€‚ å®ƒé˜²æ­¢æ”»å‡»è€…ç®€å•åœ°æ‰“å¼€æ•°æ®åº“æ–‡ä»¶ã€‚ 1. ä½¿ç”¨è‡ªå®šä¹‰SQLiteæ„å»ºå› ä¸ºAndroidä¸æ”¯æŒåŠ å¯†æ•°æ®åº“ï¼Œæ‰€ä»¥ä½ éœ€è¦åœ¨APKä¸­æ†ç»‘SQLiteçš„è‡ªå®šä¹‰æ„å»ºã€‚ è¿™äº›å®šåˆ¶æ„å»ºåŒ…æ‹¬CPUç›¸å…³å’Œæœ¬åœ°ä»£ç ã€‚ æ‰€ä»¥ä½ çš„APKå¤§å°å°†å¢åŠ å‡ ä¸ªMByteã€‚ å› æ­¤ï¼Œä½ åº”è¯¥åªä½¿ç”¨åŠ å¯†ï¼Œå¦‚æœä½ çœŸçš„éœ€è¦å®ƒã€‚ 2. è®¾ç½®æ•°æ®åº“åŠ å¯†greenDAOç›´æ¥æ”¯æŒå¸¦æœ‰ç»‘å®šçš„SQLCipherã€‚ SQLCipheræ˜¯ä½¿ç”¨256ä½AESåŠ å¯†çš„SQLiteçš„è‡ªå®šä¹‰æ„å»ºã€‚ 2.1 æ·»åŠ SQLCipherä¾èµ–å…³ç³»è¯·å‚é˜…SQLCipher for Androidï¼Œäº†è§£å¦‚ä½•å‘é¡¹ç›®æ·»åŠ SQLCipherã€‚ 2.2 æ•°æ®åº“åˆå§‹åŒ–ç¡®ä¿ä½¿ç”¨DaoMasterä¸­æä¾›çš„OpenHelperçš„å­ç±»æ¥åˆ›å»ºæ•°æ®åº“å®ä¾‹ã€‚ ä¾‹å¦‚ç®€å•çš„DevOpenHelperï¼Œä¹Ÿåœ¨DaoMasterä¸­æä¾›ã€‚ ç„¶åï¼Œåœ¨åˆ›å»ºæ•°æ®åº“å®ä¾‹æ—¶ï¼Œåªéœ€è°ƒç”¨.getEncryptedWritableDbï¼ˆ&lt;password&gt;ï¼‰è€Œä¸æ˜¯.getWritableDbï¼ˆï¼‰ã€‚ æœ€åï¼Œåƒå¾€å¸¸ä¸€æ ·å°†æ•°æ®åº“ä¼ é€’ç»™DaoMasterï¼š 1234567DevOpenHelper helper = new DevOpenHelper(this, \"notes-db-encrypted.db\");Database db = helper.getEncryptedWritableDb(\"&lt;your-secret-password&gt;\");daoSession = new DaoMaster(db).newSession();DevOpenHelper helper = new DevOpenHelper(this, \"notes-db-encrypted.db\");Database db = helper.getEncryptedWritableDb(\"&lt;your-secret-password&gt;\");daoSession = new DaoMaster(db).newSession(); 3. æ•°æ®åº“æŠ½è±¡greenDAOå¯¹æ‰€æœ‰æ•°æ®åº“äº¤äº’ä½¿ç”¨ä¸€ä¸ªå°å‹çš„æŠ½è±¡å±‚ï¼Œå› æ­¤æ”¯æŒæ ‡å‡†å’Œéæ ‡å‡†çš„SQLiteå®ç°ï¼š Androidçš„æ ‡å‡†android.database.sqlite.SQLiteDatabase SQLCipherçš„net.sqlcipher.database.SQLiteDatabase ä»»ä½•SQLiteå…¼å®¹çš„æ•°æ®åº“ï¼Œå®ƒå¯ä»¥å®ç°org.greenrobot.greendao.database.Databaseï¼ˆä¾‹å¦‚SQLiteçš„è‡ªå®šä¹‰æ„å»ºï¼‰ è¿™ä½¿æ‚¨èƒ½å¤Ÿè½»æ¾åœ°ä»æ ‡å‡†æ•°æ®åº“åˆ‡æ¢åˆ°åŠ å¯†æ•°æ®åº“ï¼Œå› ä¸ºåœ¨é’ˆå¯¹DaoSessionå’Œå•ä¸ªDAOæ—¶ï¼Œä»£ç å°†æ˜¯ç›¸åŒçš„ã€‚ 3.1 ä½¿ç”¨Robolectricè¿›è¡Œå•å…ƒæµ‹è¯•æ•°æ®åº“æŠ½è±¡å…è®¸ç”¨Robolectricè¿›è¡Œå•å…ƒæµ‹è¯•ã€‚ å³ä½¿ä½ çš„åº”ç”¨ç¨‹åºä½¿ç”¨åŠ å¯†çš„æ•°æ®åº“ï¼Œä½ çš„æµ‹è¯•ä¹Ÿå¯ä»¥ä½¿ç”¨æœªåŠ å¯†çš„æ•°æ®åº“ã€‚ Robolectricå®ç°æ ‡å‡†çš„SQLite APIï¼Œæ²¡æœ‰åŠæ³•åŠ è½½è‡ªå®šä¹‰SQLiteæ„å»ºï¼ˆAndroidäºŒè¿›åˆ¶ï¼‰ã€‚ å› æ­¤ï¼Œå¯¹äºä½ çš„æµ‹è¯•ï¼Œåœ¨åˆ›å»ºæ•°æ®åº“å®ä¾‹æ—¶ä½¿ç”¨.getWritableDbï¼ˆï¼‰è€Œä¸æ˜¯.getEncryptedWritableDbï¼ˆ&lt;password&gt;ï¼‰ï¼ˆè§ä¸Šæ–‡ï¼‰ã€‚ 3.2 SQLCipherçš„å·²çŸ¥é—®é¢˜SQLCipheræ˜¯SQLiteçš„è‡ªå®šä¹‰æ„å»ºã€‚ å®ƒçš„Android APIä¸Androidç³»ç»ŸAPIæœ‰ç‚¹åˆ†æ­§ã€‚ è¿™é‡Œæ˜¯æˆ‘ä»¬æ³¨æ„åˆ°çš„é—®é¢˜ï¼ˆä¸greenDAOæ— å…³ï¼‰ï¼š æŠ›å‡ºçš„å¼‚å¸¸ä¸æ˜¯ç±»å‹android.database.SQLExceptionï¼ˆè¯·å‚é˜…SQLcipheré—®é¢˜223ï¼‰ SQLCipheræ¯”æœ€è¿‘çš„SQLiteDatabaseå®ç°é”å®šæ›´å¤šã€‚ è¿™ä¸ä»…é™ä½äº†å¹¶å‘æ€§ï¼Œè€Œä¸”å¢åŠ äº†æ­»é”çš„æœºä¼šã€‚ ä»SQLCipher 3.5.0å¼€å§‹ï¼Œç¼ºå°‘Androidå½’ç±»ï¼ˆå¦‚LOCALIZEDï¼‰ å†™åœ¨æœ€åä¸ªäººç¿»è¯‘ï¼Œç”¨äºåé¢æŸ¥é˜…ï¼Œè‹¥æœ‰ä¸å½“è¯·æ‹…å¾…~ åŸæ–‡é“¾æ¥ï¼šhttp://greenrobot.org/greendao/","link":"/2017/02/21/ã€ŠAndroid å¼€æºåº“ã€‹ GreenDAO ç”¨æ³•è¯¦è§£ï¼ˆè¯‘æ–‡ï¼‰/"}],"tags":[{"name":"AndroidåŸºç¡€","slug":"AndroidåŸºç¡€","link":"/tags/AndroidåŸºç¡€/"},{"name":"IDEAæ’ä»¶","slug":"IDEAæ’ä»¶","link":"/tags/IDEAæ’ä»¶/"},{"name":"Android Studio","slug":"Android-Studio","link":"/tags/Android-Studio/"},{"name":"é…ç½®","slug":"é…ç½®","link":"/tags/é…ç½®/"},{"name":"å·¥å…·","slug":"å·¥å…·","link":"/tags/å·¥å…·/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"CentOS","slug":"CentOS","link":"/tags/CentOS/"},{"name":"Docker","slug":"Docker","link":"/tags/Docker/"},{"name":"Gitlab","slug":"Gitlab","link":"/tags/Gitlab/"},{"name":"å¼€å‘é—®é¢˜","slug":"å¼€å‘é—®é¢˜","link":"/tags/å¼€å‘é—®é¢˜/"},{"name":"Mysql","slug":"Mysql","link":"/tags/Mysql/"},{"name":"Angular","slug":"Angular","link":"/tags/Angular/"},{"name":"Tomcat","slug":"Tomcat","link":"/tags/Tomcat/"},{"name":"Flutter","slug":"Flutter","link":"/tags/Flutter/"},{"name":"Androidå®æˆ˜","slug":"Androidå®æˆ˜","link":"/tags/Androidå®æˆ˜/"},{"name":"Gank.io","slug":"Gank-io","link":"/tags/Gank-io/"},{"name":"å¾®ä¿¡å…¬ä¼—å·","slug":"å¾®ä¿¡å…¬ä¼—å·","link":"/tags/å¾®ä¿¡å…¬ä¼—å·/"},{"name":"Markdown","slug":"Markdown","link":"/tags/Markdown/"},{"name":"PowerDesign","slug":"PowerDesign","link":"/tags/PowerDesign/"},{"name":"PMDReader","slug":"PMDReader","link":"/tags/PMDReader/"},{"name":"Androidå¼€æºåº“","slug":"Androidå¼€æºåº“","link":"/tags/Androidå¼€æºåº“/"},{"name":"RxJava","slug":"RxJava","link":"/tags/RxJava/"},{"name":"MacOS","slug":"MacOS","link":"/tags/MacOS/"},{"name":"Androidæºç ","slug":"Androidæºç ","link":"/tags/Androidæºç /"},{"name":"Aandroidå®æˆ˜","slug":"Aandroidå®æˆ˜","link":"/tags/Aandroidå®æˆ˜/"},{"name":"WanANdroid","slug":"WanANdroid","link":"/tags/WanANdroid/"},{"name":"è™šæ‹ŸåŒ–","slug":"è™šæ‹ŸåŒ–","link":"/tags/è™šæ‹ŸåŒ–/"},{"name":"Xen","slug":"Xen","link":"/tags/Xen/"},{"name":"ionic","slug":"ionic","link":"/tags/ionic/"},{"name":"Framework","slug":"Framework","link":"/tags/Framework/"},{"name":"å¼€æœºåŠ¨ç”»","slug":"å¼€æœºåŠ¨ç”»","link":"/tags/å¼€æœºåŠ¨ç”»/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","link":"/tags/å¤šçº¿ç¨‹/"},{"name":"Fragment","slug":"Fragment","link":"/tags/Fragment/"},{"name":"è‡ªå®šä¹‰View","slug":"è‡ªå®šä¹‰View","link":"/tags/è‡ªå®šä¹‰View/"},{"name":"HAL","slug":"HAL","link":"/tags/HAL/"},{"name":"å¸ƒå±€æ§ä»¶","slug":"å¸ƒå±€æ§ä»¶","link":"/tags/å¸ƒå±€æ§ä»¶/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/tags/è®¾è®¡æ¨¡å¼/"},{"name":"NDK","slug":"NDK","link":"/tags/NDK/"},{"name":"åŠ¨ç”»","slug":"åŠ¨ç”»","link":"/tags/åŠ¨ç”»/"},{"name":"å››å¤§ç»„ä»¶","slug":"å››å¤§ç»„ä»¶","link":"/tags/å››å¤§ç»„ä»¶/"},{"name":"MultiDex","slug":"MultiDex","link":"/tags/MultiDex/"},{"name":"Drawable","slug":"Drawable","link":"/tags/Drawable/"},{"name":"allowBackup","slug":"allowBackup","link":"/tags/allowBackup/"},{"name":"Smali","slug":"Smali","link":"/tags/Smali/"},{"name":"åº”ç”¨","slug":"åº”ç”¨","link":"/tags/åº”ç”¨/"},{"name":"MPAndroidChart","slug":"MPAndroidChart","link":"/tags/MPAndroidChart/"},{"name":"Kotlin","slug":"Kotlin","link":"/tags/Kotlin/"},{"name":"ç™¾åº¦åœ°å›¾","slug":"ç™¾åº¦åœ°å›¾","link":"/tags/ç™¾åº¦åœ°å›¾/"},{"name":"å¼€æºåº“","slug":"å¼€æºåº“","link":"/tags/å¼€æºåº“/"},{"name":"ç³»ç»Ÿæºç ","slug":"ç³»ç»Ÿæºç ","link":"/tags/ç³»ç»Ÿæºç /"},{"name":"èµ„æº","slug":"èµ„æº","link":"/tags/èµ„æº/"},{"name":"è¯‘æ–‡","slug":"è¯‘æ–‡","link":"/tags/è¯‘æ–‡/"},{"name":"Realm","slug":"Realm","link":"/tags/Realm/"},{"name":"LeetCode","slug":"LeetCode","link":"/tags/LeetCode/"},{"name":"å±€åŸŸç½‘","slug":"å±€åŸŸç½‘","link":"/tags/å±€åŸŸç½‘/"},{"name":"å¼€æº","slug":"å¼€æº","link":"/tags/å¼€æº/"},{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","link":"/tags/å¾®ä¿¡å°ç¨‹åº/"},{"name":"FileProvider","slug":"FileProvider","link":"/tags/FileProvider/"},{"name":"RecyclerView","slug":"RecyclerView","link":"/tags/RecyclerView/"},{"name":"è¾…åŠ©å·¥å…·","slug":"è¾…åŠ©å·¥å…·","link":"/tags/è¾…åŠ©å·¥å…·/"},{"name":"Retrofit","slug":"Retrofit","link":"/tags/Retrofit/"},{"name":"WebService","slug":"WebService","link":"/tags/WebService/"},{"name":"Picasso","slug":"Picasso","link":"/tags/Picasso/"}],"categories":[{"name":"AndroidåŸºç¡€","slug":"AndroidåŸºç¡€","link":"/categories/AndroidåŸºç¡€/"},{"name":"è¿ç»´","slug":"è¿ç»´","link":"/categories/è¿ç»´/"},{"name":"Angular","slug":"Angular","link":"/categories/Angular/"},{"name":"Flutter","slug":"Flutter","link":"/categories/Flutter/"},{"name":"Androidå¼€æºåº“","slug":"Androidå¼€æºåº“","link":"/categories/Androidå¼€æºåº“/"},{"name":"Androidç³»ç»Ÿ","slug":"Androidç³»ç»Ÿ","link":"/categories/Androidç³»ç»Ÿ/"},{"name":"Androidåº”ç”¨","slug":"Androidåº”ç”¨","link":"/categories/Androidåº”ç”¨/"},{"name":"ionic","slug":"ionic","link":"/categories/ionic/"},{"name":"Androidæºç ","slug":"Androidæºç ","link":"/categories/Androidæºç /"},{"name":"Androidå®‰å…¨","slug":"Androidå®‰å…¨","link":"/categories/Androidå®‰å…¨/"},{"name":"Androidè¿›é˜¶","slug":"Androidè¿›é˜¶","link":"/categories/Androidè¿›é˜¶/"},{"name":"Kotlin","slug":"Kotlin","link":"/categories/Kotlin/"},{"name":"LeetCode","slug":"LeetCode","link":"/categories/LeetCode/"},{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","link":"/categories/å¾®ä¿¡å°ç¨‹åº/"}]}