<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>标签: 开源库 - onlyloveyd</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="小码过河，人人喊累">
<meta name="keywords" content="onlyloveyd">
<meta property="og:type" content="website">
<meta property="og:title" content="onlyloveyd">
<meta property="og:url" content="http://yoursite.com/tags/开源库/page/3/index.html">
<meta property="og:site_name" content="onlyloveyd">
<meta property="og:description" content="小码过河，人人喊累">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/images/og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onlyloveyd">
<meta name="twitter:description" content="小码过河，人人喊累">
<meta name="twitter:image" content="http://yoursite.com/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="onlyloveyd" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags">标签</a></li>
            <li class="is-active"><a href="#" aria-current="page">开源库</a></li>
        </ul>
        </nav>
    </div>
</div>

    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-07T13:04:09.000Z">2017-03-07</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 分钟 读完 (大约 1662 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/07/《Android开源库》 Realm For Android~ Realm（译文）/">《Android开源库》 Realm For Android~ Realm（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a><a href></a>Realm</h2><p> Realm(s) 是我们对数据库的称谓：它包含多个不同的对象，并对应磁盘中的一个文件。在使用之前，需要对 Realm 库进行初始化操作：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Realm.init(context);</span><br></pre></td></tr></table></figure>

<p> 你需要提供一个安卓的 Context 对象来对 Realm 进行初始化。初始化操作只要进行一次。继承 Application 并在重载的 onCreate() 方法中进行初始化是个不错的主意。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class MyApplication extends Application &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public void onCreate() &#123;</span><br><span class="line">    super.onCreate();</span><br><span class="line">    Realm.init(this);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 请别忘了修改 AndroidManifest.xml:</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;application</span><br><span class="line">  android:name=&quot;.MyApplication&quot;</span><br><span class="line">  ...</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>


<h4 id="配置Realm"><a href="#配置Realm" class="headerlink" title="配置Realm"></a><a href></a>配置Realm</h4><p> RealmConfiguration 用来配置要被创建的 Realm 的各种特性。最简配置如下所示：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RealmConfiguration config = new RealmConfiguration.Builder().build();</span><br></pre></td></tr></table></figure>

<p> 如上配置的 Realm 会被存储在 Context.getFilesDir() 并且命名为 default.realm。</p>
<p> 一个典型的配置如下所示：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// The RealmConfiguration is created using the builder pattern.</span><br><span class="line">// The Realm file will be located in Context.getFilesDir() with name &quot;myrealm.realm&quot;</span><br><span class="line">RealmConfiguration config = new RealmConfiguration.Builder()</span><br><span class="line">  .name(&quot;myrealm.realm&quot;)</span><br><span class="line">  .encryptionKey(getKey())</span><br><span class="line">  .schemaVersion(42)</span><br><span class="line">  .modules(new MySchemaModule())</span><br><span class="line">  .migration(new MyMigration())</span><br><span class="line">  .build();</span><br><span class="line">// Use the config</span><br><span class="line">Realm realm = Realm.getInstance(config);</span><br></pre></td></tr></table></figure>

<p> 你还可以有多个RealmConfiguration。如此，你便可以控制Realm的版本、结构（schema）和路径。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">RealmConfiguration myConfig = new RealmConfiguration.Builder()</span><br><span class="line">  .name(&quot;myrealm.realm&quot;)</span><br><span class="line">  .schemaVersion(2)</span><br><span class="line">  .modules(new MyCustomSchema())</span><br><span class="line">  .build();</span><br><span class="line"></span><br><span class="line">RealmConfiguration otherConfig = new RealmConfiguration.Builder()</span><br><span class="line">  .name(&quot;otherrealm.realm&quot;)</span><br><span class="line">  .schemaVersion(5)</span><br><span class="line">  .modules(new MyOtherSchema())</span><br><span class="line">  .build();</span><br><span class="line"></span><br><span class="line">Realm myRealm = Realm.getInstance(myConfig);</span><br><span class="line">Realm otherRealm = Realm.getInstance(otherConfig);</span><br></pre></td></tr></table></figure>

<p> 你可以使用 Realm.getPath() 来获取 Realm 文件的绝对路径。</p>
<p> 很重要的一点是 Realm 实例是线程单例化的，也就是说多次在同一线程调用静态构建器会返回同一 Realm 实例。</p>
<hr>
<h4 id="默认-RealmConfiguration"><a href="#默认-RealmConfiguration" class="headerlink" title="默认 RealmConfiguration"></a><a href></a>默认 RealmConfiguration</h4><p> RealmConfiguration可以保存为默认配置。通过在自定义的Application设置默认的Realm配置，可以使你在代码中的其他地方更加方便地创建针对该默认配置的Realm。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class MyApplication extends Application &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public void onCreate() &#123;</span><br><span class="line">    super.onCreate();</span><br><span class="line">    // The Realm file will be located in Context.getFilesDir() with name &quot;default.realm&quot;</span><br><span class="line">    Realm.init(this);</span><br><span class="line">    RealmConfiguration config = new RealmConfiguration.Builder().build();</span><br><span class="line">    Realm.setDefaultConfiguration(config);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class MyActivity extends Activity &#123;</span><br><span class="line">  @Override</span><br><span class="line">  protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">    Realm realm = Realm.getDefaultInstance();</span><br><span class="line">    try &#123;</span><br><span class="line">      // ... Do something ...</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      realm.close();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="In-Memory-Realm"><a href="#In-Memory-Realm" class="headerlink" title="In-Memory Realm"></a><a href></a>In-Memory Realm</h4><p> 定义一个非持久化的、存在于内存中的 Realm 实例：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RealmConfiguration myConfig = new RealmConfiguration.Builder()</span><br><span class="line">    .name(&quot;myrealm.realm&quot;)</span><br><span class="line">    .inMemory()</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>

<p> 这样就可以创建一个存在于“内存中的” Realm。“内存中的”Realm 在内存紧张的情况下仍有可能使用到磁盘存储，但是这些磁盘空间都会在Realm实例完全关闭的时候被释放。</p>
<p> 请注意使用同样的名称同时创建“内存中的”Realm 和常规的（持久化）Realm 是不允许的。</p>
<p> 当某个“内存中的”Realm 的所有实例引用都被释放，该 Realm 下的数据也同时会被清除。建议在你的应用生命周期中保持对“内存中的” Realm 实例的引用以避免非期望的数据丢失。</p>
<hr>
<h4 id="Dynamic-Realm"><a href="#Dynamic-Realm" class="headerlink" title="Dynamic Realm"></a><a href></a>Dynamic Realm</h4><p> 对于普通的 Realm 来说，数据模型被定义成了 RealmObject 的子类。这样做保证了类型安全，但有时候某些数据模型在编译期是无法获得的。例如在处理数据迁移（migration）或CSV文件的时候。</p>
<p> DynamicRealm 是普通 Realm 的一个变种。它可以在没有 RealmObject 子类的情况下操作 Realm 数据。其对数据的访问是基于字符串而非 RealmObject 的定义。</p>
<p> 创建 Dynamic Realm 使用与创建普通 Realm 相同的RealmConfiguration，但是它的创建过程会忽略对 schema、migration以及 schema 版本的检查。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">RealmConfiguration realmConfig = new RealmConfiguration.Builder().build();</span><br><span class="line">DynamicRealm realm = DynamicRealm.getInstance(realmConfig);</span><br><span class="line"></span><br><span class="line">// In a DynamicRealm all objects are DynamicRealmObjects</span><br><span class="line">DynamicRealmObject person = realm.createObject(&quot;Person&quot;);</span><br><span class="line"></span><br><span class="line">// All fields are accessed using strings</span><br><span class="line">String name = person.getString(&quot;name&quot;);</span><br><span class="line">int age = person.getInt(&quot;age&quot;);</span><br><span class="line"></span><br><span class="line">// An underlying schema still exists, so accessing a field that does not exist</span><br><span class="line">// will throw an exception</span><br><span class="line">person.getString(&quot;I don&apos;t exist&quot;);</span><br><span class="line"></span><br><span class="line">// Queries still work normally</span><br><span class="line">RealmResults&lt;DynamicRealmObject&gt; persons = realm.where(&quot;Person&quot;)</span><br><span class="line">    .equalTo(&quot;name&quot;, &quot;John&quot;)</span><br><span class="line">    .findAll();</span><br></pre></td></tr></table></figure>

<p> DynamicRealm 以类型安全和性能为代价，换来了更多的灵活性。请在你确实需要这些灵活性的情况下使用。</p>
<hr>
<h4 id="关闭Realm实例"><a href="#关闭Realm实例" class="headerlink" title="关闭Realm实例"></a><a href></a>关闭Realm实例</h4><p> Realm 实现了 Closeable 接口以便与释放 native 内存和文件描述符，请务必在使用完毕后关闭 Realm 实例。</p>
<p> Realm 实例是基于引用计数的, 也就是说假设你在同一个线程中调用了 getInstance() 两次，你需要同样调用 close() 两次以关闭该实例。举例来说，如果你需要实现 Runnable，简单地在函数开始的时候调用 getInstance()，在函数结束的时候调用 close() 即可！</p>
<p> 对于UI线程，你可以选择在 onDestroy() 方法内调用 realm.close()。</p>
<p> 如果你想使用除 UI 线程外的 Looper 线程，可以参考以下代码：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class MyThread extends Thread &#123;</span><br><span class="line"></span><br><span class="line">    private Realm realm;</span><br><span class="line"></span><br><span class="line">    public void run() &#123;</span><br><span class="line">        Looper.prepare();</span><br><span class="line">        try &#123;</span><br><span class="line">            realm = Realm.getDefaultInstance();</span><br><span class="line">            //... Setup the handlers using the Realm instance ...</span><br><span class="line">            Lopper.loop();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (realm != null) &#123;</span><br><span class="line">                realm.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 对于 AsyncTask，这里有个不错的例子可以参考：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">protected Void doInBackground(Void... params) &#123;</span><br><span class="line">    Realm realm = Realm.getDefaultInstance();</span><br><span class="line">    try &#123;</span><br><span class="line">        // ... Use the Realm instance ...</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        realm.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 如果你想使用 Thread 和 Runnable 进行一些短期任务，参考如下代码：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/ Run a non-Looper thread with a Realm instance.</span><br><span class="line">Thread thread = new Thread(new Runnable() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        Realm realm = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            realm = Realm.getDefaultInstance();</span><br><span class="line">            // ... Use the Realm instance ...</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (realm != null) &#123;</span><br><span class="line">                realm.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">thread.start();</span><br></pre></td></tr></table></figure>

<p> 如果你很幸运地工作在 minSdkVersion &gt;= 19 且 Java &gt;= 7 之下，可以使用try-with-resources：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">try (Realm realm = Realm.getDefaultInstance()) &#123;</span><br><span class="line">    // No need to close the Realm instance manually</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="自动刷新"><a href="#自动刷新" class="headerlink" title="自动刷新"></a><a href></a>自动刷新</h4><p> 如果 Realm 实例存在于一个带有 Looper 的线程，那么这个 Realm 实例即具有自动更新的功能。这意味这如果发生了 Realm 数据库的变化，那么该 Realm 实例会在下一个事件循环（event loop）中自动更新。这个便捷的功能使你不必花费太多的精力就能保证的UI与数据的实时同步。</p>
<p> 如果 Realm 的实例所在线程没有绑定 Looper，那么该实例不会被更新直到你手动调用 waitForChange() 方法。请注意，不更新 Realm 以保持对旧数据的引用会造成而外的磁盘和内存开销。这也是为什么要在线程结束时调用 close() 关闭 Realm 实例的一个重要原因。</p>
<p> 如果你想确定当前 Realm 实例是否有自动更新功能，可以通过调用 isAutoRefresh() 方法查询。</p>
<hr>
<h4 id="查找-Realm-数据库文件"><a href="#查找-Realm-数据库文件" class="headerlink" title="查找 Realm 数据库文件"></a><a href></a>查找 Realm 数据库文件</h4><p> 如果你想知道你应用的 Realm 文件的具体路径，请参见这个 StackOverflow上的答案。</p>
<h2 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a><a href></a>原文链接</h2><p> <a href="https://realm.io/docs/java/latest/#realms" target="_blank" rel="noopener">https://realm.io/docs/java/latest/#realms</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-06T02:32:43.000Z">2017-03-06</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    20 分钟 读完 (大约 3072 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/06/《Android开源库》 Realm For Android~ Queries（译文）/">《Android开源库》 Realm For Android~ Queries（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a><a href></a>查询</h2><blockquote>
<p>Realm 中的所有读取（包括查询）操作都是延迟执行的，且数据绝不会被拷贝。</p>
<p> Realm 的查询引擎使用 Fluent interface 来构造多条件查询。<br> 使用 User 类 -</p>
</blockquote>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class User extends RealmObject &#123;</span><br><span class="line"></span><br><span class="line">    @PrimaryKey</span><br><span class="line">    private String          name;</span><br><span class="line">    private int             age;</span><br><span class="line"></span><br><span class="line">    @Ignore</span><br><span class="line">    private int             sessionId;</span><br><span class="line"></span><br><span class="line">    // Standard getters &amp; setters generated by your IDE…</span><br><span class="line">    public String getName() &#123; return name; &#125;</span><br><span class="line">    public void   setName(String name) &#123; this.name = name; &#125;</span><br><span class="line">    public int    getAge() &#123; return age; &#125;</span><br><span class="line">    public void   setAge(int age) &#123; this.age = age; &#125;</span><br><span class="line">    public int    getSessionId() &#123; return sessionId; &#125;</span><br><span class="line">    public void   setSessionId(int sessionId) &#123; this.sessionId = sessionId; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 比如查找所有叫做 John 或 Peter 的用户，你可以这么写：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// Build the query looking at all users:</span><br><span class="line">RealmQuery&lt;User&gt; query = realm.where(User.class);</span><br><span class="line"></span><br><span class="line">// Add query conditions:</span><br><span class="line">query.equalTo(&quot;name&quot;, &quot;John&quot;);</span><br><span class="line">query.or().equalTo(&quot;name&quot;, &quot;Peter&quot;);</span><br><span class="line"></span><br><span class="line">// Execute the query:</span><br><span class="line">RealmResults&lt;User&gt; result1 = query.findAll();</span><br><span class="line"></span><br><span class="line">// Or alternatively do the same all at once (the &quot;Fluent interface&quot;):</span><br><span class="line">RealmResults&lt;User&gt; result2 = realm.where(User.class)</span><br><span class="line">                                  .equalTo(&quot;name&quot;, &quot;John&quot;)</span><br><span class="line">                                  .or()</span><br><span class="line">                                  .equalTo(&quot;name&quot;, &quot;Peter&quot;)</span><br><span class="line">                                  .findAll();</span><br></pre></td></tr></table></figure>

<p> 这个查询将返回一个包含名为John或者Peter的人的RealmResults实例。在findAll()方法被调用的时候，查询操作就执行了。findAll()是findAll家族的一员，例如findAllSorted()将返回一个排序后的结果集；findAllAsync()将在后台线程中执行异步查询。具体详情请阅<a href="https://realm.io/docs/java/latest/api/io/realm/RealmQuery.html" target="_blank" rel="noopener">API指南</a>。</p>
<p> 这些对象并非拷贝，也就是说你得到的是一个匹配对象引用的列表，你对匹配对象所有的操作都是直接施加于它的原始对象。RealmResults 继承自 Java 的 AbstractList，行为类似。例如你可以通过 index 来访问其中的某个对象。<br> 当查询没有任何匹配时，返回的 RealmResults 对象将不会为 null，取而代之的是它的 size() 方法将返回 0。</p>
<p> 修改或删除 RealmResults 中任何一个对象都必须在写入事务中完成。</p>
<p> 你也可以查询<a href="https://realm.io/docs/java/latest/#link-queries" target="_blank" rel="noopener">关系</a>.</p>
<hr>
<h4 id="查询条件"><a href="#查询条件" class="headerlink" title="查询条件"></a><a href></a>查询条件</h4><p> 使用where()方法构建一个由RealmQuery 对象代表的查询。一旦构建了RealmQuery ，你可以使用各种各样的谓词来过滤查询得到的数据。大多数谓词意义从字面上都能看出来。</p>
<p> 谓词的第一个参数是字段名。 如果字段的类型不支持谓词，则抛出异常。 有关详细信息，请参阅RealmQuery的API参考。</p>
<p> 对于所有数据类型，你有以下谓词：</p>
<ul>
<li><p>equalTo() </p>
</li>
<li><p>notEqualTo()  要将字段与值列表匹配，请使用in（）。 例如，要查找名称“Jill”，“William”或“Trillian”，您可以在（“name”，new String [] {“Jill”，“William”，“Trillian”}中使用。 in（）谓词适用于字符串，二进制数据和数字字段。</p>
<p>数字数据类型（包括日期）允许这些附加谓词：</p>
</li>
</ul>
<ul>
<li>between() (两个端点会被包含在内, 即，有界间隔) </li>
<li>greaterThan() </li>
<li>lessThan() </li>
<li>greaterThanOrEqualTo() </li>
<li>lessThanOrEqualTo()  字符串字段允许如下附加谓词：</li>
</ul>
<ul>
<li><p>contains() </p>
</li>
<li><p>beginsWith() </p>
</li>
<li><p>endsWith() </p>
</li>
<li><p>like()  所有四个字符串谓词都有可选的第三个参数，用于控制大小写区分。 将其设置为Case.INSENSITIVE以在匹配时忽略大小写，或者将Case.SENSITIVE设置为执行区分大小写匹配。 默认值为Case.SENSITIVE。</p>
<p>谓词like（）执行glob样式通配符匹配。 匹配模式由字符和一个或多个通配符组成：</p>
</li>
</ul>
<ul>
<li><ul>
<li>匹配0个或多个Unicode字符 </li>
</ul>
</li>
<li><p>？匹配1个Unicode字符  例如，考虑一个有四个对象的Realm，名为name的字段，其值有William，Bill，Jill和Trillian。 类似于（“name”，“？ill <em>”）的谓词将匹配前三个对象，类似（“name”，“</em> ia？”）将匹配第一个和最后一个对象。</p>
<p>二进制数据，字符串和RealmObject（RealmList）的列表可以是空的，即具有零的长度。 如下是检查是否为空的谓词：</p>
</li>
</ul>
<ul>
<li>isEmpty() </li>
<li>isNotEmpty()  如果不是必填字段，则值可以为null（记住，RealmObjects字段不是必填，值可以为null）。 用于匹配空值的两个有用谓词是：</li>
</ul>
<ul>
<li>isNull() </li>
<li>isNotNull()  </li>
</ul>
<hr>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a><a href></a>逻辑运算符</h4><p> 每个查询条件都会被被隐式地被逻辑和（&amp;）组合在一起，而逻辑或（or）需要显式地去执行 or()。</p>
<p> 使用 User 类 -</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class User extends RealmObject &#123;</span><br><span class="line"></span><br><span class="line">    @PrimaryKey</span><br><span class="line">    private String          name;</span><br><span class="line">    private int             age;</span><br><span class="line"></span><br><span class="line">    @Ignore</span><br><span class="line">    private int             sessionId;</span><br><span class="line"></span><br><span class="line">    // Standard getters &amp; setters generated by your IDE…</span><br><span class="line">    public String getName() &#123; return name; &#125;</span><br><span class="line">    public void   setName(String name) &#123; this.name = name; &#125;</span><br><span class="line">    public int    getAge() &#123; return age; &#125;</span><br><span class="line">    public void   setAge(int age) &#123; this.age = age; &#125;</span><br><span class="line">    public int    getSessionId() &#123; return sessionId; &#125;</span><br><span class="line">    public void   setSessionId(int sessionId) &#123; this.sessionId = sessionId; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 你也可以将查询条件组合在一起，使用 beginGroup()（相当于左括号）和 endGroup()（相当于右括号）：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; r = realm.where(User.class)</span><br><span class="line">                            .greaterThan(&quot;age&quot;, 10)  // implicit AND</span><br><span class="line">                            .beginGroup()</span><br><span class="line">                                .equalTo(&quot;name&quot;, &quot;Peter&quot;)</span><br><span class="line">                                .or()</span><br><span class="line">                                .contains(&quot;name&quot;, &quot;Jo&quot;)</span><br><span class="line">                            .endGroup()</span><br><span class="line">                            .findAll();</span><br></pre></td></tr></table></figure>

<p> 此外，也可以用 not() 否定一个条件。该 not() 运算符可以与 beginGroup()/endGroup() 一起使用来否定子条件。假如说你想查询名字不是“Peter”或者“Jo.”的User。查询方式如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RealmResult&lt;User&gt; r = realm.where(User.class)</span><br><span class="line">                           .not()</span><br><span class="line">                           .beginGroup()</span><br><span class="line">                                .equalTo(&quot;name&quot;, &quot;Peter&quot;)</span><br><span class="line">                                .or()</span><br><span class="line">                                .contains(&quot;name&quot;, &quot;Jo&quot;)</span><br><span class="line">                            .endGroup()</span><br><span class="line">                            .findAll();</span><br></pre></td></tr></table></figure>

<p> 当然，对于这种特定的查询，使用in()更为简洁：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RealmResult&lt;User&gt; r = realm.where(User.class)</span><br><span class="line">                   .not()</span><br><span class="line">                   .in(&quot;name&quot;, new String[]&#123;&quot;Peter&quot;, &quot;Jo&quot;&#125;)</span><br><span class="line">                    finalAll();</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a><a href></a>排序</h4><p> 当你执行完查询获得结果后，可以对它进行排序：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; result = realm.where(User.class).findAll();</span><br><span class="line">result = result.sort(&quot;age&quot;); // Sort ascending</span><br><span class="line">result = result.sort(&quot;age&quot;, Sort.DESCENDING);</span><br></pre></td></tr></table></figure>

<p> 排序默认为升序; 使用Sort.DESCENDING作为第二个可选参数可以修改为降序。 可以同时使用多个字段进行排序。</p>
<hr>
<h4 id="唯一值"><a href="#唯一值" class="headerlink" title="唯一值"></a><a href></a>唯一值</h4><p> 使用distinct（）谓词仅返回唯一值。 例如，要了解你的Realm中有多少不同的名字：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;Person&gt; unique = realm.where(Person.class).distinct(&quot;name&quot;);</span><br></pre></td></tr></table></figure>

<p> 只支持整数和字符串字段; 如果你尝试使用distinct（）不支持的字段类型，将抛出异常。 与排序一样，你可以指定多个字段。</p>
<hr>
<h4 id="链式查询"><a href="#链式查询" class="headerlink" title="链式查询"></a><a href></a>链式查询</h4><p> 因为查询结果并不会被复制，且在查询提交时并不会被执行，你可以链式串起查询并逐步进行分类筛选：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;Person&gt; teenagers = realm.where(Person.class).between(&quot;age&quot;, 13, 20).findAll();</span><br><span class="line">Person firstJohn = teenagers.where().equalTo(&quot;name&quot;, &quot;John&quot;).findFirst();</span><br></pre></td></tr></table></figure>

<p> 你也可以在子对象上使用链式查询。假设以上 Person 对象包含一个 Dog 对象列表：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class Dog extends RealmObject &#123;</span><br><span class="line">    private int age;</span><br><span class="line">    // getters &amp; setters ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Person extends RealmObject &#123;</span><br><span class="line">    private int age;</span><br><span class="line">    private RealmList&lt;Dog&gt; dogs;</span><br><span class="line">    // getters &amp; setters ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 你可以查询找出所有年龄在 13 和 20 之间的 Person 并且他至少拥有一个 1 岁的 Dog：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;Person&gt; teensWithPups = realm.where(Person.class).between(&quot;age&quot;, 13, 20).equalTo(&quot;dogs.age&quot;, 1).findAll();</span><br></pre></td></tr></table></figure>

<p> 请注意，查询链最终是建立在 RealmResults 上而非 RealmQuery。如果你在某存在的 RealmQuery 上添加更多的查询条件，那么你在修改查询本身，而非查询链。请参考<a href="https://realm.io/docs/java/latest/#link-queries" target="_blank" rel="noopener">关联查询</a>。</p>
<hr>
<h4 id="查询结果的自动更新（Auto-Updating-Results）"><a href="#查询结果的自动更新（Auto-Updating-Results）" class="headerlink" title="查询结果的自动更新（Auto-Updating Results）"></a><a href></a>查询结果的自动更新（Auto-Updating Results）</h4><p> RealmResults 是对其所包含数据的实时、自动更新视图，这意味着它永远不需要被重新查询获取。数据对象的改变会在下一次 Looper 事件中被反映到相应的查询结果。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">final RealmResults&lt;Dog&gt; puppies = realm.where(Dog.class).lessThan(&quot;age&quot;, 2).findAll();</span><br><span class="line">puppies.size(); // =&gt; 0</span><br><span class="line"></span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    void public execute(Realm realm) &#123;</span><br><span class="line">        Dog dog = realm.createObject(Dog.class);</span><br><span class="line">        dog.setName(&quot;Fido&quot;);</span><br><span class="line">        dog.setAge(1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">puppies.addChangeListener(new RealmChangeListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onChange(RealmResults&lt;Dog&gt; results) &#123;</span><br><span class="line">      // results and puppies point are both up to date</span><br><span class="line">      results.size(); // =&gt; 1</span><br><span class="line">      puppies.size(); // =&gt; 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p> 这对所有的 RealmResults 有效 —— 无论是否有过滤条件、是否是链式查询。</p>
<p> RealmResults 的这个特性不仅使得 Realm 快速高效，而且让你的代码更简洁。举例来说，假设你的 Activity 或者 Fragment 依赖于某个查询结果，你可以将相应的 Realm 对象或者 RealmResults 保存为一个属性，你不需要在每次访问时确定其是否被更新 —— Realm 会保证这些。</p>
<p> 你可以通过订阅 <a href="https://realm.io/cn/docs/java/latest/#notifications" target="_blank" rel="noopener">Realm notifications</a> 来得知 Realm 数据更新了，进而刷新 UI 而不必重新查询获得 RealmResults。</p>
<p> 因为查询结果的自动更新特性，请不要依赖于固定的索引（indices）、不变的条目数。</p>
<hr>
<h4 id="按类型检索对象"><a href="#按类型检索对象" class="headerlink" title="按类型检索对象"></a><a href></a>按类型检索对象</h4><p> 从 Realm 中检索对象的最基本方法是 realm.where(Foo.class).findAll()，它返回了包含被查询模型类的所有对象的 RealmResults。</p>
<p> 另外还有提供排序功能的 findAll()。参见 realm.where(Foo.class).findAllSorted() 了解详情。</p>
<hr>
<h4 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a><a href></a>聚合</h4><p> RealmResult 自带一些聚合方法：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; results = realm.where(User.class).findAll();</span><br><span class="line">long   sum     = results.sum(&quot;age&quot;).longValue();</span><br><span class="line">long   min     = results.min(&quot;age&quot;).longValue();</span><br><span class="line">long   max     = results.max(&quot;age&quot;).longValue();</span><br><span class="line">double average = results.average(&quot;age&quot;);</span><br><span class="line"></span><br><span class="line">long   matches = results.size();</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a><a href></a>迭代</h4><p> 可以这样遍历 RealmResults：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; results = realm.where(User.class).findAll();</span><br><span class="line">for (User u : results) &#123;</span><br><span class="line">    // ... do something with the object ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 或者使用 for 循环：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; results = realm.where(User.class).findAll();</span><br><span class="line">for (int i = 0; i &lt; results.size(); i++) &#123;</span><br><span class="line">    User u = results.get(i);</span><br><span class="line">    // ... do something with the object ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> RealmResults 的自动更新会通过 looper 事件触发，但在事件到来之前，某些元素有可能不再满足查询条件或者其已被删除。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">final RealmResults&lt;User&gt; users = getUsers();</span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        users.get(0).deleteFromRealm(); // indirectly delete object</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">for (User user : users) &#123;</span><br><span class="line">    showUser(user); // Will crash for the deleted user</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 为避免该问题，可以使用 RealmResults 的 deleteFromRealm() 方法：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">final RealmResults&lt;User&gt; users = getUsers();</span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        users.deleteFromRealm(0); // Delete and remove object directly</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">for (User user : users) &#123;</span><br><span class="line">    showUser(user); // Deleted user will not be shown</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a><a href></a>删除</h4><p> 你可以从查询结果中删除数据：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// obtain the results of a query</span><br><span class="line">final RealmResults&lt;Dog&gt; results = realm.where(Dog.class).findAll();</span><br><span class="line"></span><br><span class="line">// All changes to data must happen in a transaction</span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        // remove single match</span><br><span class="line">        results.deleteFirstFromRealm();</span><br><span class="line">        results.deleteLastFromRealm();</span><br><span class="line"></span><br><span class="line">        // remove a single object</span><br><span class="line">        Dog dog = results.get(5);</span><br><span class="line">        dog.deleteFromRealm();</span><br><span class="line"></span><br><span class="line">        // Delete all matches</span><br><span class="line">        results.deleteAllFromRealm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="异步查询（Asynchronous-Queries）"><a href="#异步查询（Asynchronous-Queries）" class="headerlink" title="异步查询（Asynchronous Queries）"></a><a href></a>异步查询（Asynchronous Queries）</h4><p> 可以使用后台线程进行查询。</p>
<p> Realm 的大部分查询都非常快——快到可以使用在UI线程中而感觉不到延迟。但如果需要进行非常复杂的查询或者在大量数据中进行查询，那么使用后台线程进行查询将会是一个不错的主意。</p>
<p> 示例：查找名字为 “John” 或者 “Peter” 的用户。</p>
<p> <a href></a>创建异步查询 </p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; result = realm.where(User.class)</span><br><span class="line">                              .equalTo(&quot;name&quot;, &quot;John&quot;)</span><br><span class="line">                              .or()</span><br><span class="line">                              .equalTo(&quot;name&quot;, &quot;Peter&quot;)</span><br><span class="line">                              .findAllAsync();</span><br></pre></td></tr></table></figure>

<p> 请注意，这里的调用并不会阻塞，而是立即返回一个 RealmResults。这很类似于标准 Java 中 <a href="https://developer.android.com/reference/java/util/concurrent/Future.html" target="_blank" rel="noopener">Future</a> 的概念。查询将会在后台线程中被执行，当其完成时，之前返回的 RealmResults 实例会被更新。</p>
<p> 如果你希望当查询完成、RealmResults 被更新时获得通知，你可以注册一个 RealmChangeListener。这个监听器会在 RealmResults 被更新时被调用（通常是在事务被提交后）。</p>
<h5 id="注册回调"><a href="#注册回调" class="headerlink" title="注册回调"></a><a href></a>注册回调</h5><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">private RealmChangeListener callback = new RealmChangeListener&lt;RealmResults&lt;User&gt;&gt;() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onChange(RealmResults&lt;User&gt; results) &#123;</span><br><span class="line">        // called once the query complete and on every update</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">public void onStart() &#123;</span><br><span class="line">    RealmResults&lt;User&gt; result = realm.where(User.class).findAllAsync();</span><br><span class="line">    result.addChangeListener(callback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 请在退出 Activity 或者 Fragment 时移除监听器的注册以避免内存泄漏。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public void onStop () &#123;</span><br><span class="line">    result.removeChangeListener(callback); // remove a particular listener</span><br><span class="line">    // or</span><br><span class="line">    result.removeChangeListeners(); // remove all registered listeners</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h5 id="检查查询是否完成"><a href="#检查查询是否完成" class="headerlink" title="检查查询是否完成"></a><a href></a>检查查询是否完成</h5><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; result = realm.where(User.class).findAllAsync();</span><br><span class="line">if (result.isLoaded()) &#123;</span><br><span class="line">  // Results are now available</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 同步查询返回的 RealmResults 实例的 isLoaded 方法会永远返回 true。</p>
<h5 id="强制装载异步查询"><a href="#强制装载异步查询" class="headerlink" title="强制装载异步查询"></a><a href></a>强制装载异步查询</h5><p> 你可以选择性地等待异步查询完成，而这将会阻塞当前线程，使查询变成同步（与 <a href="https://developer.android.com/reference/java/util/concurrent/Future.html#get()" target="_blank" rel="noopener">Future.get()</a> 类似的概念）。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;User&gt; result = realm.where(User.class).findAllAsync();</span><br><span class="line">result.load() // be careful, this will block the current thread until it returns</span><br></pre></td></tr></table></figure>


<h5 id="非-Looper-线程"><a href="#非-Looper-线程" class="headerlink" title="非 Looper 线程"></a><a href></a>非 Looper 线程</h5><p> 你可以在 Looper 线程中使用异步查询。异步查询需要使用 <a href="https://developer.android.com/reference/android/os/Handler.html" target="_blank" rel="noopener">Handler</a> 来传递查询结果。在没有 <a href="https://developer.android.com/reference/android/os/Looper.html" target="_blank" rel="noopener">Looper</a> 的线程中使用异步查询会导致 IllegalStateException 异常被抛出。</p>
<h2 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a><a href></a>原文链接</h2><p> <a href="https://realm.io/docs/java/latest/#queries" target="_blank" rel="noopener">https://realm.io/docs/java/latest/#queries</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-05T13:04:49.000Z">2017-03-05</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    21 分钟 读完 (大约 3115 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/05/《Android开源库》 Realm For Android~ RelationShips and Writes（译文）/">《Android开源库》 Realm For Android~ RelationShips and Writes（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="关系"><a href="#关系" class="headerlink" title="关系"></a><a href></a>关系</h2><p> 任何两个RealmObject都可以链接在一起。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Email extends RealmObject &#123;</span><br><span class="line">    private String address;</span><br><span class="line">    private boolean active;</span><br><span class="line">    // ... setters and getters left out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Contact extends RealmObject &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private Email email;</span><br><span class="line">    // ... setters and getters left out</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 关系在Realm中开销不大。这意味着保持连接并不会影响速度，并且关系的内部实现在使用内存上也是相当高效的。</p>
<h4 id="多对一"><a href="#多对一" class="headerlink" title="多对一"></a><a href></a>多对一</h4><p> 在类中简单的定义一个继承自RealmObject的子类作为成员即可：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public class Contact extends RealmObject &#123;</span><br><span class="line">    private Email email;</span><br><span class="line">    // Other fields…</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 每个联系人（Contact的实例）都有0或1个电子邮件（Email实例）。在Realm中，没有什么可以阻止你在多个联系人中使用相同的电子邮件对象，上述模型可以是多对一关系，但通常用于建模一对一关系。</p>
<p> 设置RealmObject字段null将清除引用，但对象不会从Realm中删除</p>
<hr>
<h4 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a><a href></a>多对多</h4><p> 你可以通过RealmList字段声明从单个对象与任意数量的对象建立关系。例如，假设有多个电子邮件地址的联系人</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Contact extends RealmObject &#123;</span><br><span class="line">    public String name;</span><br><span class="line">    public RealmList&lt;Email&gt; emails;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Email extends RealmObject &#123;</span><br><span class="line">    public String address;</span><br><span class="line">    public boolean active;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> RealmLists基本上是RealmObjects的容器，并且RealmList和一个普通的Java List用法基本相同。Realm在不同的RealmLists中可以使用相同的对象两次（或更多），没有限制，因此你可以使用它来建模一对多和多对多关系。</p>
<p> 你可以创建对象，并使用RealmList.add()将Email对象添加到Contact对象：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        Contact contact = realm.createObject(Contact.class);</span><br><span class="line">        contact.name = &quot;John Doe&quot;;</span><br><span class="line"></span><br><span class="line">        Email email1 = realm.createObject(Email.class);</span><br><span class="line">        email1.address = &quot;john@example.com&quot;;</span><br><span class="line">        email1.active = true;</span><br><span class="line">        contact.emails.add(email1);</span><br><span class="line"></span><br><span class="line">        Email email2 = realm.createObject(Email.class);</span><br><span class="line">        email2.address = &quot;jd@example.com&quot;;</span><br><span class="line">        email2.active = false;</span><br><span class="line">        contact.emails.add(email2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p> 可以声明递归关系，当建模某些类型的数据时，这些关系可能很有用</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class Person extends RealmObject &#123;</span><br><span class="line">    public String name;</span><br><span class="line">    public RealmList&lt;Person&gt; friends;</span><br><span class="line">    // Other fields…</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 将RealmList字段的值设置null将清除列表。也就是说，列表将为空（长度为零），但没有对象会被删除。通过getter方法获取RealmList将永远不会返回null。返回的对象总是一个列表，但长度可能为零。</p>
<hr>
<h4 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a><a href></a>连接查询</h4><p> 查询连接和关系时可以的。考虑如下模型：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Person extends RealmObject &#123;</span><br><span class="line">  private String id;</span><br><span class="line">  private String name;</span><br><span class="line">  private RealmList&lt;Dog&gt; dogs;</span><br><span class="line">  // getters and setters</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Dog extends RealmObject &#123;</span><br><span class="line">  private String id;</span><br><span class="line">  private String name;</span><br><span class="line">  private String color;</span><br><span class="line">  // getters and setters</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 每个Person可以和狗建立一对多的关系，正如下表所示：</p>
<p> <img src="https://img-blog.csdn.net/20170305192726691" alt="这里写图片描述"></p>
<p> 使用连接查询来找一些人</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// persons =&gt; [U1,U2]</span><br><span class="line">RealmResults&lt;Person&gt; persons = realm.where(Person.class)</span><br><span class="line">                                .equalTo(&quot;dogs.color&quot;, &quot;Brown&quot;)</span><br><span class="line">                                .findAll();</span><br></pre></td></tr></table></figure>

<p> 首先，请注意，条件中的字段名称”equalTo”包含通过关系的路径（以句点分隔.）。</p>
<p> 上述查询应读取，查找到拥有名为”布朗”的狗的所有人。重要的是要理解，结果将包含不满足条件的Dog对象，因为它们是Person对象的一部分。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">persons.get(0).getDogs(); // =&gt; [A,B]</span><br><span class="line">persons.get(1).getDogs(); // =&gt; [B,C,D]</span><br></pre></td></tr></table></figure>

<p> 这可以通过以下两个查询进一步检查。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// r1 =&gt; [U1,U2]</span><br><span class="line">RealmResults&lt;Person&gt; r1 = realm.where(Person.class)</span><br><span class="line">                             .equalTo(&quot;dogs.name&quot;, &quot;Fluffy&quot;)</span><br><span class="line">                             .findAll();</span><br><span class="line"></span><br><span class="line">// r2 =&gt; [U1,U2]</span><br><span class="line">RealmResults&lt;Person&gt; r2 = r1.where()</span><br><span class="line">                          .equalTo(&quot;dogs.color&quot;, &quot;Brown&quot;)</span><br><span class="line">                          .findAll();</span><br></pre></td></tr></table></figure>

<p> 注意第一个查询如何返回这两个Person对象，因为条件与两个人都匹配。每个Person查询结果都包含一个Dog对象列表- 它们的所有Dog对象（即使是那些不满足原始查询条件的对象）。记住，我们正在寻找有特定种类的Dog（姓名和颜色）的人，而不是实际的狗本身。因此，第二个查询将针对第一个Person查询result（r1）和每个Persons狗进行评估。第二个查询也匹配两个人，但这次是因为狗的颜色。</p>
<p> 让我们深入一点，以帮助巩固这个概念。请查看以下示例：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/ r1 =&gt; [U1,U2]</span><br><span class="line">RealmResults&lt;Person&gt; r1 = realm.where(Person.class)</span><br><span class="line">                             .equalTo(&quot;dogs.name&quot;, &quot;Fluffy&quot;)</span><br><span class="line">                             .equalTo(&quot;dogs.color&quot;, &quot;Brown&quot;)</span><br><span class="line">                             .findAll();</span><br><span class="line"></span><br><span class="line">// r2 =&gt; [U2]</span><br><span class="line">RealmResults&lt;Person&gt; r2 = realm.where(Person.class)</span><br><span class="line">                             .equalTo(&quot;dogs.name&quot;, &quot;Fluffy&quot;)</span><br><span class="line">                             .findAll()</span><br><span class="line">                             .where()</span><br><span class="line">                             .equalTo(&quot;dogs.color&quot;, &quot;Brown&quot;)</span><br><span class="line">                             .findAll();</span><br><span class="line">                             .where()</span><br><span class="line">                             .equalTo(&quot;dogs.color&quot;, &quot;Yellow&quot;)</span><br><span class="line">                             .findAll();</span><br></pre></td></tr></table></figure>

<p> 第一个查询应该读取，查找到所有有名为”Fluffy”狗的 Person，也找到那些有名为”Brown”狗的Person，然后给我两个的​​交集。第二个查询先读取并查找到所有名为“Fluffy”的狗的Person。然后，给定结果集，找到所有有颜色为“棕色”的狗的Person，并且给定结果集，找到具有颜色为“黄色”的狗的所有人。</p>
<p> 让我们来看看背后的查询，r1以便充分了解发生了什么。两个条件是equalTo(“<a href="http://dogs.name" target="_blank" rel="noopener">dogs.name</a>”, “Fluffy”)和equalTo(“dogs.color”, “Brown”)。第一个条件满足U1和U2- 这是C1集合。第二个条件也满足U1和U2- 这是C2集合。查询中的逻辑和，和C1和C2的交集是一样的。C1和C2的交集为U1 and U2。因此，r1是U1 and U2。</p>
<p> 后面的查询r2就不同了。让我们开始分解这次查询以探究竟。查询的第一部分如下所示：RealmResults r2a = realm.where(Person.class).equalTo(“<a href="http://dogs.name" target="_blank" rel="noopener">dogs.name</a>”, “Fluffy”).findAll();。它匹配U1和U2。然后，r2b = r2a.where().equalTo(“dogs.color”, “Brown”).findAll();还是匹配U1和U2（两个人都有棕色的狗）。最后的查询，r2 = r2b.where().equalTo(“dogs.color”, “Yellow”).findAll();只匹配U2，因为只有一个人在棕色狗结果集中有一个黄色的狗，也就是U2</p>
<hr>
<h2 id="写"><a href="#写" class="headerlink" title="写"></a><a href></a>写</h2><p> 读操作是隐式的，这意味着可以随时访问和查询对象。所有写操作（添加，修改和删除对象）必须包含在写事务中。写事务可以提交或取消。在提交期间，所有更改都将写入磁盘，并且提交只有在所有更改都可以保留时才会成功。通过取消写入事务，所有更改都将被丢弃。使用写事务，你的数据将始终处于一致状态。</p>
<p> 写事务也用于确保线程安全</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// Obtain a Realm instance</span><br><span class="line">Realm realm = Realm.getDefaultInstance();</span><br><span class="line"></span><br><span class="line">realm.beginTransaction();</span><br><span class="line"></span><br><span class="line">//... add or update objects here ...</span><br><span class="line"></span><br><span class="line">realm.commitTransaction();</span><br></pre></td></tr></table></figure>

<p> 在写事务中使用到你的RealmObjects时，你可能最后想放弃修改。与其提交之后再回退，你可以简单地取消写事务。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">realm.beginTransaction();</span><br><span class="line">User user = realm.createObject(User.class);</span><br><span class="line"></span><br><span class="line">//  ...</span><br><span class="line"></span><br><span class="line">realm.cancelTransaction();</span><br></pre></td></tr></table></figure>

<p> 请注意，写事务可能会相互阻塞。如果你在UI线程和后台线程上同时创建写入事务，这可能会导致ANR错误。为了避免这种情况，在UI线程上创建写事务时使用异步事务。</p>
<p> Realm是崩溃安全的，所以在一次事务中发生了Exception，Realm本身不会崩溃。只是当前事务中的数据会丢失。如果异常被捕获但应用程序仍在继续，这个时候取消正在执行的事务就显得尤为重要。如果使用executeTransaction()，这些将会自动的执行。</p>
<p> 感谢Realm的MVCC架构，在写事务打开的时候读取不会被阻塞！这意味着，除非你需要从多个线程同时进行事务，你可以使用一个更大的事务，这些事务如果使用小事务来做的话将会耗费更多的工作量。当你将写事务提交到Realm时，该Realm的所有其他实例将被通知并<a href="https://realm.io/docs/java/latest/#auto-updating" target="_blank" rel="noopener">自动更新</a>。</p>
<p> Realm中的读写访问是<a href="https://en.wikipedia.org/wiki/ACID" target="_blank" rel="noopener">ACID</a></p>
<h4 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a><a href></a>创建对象</h4><p> 因为RealmObjects都得绑定到一个领域，他们应该通过Realm直接实例化</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">realm.beginTransaction();</span><br><span class="line">User user = realm.createObject(User.class); // Create a new object</span><br><span class="line">user.setName(&quot;John&quot;);</span><br><span class="line">user.setEmail(&quot;john@corporation.com&quot;);</span><br><span class="line">realm.commitTransaction();</span><br></pre></td></tr></table></figure>

<p> 或者，你可以首先创建一个对象的实例，然后使用<a href="https://realm.io/docs/java/latest/api/io/realm/Realm.html#copyToRealm(E)" target="_blank" rel="noopener">realm.copyToRealm（）</a>添加它。Realm支持尽可能多的自定义构造函数，只要其中一个是<a href="http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html" target="_blank" rel="noopener">公共的无参数构造函数</a>。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">User user = new User(&quot;John&quot;);</span><br><span class="line">user.setEmail(&quot;john@corporation.com&quot;);</span><br><span class="line"></span><br><span class="line">// Copy the object to Realm. Any further changes must happen on realmUser</span><br><span class="line">realm.beginTransaction();</span><br><span class="line">User realmUser = realm.copyToRealm(user);</span><br><span class="line">realm.commitTransaction();</span><br></pre></td></tr></table></figure>

<p> 当使用时，realm.copyToRealm()重要的是要记住只有返回的对象由Realm管理，所以对原始对象的任何进一步的更改都不会被持久化</p>
<hr>
<h4 id="事务块"><a href="#事务块" class="headerlink" title="事务块"></a><a href></a>事务块</h4><p> 不用手动保持跟踪realm.beginTransaction()，realm.commitTransaction()以及realm.cancelTransaction()可以使用<a href="https://realm.io/docs/java/latest/api/io/realm/Realm.html#executeTransaction(io.realm.Realm.Transaction)" target="_blank" rel="noopener">realm.executeTransaction（）</a>方法，它会自动处理开始/提交，发生错误的时候将自动取消</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">	@Override</span><br><span class="line">	public void execute(Realm realm) &#123;</span><br><span class="line">		User user = realm.createObject(User.class);</span><br><span class="line">		user.setName(&quot;John&quot;);</span><br><span class="line">		user.setEmail(&quot;john@corporation.com&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="异步事务"><a href="#异步事务" class="headerlink" title="异步事务"></a><a href></a>异步事务</h4><p> 因为事务被其他事务阻塞，所以在后台线程上执行所有写操作以避免阻塞UI线程是一个很好的主意。通过使用异步事务，Realm将在后台线程上运行该事务并在事务完成时报告。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">realm.executeTransactionAsync(new Realm.Transaction() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void execute(Realm bgRealm) &#123;</span><br><span class="line">                User user = bgRealm.createObject(User.class);</span><br><span class="line">                user.setName(&quot;John&quot;);</span><br><span class="line">                user.setEmail(&quot;john@corporation.com&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, new Realm.Transaction.OnSuccess() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onSuccess() &#123;</span><br><span class="line">                // Transaction was a success.</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, new Realm.Transaction.OnError() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onError(Throwable error) &#123;</span><br><span class="line">                // Transaction failed and was automatically canceled.</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p> OnSuccess和OnError回调都是可选的，但是如果提供，它们将在事务成功完成或失败时分别被调用。回调由Looper控制，因此它们只允许在Looper线程上回调。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ealmAsyncTask transaction = realm.executeTransactionAsync(new Realm.Transaction() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void execute(Realm bgRealm) &#123;</span><br><span class="line">                User user = bgRealm.createObject(User.class);</span><br><span class="line">                user.setName(&quot;John&quot;);</span><br><span class="line">                user.setEmail(&quot;john@corporation.com&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, null);</span><br></pre></td></tr></table></figure>

<p> 异步事务由RealmAsyncTask对象表示。如果在事务完成之前退出Activity / Fragment，此对象可用于取消任何挂起的事务。如果回调更新UI，忘记取消事务可能会导致应用程序崩溃。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ublic void onStop () &#123;</span><br><span class="line">    if (transaction != null &amp;&amp; !transaction.isCancelled()) &#123;</span><br><span class="line">        transaction.cancel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="更新字符串和字节数"><a href="#更新字符串和字节数" class="headerlink" title="更新字符串和字节数"></a><a href></a>更新字符串和字节数</h4><p> Realm是以完整的字段作为操作对象的，不可能更新字符串或字节数组的单个元素。假如你需要更新字符串的第5个元素，你将需要做类似的事情：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        bytes[] bytes = realmObject.binary;</span><br><span class="line">        bytes[4] = &apos;a&apos;;</span><br><span class="line">        realmObject.binary = bytes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p> 是由于Realm的MVCC架构，它避免了对现有数据的改变，以确保读取数据的其他线程或进程下表现一致。</p>
<hr>
<h4 id="快照"><a href="#快照" class="headerlink" title="快照"></a><a href></a>快照</h4><p> 所有Realm集合都是<a href="https://realm.io/docs/java/latest/#auto-updating-results" target="_blank" rel="noopener">实时的</a>。这意味着它们总是反映最新的状态。在大多数情况下，这是可取的，但如果你循环一个集合，目的是修改元素呢？例如：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;Person&gt; guests = realm.where(Person.class).equalTo(&quot;invited&quot;, false).findAll();</span><br><span class="line">realm.beginTransaction();</span><br><span class="line">for (int i = 0; guests.size(); i++) &#123;</span><br><span class="line">    guests.get(i).setInvited(true);</span><br><span class="line">&#125;</span><br><span class="line">realm.commitTransaction();</span><br></pre></td></tr></table></figure>

<p> 通常你会期望这个简单的循环邀请所有客人。因为RealmResults是立即更新，虽然，只有一半的客人最终被邀请！受邀的邀请对象将从该集合中立即删除，这会移动所有元素。当i参数增加时，它将错过一个元素。</p>
<p> 为了防止这种情况，你可以拍摄集合数据的快照。快照保证元素的顺序不会改变，即使元素被删除或修改。</p>
<p> Iterator从Realm集合创建的文件将自动使用快照。RealmResults和RealmList可以使用createSnapshot()手动创建快照。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">RealmResults&lt;Person&gt; guests = realm.where(Person.class).equalTo(&quot;invited&quot;, false).findAll();</span><br><span class="line"></span><br><span class="line">// Use an iterator to invite all guests</span><br><span class="line">realm.beginTransaction();</span><br><span class="line">for (Person guest : guests) &#123;</span><br><span class="line">    guest.setInvited(true);</span><br><span class="line">&#125;</span><br><span class="line">realm.commitTransaction();</span><br><span class="line"></span><br><span class="line">// Use a snapshot to invite all guests</span><br><span class="line">realm.beginTransaction();</span><br><span class="line">OrderedRealmCollectionSnapshot&lt;Person&gt; guestsSnapshot = guests.createSnapshot();</span><br><span class="line">for (int i = 0; guestsSnapshot.size(); i++) &#123;</span><br><span class="line">    guestsSnapshot.get(i).setInvited(true);</span><br><span class="line">&#125;</span><br><span class="line">realm.commitTransaction();</span><br></pre></td></tr></table></figure>


<hr>
<h2 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a><a href></a>原文链接</h2><p> <a href="https://realm.io/docs/java/latest/#relationships" target="_blank" rel="noopener">https://realm.io/docs/java/latest/#relationships</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-04T10:36:33.000Z">2017-03-04</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分钟 读完 (大约 2020 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/04/《Android开源库》Realm For Android~ Getting Help and Models（译文）/">《Android开源库》Realm For Android~ Getting Help and Models（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="获得帮助"><a href="#获得帮助" class="headerlink" title="获得帮助"></a><a href></a>获得帮助</h2><p> 你编程时需要帮助？：在 <a href="http://stackoverflow.com/questions/ask?tags=realm" target="_blank" rel="noopener">StackOverflow 上提问</a>。我们在实时监控并且回答 SO 上的相关问题！<br> 要报告一个 bug？：<a href="https://github.com/realm/realm-java/issues/new" target="_blank" rel="noopener">在我们的 GitHub 仓库里新建一个问题</a>，并且尽可能地按问题模板将 bug 描述清楚。<br> 需要一个新功能？：<a href="https://github.com/realm/realm-java/issues/new" target="_blank" rel="noopener">在我们的 GitHub 仓库里新建一个问题</a>，并且尽可能地按问题模板将该功能描述清楚。<br> 想知道接下来将会发生什么？：<a href="https://github.com/realm/realm-java/blob/master/CHANGELOG.md" target="_blank" rel="noopener">看看我们的 changelog</a>。这里有我们即将发布的改动以及修改历史。</p>
<hr>
<h2 id="模型"><a href="#模型" class="headerlink" title="模型"></a><a href></a>模型</h2><p> Realm 数据模型定义需要继承自 RealmObject 类。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class User extends RealmObject &#123;</span><br><span class="line"></span><br><span class="line">    private String          name;</span><br><span class="line">    private int             age;</span><br><span class="line"></span><br><span class="line">    @Ignore</span><br><span class="line">    private int             sessionId;</span><br><span class="line"></span><br><span class="line">    // Standard getters &amp; setters generated by your IDE…</span><br><span class="line">    public String getName() &#123; return name; &#125;</span><br><span class="line">    public void   setName(String name) &#123; this.name = name; &#125;</span><br><span class="line">    public int    getAge() &#123; return age; &#125;</span><br><span class="line">    public void   setAge(int age) &#123; this.age = age; &#125;</span><br><span class="line">    public int    getSessionId() &#123; return sessionId; &#125;</span><br><span class="line">    public void   setSessionId(int sessionId) &#123; this.sessionId = sessionId; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> Realm 数据模型不仅仅支持 private 成员变量，你还可以使用 public、protected 以及自定义的成员方法。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class User extends RealmObject &#123;</span><br><span class="line"></span><br><span class="line">    public String name;</span><br><span class="line"></span><br><span class="line">    public boolean hasLongName() &#123;</span><br><span class="line">      return name.length() &gt; 7;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean equals(Object o) &#123;</span><br><span class="line">      // Custom equals comparison</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<h4 id="字段类型"><a href="#字段类型" class="headerlink" title="字段类型"></a><a href></a>字段类型</h4><p> Realm 支持以下字段类型：boolean、byte、short、int、long、float、double、String、Date和byte []。整数类型 short、int 和 long 都被映射到 Realm 内的相同类型（实际上为 long ）。再者，还可以使用 RealmObject 的子类和 RealmList&lt;? extends RealmObject&gt; 来表示模型关系。</p>
<p> Realm 对象中还可以声明包装类型（boxed type）属性，包括：Boolean、Byte、Short、Integer、Long、Float和Double。通过使用包装类型，可以使这些属性存取空值（null)。</p>
<hr>
<h4 id="Required修饰类型和空值（null）"><a href="#Required修饰类型和空值（null）" class="headerlink" title="@Required修饰类型和空值（null）"></a><a href></a>@Required修饰类型和空值（null）</h4><p> 某些时候，空值（null）对于属性并不合适。这时可以使用注解 @Required 告诉 Realm 强制禁止空值（null）被存储。只有 Boolean、 Byte、 Short、 Integer、 Long、 Float、 Double、 String、 byte[] 以及 Date 可以被 @Required 修饰。在其它类型属性上使用 @Required 修饰会导致编译失败。基本数据类型（primitive types）不需要使用注解 @Required，因为他们本身就不可为空。RealmObject 属性永远可以为空。</p>
<hr>
<h4 id="忽略的属性"><a href="#忽略的属性" class="headerlink" title="忽略的属性"></a><a href></a>忽略的属性</h4><p> 注解 @Ignore 意味着一个字段不应该被保存到 Realm。某些时候输入的信息包含比模型更多的字段，而你不希望处理这些未使用的数据字段，你可以用 @Ignore 来标识这些你希望被 Realm 忽略的字段</p>
<hr>
<h4 id="Auto-Updating-Objects"><a href="#Auto-Updating-Objects" class="headerlink" title="Auto-Updating Objects"></a><a href></a>Auto-Updating Objects</h4><p> RealmObject 是实时的、自动更新的底层数据的映射视图。你不需要去重新获得对象已取得其最新版本。对于数据的改动会即时反应到相关的对象或者查询结果。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">final Dog myDog;</span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        myDog = realm.createObject(Dog.class);</span><br><span class="line">        myDog.setName(&quot;Fido&quot;);</span><br><span class="line">        myDog.setAge(1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        Dog myPuppy = realm.where(Dog.class).equalTo(&quot;age&quot;, 1).findFirst();</span><br><span class="line">        myPuppy.setAge(2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">myDog.getAge(); // =&gt; 2</span><br></pre></td></tr></table></figure>

<p> RealmObject 和 RealmResults 的设计不仅仅是为了更快和更有效率，它们同时也让代码更加简洁以及反应性更强。举例来说，假设你的 Activity 或者 Fragment 依赖于某个 RealmObject 或者 RealmResults，你无需担心何时去刷新或者重新获取它们以更新 UI——它们会自动更新。</p>
<p> 你可以通过订阅 Realm notifications 来得知 Realm 的数据在何时被更新从而刷新你的 UI。</p>
<hr>
<h4 id="索引（Index）属性"><a href="#索引（Index）属性" class="headerlink" title="索引（Index）属性"></a><a href></a>索引（Index）属性</h4><p> 注解 @Index 会为字段增加搜索索引。这会导致插入速度变慢，同时数据文件体积有所增加，但能加速查询。因此建议仅在需要加速查询时才添加索引。目前仅支持索引的属性类型包括：String、byte、short、int、long、boolean和Date。</p>
<hr>
<h4 id="主键-primary-keys"><a href="#主键-primary-keys" class="headerlink" title="主键 (primary keys)"></a><a href></a>主键 (primary keys)</h4><p> @PrimaryKey 可以用来定义字段为主键，该字段类型必须为字符串（String）或整数（short、int 或 long）以及它们的包装类型（Short、Int 或 Long）。不可以存在多个主键。使用支持索引的属性类型作为主键同时意味着为该字段建立索引。</p>
<p> 当创建 Realm 对象时，所有字段会被设置为默认值。为了避免与具有相同主键的另一个对象冲突，建议创建一个 unmanaged 对象，为字段的赋值，然后用 copyToRealm() 方法将该对象复制到 Realm。</p>
<p> 主键的存在意味着可以使用 copyToRealmOrUpdate() 方法，它会用此主键尝试寻找一个已存在的对象，如果对象存在，就更新该对象；反之，它会创建一个新的对象。当 copyToRealmOrUpdate() 的调用对象没有主键时，会抛出异常。</p>
<p> 使用主键会对性能产生影响。创建和更新对象将会慢一点，而查询则会变快。很难量化这些性能的差异，因为性能的改变跟你数据库的大小息息相关。</p>
<p> Realm.createObject()会返回一个所有字段被设置为默认值的新对象。如果该模型类存在主键，那么有可能返回对象的主键的默认值与其它已存在的对象冲突。建议创建一个非托管（unmanaged）Realm 对象，并给其主键赋值，然后调用 copyToRealm() 来避免冲突。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">final MyObject obj = new MyObject();</span><br><span class="line">obj.setId(42);</span><br><span class="line">obj.setName(&quot;Fish&quot;);</span><br><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        // This will create a new object in Realm or throw an exception if the</span><br><span class="line">        // object already exists (same primary key)</span><br><span class="line">        // realm.copyToRealm(obj);</span><br><span class="line"></span><br><span class="line">        // This will update an existing object with the same primary key</span><br><span class="line">        // or create a new object if an object with no primary key = 42</span><br><span class="line">        realm.copyToRealmOrUpdate(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p> 字符串（String）和包装类型（Short、Int 或 Long）的主键可以被赋予空值（null）；除非它们同时被 @Required 修饰。</p>
<hr>
<h4 id="定制对象（Customizing-Objects）"><a href="#定制对象（Customizing-Objects）" class="headerlink" title="定制对象（Customizing Objects）"></a><a href></a>定制对象（Customizing Objects）</h4><p> 你几乎可以把 RealmObject 当作 POJO 使用。只需扩展 RealmObject，将相应属性声明为 public。不需要 setter 和 getter， 而是直接访问属性。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public class Dog extends RealmObject &#123;</span><br><span class="line">    public String name;</span><br><span class="line">    public int age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 你可以像使用其他类一样直接使用 Dog 类。createObject() 和 copyToRealm() 可以帮助你创建一个托管给 Realm 的 Dog 对象。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">realm.executeTransaction(new Realm.Transaction() &#123;</span><br><span class="line">    @Overrride</span><br><span class="line">    public void execute(Realm realm) &#123;</span><br><span class="line">        Dog dog = realm.createObject(Dog.class);</span><br><span class="line">        dog.name = &quot;Fido&quot;;</span><br><span class="line">        dog.age  = 5;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p> 如果需要的话，你可以在 setter 和 getter 中添加你自己的逻辑。例如你可能需要在保存之前验证值的合法性。另外，你还可以为你的 RealmObject 添加自定义方法。</p>
<hr>
<h4 id="限制"><a href="#限制" class="headerlink" title="限制"></a><a href></a>限制</h4><p> 目前不支持 final、transient 和 volatile 修饰的成员变量，这主要是为了 Realm 对象在非托管（unmanaged RealmObject）时候的行为差异化。</p>
<p> Realm 数据模型不可以继承自除了 RealmObject 以外的其它对象。你可以选择不声明默认无参数构造器，但是如果你声明了，那么该构造器必须为空构造器。这是目前 Realm 的一个限制。但你可以自由添加任意其它的构造器。</p>
<hr>
<h4 id="RealmModel-接口"><a href="#RealmModel-接口" class="headerlink" title="RealmModel 接口"></a><a href></a>RealmModel 接口</h4><p> 除直接继承于 RealmObject 来声明 Realm 数据模型之外，还可以通过实现 RealmModel 接口并添加 @RealmClass 修饰符来声明。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@RealmClass</span><br><span class="line">public class User implements RealmModel &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> RealmObject 的所有方法都有其相对应的静态方法。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// With RealmObject</span><br><span class="line">user.isValid();</span><br><span class="line">user.addChangeListener(listener);</span><br><span class="line"></span><br><span class="line">// With RealmModel</span><br><span class="line">RealmObject.isValid(user);</span><br><span class="line">RealmObject.addChangeListener(user, listener);</span><br></pre></td></tr></table></figure>


<hr>
<h2 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a><a href></a>原文链接</h2><p> <a href="https://realm.io/docs/java/latest/#getting-help" target="_blank" rel="noopener">https://realm.io/docs/java/latest/#getting-help</a><br> <a href="https://realm.io/docs/java/latest/#models" target="_blank" rel="noopener">https://realm.io/docs/java/latest/#models</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-03T03:36:14.000Z">2017-03-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分钟 读完 (大约 1061 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/03/《Android开源库》 Realm For Android~ Getting Started（译文）/">《Android开源库》 Realm For Android~ Getting Started（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="入门"><a href="#入门" class="headerlink" title="入门"></a><a href></a>入门</h2><p> <a href="https://static.realm.io/downloads/java/realm-java-3.0.0.zip" target="_blank" rel="noopener">下载Realm for Android</a>或者在Github <a href="https://github.com/realm/realm-java" target="_blank" rel="noopener">realm-java</a>上查看源代码.</p>
<hr>
<h4 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a><a href></a>原文链接</h4><p> <a href="https://realm.io/docs/java/latest/#getting-started" target="_blank" rel="noopener">https://realm.io/docs/java/latest/#getting-started</a></p>
<hr>
<h4 id="开发条件"><a href="#开发条件" class="headerlink" title="开发条件"></a><a href></a>开发条件</h4><ul>
<li>我们目前不支持Android之外的Java。 </li>
<li>Android Studio&gt; = 1.5.1 </li>
<li>最近版本的Android SDK。 </li>
<li>JDK version&gt; = 7。 </li>
<li>我们支持所有Android版本自API Level 9（Android 2.3 Gingerbread及以上）  </li>
</ul>
<hr>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a><a href></a>安装</h4><p> Realm安装为Gradle插件。</p>
<p> 将Realm安装为Gradle插件需要两个步骤。</p>
<p> 步骤1：将以下类路径依赖项添加到项目级build.gradle文件。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath &quot;io.realm:realm-gradle-plugin:3.0.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 项目级的<strong>build.gradle</strong>的位置如下<br> <img src="https://img-blog.csdn.net/20170303101342793" alt="这里写图片描述"></p>
<p> 步骤2：将realm-android插件应用到应用程序级build.gradle文件的顶部。<br> 应用程序级的<strong>build.gradle</strong>的位置如下<br> <img src="https://img-blog.csdn.net/20170303101506786" alt="这里写图片描述"></p>
<p> 一旦这两个更改完成，只需刷新你的gradle依赖项。 如果你从v0.88之前的版本升级，你可能还需要清洁gradle项目（./gradlew clean）以删除任何遗留的以前的安装。</p>
<p> 可以在这里找到两个修改的build.gradle文件的示例：</p>
<ul>
<li>项目级<strong>build.gradle</strong> </li>
<li>应用程序级<strong>build.gradle</strong>  <em><strong>其他构建系统</strong></em><br>不支持Maven＆Ant构建系统。 如果你希望看到这些构建系统的支持，请表达你对以下问题的兴趣，然后我们会权衡是否需要添加这种支持。</li>
</ul>
<ul>
<li><p>Maven支持 </p>
</li>
<li><p>Ant 支持  你的意见将决定我们是否以及何时实现Ant和Maven插件。</p>
<p>从v1.0.0起，不支持Eclipse。 我们建议迁移到Android Studio。</p>
</li>
</ul>
<hr>
<h4 id="ProGuard"><a href="#ProGuard" class="headerlink" title="ProGuard"></a><a href></a>ProGuard</h4><p> ProGuard配置作为Realm库的一部分提供。 这意味着你不需要为Realm配置任何ProGuard规则。</p>
<hr>
<h4 id="Realm-浏览器"><a href="#Realm-浏览器" class="headerlink" title="Realm 浏览器"></a><a href></a>Realm 浏览器</h4><p> 我们提供独立的<a href="https://itunes.apple.com/app/realm-browser/id1007457278" target="_blank" rel="noopener">Realm浏览器</a>，用于读取和编辑Realm数据库</p>
<p> <img src="https://img-blog.csdn.net/20170303104927632" alt="这里写图片描述"></p>
<p> 你可以使用菜单项“ Tools &gt; Generate demo database ”生成带有示例数据的测试数据库。</p>
<p> 如果你在查你的应用程序的Realm文件上遇到了问题，就去看下<a href="http://stackoverflow.com/a/28465803/3838010" target="_blank" rel="noopener">StackOverflow答案</a>详细说明。</p>
<p> Realm浏览器可以在<a href="https://itunes.apple.com/app/realm-browser/id1007457278" target="_blank" rel="noopener">Mac App Store</a>上找到，也可以从我们<a href="https://github.com/realm/realm-browser-osx/releases" target="_blank" rel="noopener">GitHub页面下载</a>。</p>
<p> 浏览器目前不能在Windows或Linux上运行。 在这些平台上，你可以使用<a href="https://github.com/uPhyca/stetho-realm" target="_blank" rel="noopener">Stetho-Realm</a>。 Stetho是由Facebook创建的Chrome浏览器的Android调试桥。</p>
<hr>
<h4 id="API指南"><a href="#API指南" class="headerlink" title="API指南"></a><a href></a>API指南</h4><p> 想知道关于类、方法和其他内容，请查阅<a href="https://realm.io/docs/java/latest/api/" target="_blank" rel="noopener">API指南</a></p>
<hr>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a><a href></a>示例</h4><p> 看看我们的<a href="https://github.com/realm/realm-java/tree/master/examples" target="_blank" rel="noopener">例子</a>，看看Realm在应用程序中是如何实践。 有关如何运行示例的更多详细信息，请参阅<a href="https://github.com/realm/realm-java/blob/master/README.md#examples" target="_blank" rel="noopener">此处</a>。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/introExample" target="_blank" rel="noopener">introExample</a>包含如何使用当前API的简单示例。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/gridViewExample" target="_blank" rel="noopener">gridViewExample</a>是一个简单的应用程序，显示如何使用Realm作为GridView的后台存储。 它还显示了如何使用GSON使用JSON填充数据库，以及如何使用ABI拆分将最终APK的大小最小化。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/threadExample" target="_blank" rel="noopener">threadExample</a>是一个简单的应用程序，显示如何在多线程环境中使用Realm。</p>
<p> <a href="https://github.com/realm/realm-android-adapters/tree/master/example" target="_blank" rel="noopener">adapterExample</a>显示了如何使用RealmBaseAdapter和RealmRecyclerViewAdapter来使Realm以优雅的方式与Android ListView和RecyclerView一起工作。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/jsonExample" target="_blank" rel="noopener">jsonExample</a>说明了如何使用新的Realm JSON功能呢。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/encryptionExample" target="_blank" rel="noopener">encryptionExample</a>显示如何使用加密的Realms。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/rxJavaExample" target="_blank" rel="noopener">rxJavaExamples</a>显示了Realm如何与RxJava一起工作。</p>
<p> <a href="https://github.com/realm/realm-java/tree/master/examples/unitTestExample" target="_blank" rel="noopener">unitTestExample</a>显示了如何在使用Realm时编写单元测试。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-02-25T15:05:17.000Z">2017-02-25</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 分钟 读完 (大约 761 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/02/25/《Android开源库》 Essential介绍（译文）/">《Android开源库》 Essential介绍（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a><a href></a>简介</h2><p> GreenRobot Essentials为Android和Java项目提供通用的实用工具。 在Android开发的早期，它就已经存在了。整个库很简单，jar包 &lt;100k，在效率和性能上也是独树一帜的。</p>
<hr>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a><a href></a>特性</h2><p> Essentials是一个通用类的集合，我们发现在许多场合都很有用。</p>
<p> 使用要点的主要原因：</p>
<ul>
<li>在项目中编写较少的代码 </li>
<li>专门实现与标准API相比更好的性能 </li>
<li>超轻量级：&lt;100k </li>
<li>兼容Android和Java  特征：</li>
</ul>
<ul>
<li>IO utilities 在IO流（基于字节和字符）和digests（例如MD5和SHA-1）上起到很大的帮助作用。 </li>
<li>File utilities 简化了从字符串/字节/对象写入文件或向文件写入字符串/字节/对象。还包括从文件获取哈希和复制文件。 </li>
<li>String utilities允许有效分割和连接字符串，hex和MD5创建，以及其他有用的字符串助手。 </li>
<li>Better hash functions: ：我们的Murmur3实现提供了优越的散列质量，并且胜过标准的Java散列函数 </li>
<li>Specialized Streams: 例如优化的PipedOutputStream替换（基于循环字节缓冲器） </li>
<li>Hash set and map for primitive long keys 原始长键的哈希集和映射优于Java集合API的通用版本 </li>
<li>Multimaps多映射提供了列表或集合的映射，以简化为单个键存储多个值 </li>
<li>Object cache 对象缓存具有强大的配置选项：软/弱/强引用，最大大小和基于时间的到期 </li>
<li>Base64实现（从iharder.net捆绑）用于较低版本的Java和Android（包括输入/​​输出流）  </li>
</ul>
<hr>
<h2 id="集成"><a href="#集成" class="headerlink" title="集成"></a><a href></a>集成</h2><h4 id="1-添加到工程"><a href="#1-添加到工程" class="headerlink" title="1. 添加到工程"></a><a href></a>1. 添加到工程</h4><p> 使用最新版本</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;org.greenrobot:essentials:3.0.0-RC1&apos;</span><br></pre></td></tr></table></figure>

<p> 或者使用老版本</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;de.greenrobot:java-common:2.3.1&apos;</span><br></pre></td></tr></table></figure>

<p> 针对Maven</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;de.greenrobot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;java-common&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.3.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>


<h4 id="2-示例代码"><a href="#2-示例代码" class="headerlink" title="2. 示例代码"></a><a href></a>2. 示例代码</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// Get all bytes from stream and close the stream safely</span><br><span class="line">byte[] bytes = IoUtils.readAllBytesAndClose(inputStream);</span><br><span class="line"></span><br><span class="line">// Read the contents of an file as a string (use readBytes to get byte[])</span><br><span class="line">String contents = FileUtils.readUtf8(file);</span><br><span class="line"></span><br><span class="line">// How many days until new year&apos;s eve?</span><br><span class="line">long time2 = DateUtils.getTimeForDay(2015, 12, 31);</span><br><span class="line">int daysToNewYear = DateUtils.getDayDifference(time, time2);</span><br></pre></td></tr></table></figure>

<p> 多映射Map（版本v2.2加入）</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ListMap&lt;String,String&gt; multimap = new ListMap&lt;&gt;();</span><br><span class="line">multimap.putElement(&quot;a&quot;, &quot;1&quot;);</span><br><span class="line">multimap.putElement(&quot;a&quot;, &quot;2&quot;);</span><br><span class="line">multimap.putElement(&quot;a&quot;, &quot;3&quot;);</span><br><span class="line">List&lt;String&gt; strings = multimap.get(&quot;a&quot;); //Contains &quot;1&quot;, &quot;2&quot;, and &quot;3&quot;</span><br></pre></td></tr></table></figure>

<p> 散列函数实现 java.util.zip.Checksum，所以下面的代码可能看起来很眼熟</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Murmur3A murmur = new Murmur3A();</span><br><span class="line">murmur.update(bytes);</span><br><span class="line">long hash = murmur.getValue();</span><br></pre></td></tr></table></figure>

<p> 所有散列可以通过多次调用update（…）来逐步计算。 我们的Murmur3A实现更进一步，以非常有效的方式提供原始数据的更新：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// reuse the previous instance and start over to calculate a new hash</span><br><span class="line">murmur.reset();</span><br><span class="line"></span><br><span class="line">murmur.updateLong(42L);</span><br><span class="line"></span><br><span class="line">// Varargs and arrays are supported natively, too  </span><br><span class="line">murmur.updateInt(2014, 2015, 2016);</span><br><span class="line"></span><br><span class="line">murmur.updateUtf8(&quot;And strings, of course&quot;);</span><br><span class="line"></span><br><span class="line">// Hash for the previous update calls. No conversion to byte[] necessary.</span><br><span class="line">hash = murmur.getValue();</span><br></pre></td></tr></table></figure>

<p> 实用程序类是直接的，没有依赖性，所以你应该很好地通过看看他们的源代码来掌握它们。 大多数方法名称应该是自解释的，通常你会在需要的地方找到JavaDocs。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-02-21T06:11:28.000Z">2017-02-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 小时 读完 (大约 10529 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/02/21/《Android 开源库》 GreenDAO 用法详解（译文）/">《Android 开源库》 GreenDAO 用法详解（译文）</a>
            
        </h1>
        <div class="content">
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a><a href></a>简介</h2><p> greenDAO是一个开源的Android ORM，使SQLite数据库的开发再次变得有趣。 它减轻了开发人员处理底层的数据库需求，同时节省开发时间。 SQLite是一个很不错的关系型数据库。 尽管如此，编写SQL和解析查询结果仍然是相当乏味和耗时的任务。 greenDAO通过将Java对象映射到数据库表（称为ORM，“对象/关系映射”）来解决这些问题。 这样，您可以使用简单的面向对象的API来存储，更新，删除和查询Java对象。</p>
<hr>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a><a href></a>特性</h2><ul>
<li>最高性能（可能是Android中最快的ORM）; 我们的benchmarks 也是开源的 </li>
<li>涵盖关系和连接且易用的强大API </li>
<li>最小的内存开销 </li>
<li>迷你开源库（&lt;100KB），降低工程构建时间同时避免65k方法限制 </li>
<li>数据库加密：greenDAO支持SQLCipher以保证用户的数据安全 </li>
<li>强大的社区：超过5000 GitHub星星表明我们拥有一个强大而活跃的社区  </li>
</ul>
<hr>
<h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a><a href></a>开始使用</h2><h4 id="入门"><a href="#入门" class="headerlink" title="入门"></a><a href></a>入门</h4><p> 本教程将引导你完成一个简单的greenDAO示例项目<a href="https://github.com/greenrobot/greenDAO/tree/master/examples/DaoExample" target="_blank" rel="noopener">DaoExample</a>。 克隆代码并运行它，或者直接在<a href="https://github.com/greenrobot/greenDAO/tree/master/examples/DaoExample/src/main/java/org/greenrobot/greendao/example" target="_blank" rel="noopener">GitHub上查看文件</a>。  
 DaoExample是一个简单地用来记笔记的Android应用程序。 你可以通过键入一些文本来添加新笔记，并通过点击现有笔记删除笔记。</p>
<p> #####1. Note实体和DAO类<br> 一起看下代码：在src文件夹中，你会发现一个实体类Note.java。 它被持久化到数据库并包含Note的所有数据，如id，注释文本和创建日期。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Entity(indexes = &#123;</span><br><span class="line">    @Index(value = &quot;text, date DESC&quot;, unique = true)</span><br><span class="line">&#125;)</span><br><span class="line">public class Note &#123;</span><br><span class="line"> </span><br><span class="line">    @Id</span><br><span class="line">    private Long id;</span><br><span class="line"> </span><br><span class="line">    @NotNull</span><br><span class="line">    private String text;</span><br><span class="line">    private Date date;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p> 通常，实体是在数据库中持久化的类（例如，一个对象的一行）。 实体包含映射到数据库列的属性。</p>
<p> 现在开始编译工程，例如在Android Studio中使用“Build&gt; Make project”。 这将触发greenDAO来生成DAO类，例如NoteDao.java，这将帮助我们向数据库添加笔记。</p>
<p> #####2. 插入和删除笔记<br> 要学习如何添加一些笔记，请看一下NoteActivity类。 首先，我们必须为我们的Note类准备一个DAO对象，我们在onCreate（）中做：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// get the note DAO</span><br><span class="line">DaoSession daoSession = ((App) getApplication()).getDaoSession();</span><br><span class="line">noteDao = daoSession.getNoteDao();</span><br></pre></td></tr></table></figure>

<p> 当用户单击添加按钮时，将调用addNote()方法。 在这里，我们创建一个新的Note对象，并将其传递给DAO insert()方法，以将其插入到数据库中：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Note note = new Note(null, noteText, comment, new Date());</span><br><span class="line">noteDao.insert(note);</span><br><span class="line">Log.d(&quot;DaoExample&quot;, &quot;Inserted new note, ID: &quot; + note.getId());</span><br></pre></td></tr></table></figure>

<p> 注意，我们在创建笔记的时候没有传递id。 在这种情况下，数据库决定note id。 DAO负责在从插入操作返回之前自动设置新的ID（请参阅日志语句）。</p>
<p> 删除笔记也很简单，参见NoteClickListener：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">noteDao.deleteByKey(id);</span><br></pre></td></tr></table></figure>

<p> 你可以探索NoteDao的其他方法，比如loadAll（）和update（）。</p>
<p> #####3. 设置数据库<br> 你已经看到了DAO，但是如何初始化greenDAO和底层数据库呢？ 通常你需要init一个DaoSession，它通常在整个应用程序中的Application类中执行一次：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DevOpenHelper helper = new DevOpenHelper(this, &quot;notes-db&quot;);</span><br><span class="line">Database db = helper.getWritableDb();</span><br><span class="line">daoSession = new DaoMaster(db).newSession();</span><br></pre></td></tr></table></figure>

<p> 使用生成的DaoMaster类提供的帮助器类DevOpenHelper创建数据库。 它是DaoMaster中的OpenHelper类的一个实现，它为你创建所有数据库。 再也不需要编写“CREATE TABLE”语句。</p>
<p> 然后Activity和Fragment可以调用getDaoSession()来访问所有实体DAO，和我们之前在插入和删除的时候一样。  </p>
<p> #####4. 扩展和添加实体<br> 为了扩展我们的笔记或创建新实体，你只需修改或创建Java类，并以相同的方式注解它们。 然后重新编译项目。</p>
<p> 有关详细信息，请参阅<a href="http://greenrobot.org/greendao/documentation/modelling-entities/" target="_blank" rel="noopener">建模实体</a>。(这个下面已经翻译出来)</p>
<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a><a href></a>介绍</h4><p> greenDAO是Android的对象/关系映射（ORM）工具。 它为关系数据库SQLite提供了一个面向对象的接口。像greenDAO一类的ORM工具为你做很多重复性的任务，提供简单的数据接口。<br> <img src="https://img-blog.csdn.net/20170217133047176" alt="这里写图片描述"></p>
<h5 id="1-Gradle插件和DAO代码生成"><a href="#1-Gradle插件和DAO代码生成" class="headerlink" title="1. Gradle插件和DAO代码生成"></a><a href></a>1. Gradle插件和DAO代码生成</h5><p> 为了在你的Android项目中使用greenDAO，你需要添加greenDAO Gradle插件并添加greenDAO库：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath &apos;org.greenrobot:greendao-gradle-plugin:3.2.1&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">apply plugin: &apos;com.android.application&apos;</span><br><span class="line">apply plugin: &apos;org.greenrobot.greendao&apos;</span><br><span class="line"> </span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile &apos;org.greenrobot:greendao:3.2.0&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 然后进行实体建模也就是创建实体，并编译项目，例如在Android Studio中使用“Build&gt; Make Project”。</p>
<h5 id="2-核心类"><a href="#2-核心类" class="headerlink" title="2. 核心类"></a><a href></a>2. 核心类</h5><p> <img src="https://img-blog.csdn.net/20170217133254271" alt="这里写图片描述"></p>
<p> 一旦项目构建完毕，你就可以在Android项目中开始使用greenDAO了。</p>
<p> 以下核心类是greenDAO的基本接口：</p>
<p> <strong>DaoMaster</strong>：使用greenDAO的切入点。 DaoMaster保存数据库对象（SQLiteDatabase）并管理特定模式的DAO类（而不是对象）。 它有静态方法来创建表或删除它们。 它的内部类OpenHelper和DevOpenHelper都是SQLiteOpenHelper的实现，用来在SQLite数据库中创建模式。</p>
<p> <strong>DaoSession</strong>：管理特定模式的所有可用DAO对象，你可以使用其中一个的getter方法获取DAO对象。 DaoSession还为实体提供了一些通用的持久性方法，如插入，加载，更新，刷新和删除。 最后，DaoSession对象也跟踪identity scope。 有关更多详细信息，请查看<a href="http://greenrobot.org/greendao/documentation/sessions/" target="_blank" rel="noopener">会话文档</a></p>
<p> <strong>DAO</strong>：数据访问对象（DAO），用于实体的持久化和查询。 对于每个实体，greenDAO会生成一个DAO。 它比DaoSession拥有更多的持久化方法，例如：count，loadAll和insertInTx。</p>
<p> <strong>实体</strong>：可持久化对象。 通常，实体是使用标准Java属性（如POJO或JavaBean）表示数据库行的对象。</p>
<h5 id="3-核心初始化"><a href="#3-核心初始化" class="headerlink" title="3. 核心初始化"></a><a href></a>3. 核心初始化</h5><p> 最后，以下代码示例说明了初始化数据库和核心greenDAO类的第一步</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//做一次，例如在你的Application类中</span><br><span class="line">helper = new DaoMaster.DevOpenHelper（this，“notes-db”，null）;</span><br><span class="line">db = helper.getWritableDatabase（）;</span><br><span class="line">daoMaster = new DaoMaster（db）;</span><br><span class="line">daoSession = daoMaster.newSession（）;</span><br><span class="line">//在您的活动/片段中执行此操作以获取DAO</span><br><span class="line">noteDao = daoSession.getNoteDao（）;</span><br></pre></td></tr></table></figure>

<p> 该示例假设存在一个Note实体。 有了它的DAO（noteDao对象），我们可以调用这个特定实体的持久化操作。</p>
<hr>
<h4 id="实体建模"><a href="#实体建模" class="headerlink" title="实体建模"></a><a href></a>实体建模</h4><p> 要在项目中使用greenDAO，您需要创建一个表示应用程序中持久数据的实体模型。 然后，基于此模型，greenDAO为DAO类生成Java代码。<br> 模型本身是使用带有注解的Java类定义的。<br> 要使用旧式生成器创建模式，请参阅<a href="http://greenrobot.org/greendao/documentation/generator/" target="_blank" rel="noopener">生成器</a>。  
 下侧的图示描述了greenDAO所基于的元模型。</p>
<p> <img src="https://img-blog.csdn.net/20170216211550320" alt="这里写图片描述">  </p>
<p> #####1. 模式<br> 无需任何其他配置就可以开始使用greenDAO Gradle插件。但是，至少应该像下面这样设置下模式版本：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// In the build.gradle file of your app project:</span><br><span class="line">android &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">greendao &#123;</span><br><span class="line">    schemaVersion 2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 此外，greendao配置元素支持一系列配置选项：</p>
<ul>
<li>schemaVersion：数据库模式的当前版本。 这由* OpenHelpers类用于在模式版本之间迁移。 如果更改实体/数据库模式，则必须增加此值。 默认值为1。 </li>
<li>daoPackage：生成的DAO，DaoMaster和DaoSession的包名称。 默认为源实体的包名称。 </li>
<li>targetGenDir：生成的源码应存储在的位置。 默认为生成目录（build / generated / source / greendao）中生成的源文件夹。 </li>
<li>generateTests：设置为true以自动生成单元测试。 </li>
<li>targetGenDirTests：生成的单元测试应存储在的基本目录。 默认为src / androidTest / java。  #####2. 实体和注解<br>greenDAO 3使用注解来定义模式和实体。 这里有一个简单的例子：</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class User &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Long id;</span><br><span class="line"> </span><br><span class="line">    private String name;</span><br><span class="line"> </span><br><span class="line">    @Transient</span><br><span class="line">    private int tempUsageCount; // not persisted</span><br><span class="line"> </span><br><span class="line">   // getters and setters for id and user ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> @Entity注解将Java类User转换为数据库支持的实体。 这也将指示greenDAO生成必要的代码（例如DAO）。</p>
<p> <em><strong>注意：仅支持Java类。 如果你喜欢另一种语言，如Kotlin，你的实体类仍然必须是Java。</strong></em></p>
<p> #####5. @Entity 注解<br> 正如在上面的示例中看到的，@Entity注解将Java类标记为greenDAO的持久化的实体。</p>
<p> 虽然通常没有任何额外的参数，在使用@Entity的时候你仍然可以配置一些细节：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">@Entity(</span><br><span class="line">        // If you have more than one schema, you can tell greenDAO</span><br><span class="line">        // to which schema an entity belongs (pick any string as a name).</span><br><span class="line">        schema = &quot;myschema&quot;,</span><br><span class="line">        </span><br><span class="line">        // Flag to make an entity &quot;active&quot;: Active entities have update,</span><br><span class="line">        // delete, and refresh methods.</span><br><span class="line">        active = true,</span><br><span class="line">        </span><br><span class="line">        // Specifies the name of the table in the database.</span><br><span class="line">        // By default, the name is based on the entities class name.</span><br><span class="line">        nameInDb = &quot;AWESOME_USERS&quot;,</span><br><span class="line">        </span><br><span class="line">        // Define indexes spanning multiple columns here.</span><br><span class="line">        indexes = &#123;</span><br><span class="line">                @Index(value = &quot;name DESC&quot;, unique = true)</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br><span class="line">        // Flag if the DAO should create the database table (default is true).</span><br><span class="line">        // Set this to false, if you have multiple entities mapping to one table,</span><br><span class="line">        // or the table creation is done outside of greenDAO.</span><br><span class="line">        createInDb = false,</span><br><span class="line"> </span><br><span class="line">        // Whether an all properties constructor should be generated.</span><br><span class="line">        // A no-args constructor is always required.</span><br><span class="line">        generateConstructors = true,</span><br><span class="line"> </span><br><span class="line">        // Whether getters and setters for properties should be generated if missing.</span><br><span class="line">        generateGettersSetters = true</span><br><span class="line">)</span><br><span class="line">public class User &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <em><strong>注意，当使用Gradle插件时，<a href="https://github.com/greenrobot/greenDAO/issues/356" target="_blank" rel="noopener">目前不支持多个模式</a>。 暂时，继续使用你的<a href="http://greenrobot.org/greendao/documentation/generator/" target="_blank" rel="noopener">生成器项目</a>。</strong></em></p>
<p> #####5. 基本属性</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class User &#123;</span><br><span class="line">    @Id(autoincrement = true)</span><br><span class="line">    private Long id;</span><br><span class="line"> </span><br><span class="line">    @Property(nameInDb = &quot;USERNAME&quot;)</span><br><span class="line">    private String name;</span><br><span class="line"> </span><br><span class="line">    @NotNull</span><br><span class="line">    private int repos;</span><br><span class="line"> </span><br><span class="line">    @Transient</span><br><span class="line">    private int tempUsageCount;</span><br><span class="line"> </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> @Id注解选择long / Long属性作为实体ID。 在数据库术语中，它是主键。 参数autoincrement是一个标志，使ID值不断增加（不重用旧值）。</p>
<p> @Property允许你定义一个当前属性映射到的数据库列的非默认名称。 如果为空，greenDAO将以SQL-ish方式使用字段名（大写字母，下划线代替驼峰，例如customName将成为CUSTOM_NAME）。 注意：当前只能使用内联常量来指定列名称。</p>
<p> @NotNull使属性在数据库端为“NOT NULL”列。 通常，使用@NotNull标记原始类型（long，int，short，byte），同时使用封装类（Long，Integer，Short，Byte）可以使用空值。</p>
<p> @Transient标记要从持久性中排除的属性。 将它们用于临时状态等。或者，也可以使用Java中的transient关键字。</p>
<h5 id="6-主键限制"><a href="#6-主键限制" class="headerlink" title="6. 主键限制"></a><a href></a>6. 主键限制</h5><p> 目前，实体必须具有long或Long属性作为其主键。 这是Android和SQLite的推荐做法。</p>
<p> 要解决此问题，请将你的键属性定义为其他属性，但为其创建唯一索引：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Id</span><br><span class="line">private Long id;</span><br><span class="line"> </span><br><span class="line">@Index(unique = true)</span><br><span class="line">private String key;</span><br></pre></td></tr></table></figure>

<p> #####7. 属性索引<br> 在属性中使用@Index可为相应的数据库列创建数据库索引。 使用以下参数自定义：</p>
<p> name：如果你不喜欢greenDAO为索引生成的默认名称，你可以在这里指定你的名字。<br> unique：向索引添加UNIQUE约束，强制所有值是唯一的。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class User &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    @Index(unique = true)</span><br><span class="line">    private String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> @Unique向数据库列添加UNIQUE约束。 注意，SQLite也隐式地为它创建一个索引。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class User &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    @Unique private String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h5 id="8-默认值"><a href="#8-默认值" class="headerlink" title="8. 默认值"></a><a href></a>8. 默认值</h5><p> greenDAO尝试使用合理的默认值，以便开发人员每个都一一配置。</p>
<p> 例如，数据库侧的表和列名称派生自实体和属性名称。 而不是在Java中使用的骆驼案例样式，默认数据库名称使用大写，使用下划线分隔单词。</p>
<p> 例如，名为creationDate的属性将成为数据库列CREATION_DATE</p>
<h5 id="9-关系"><a href="#9-关系" class="headerlink" title="9. 关系"></a><a href></a>9. 关系</h5><p> 要了解如何添加一对一和多对多关系，请参阅<a href="http://greenrobot.org/greendao/documentation/relations/" target="_blank" rel="noopener">关系</a>(下面已经翻译)</p>
<h5 id="10-触发生成"><a href="#10-触发生成" class="headerlink" title="10. 触发生成"></a><a href></a>10. 触发生成</h5><p> 一旦实体模式就位，你就可以通过在IDE中使用“Make project”来触发代码生成过程。 或者直接执行greendao Gradle任务。</p>
<p> 如果在更改实体类之后遇到错误，请尝试重新生成项目，以确保清除旧生成的类。</p>
<h5 id="11-修改生成的代码"><a href="#11-修改生成的代码" class="headerlink" title="11. 修改生成的代码"></a><a href></a>11. 修改生成的代码</h5><p> greenDAO 3中的实体类由开发人员创建和编辑。 然而，在代码生成过程中，greenDAO可能会增加实体的源代码。</p>
<p> greenDAO将为它创建的方法和字段添加一个@Generated注解，以通知开发人员并防止任何代码丢失。 在大多数情况下，你不必关心使用@Generated注解的代码。</p>
<p> 作为预防措施，greenDAO不会覆盖现有代码，并且如果手动更改生成的代码会引发错误：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Error:Execution failed for task &apos;:app:greendao&apos;.</span><br><span class="line">&gt; Constructor (see ExampleEntity:21) has been changed after generation.</span><br><span class="line">Please either mark it with @Keep annotation instead of @Generated to keep it untouched,</span><br><span class="line">or use @Generated (without hash) to allow to replace it.</span><br></pre></td></tr></table></figure>

<p> 正如错误消息所暗示的，通常有两种方法来解决此问题：</p>
<ul>
<li><p>将更改还原为使用@Generated注解的代码。 或者，你也可以完全删除更改的构造函数或方法。 它们将与下一个版本重新生成。 </p>
</li>
<li><p>使用@Keep注解替换@Generated注解。 这将告诉greenDAO永远不要触摸带注解的代码。 请记住，你的更改可能会中断实体和其他greenDAO之间的约定。 此外，未来的greenDAO版本可能期望生成的方法中有不同的代码。 所以，要谨慎！。同时采用单元测试的方法来避免麻烦是个不错的选择。  </p>
<h5 id="12-保留部分"><a href="#12-保留部分" class="headerlink" title="12. 保留部分"></a><a href></a>12. 保留部分</h5><p>不再支持旧版本的greenDAO中使用的KEEP。</p>
<p>但是，如果Gradle插件检测到KEEP FIELDS部分，它将自动使用@Transient注释字段。 之后，可能会删除周围的KEEP FIELDS注释。</p>
</li>
</ul>
<hr>
<h4 id="会话和会话的identity-scope"><a href="#会话和会话的identity-scope" class="headerlink" title="会话和会话的identity scope"></a><a href></a>会话和会话的identity scope</h4><p> （生成的）DaoSession类是greenDAO的中心接口之一。 DaoSession提供开发人员访问基本实体操作和相较于DAO的更完整的操作集合。 此外，会话还管理实体的identity scope。</p>
<h5 id="1-DaoMaster-and-DaoSession"><a href="#1-DaoMaster-and-DaoSession" class="headerlink" title="1. DaoMaster and DaoSession"></a><a href></a>1. DaoMaster and DaoSession</h5><p> 如“入门”部分所述，你需要创建一个DaoMaster以获取DaoSession：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">daoMaster = new DaoMaster(db);</span><br><span class="line">daoSession = daoMaster.newSession();</span><br></pre></td></tr></table></figure>

<p> 请注意，数据库连接属于DaoMaster部分，因此多个会话指的是同一个数据库连接。 因此，我们可以相当快地创建新会话。 但是，每个会话得分配存储空间，特别是实体的会话“缓存”。</p>
<h5 id="2-Identity-scope-和会话缓存"><a href="#2-Identity-scope-和会话缓存" class="headerlink" title="2. Identity scope 和会话缓存"></a><a href></a>2. Identity scope 和会话缓存</h5><p> 如果有两个查询返回相同的数据库对象，则使用多少个Java对象：一个或两个？ 它完全取决于Identity scope。</p>
<p> greenDAO中的默认值（行为是可配置的）是多个查询返回对同一Java对象的引用。 例如，从ID为42的USER表中加载User对象会为这两个查询返回相同的Java对象。</p>
<p> 这种方式的副作用是某种实体“缓存”。 如果实体对象在内存中仍然存在（greenDAO在这里使用弱引用），则不会再次构造该实体。 此外，greenDAO不执行数据库查询以更新实体值。 相反，对象从会话高速缓存“立即”返回，这个速度是相当快的。</p>
<h5 id="3-清除identity-scope"><a href="#3-清除identity-scope" class="headerlink" title="3. 清除identity scope"></a><a href></a>3. 清除identity scope</h5><p> 要清除整个会话的identity scope，以便不返回“缓存”对象：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">daoSession.clear();</span><br></pre></td></tr></table></figure>

<p> 清除单个DAO的identity scope：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">noteDao = daoSession.getNoteDao();</span><br><span class="line">noteDao.detachAll();</span><br></pre></td></tr></table></figure>


<h5 id="4-概念"><a href="#4-概念" class="headerlink" title="4. 概念"></a><a href></a>4. 概念</h5><p> 本文档页面当前信息有限。 请参考<a href="http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/transactions.html#transactions-basics-uow" target="_blank" rel="noopener">Hibernate会话以掌握会话和identiry scope的完整概念</a>。</p>
<hr>
<h4 id="查询和查询构建器"><a href="#查询和查询构建器" class="headerlink" title="查询和查询构建器"></a><a href></a>查询和查询构建器</h4><p> 查询返回符合特定条件的实体。 在greenDAO中，你可以使用原始SQL来制定查询，或者使用QueryBuilder API，相对而言后者会更容易。</p>
<p> 此外，查询支持懒加载结果，当在大结果集上操作时，可以节省内存和性能。</p>
<h5 id="1-查询构建器"><a href="#1-查询构建器" class="headerlink" title="1. 查询构建器"></a><a href></a>1. 查询构建器</h5><p> 编写SQL可能很困难，并且容易出现错误，这些错误仅在运行时被察觉。 QueryBuilder类允许你为没有SQL的实体构建自定义查询，并帮助在编译时检测错误。</p>
<p> <strong>简单条件示例</strong>：查询所有名为“Joe”的用户，按姓氏排序：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;User&gt; joes = userDao.queryBuilder()</span><br><span class="line">  .where(Properties.FirstName.eq(&quot;Joe&quot;))</span><br><span class="line">  .orderAsc(Properties.LastName)</span><br><span class="line">  .list();</span><br></pre></td></tr></table></figure>

<p> <strong>嵌套条件示例</strong>：获取1970年10月或之后出生的名为“Joe”的用户。</p>
<p> 假设我们有一个用户的生日作为年，月和日的单独属性。 然后，我们可以用更正式的方式表示条件：名字是“Joe”AND（出生年份大于1970年或（出生年份是1970年，出生年份等于或大于10））（ 10月，10月）。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder&lt;User&gt; qb = userDao.queryBuilder();</span><br><span class="line">qb.where(Properties.FirstName.eq(&quot;Joe&quot;),</span><br><span class="line">qb.or(Properties.YearOfBirth.gt(1970),</span><br><span class="line">qb.and(Properties.YearOfBirth.eq(1970), Properties.MonthOfBirth.ge(10))));</span><br><span class="line">List&lt;User&gt; youngJoes = qb.list();</span><br></pre></td></tr></table></figure>


<h5 id="2-限制，偏移和分页"><a href="#2-限制，偏移和分页" class="headerlink" title="2. 限制，偏移和分页"></a><a href></a>2. 限制，偏移和分页</h5><p> 有时候，你只需要一个查询结果的子集，例如在用户界面中显示的前10个元素。 当拥有大量实体时，这是非常有用的（节省资源的），并且你也不能使用“where”语句来限制结果。 QueryBuilder 有定义限制和偏移的方法：</p>
<p> limit（int）：限制查询返回的结果数。</p>
<p> offset（int）：结合limit（int）设置查询结果的偏移量。 将跳过第一个偏移结果，并且结果的总数将受limit（int）限制。 你不能使用offset无限制（int）。</p>
<h5 id="3-使用自定义类型作为参数"><a href="#3-使用自定义类型作为参数" class="headerlink" title="3. 使用自定义类型作为参数"></a><a href></a>3. 使用自定义类型作为参数</h5><p> 通常，greenDAO以透明方式映射查询中使用的类型。 例如，boolean被映射到INTEGER，具有0或1个值，并且Date被映射到（long）INTEGER值。</p>
<p> 自定义类型是一个例外：在构建查询时，总是必须使用数据库值类型。 例如，如果使用转换器将枚举类型映射到int值，则应在查询中使用int值。</p>
<h5 id="4-查询和LazyList"><a href="#4-查询和LazyList" class="headerlink" title="4. 查询和LazyList"></a><a href></a>4. 查询和LazyList</h5><p> Query类表示可以多次执行的查询。当你使用QueryBuilder中的一个方法来获取结果（如list()）时，执行过程中QueryBuilder 内部会使用Query 类。如果要多次运行同一个查询，应该在QueryBuilder 上调用build()来创建查询而并非执行它。</p>
<p> greenDAO支持唯一结果（0或1个结果）和结果列表。如果你想在Query （或QueryBuilder ）上有唯一的结果调用unique()，这将为你提供单个结果或者在没有找到匹配的实体时返回null。如果你的用例禁止null作为结果，调用uniqueOrThrow()将保证返回一个非空的实体（否则会抛出一个DaoException）。</p>
<p> 如果希望多个实体作为查询结果，请使用以下方法之一：</p>
<ul>
<li><p>list()所有实体都加载到内存中。结果通常是一个简单的ArrayList。最方便使用。 </p>
</li>
<li><p>listLazy()实体按需加载到内存中。一旦列表中的元素第一次被访问，它将被加载并缓存以备将来使用。使用完后必须关闭。 </p>
</li>
<li><p>listLazyUncached()一个“虚拟”实体列表：对列表元素的任何访问都导致从数据库加载其数据。使用完后必须关闭。 </p>
</li>
<li><p>listIterator()让我们通过按需加载数据（lazily）来遍历结果。数据未缓存。使用完后必须关闭。  方法listLazy()，listLazyUncached()和listIterator()使用greenDAO的LazyList类。要按需加载数据，它保存对数据库游标的引用。这就是为什么你必须确保关闭惰性列表和迭代器（通常在try / finally块）。</p>
<p><em><strong>来自listLazy()的缓存延迟列表和listIterator()中的惰性迭代器在访问或遍历所有元素后自动关闭游标。如果列表处理过早停止,开发者需要自己调用close()进行处理</strong></em></p>
</li>
</ul>
<h5 id="5-多次执行查询"><a href="#5-多次执行查询" class="headerlink" title="5. 多次执行查询"></a><a href></a>5. 多次执行查询</h5><p> 使用QueryBuilder构建查询后，这个Query对象是可以被重复使用的。 这比总是创建新的Query对象更高效。 如果查询参数不更改，你可以继续调用列表/唯一结果等方法进行查询操作。</p>
<p> 但是，参数是可以被更改的：通过调用setParameter方法来更改参数。 当前，通过基于零的参数索引来寻址各个参数。 索引基于我们传入到QueryBuilder的顺序。 例如：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// fetch users with Joe as a first name born in 1970</span><br><span class="line">Query&lt;User&gt; query = userDao.queryBuilder().where(</span><br><span class="line">    Properties.FirstName.eq(&quot;Joe&quot;), Properties.YearOfBirth.eq(1970)</span><br><span class="line">).build();</span><br><span class="line">List&lt;User&gt; joesOf1970 = query.list();</span><br><span class="line"> </span><br><span class="line">// using the same Query object, we can change the parameters</span><br><span class="line">// to search for Marias born in 1977 later:</span><br><span class="line">query.setParameter(0, &quot;Maria&quot;);</span><br><span class="line">query.setParameter(1, 1977);</span><br><span class="line">List&lt;User&gt; mariasOf1977 = query.list();</span><br></pre></td></tr></table></figure>


<h5 id="6-在多线程中执行查询"><a href="#6-在多线程中执行查询" class="headerlink" title="6. 在多线程中执行查询"></a><a href></a>6. 在多线程中执行查询</h5><p> 如果在多个线程中使用查询，则必须调用forCurrentThread（）获取当前线程的Query实例。 Query实例绑定到构建查询的那个线程。</p>
<p> 你可以安全地设置Query对象的参数，不涉及到其他线程。 如果一个线程尝试修改查询参数或执行已经绑定到另一个线程的查询绑，系统将抛出异常。 用这种方式，你就不再需要synchronized语句了。 实际上，你应该避免锁定，因为如果并发事务使用相同的Query对象，这可能导致死锁。</p>
<p> <em><strong>每次调用forCurrentThread()时，查询参数将会被设置成使用构建器构建查询时的参数。</strong></em></p>
<h5 id="7-原始查询"><a href="#7-原始查询" class="headerlink" title="7. 原始查询"></a><a href></a>7. 原始查询</h5><p> 如果QueryBuilder不能满足你的需求，有两种方法来执行原始SQL并返回实体对象。 第一种，首选的方法是使用QueryBuilder和WhereCondition.StringCondition。 这样，你可以将任何SQL片段作为WHERE子句传递给查询构建器。</p>
<p> 以下代码是一个理论示例，说明如何运行子选择（使用连接将是更好的解决方案）：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Query&lt;User&gt; query = userDao.queryBuilder().where(</span><br><span class="line">  new StringCondition(&quot;_ID IN &quot; +</span><br><span class="line">    &quot;(SELECT USER_ID FROM USER_MESSAGE WHERE READ_FLAG = 0)&quot;)</span><br><span class="line">).build();</span><br></pre></td></tr></table></figure>

<p> 第二种方法不使用QueryBuilder， 而是使用queryRaw或queryRawCreate方法。 它们允许您传递一个原始SQL字符串，它附加在SELECT和实体列之后。 这样，你可以有任何WHERE和ORDER BY子句来选择实体。 可以使用别名T来引用实体表。</p>
<p> 以下示例显示如何创建一个查询，该查询使用连接检索名为“admin”的组的用户（同样，greenDAO本身支持连接，这只是为了演示）：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Query&lt;User&gt; query = userDao.queryRawCreate(</span><br><span class="line">  &quot;, GROUP G WHERE G.NAME=? AND T.GROUP_ID=G._ID&quot;, &quot;admin&quot;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p> <em><strong>注意：可以使用生成的常量引用表和列名称。 这是建议避免打字错误，因为编译器将检查名称。 在实体的DAO中，你将发现TABLENAME包含数据库表的名称，以及一个内部类属性，其中包含所有属性的常量（字段columnName）。</strong></em></p>
<h5 id="8-删除查询"><a href="#8-删除查询" class="headerlink" title="8. 删除查询"></a><a href></a>8. 删除查询</h5><p> 批量删除不会删除单个实体，但是所有实体都符合一些条件。 要执行批量删除，请创建一个QueryBuilder，调用其buildDelete（）方法，并执行返回的DeleteQuery。</p>
<p> ***API的这一部分可以在将来改变，例如可以添加方便的方法。</p>
<p> 请注意，批量删除目前不影响identity scope中的实体，例如，如果已删除的实体先前已缓存，并通过其ID（加载方法）进行访问，则可以“复活”。 请考虑立即清除身份范围，如果这可能会导致你的用例的问题。***</p>
<h5 id="9-疑难解答查询"><a href="#9-疑难解答查询" class="headerlink" title="9. 疑难解答查询"></a><a href></a>9. 疑难解答查询</h5><p> 您的查询不返回预期结果？ 在QueryBuilder上启用SQL和参数记录有两个静态标志：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder.LOG_SQL = true;</span><br><span class="line">QueryBuilder.LOG_VALUES = true;</span><br></pre></td></tr></table></figure>

<p> 当调用其中一个构建方法时，它们将记录生成的SQL命令和传递的值，并将它们与实际所需的值进行比较。 此外，它可能有助于将生成的SQL复制到一些SQLite数据库浏览器，并看看它如何执行。</p>
<hr>
<h4 id="查询构建器连接表"><a href="#查询构建器连接表" class="headerlink" title="查询构建器连接表"></a><a href></a>查询构建器连接表</h4><h5 id="1-连接"><a href="#1-连接" class="headerlink" title="1. 连接"></a><a href></a>1. 连接</h5><p> 非普通查询通常需要几个实体类型（表）的数据。 在SQL世界中，可以通过使用连接条件“连接”两个或多个表来实现。</p>
<p> 让我们考虑一个实体User，它与Address实体具有一对多的关系。 然后，我们要查询居住在“Sesame Street”上的用户：我们必须使用用户ID与User实体加入Address实体，并在Address实体上定义WHERE条件：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder&lt;User&gt; queryBuilder = userDao.queryBuilder();</span><br><span class="line">queryBuilder.join(Address.class, AddressDao.Properties.userId)</span><br><span class="line">  .where(AddressDao.Properties.Street.eq(&quot;Sesame Street&quot;));</span><br><span class="line">List&lt;User&gt; users = queryBuilder.list();</span><br></pre></td></tr></table></figure>

<p> 连接需要目标实体类作为每个实体的参数和连接属性。 在示例中，只定义Address实体的join属性，因为默认使用主键属性。 换句话说，查询导致用户具有UserId等于User实体ID并且还具有特定街道的Address实体。</p>
<h5 id="2-查询构建器连接API"><a href="#2-查询构建器连接API" class="headerlink" title="2. 查询构建器连接API"></a><a href></a>2. 查询构建器连接API</h5><p> 由于可以在使用主键属性时省略join属性，因此QueryBuilder中提供了三种重载的连接方法：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * Expands the query to another entity type by using a JOIN.</span><br><span class="line">  * The primary key property of the primary entity for</span><br><span class="line">  * this QueryBuilder is used to match the given destinationProperty.</span><br><span class="line">  */</span><br><span class="line">public &lt;J&gt; Join&lt;T, J&gt; join(Class&lt;J&gt; destinationEntityClass, Property destinationProperty)</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * Expands the query to another entity type by using a JOIN.</span><br><span class="line"> * The given sourceProperty is used to match the primary</span><br><span class="line"> * key property of the given destinationEntity.</span><br><span class="line"> */</span><br><span class="line">public &lt;J&gt; Join&lt;T, J&gt; join(Property sourceProperty, Class&lt;J&gt; destinationEntityClass)</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * Expands the query to another entity type by using a JOIN.</span><br><span class="line"> * The given sourceProperty is used to match the given</span><br><span class="line"> * destinationProperty of the given destinationEntity.</span><br><span class="line"> */</span><br><span class="line">public &lt;J&gt; Join&lt;T, J&gt; join(Property sourceProperty, Class&lt;J&gt; destinationEntityClass,</span><br><span class="line">    Property destinationProperty)</span><br></pre></td></tr></table></figure>


<h5 id="3-链式连接"><a href="#3-链式连接" class="headerlink" title="3. 链式连接"></a><a href></a>3. 链式连接</h5><p> 此外，greenDAO允许跨多个表连接。 在这里，使用另一个连接和目标实体定义连接。 在这种情况下，第一连接的目的实体变为第二联接的起始实体。</p>
<p> 用于链接连接的QueryBuilder API如下所示：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Expands the query to another entity type by using a JOIN.</span><br><span class="line"> * The given sourceJoin&apos;s property is used to match the</span><br><span class="line"> * given destinationProperty of the given destinationEntity.</span><br><span class="line"> * Note that destination entity of the given join is used</span><br><span class="line"> * as the source for the new join to add. In this way,</span><br><span class="line"> * it is possible to compose complex &quot;join of joins&quot; across</span><br><span class="line"> * several entities if required.</span><br><span class="line"> */</span><br><span class="line">public &lt;J&gt; Join&lt;T, J&gt; join(Join&lt;?, T&gt; sourceJoin, Property sourceProperty,</span><br><span class="line">    Class&lt;J&gt; destinationEntityClass, Property destinationProperty)</span><br></pre></td></tr></table></figure>

<p> 让我们看看另一个有三个实体的例子：城市，国家和大陆。 如果我们要查询欧洲所有人口至少100万的所有城市，它将如下所示：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder&lt;City&gt; qb = cityDao.queryBuilder().where(Properties.Population.ge(1000000));</span><br><span class="line">Join country = qb.join(Properties.CountryId, Country.class);</span><br><span class="line">Join continent = qb.join(country, CountryDao.Properties.ContinentId,</span><br><span class="line">  Continent.class, ContinentDao.Properties.Id);</span><br><span class="line">continent.where(ContinentDao.Properties.Name.eq(&quot;Europe&quot;));</span><br><span class="line">List&lt;City&gt; bigEuropeanCities = qb.list();</span><br></pre></td></tr></table></figure>


<h5 id="4-自连接-树示例"><a href="#4-自连接-树示例" class="headerlink" title="4. 自连接/树示例"></a><a href></a>4. 自连接/树示例</h5><p> 连接也可以与引用单个实体的关系一起使用。 例如，我们想找到所有的人，他的祖父的名字是“林肯”。 让我们假设我们有一个具有指向同一个实体的fatherId属性的Person实体。 然后，查询构建如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder&lt;Person&gt; qb = personDao.queryBuilder();</span><br><span class="line">Join father = qb.join(Person.class, Properties.FatherId);</span><br><span class="line">Join grandfather = qb.join(father, Properties.FatherId, Person.class, Properties.Id);</span><br><span class="line">grandfather.where(Properties.Name.eq(&quot;Lincoln&quot;));</span><br><span class="line">List&lt;Person&gt; lincolnDescendants = qb.list();</span><br></pre></td></tr></table></figure>

<p> 如您所见，连接是构建跨多个实体类型或关系的查询的强大工具。</p>
<hr>
<h4 id="实体之间的关系（一对多）"><a href="#实体之间的关系（一对多）" class="headerlink" title="实体之间的关系（一对多）"></a><a href></a>实体之间的关系（一对多）</h4><h5 id="1-关系"><a href="#1-关系" class="headerlink" title="1. 关系"></a><a href></a>1. 关系</h5><p> 数据库表可以使用1：1,1：N或N：M关系彼此相关。 如果你刚接触数据库关系，你需要在我们讨论ORM之前快速的恶补一下。 这里有一些关于数据库关系的网络链接。<br> <a href="https://code.tutsplus.com/articles/sql-for-beginners-part-3-database-relationships--net-8561" target="_blank" rel="noopener">第一篇</a><br> <a href="https://en.wikipedia.org/wiki/Relation_(database)" target="_blank" rel="noopener">第二篇</a><br> <a href="http://www.sql-tutorial.com/relations-keys-normalization-sql-tutorial/" target="_blank" rel="noopener">第三篇</a></p>
<p> 在greenDAO中，实体使用一对一或一对多关系。 例如，如果要在greenDAO中建模1：n关系，则将具有一对一关系和一对多关系。 但是，请注意，一对一和一对多关系不会彼此连接，因此你必须更新两者。</p>
<h5 id="2-构建一对一关系"><a href="#2-构建一对一关系" class="headerlink" title="2. 构建一对一关系"></a><a href></a>2. 构建一对一关系</h5><p> @ToOne注解定义与另一个实体（一个实体对象）的关系。 将其应用于包含其他实体对象的属性。</p>
<p> 在内部，greenDAO需要一个指向由joinProperty参数指定的目标实体的ID的附加属性。 如果此参数不存在，则会自动创建一个附加列来保存这个信息。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Order &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line"> </span><br><span class="line">    private long customerId;</span><br><span class="line"> </span><br><span class="line">    @ToOne(joinProperty = &quot;customerId&quot;)</span><br><span class="line">    private Customer customer;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@Entity</span><br><span class="line">public class Customer &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 一对一关系的getter方法（在此示例中为getCustomer()）在其第一次调用时延迟解析目标实体。 后续调用将立即返回先前解析的对象。</p>
<p> 注意，如果更改外键属性（这里为customerId），下一次对getter（getCustomer()）的调用将解析实体以获取更新的ID。</p>
<p> 另外，如果设置了一个新实体（setCustomer（）），外键属性（customerId）也将被更新。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Customer customerA = user.getCustomer();</span><br><span class="line"> </span><br><span class="line">// change the customer id</span><br><span class="line">user.setCustomerId(customerIdB);</span><br><span class="line">// or set a customer with a different id</span><br><span class="line">user.setCustomer(customerB);</span><br><span class="line"> </span><br><span class="line">customerB = user.getCustomer();</span><br><span class="line">assert(customerA.getId() != customerB.getId());</span><br></pre></td></tr></table></figure>

<p> <em><strong>注意：要热加载一对一关系，请使用实体DAO类的loadDeep（）和queryDeep（）。 这将解析与单个数据库查询具有所有一对一关系的实体。 如果你总是访问相关实体，这将有助于性能的提高。</strong></em></p>
<h5 id="2-构建一对多关系"><a href="#2-构建一对多关系" class="headerlink" title="2. 构建一对多关系"></a><a href></a>2. 构建一对多关系</h5><p> @ToMany定义与一组其他实体（多个实体对象）的关系。 将此应用于表示目标实体列表的属性。 引用的实体必须有一个或多个属性指向拥有@ToMany的实体。</p>
<p> 有三种可能性来指定关系映射，只使用其中一个即可：</p>
<ul>
<li>referencedJoinProperty参数：指定目标实体中指向此实体标识的“外键”属性的名称。  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Customer &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line"> </span><br><span class="line">    @ToMany(referencedJoinProperty = &quot;customerId&quot;)</span><br><span class="line">    @OrderBy(&quot;date ASC&quot;)</span><br><span class="line">    private List&lt;Order&gt; orders;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@Entity</span><br><span class="line">public class Order &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    private Date date;</span><br><span class="line">    private long customerId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li>joinProperties参数：对于更复杂的关系，你可以指定一列@JoinProperty注解。 每个@JoinProperty需要原始实体中的源属性和目标实体中的引用属性。  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Customer &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    @Unique private String tag;</span><br><span class="line"> </span><br><span class="line">    @ToMany(joinProperties = &#123;</span><br><span class="line">            @JoinProperty(name = &quot;tag&quot;, referencedName = &quot;customerTag&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    @OrderBy(&quot;date ASC&quot;)</span><br><span class="line">    private List&lt;Site&gt; orders;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@Entity</span><br><span class="line">public class Order &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    private Date date;</span><br><span class="line">    @NotNull private String customerTag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>@JoinEntity：如果你正在执行涉及另一个连接实体/表的N：M（多对多）关系，请在属性上放置此附加注解。  </p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Product &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line"> </span><br><span class="line">    @ToMany</span><br><span class="line">    @JoinEntity(</span><br><span class="line">            entity = JoinProductsWithOrders.class,</span><br><span class="line">            sourceProperty = &quot;productId&quot;,</span><br><span class="line">            targetProperty = &quot;orderId&quot;</span><br><span class="line">    )</span><br><span class="line">    private List&lt;Order&gt; ordersWithThisProduct;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@Entity</span><br><span class="line">public class JoinProductsWithOrders &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    private Long productId;</span><br><span class="line">    private Long orderId;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@Entity</span><br><span class="line">public class Order &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一旦运行，插件将生成一个getter来解析被引用实体的列表。 例如在前两种情况下：</p>
</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// return all orders where customerId == customer.getId()</span><br><span class="line">List&lt;Order&gt; orders = customer.getOrders();</span><br></pre></td></tr></table></figure>


<h5 id="3-解析和更新对多关系"><a href="#3-解析和更新对多关系" class="headerlink" title="3. 解析和更新对多关系"></a><a href></a>3. 解析和更新对多关系</h5><p> 多对多关系在第一个请求上解析比较慢，然后将List对象缓存在实体中。 因此，后续采用get方法调用将不会查询数据库。</p>
<p> 更新多对多关系需要一些额外的工作。 因为缓存了一对多列表，所以当将相关实体添加到数据库时，它们不会更新。 以下代码说明了这种行为：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// get the current list of orders for a customer</span><br><span class="line">List&lt;Order&gt; orders1 = customer.getOrders();</span><br><span class="line"> </span><br><span class="line">// insert a new order for this customer</span><br><span class="line">Order order = new Order();</span><br><span class="line">order.setCustomerId(customer.getId());</span><br><span class="line">daoSession.insert(order);</span><br><span class="line"> </span><br><span class="line">// get the list of orders again</span><br><span class="line">List&lt;Order&gt; orders2 = customer.getOrders();</span><br><span class="line"> </span><br><span class="line">// the (cached) list of orders was not updated</span><br><span class="line">// orders1 has the same size as orders2</span><br><span class="line">assert(orders1.size() == orders2.size);</span><br><span class="line">// orders1 is the same object as orders2</span><br><span class="line">assert(orders1.equals(orders2));</span><br></pre></td></tr></table></figure>

<p> 因此，要添加新的相关实体，请将它们手动添加到源实体的多对多列表中，如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// get the to-many list before inserting the new entity</span><br><span class="line">// otherwise the new entity might be in the list twice</span><br><span class="line">List&lt;Order&gt; orders = customer.getOrders();</span><br><span class="line">// create the new entity</span><br><span class="line">Order newOrder = ...</span><br><span class="line">// set the foreign key property</span><br><span class="line">newOrder.setCustomerId(customer.getId());</span><br><span class="line">// persist the new entity</span><br><span class="line">daoSession.insert(newOrder);</span><br><span class="line">// add it to the to-many list</span><br><span class="line">orders.add(newOrder);</span><br></pre></td></tr></table></figure>

<p> 同样，你可以删除相关实体，如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Order&gt; orders = customer.getOrders();</span><br><span class="line">// remove one of the orders from the database</span><br><span class="line">daoSession.delete(someOrder);</span><br><span class="line">// manually remove it from the to-many list</span><br><span class="line">orders.remove(someOrder);</span><br></pre></td></tr></table></figure>

<p> 添加，更新或删除许多相关实体时，可以使用重置方法清除缓存的列表。 然后下一个get将重新查询相关实体：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// clear any cached list of related orders</span><br><span class="line">customer.resetOrders();</span><br><span class="line">List&lt;Order&gt; orders = customer.getOrders();</span><br></pre></td></tr></table></figure>


<h5 id="4-双向1：N关系"><a href="#4-双向1：N关系" class="headerlink" title="4. 双向1：N关系"></a><a href></a>4. 双向1：N关系</h5><p> 有时你想在两个方向上建立1：N关系。 在greenDAO中，你必须添加一对一和一对多关系才能实现此目的。</p>
<p> 以下示例显示了客户和订单实体的完整建模，我们之前用作示例。 这次，我们使用customerId属性创建两个关系：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class Customer &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line"> </span><br><span class="line">    @ToMany(referencedJoinProperty = &quot;customerId&quot;)</span><br><span class="line">    @OrderBy(&quot;date ASC&quot;)</span><br><span class="line">    private List&lt;Order&gt; orders;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@Entity</span><br><span class="line">public class Order &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line">    private Date date;</span><br><span class="line">    private long customerId;</span><br><span class="line"> </span><br><span class="line">    @ToOne(joinProperty = &quot;customerId&quot;)</span><br><span class="line">    private Customer customer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 让我们假设我们有一个订单实体。 使用这两种关系，我们可以得到客户和客户所做的所有订单：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Order&gt; allOrdersOfCustomer = order.getCustomer().getOrders();</span><br></pre></td></tr></table></figure>


<h5 id="5-示例：建模树关系"><a href="#5-示例：建模树关系" class="headerlink" title="5. 示例：建模树关系"></a><a href></a>5. 示例：建模树关系</h5><p> 您可以通过使用指向自身的一对一和多对一关系建模实体来建模树关系：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class TreeNode &#123;</span><br><span class="line">    @Id private Long id;</span><br><span class="line"> </span><br><span class="line">    private Long parentId;</span><br><span class="line"> </span><br><span class="line">    @ToOne(joinProperty = &quot;parentId&quot;)</span><br><span class="line">    private TreeNode parent;</span><br><span class="line"> </span><br><span class="line">    @ToMany(referencedJoinProperty = &quot;parentId&quot;)</span><br><span class="line">    private List&lt;TreeNode&gt; children;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 生成的实体允许您导航其父级和子级：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TreeNode parent = entity.getParent();</span><br><span class="line">List&lt;TreeNode&gt; children = entity.getChildren();</span><br></pre></td></tr></table></figure>


<h5 id="6-更多示例"><a href="#6-更多示例" class="headerlink" title="6. 更多示例"></a><a href></a>6. 更多示例</h5><p> 查看<a href="https://github.com/greenrobot/greenDAO/tree/master/examples/DaoExample" target="_blank" rel="noopener">DaoExample</a>项目以获取完整的Android应用示例。</p>
<p> 此外，<a href="https://github.com/greenrobot/greenDAO/tree/master/tests/DaoTestEntityAnnotation" target="_blank" rel="noopener">DaoTestEntityAnnotation项目</a>附带了几个关系测试。 其中，除了其他<a href="https://github.com/greenrobot/greenDAO/tree/master/examples" target="_blank" rel="noopener">示例</a>和<a href="https://github.com/greenrobot/greenDAO/tree/master/tests" target="_blank" rel="noopener">测试项目</a>之外，可以用作进一步的示例。</p>
<hr>
<h4 id="自定义类型：将类和枚举映射到数据库值"><a href="#自定义类型：将类和枚举映射到数据库值" class="headerlink" title="自定义类型：将类和枚举映射到数据库值"></a><a href></a>自定义类型：将类和枚举映射到数据库值</h4><p> 自定义类型允许实体具有任何类型的属性。 默认情况下，greenDAO支持以下类型</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">boolean, Boolean</span><br><span class="line">int, Integer</span><br><span class="line">short, Short</span><br><span class="line">long, Long</span><br><span class="line">float, Float</span><br><span class="line">double, Double</span><br><span class="line">byte, Byte</span><br><span class="line">byte[]</span><br><span class="line">String</span><br><span class="line">Date</span><br></pre></td></tr></table></figure>


<h5 id="1-转换注解和属性转换器"><a href="#1-转换注解和属性转换器" class="headerlink" title="1. 转换注解和属性转换器"></a><a href></a>1. 转换注解和属性转换器</h5><p> 要添加对自定义类型的支持，可以使用@Convert注释将它们映射到其中一种受支持的类型。 同时你还需要提供PropertyConverter实现。</p>
<p> 例如，你可以使用自定义Color类在实体中定义颜色，并将其映射到整数。 或者你可以将流行的org.joda.time.DateTime从Joda Time映射到Long。</p>
<p> 这是将枚举映射到整数的示例：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">public class User &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Long id;</span><br><span class="line"> </span><br><span class="line">    @Convert(converter = RoleConverter.class, columnType = Integer.class)</span><br><span class="line">    private Role role;</span><br><span class="line"> </span><br><span class="line">    public enum Role &#123;</span><br><span class="line">        DEFAULT(0), AUTHOR(1), ADMIN(2);</span><br><span class="line">        </span><br><span class="line">        final int id;</span><br><span class="line">        </span><br><span class="line">        Role(int id) &#123;</span><br><span class="line">            this.id = id;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public static class RoleConverter implements PropertyConverter&lt;Role, Integer&gt; &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public Role convertToEntityProperty(Integer databaseValue) &#123;</span><br><span class="line">            if (databaseValue == null) &#123;</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line">            for (Role role : Role.values()) &#123;</span><br><span class="line">                if (role.id == databaseValue) &#123;</span><br><span class="line">                    return role;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return Role.DEFAULT;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public Integer convertToDatabaseValue(Role entityProperty) &#123;</span><br><span class="line">            return entityProperty == null ? null : entityProperty.id;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <em><strong>注意：如果你在实体类中定义自定义类型或转换器，它们必须是静态的。</strong></em></p>
<p> 不要忘记正确处理空值 - 通常，如果输入为null，则应返回null。</p>
<p> 转换器的数据库类型意义上不是SQLite类型，而是由greenDAO提供的原始Java类型。 建议使用易于转换的基本类型（int，long，byte数组，String，…）。</p>
<p> <em><strong>注意：为了获得最佳性能，greenDAO将为所有转换使用单个转换器实例。 确保转换器除了无参数默认构造函数之外没有任何其他构造函数。 另外，使它线程安全，因为它可能在多个实体上并发调用。</strong></em></p>
<h5 id="2-如何正确转换枚举"><a href="#2-如何正确转换枚举" class="headerlink" title="2. 如何正确转换枚举"></a><a href></a>2. 如何正确转换枚举</h5><p> 枚举在像实体这样的数据对象中使很常用的。 当持久化枚举时，有下面几个不错的方法：</p>
<ul>
<li><p>不要持久化枚举的序号或名称：两者都不稳定，并且很有可能下次编辑枚举定义的时候就变化了。 </p>
</li>
<li><p>使用stable ids：在你的枚举中定义一个保证稳定的自定义属性（整数或字符串）。 使用它来进行持久性映射。 </p>
</li>
<li><p>未知值：定义一个UNKNOWN枚举值。 它可以用于处理空值或未知值。 这将允许你处理像旧的枚举值被删除而不会崩溃您的应用程序的情况。  </p>
<h5 id="3-自定义类型在查询中的处理"><a href="#3-自定义类型在查询中的处理" class="headerlink" title="3. 自定义类型在查询中的处理"></a><a href></a>3. 自定义类型在查询中的处理</h5><p>QueryBuilder不知道自定义类型。 您必须对查询使用原语类型（例如在WHERE参数中）。 还要注意，在数据库中完成的操作总是引用原始类型，例如在ORDER BY子句中。</p>
</li>
</ul>
<hr>
<h4 id="数据库加密"><a href="#数据库加密" class="headerlink" title="数据库加密"></a><a href></a>数据库加密</h4><p> greenDAO支持加密的数据库来保护敏感数据。</p>
<p> 虽然较新版本的Android支持文件系统加密，但Android本身并不为数据库文件提供加密。 因此，如果攻击者获得对数据库文件的访问（例如通过利用安全缺陷或欺骗有根的设备的用户），攻击者可以访问该数据库内的所有数据。 使用受密码保护的加密数据库增加了额外的安全层。 它防止攻击者简单地打开数据库文件。</p>
<h5 id="1-使用自定义SQLite构建"><a href="#1-使用自定义SQLite构建" class="headerlink" title="1. 使用自定义SQLite构建"></a><a href></a>1. 使用自定义SQLite构建</h5><p> 因为Android不支持加密数据库，所以你需要在APK中捆绑SQLite的自定义构建。 这些定制构建包括CPU相关和本地代码。 所以你的APK大小将增加几个MByte。 因此，你应该只使用加密，如果你真的需要它。</p>
<h5 id="2-设置数据库加密"><a href="#2-设置数据库加密" class="headerlink" title="2. 设置数据库加密"></a><a href></a>2. 设置数据库加密</h5><p> greenDAO直接支持带有绑定的<a href="https://www.zetetic.net/sqlcipher/" target="_blank" rel="noopener">SQLCipher</a>。 SQLCipher是使用256位AES加密的SQLite的自定义构建。</p>
<p> <a href></a>2.1 添加SQLCipher依赖关系 请参阅<a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/" target="_blank" rel="noopener">SQLCipher for Android</a>，了解如何向项目添加SQLCipher。</p>
<p> <a href></a>2.2 数据库初始化 确保使用DaoMaster中提供的OpenHelper的子类来创建数据库实例。 例如简单的DevOpenHelper，也在DaoMaster中提供。</p>
<p> 然后，在创建数据库实例时，只需调用.getEncryptedWritableDb（）而不是.getWritableDb（）。 最后，像往常一样将数据库传递给DaoMaster：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DevOpenHelper helper = new DevOpenHelper(this, &quot;notes-db-encrypted.db&quot;);</span><br><span class="line">Database db = helper.getEncryptedWritableDb(&quot;&lt;your-secret-password&gt;&quot;);</span><br><span class="line">daoSession = new DaoMaster(db).newSession();</span><br><span class="line"></span><br><span class="line">DevOpenHelper helper = new DevOpenHelper(this, &quot;notes-db-encrypted.db&quot;);</span><br><span class="line">Database db = helper.getEncryptedWritableDb(&quot;&lt;your-secret-password&gt;&quot;);</span><br><span class="line">daoSession = new DaoMaster(db).newSession();</span><br></pre></td></tr></table></figure>


<h5 id="3-数据库抽象"><a href="#3-数据库抽象" class="headerlink" title="3. 数据库抽象"></a><a href></a>3. 数据库抽象</h5><p> greenDAO对所有数据库交互使用一个小型的抽象层，因此支持标准和非标准的SQLite实现：</p>
<ul>
<li><p>Android的标准android.database.sqlite.SQLiteDatabase </p>
</li>
<li><p>SQLCipher的net.sqlcipher.database.SQLiteDatabase </p>
</li>
<li><p>任何SQLite兼容的数据库，它可以实现<br> org.greenrobot.greendao.database.Database（例如SQLite的自定义构建）  这使您能够轻松地从标准数据库切换到加密数据库，因为在针对DaoSession和单个DAO时，代码将是相同的。</p>
<p><a href></a>3.1 使用Robolectric进行单元测试 数据库抽象允许用Robolectric进行单元测试。 即使你的应用程序使用加密的数据库，你的测试也可以使用未加密的数据库。</p>
<p>Robolectric实现标准的SQLite API，没有办法加载自定义SQLite构建（Android二进制）。 因此，对于你的测试，在创建数据库实例时使用.getWritableDb（）而不是.getEncryptedWritableDb（）（见上文）。</p>
<p><a href></a>3.2 SQLCipher的已知问题 SQLCipher是SQLite的自定义构建。 它的Android API与Android系统API有点分歧。 这里是我们注意到的问题（与greenDAO无关）：</p>
</li>
</ul>
<ul>
<li>抛出的异常不是类型android.database.SQLException（请参阅SQLcipher问题223） </li>
<li>SQLCipher比最近的SQLiteDatabase实现锁定更多。 这不仅降低了并发性，而且增加了死锁的机会。 </li>
<li>从SQLCipher 3.5.0开始，缺少Android归类（如LOCALIZED）  </li>
</ul>
<hr>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a><a href></a>写在最后</h2><p> 个人翻译，用于后面查阅，若有不当请担待~  
 原文链接：<br> <a href="http://greenrobot.org/greendao/" target="_blank" rel="noopener">http://greenrobot.org/greendao/</a></p>
<hr>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a><a href></a>最后</h2><p> 关注「码道长」，了解最前沿的技术知识，抬高自己的天花板。<br> <img src="https://img-blog.csdn.net/20180101122148924?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcG9vcmtpY2s=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2016-12-25T08:27:23.000Z">2016-12-25</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android开源库/">Android开源库</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    14 分钟 读完 (大约 2066 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2016/12/25/《Android开源库》 PagerSlidingTabStrip从头到脚/">《Android开源库》 PagerSlidingTabStrip从头到脚</a>
            
        </h1>
        <div class="content">
            <p> 版权声明：本文为博主原创文章，未经博主允许不得转载。 <a href="https://blog.csdn.net/poorkick/article/details/53868426" target="_blank" rel="noopener">https://blog.csdn.net/poorkick/article/details/53868426</a>   </p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a><a href></a>简介</h2><p> <a href="https://github.com/astuetz/PagerSlidingTabStrip" target="_blank" rel="noopener">PagerSlidingTabStrip</a>，是我个人经常使用到的一个和ViewPager配合的页面指示器，可以满足开发过程中常用的需求，如类似于今日头条的首页新闻内容导航栏等等，之前自己开发的<a href="https://github.com/onlyloveyd/JuheNews" target="_blank" rel="noopener">JuheNews</a>和正在开发的<a href="https://github.com/onlyloveyd/GankIOClient" target="_blank" rel="noopener">GankIOClient</a>均有使用到它，所以想对其进行一个全面的介绍。  </p>
<p> <img src="https://img-blog.csdn.net/20161225095838631" alt="JuheNews"> <img src="https://img-blog.csdn.net/20161225095901710" alt="GankIOClient">  </p>
<p> PagerSlidingTabStrip源码地址：</p>
<p> <a href="https://github.com/astuetz/PagerSlidingTabStrip" target="_blank" rel="noopener">https://github.com/astuetz/PagerSlidingTabStrip</a></p>
<hr>
<h2 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a><a href></a>简单使用</h2><ul>
<li>添加库依赖  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile &apos;com.astuetz:pagerslidingtabstrip:1.0.1&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li>定义布局文件  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.astuetz.PagerSlidingTabStrip</span><br><span class="line">    android:id=&quot;@+id/psts_indicator&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;40dp&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.v4.view.ViewPager</span><br><span class="line">    android:id=&quot;@+id/vp_content&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;/&gt;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li>关联ViewPager  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    @BindView(R.id.psts_indicator)</span><br><span class="line">    PagerSlidingTabStrip pstsIndicator;</span><br><span class="line">    @BindView(R.id.activity_main)</span><br><span class="line">    LinearLayout activityMain;</span><br><span class="line">    @BindView(R.id.vp_content)</span><br><span class="line">    ViewPager vpContent;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        ButterKnife.bind(this);</span><br><span class="line">        MainPagerAdapter mainPagerAdapter = new MainPagerAdapter(getSupportFragmentManager());</span><br><span class="line">        vpContent.setAdapter(mainPagerAdapter);</span><br><span class="line">        pstsIndicator.setViewPager(vpContent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li>结果  <img src="https://img-blog.csdn.net/20161225100453936" alt="这里写图片描述"></li>
</ul>
<ul>
<li>后话<br> 看到这个效果，是不是很炸裂，如此的丑陋，上图是什么属性都没有修改默认的效果图，接着我们看下源码，看下可以从哪方面来进行改造。  </li>
</ul>
<hr>
<h2 id="源码解析"><a href="#源码解析" class="headerlink" title="源码解析"></a><a href></a>源码解析</h2><p> 这个开源库，简单点说就是大家都非常熟悉的自定义View，所以，解读的方式可以从自定义属性到此视图的构造，onMeasure,onLayout, onDraw等等</p>
<ol>
<li>自定义的属性值</li>
</ol>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;declare-styleable name=&quot;PagerSlidingTabStrip&quot;&gt;</span><br><span class="line">        &lt;!--底部滑动指示器的颜色--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsIndicatorColor&quot; format=&quot;color&quot; /&gt;</span><br><span class="line">        &lt;!--底部用于给指示器滑动的区域的颜色--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsUnderlineColor&quot; format=&quot;color&quot; /&gt;</span><br><span class="line">        &lt;!--分割线的颜色--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsDividerColor&quot; format=&quot;color&quot; /&gt;</span><br><span class="line">        &lt;!--指示器的高度--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsIndicatorHeight&quot; format=&quot;dimension&quot; /&gt;</span><br><span class="line">        &lt;!--底部区域的高度--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsUnderlineHeight&quot; format=&quot;dimension&quot; /&gt;</span><br><span class="line">        &lt;!--分割线与上下的间距--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsDividerPadding&quot; format=&quot;dimension&quot; /&gt;</span><br><span class="line">        &lt;!--每个Tab的左右边距--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsTabPaddingLeftRight&quot; format=&quot;dimension&quot; /&gt;</span><br><span class="line">        &lt;!--选中tab的滚动偏移量,个人基本没有用到过--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsScrollOffset&quot; format=&quot;dimension&quot; /&gt;</span><br><span class="line">        &lt;!--每个Tab的背景图，StateListDrawable--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsTabBackground&quot; format=&quot;reference&quot; /&gt;</span><br><span class="line">        &lt;!--是否根据tab均为位置，true的时候均分，默认为false,一般都是使用默认值--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsShouldExpand&quot; format=&quot;boolean&quot; /&gt;</span><br><span class="line">        &lt;!--标题文本是否大写，默认为true--&gt;</span><br><span class="line">        &lt;attr name=&quot;pstsTextAllCaps&quot; format=&quot;boolean&quot; /&gt;</span><br><span class="line">    &lt;/declare-styleable&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure>

<p> 看下大致的布局和属性对号入座<br> <img src="https://img-blog.csdn.net/20161225110620803" alt="这里写图片描述"></p>
<ol start="2">
<li>PagerSlidingTabStrip.java类结构</li>
</ol>
<hr>
<p> <img src="https://img-blog.csdn.net/20161225135308515" alt="getter and setter">  </p>
<p> 类中的getter和setter方法，基本上和上面的自定义属性可以对上号，不仅可以在布局文件中定义，还可以通过java代码进行设置。  </p>
<hr>
<p> <img src="https://img-blog.csdn.net/20161225135749135" alt="这里写图片描述">  </p>
<p> 类中使用到的变量，大部分都是和自定义属性挂钩的，主要关注几个</p>
<pre><code>变量                   | 意义                                                                                     
-------------------- | --------------------------------------------------------------------------------------- 
ATTRS                | 引用Android系统的两个属性，文本字体大小和字体颜色                                                           
pageListener         | 内部使用的OnPagerChangeListener,通过setViewPager实现和ViewPager的联动                               
delegatePageListener | 暴露给开发者的接口，类本身使用到了两个OnPageChangeListener，一个用来实现自己的逻辑，而这个则是留给开发者实现自己需要针对ViewPager的页面变化的逻辑
tabsContainer        | 内部容器，用户所见文本指示器和图标指示器的父节点，所以，如果需要针对文本指示器或者是图标指示器做什么操作，通过这个查找孩子节点即可                      </code></pre><hr>
<p> <img src="https://img-blog.csdn.net/20161225141223354" alt="这里写图片描述">  </p>
<ul>
<li>IconTabProvider<br> 类中比较关键的一些内容，接口IconTabProvider，ViewPager对应的Adapter实现该方法并返回每个ViewPager对应的图标即可实现图标指示器。</li>
</ul>
<ul>
<li>PageListener &lt;用户自定义的OnPagerListener的事件处理集成于此处&gt;</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">private class PageListener implements OnPageChangeListener &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) &#123;</span><br><span class="line"></span><br><span class="line">           //存储当前位置信息</span><br><span class="line">		currentPosition = position;</span><br><span class="line">		currentPositionOffset = positionOffset;</span><br><span class="line"></span><br><span class="line">           //滑动到子视图</span><br><span class="line">		scrollToChild(position, (int) (positionOffset * tabsContainer.getChildAt(position).getWidth()));</span><br><span class="line"></span><br><span class="line">		invalidate();//触发重绘</span><br><span class="line"></span><br><span class="line">           //用户自定义的OnPagerChangeListener事件之onPagerScrolled</span><br><span class="line">		if (delegatePageListener != null) &#123;</span><br><span class="line">			delegatePageListener.onPageScrolled(position, positionOffset, positionOffsetPixels);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void onPageScrollStateChanged(int state) &#123;</span><br><span class="line">	    //已经滑动完成，offset归0</span><br><span class="line">		if (state == ViewPager.SCROLL_STATE_IDLE) &#123;</span><br><span class="line">			scrollToChild(pager.getCurrentItem(), 0);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">           //用户自定义的OnPagerChangeListener事件之onPageScrollStateChanged</span><br><span class="line">		if (delegatePageListener != null) &#123;</span><br><span class="line">			delegatePageListener.onPageScrollStateChanged(state);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void onPageSelected(int position) &#123;</span><br><span class="line">	    //这里类内部没有做什么处理，只处理用户自定义的OnPagerSelected方法</span><br><span class="line">		if (delegatePageListener != null) &#123;</span><br><span class="line">			delegatePageListener.onPageSelected(position);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *滑动指定子视图</span><br><span class="line"> */</span><br><span class="line">   private void scrollToChild(int position, int offset) &#123;</span><br><span class="line"></span><br><span class="line">	if (tabCount == 0) &#123;</span><br><span class="line">		return;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	int newScrollX = tabsContainer.getChildAt(position).getLeft() + offset;</span><br><span class="line"></span><br><span class="line">	if (position &gt; 0 || offset &gt; 0) &#123;</span><br><span class="line">		newScrollX -= scrollOffset;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if (newScrollX != lastScrollX) &#123;</span><br><span class="line">		lastScrollX = newScrollX;</span><br><span class="line">		scrollTo(newScrollX, 0);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<ul>
<li>PagerSlidingTabStrip构造方法<br> 构造方法的内容不多，基本上全是基本属性的获取，自定义View中常用的TypedArray ，记得回收recycle()，这里关注一下 TypedValue.applyDimension方法的使用，全部转换成px。  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">public PagerSlidingTabStrip(Context context, AttributeSet attrs, int defStyle) &#123;</span><br><span class="line">	super(context, attrs, defStyle);</span><br><span class="line"></span><br><span class="line">	setFillViewport(true);</span><br><span class="line">	setWillNotDraw(false);</span><br><span class="line"></span><br><span class="line">	tabsContainer = new LinearLayout(context);</span><br><span class="line">	tabsContainer.setOrientation(LinearLayout.HORIZONTAL);</span><br><span class="line">	tabsContainer.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));</span><br><span class="line">	addView(tabsContainer);</span><br><span class="line"></span><br><span class="line">	DisplayMetrics dm = getResources().getDisplayMetrics();</span><br><span class="line"></span><br><span class="line">	scrollOffset = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, scrollOffset, dm);</span><br><span class="line">	indicatorHeight = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, indicatorHeight, dm);</span><br><span class="line">	underlineHeight = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, underlineHeight, dm);</span><br><span class="line">	dividerPadding = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, dividerPadding, dm);</span><br><span class="line">	tabPadding = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, tabPadding, dm);</span><br><span class="line">	dividerWidth = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, dividerWidth, dm);</span><br><span class="line">	tabTextSize = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_SP, tabTextSize, dm);</span><br><span class="line"></span><br><span class="line">	// get system attrs (android:textSize and android:textColor)</span><br><span class="line"></span><br><span class="line">	TypedArray a = context.obtainStyledAttributes(attrs, ATTRS);</span><br><span class="line"></span><br><span class="line">	tabTextSize = a.getDimensionPixelSize(0, tabTextSize);</span><br><span class="line">	tabTextColor = a.getColor(1, tabTextColor);</span><br><span class="line"></span><br><span class="line">	a.recycle();</span><br><span class="line"></span><br><span class="line">	// get custom attrs</span><br><span class="line"></span><br><span class="line">	a = context.obtainStyledAttributes(attrs, R.styleable.PagerSlidingTabStrip);</span><br><span class="line"></span><br><span class="line">	indicatorColor = a.getColor(R.styleable.PagerSlidingTabStrip_pstsIndicatorColor, indicatorColor);</span><br><span class="line">	underlineColor = a.getColor(R.styleable.PagerSlidingTabStrip_pstsUnderlineColor, underlineColor);</span><br><span class="line">	dividerColor = a.getColor(R.styleable.PagerSlidingTabStrip_pstsDividerColor, dividerColor);</span><br><span class="line">	indicatorHeight = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsIndicatorHeight, indicatorHeight);</span><br><span class="line">	underlineHeight = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsUnderlineHeight, underlineHeight);</span><br><span class="line">	dividerPadding = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsDividerPadding, dividerPadding);</span><br><span class="line">	tabPadding = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsTabPaddingLeftRight, tabPadding);</span><br><span class="line">	tabBackgroundResId = a.getResourceId(R.styleable.PagerSlidingTabStrip_pstsTabBackground, tabBackgroundResId);</span><br><span class="line">	shouldExpand = a.getBoolean(R.styleable.PagerSlidingTabStrip_pstsShouldExpand, shouldExpand);</span><br><span class="line">	scrollOffset = a.getDimensionPixelSize(R.styleable.PagerSlidingTabStrip_pstsScrollOffset, scrollOffset);</span><br><span class="line">	textAllCaps = a.getBoolean(R.styleable.PagerSlidingTabStrip_pstsTextAllCaps, textAllCaps);</span><br><span class="line"></span><br><span class="line">	a.recycle();</span><br><span class="line"></span><br><span class="line">       /* 初始化矩形Paint */</span><br><span class="line">	rectPaint = new Paint();</span><br><span class="line">	rectPaint.setAntiAlias(true);</span><br><span class="line">	rectPaint.setStyle(Style.FILL);</span><br><span class="line">       /* 初始化分割线Paint */</span><br><span class="line">	dividerPaint = new Paint();</span><br><span class="line">	dividerPaint.setAntiAlias(true);</span><br><span class="line">	dividerPaint.setStrokeWidth(dividerWidth);</span><br><span class="line"></span><br><span class="line">       /* 是否延伸，默认WRAP_CONTENT,这种比较合理 */</span><br><span class="line">	defaultTabLayoutParams = new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT);</span><br><span class="line">	expandedTabLayoutParams = new LinearLayout.LayoutParams(0, LayoutParams.MATCH_PARENT, 1.0f);</span><br><span class="line"></span><br><span class="line">	if (locale == null) &#123;</span><br><span class="line">		locale = getResources().getConfiguration().locale;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<hr>
<ul>
<li>onDraw  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onDraw(Canvas canvas) &#123;</span><br><span class="line">	super.onDraw(canvas);</span><br><span class="line"></span><br><span class="line">	if (isInEditMode() || tabCount == 0) &#123;</span><br><span class="line">		return;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	final int height = getHeight();</span><br><span class="line"></span><br><span class="line">	// 设置Indicator颜色</span><br><span class="line">	rectPaint.setColor(indicatorColor);</span><br><span class="line"></span><br><span class="line">	// 获取当前选中Tab</span><br><span class="line">	View currentTab = tabsContainer.getChildAt(currentPosition);</span><br><span class="line">	//获取Left,Right值</span><br><span class="line">	float lineLeft = currentTab.getLeft();</span><br><span class="line">	float lineRight = currentTab.getRight();</span><br><span class="line"></span><br><span class="line">	// if there is an offset, start interpolating left and right coordinates between current and next tab</span><br><span class="line">	if (currentPositionOffset &gt; 0f &amp;&amp; currentPosition &lt; tabCount - 1) &#123;</span><br><span class="line">	    //结合下一个Tab获取当前要绘制的indicator的位置,这里的currentPositionOffset 比较关键，可以看到这个值是与ViewPager相关的，在onPagerScrolled方法中，这个值在不断的更新</span><br><span class="line">		View nextTab = tabsContainer.getChildAt(currentPosition + 1);</span><br><span class="line">		final float nextTabLeft = nextTab.getLeft();</span><br><span class="line">		final float nextTabRight = nextTab.getRight();</span><br><span class="line"></span><br><span class="line">		lineLeft = (currentPositionOffset * nextTabLeft + (1f - currentPositionOffset) * lineLeft);</span><br><span class="line">		lineRight = (currentPositionOffset * nextTabRight + (1f - currentPositionOffset) * lineRight);</span><br><span class="line">	&#125;</span><br><span class="line">       // 绘制Indicator</span><br><span class="line">	canvas.drawRect(lineLeft, height - indicatorHeight, lineRight, height, rectPaint);</span><br><span class="line"></span><br><span class="line">	// 绘制UnderLine</span><br><span class="line">	rectPaint.setColor(underlineColor);</span><br><span class="line">	canvas.drawRect(0, height - underlineHeight, tabsContainer.getWidth(), height, rectPaint);</span><br><span class="line"></span><br><span class="line">	// 绘制分割线</span><br><span class="line">	dividerPaint.setColor(dividerColor);</span><br><span class="line">	for (int i = 0; i &lt; tabCount - 1; i++) &#123;</span><br><span class="line">		View tab = tabsContainer.getChildAt(i);</span><br><span class="line">		canvas.drawLine(tab.getRight(), dividerPadding, tab.getRight(), height - dividerPadding, dividerPaint);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<hr>
<ul>
<li>setViewPager， setOnPageChangeListener<br> 一个用来与ViewPager联动，一个用来处理自定义的OnPagerListener逻辑  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public void setViewPager(ViewPager pager) &#123;</span><br><span class="line">		this.pager = pager;</span><br><span class="line"></span><br><span class="line">		if (pager.getAdapter() == null) &#123;</span><br><span class="line">			throw new IllegalStateException(&quot;ViewPager does not have adapter instance.&quot;);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		pager.setOnPageChangeListener(pageListener);</span><br><span class="line"></span><br><span class="line">		notifyDataSetChanged();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setOnPageChangeListener(OnPageChangeListener listener) &#123;</span><br><span class="line">		this.delegatePageListener = listener;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<hr>
<ol start="3">
<li>PagerSlidingTabStrip综合用法</li>
</ol>
<ul>
<li>文本指示器选中后文本大小和颜色变化<br> <img src="https://img-blog.csdn.net/20161225162617006" alt="这里写图片描述"><br> 关键点在于实现自己的OnPagerListener  <figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">       super.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.activity_main);</span><br><span class="line">       ButterKnife.bind(this);</span><br><span class="line">       MainPagerAdapter mainPagerAdapter = new MainPagerAdapter(getSupportFragmentManager());</span><br><span class="line">       vpContent.setAdapter(mainPagerAdapter);</span><br><span class="line">       pstsIndicator.setViewPager(vpContent);</span><br><span class="line">       vpContent.addOnPageChangeListener(new ViewPager.OnPageChangeListener() &#123;</span><br><span class="line">           @Override</span><br><span class="line">           public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) &#123;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           @Override</span><br><span class="line">           public void onPageSelected(int position) &#123;</span><br><span class="line">               updateTextStyle(position);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           @Override</span><br><span class="line">           public void onPageScrollStateChanged(int state) &#123;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">       updateTextStyle(vpContent.getCurrentItem());</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   private void updateTextStyle(int position) &#123;</span><br><span class="line">       LinearLayout tabsContainer = (LinearLayout) pstsIndicator.getChildAt(0);</span><br><span class="line">       for(int i=0; i&lt; tabsContainer.getChildCount(); i++) &#123;</span><br><span class="line">           TextView textView = (TextView) tabsContainer.getChildAt(i);</span><br><span class="line">           if(position == i) &#123;</span><br><span class="line">               textView.setTextSize(18);</span><br><span class="line">               textView.setTextColor(getResources().getColor(R.color.colorToolbar));</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               textView.setTextSize(12);</span><br><span class="line">               textView.setTextColor(getResources().getColor(R.color.colorBlack));</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<hr>
<ul>
<li><p>图标指示器选中图标颜色变化  </p>
<p> <img src="https://img-blog.csdn.net/20161226201936086" alt="这里写图片描述">  关键点在于实现自己的OnPagerListener和继承PagerSlidingTabStrip.IconTabProvider</p>
</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">private void updateIconStyle(int position) &#123;</span><br><span class="line">    LinearLayout tabsContainer = (LinearLayout) pstsIndicator.getChildAt(0);</span><br><span class="line">    for (int i = 0; i &lt; tabsContainer.getChildCount(); i++) &#123;</span><br><span class="line">        ImageButton imageButton = (ImageButton) tabsContainer.getChildAt(i);</span><br><span class="line">        imageButton.setImageTintMode(PorterDuff.Mode.SRC_IN);</span><br><span class="line">        if (i == position) &#123;</span><br><span class="line">            imageButton.setImageTintList(getResources().getColorStateList(R.color.ib_color_list));</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            imageButton.setImageTintList(getResources().getColorStateList(R.color.ib_color_list_normal));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<hr>
<ol start="4">
<li><p>写在最后的话<br>PagerSlidingTabStrip，总体来说简洁方便，如果开发者想集成自己的一些内容，比如说Indicator改成其他的形状，或者说想做到既有文字又有图片的效果，都可以自己修改代码来实现，比较的方便。</p>
<p>祝大家圣诞快乐。</p>
<p>Ending ~</p>
</li>
</ol>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/tags/开源库/page/2/">上一页</a>
        </div>
        <div class="pagination-next is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/tags/开源库/page/4/">下一页</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/tags/开源库/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/tags/开源库/page/2/">2</a></li>
            
            <li><a class="pagination-link is-current" href="/tags/开源库/page/3/">3</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.png" alt="Onlyloveyd">
                    
                    
                    <p class="is-size-4 is-block">
                        Onlyloveyd
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        小码过河
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>China，GuiYang</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        163
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        14
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        80
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/onlyloveyd" target="_blank">
                关注我</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/onlyloveyd">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="CSDN" href="https://blog.csdn.net/poorkick">
                
                <i class="blog"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Android基础/">
            <span class="level-start">
                <span class="level-item">Android基础</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">53</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Android基础/Android-Studio/">
            <span class="level-start">
                <span class="level-item">Android Studio</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Android安全/">
            <span class="level-start">
                <span class="level-item">Android安全</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Android应用/">
            <span class="level-start">
                <span class="level-item">Android应用</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">26</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Android开源库/">
            <span class="level-start">
                <span class="level-item">Android开源库</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">29</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Android源码/">
            <span class="level-start">
                <span class="level-item">Android源码</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Android系统/">
            <span class="level-start">
                <span class="level-item">Android系统</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Android进阶/">
            <span class="level-start">
                <span class="level-item">Android进阶</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Angular/">
            <span class="level-start">
                <span class="level-item">Angular</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Flutter/">
            <span class="level-start">
                <span class="level-item">Flutter</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Kotlin/">
            <span class="level-start">
                <span class="level-item">Kotlin</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/LeetCode/">
            <span class="level-start">
                <span class="level-item">LeetCode</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/微信小程序/">
            <span class="level-start">
                <span class="level-item">微信小程序</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/运维/">
            <span class="level-start">
                <span class="level-item">运维</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/Aandroid实战/" style="font-size: 10px;">Aandroid实战</a> <a href="/tags/Android-Studio/" style="font-size: 13.08px;">Android Studio</a> <a href="/tags/Android基础/" style="font-size: 10px;">Android基础</a> <a href="/tags/Android实战/" style="font-size: 18.46px;">Android实战</a> <a href="/tags/Android开源库/" style="font-size: 11.54px;">Android开源库</a> <a href="/tags/Android源码/" style="font-size: 10px;">Android源码</a> <a href="/tags/Angular/" style="font-size: 10px;">Angular</a> <a href="/tags/BroadcastReceiver/" style="font-size: 10px;">BroadcastReceiver</a> <a href="/tags/CentOS/" style="font-size: 11.54px;">CentOS</a> <a href="/tags/CodeStyle/" style="font-size: 10px;">CodeStyle</a> <a href="/tags/Docker/" style="font-size: 12.31px;">Docker</a> <a href="/tags/Drawable/" style="font-size: 10.77px;">Drawable</a> <a href="/tags/EditText/" style="font-size: 10px;">EditText</a> <a href="/tags/FileProvider/" style="font-size: 10px;">FileProvider</a> <a href="/tags/Flex/" style="font-size: 10px;">Flex</a> <a href="/tags/Flutter/" style="font-size: 10px;">Flutter</a> <a href="/tags/Fragment/" style="font-size: 12.31px;">Fragment</a> <a href="/tags/Framework/" style="font-size: 14.62px;">Framework</a> <a href="/tags/Gank-io/" style="font-size: 12.31px;">Gank.io</a> <a href="/tags/Gitlab/" style="font-size: 10px;">Gitlab</a> <a href="/tags/HAL/" style="font-size: 10px;">HAL</a> <a href="/tags/IDEA插件/" style="font-size: 10px;">IDEA插件</a> <a href="/tags/JetPack/" style="font-size: 10px;">JetPack</a> <a href="/tags/Kotlin/" style="font-size: 13.85px;">Kotlin</a> <a href="/tags/LeetCode/" style="font-size: 12.31px;">LeetCode</a> <a href="/tags/Linux/" style="font-size: 13.85px;">Linux</a> <a href="/tags/MPAndroidChart/" style="font-size: 16.15px;">MPAndroidChart</a> <a href="/tags/MacOS/" style="font-size: 10px;">MacOS</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/MultiDex/" style="font-size: 10px;">MultiDex</a> <a href="/tags/Mysql/" style="font-size: 10.77px;">Mysql</a> <a href="/tags/PMDReader/" style="font-size: 10px;">PMDReader</a> <a href="/tags/Picasso/" style="font-size: 10px;">Picasso</a> <a href="/tags/PowerDesign/" style="font-size: 10px;">PowerDesign</a> <a href="/tags/Realm/" style="font-size: 15.38px;">Realm</a> <a href="/tags/RecyclerView/" style="font-size: 11.54px;">RecyclerView</a> <a href="/tags/Retrofit/" style="font-size: 10px;">Retrofit</a> <a href="/tags/RxJava/" style="font-size: 11.54px;">RxJava</a> <a href="/tags/Service/" style="font-size: 10px;">Service</a> <a href="/tags/Smali/" style="font-size: 10.77px;">Smali</a> <a href="/tags/TabLayout/" style="font-size: 10px;">TabLayout</a> <a href="/tags/Tomcat/" style="font-size: 10px;">Tomcat</a> <a href="/tags/View/" style="font-size: 10px;">View</a> <a href="/tags/WanANdroid/" style="font-size: 10px;">WanANdroid</a> <a href="/tags/WebService/" style="font-size: 10px;">WebService</a> <a href="/tags/Xen/" style="font-size: 11.54px;">Xen</a> <a href="/tags/allowBackup/" style="font-size: 10px;">allowBackup</a> <a href="/tags/事件分发/" style="font-size: 10px;">事件分发</a> <a href="/tags/动画/" style="font-size: 10.77px;">动画</a> <a href="/tags/四大组件/" style="font-size: 10px;">四大组件</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/局域网/" style="font-size: 10px;">局域网</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/布局控件/" style="font-size: 20px;">布局控件</a> <a href="/tags/应用/" style="font-size: 17.69px;">应用</a> <a href="/tags/开发问题/" style="font-size: 10px;">开发问题</a> <a href="/tags/开机动画/" style="font-size: 10.77px;">开机动画</a> <a href="/tags/开源/" style="font-size: 11.54px;">开源</a> <a href="/tags/开源库/" style="font-size: 19.23px;">开源库</a> <a href="/tags/微信公众号/" style="font-size: 10px;">微信公众号</a> <a href="/tags/快捷键/" style="font-size: 10px;">快捷键</a> <a href="/tags/手电筒/" style="font-size: 10px;">手电筒</a> <a href="/tags/技术选型/" style="font-size: 10px;">技术选型</a> <a href="/tags/文本/" style="font-size: 10px;">文本</a> <a href="/tags/框架/" style="font-size: 10px;">框架</a> <a href="/tags/源码分析/" style="font-size: 11.54px;">源码分析</a> <a href="/tags/百度地图/" style="font-size: 12.31px;">百度地图</a> <a href="/tags/系统源码/" style="font-size: 10px;">系统源码</a> <a href="/tags/终端/" style="font-size: 10px;">终端</a> <a href="/tags/聚合数据/" style="font-size: 10px;">聚合数据</a> <a href="/tags/自定义View/" style="font-size: 14.62px;">自定义View</a> <a href="/tags/虚拟化/" style="font-size: 11.54px;">虚拟化</a> <a href="/tags/设计模式/" style="font-size: 10.77px;">设计模式</a> <a href="/tags/译文/" style="font-size: 16.92px;">译文</a> <a href="/tags/贪吃蛇/" style="font-size: 10px;">贪吃蛇</a> <a href="/tags/资源/" style="font-size: 10px;">资源</a> <a href="/tags/资源配置/" style="font-size: 10px;">资源配置</a> <a href="/tags/辅助工具/" style="font-size: 10px;">辅助工具</a> <a href="/tags/配置/" style="font-size: 11.54px;">配置</a> <a href="/tags/问题/" style="font-size: 10px;">问题</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十五）》Frame Animation/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.039Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十五）》Frame Animation/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十）》 CoordinatorLayout Behavior/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.039Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十）》 CoordinatorLayout Behavior/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（九）》  Ndk配置与Demo/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.037Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（九）》  Ndk配置与Demo/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十七）》 Android Studio常用技巧（免费代理下载Google内容）/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.037Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十七）》 Android Studio常用技巧（免费代理下载Google内容）/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十一）》Android 屏幕适配/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.037Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十一）》Android 屏幕适配/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/10/">
                <span class="level-start">
                    <span class="level-item">十月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">四月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">三月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">十月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">八月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">七月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">六月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">五月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">四月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">三月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">二月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">十月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">九月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">10</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">八月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">七月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">六月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">五月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/04/">
                <span class="level-start">
                    <span class="level-item">四月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/09/">
                <span class="level-start">
                    <span class="level-item">九月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/08/">
                <span class="level-start">
                    <span class="level-item">八月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2014/04/">
                <span class="level-start">
                    <span class="level-item">四月 2014</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Aandroid实战/">
                        <span class="tag">Aandroid实战</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android-Studio/">
                        <span class="tag">Android Studio</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android基础/">
                        <span class="tag">Android基础</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android实战/">
                        <span class="tag">Android实战</span>
                        <span class="tag is-grey">27</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android开源库/">
                        <span class="tag">Android开源库</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android源码/">
                        <span class="tag">Android源码</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Angular/">
                        <span class="tag">Angular</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/BroadcastReceiver/">
                        <span class="tag">BroadcastReceiver</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CentOS/">
                        <span class="tag">CentOS</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CodeStyle/">
                        <span class="tag">CodeStyle</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Docker/">
                        <span class="tag">Docker</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Drawable/">
                        <span class="tag">Drawable</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/EditText/">
                        <span class="tag">EditText</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/FileProvider/">
                        <span class="tag">FileProvider</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Flex/">
                        <span class="tag">Flex</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Flutter/">
                        <span class="tag">Flutter</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Fragment/">
                        <span class="tag">Fragment</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Framework/">
                        <span class="tag">Framework</span>
                        <span class="tag is-grey">8</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Gank-io/">
                        <span class="tag">Gank.io</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Gitlab/">
                        <span class="tag">Gitlab</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HAL/">
                        <span class="tag">HAL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IDEA插件/">
                        <span class="tag">IDEA插件</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JetPack/">
                        <span class="tag">JetPack</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Kotlin/">
                        <span class="tag">Kotlin</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LeetCode/">
                        <span class="tag">LeetCode</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Linux/">
                        <span class="tag">Linux</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MPAndroidChart/">
                        <span class="tag">MPAndroidChart</span>
                        <span class="tag is-grey">11</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MacOS/">
                        <span class="tag">MacOS</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Markdown/">
                        <span class="tag">Markdown</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MultiDex/">
                        <span class="tag">MultiDex</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Mysql/">
                        <span class="tag">Mysql</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PMDReader/">
                        <span class="tag">PMDReader</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Picasso/">
                        <span class="tag">Picasso</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PowerDesign/">
                        <span class="tag">PowerDesign</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Realm/">
                        <span class="tag">Realm</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RecyclerView/">
                        <span class="tag">RecyclerView</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Retrofit/">
                        <span class="tag">Retrofit</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RxJava/">
                        <span class="tag">RxJava</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Service/">
                        <span class="tag">Service</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Smali/">
                        <span class="tag">Smali</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/TabLayout/">
                        <span class="tag">TabLayout</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Tomcat/">
                        <span class="tag">Tomcat</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/View/">
                        <span class="tag">View</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/WanANdroid/">
                        <span class="tag">WanANdroid</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/WebService/">
                        <span class="tag">WebService</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Xen/">
                        <span class="tag">Xen</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/allowBackup/">
                        <span class="tag">allowBackup</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/事件分发/">
                        <span class="tag">事件分发</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/动画/">
                        <span class="tag">动画</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/四大组件/">
                        <span class="tag">四大组件</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/多线程/">
                        <span class="tag">多线程</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/局域网/">
                        <span class="tag">局域网</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/工具/">
                        <span class="tag">工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/布局控件/">
                        <span class="tag">布局控件</span>
                        <span class="tag is-grey">29</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/应用/">
                        <span class="tag">应用</span>
                        <span class="tag is-grey">24</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开发问题/">
                        <span class="tag">开发问题</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开机动画/">
                        <span class="tag">开机动画</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开源/">
                        <span class="tag">开源</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开源库/">
                        <span class="tag">开源库</span>
                        <span class="tag is-grey">28</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/微信公众号/">
                        <span class="tag">微信公众号</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/快捷键/">
                        <span class="tag">快捷键</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/手电筒/">
                        <span class="tag">手电筒</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/技术选型/">
                        <span class="tag">技术选型</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/文本/">
                        <span class="tag">文本</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/框架/">
                        <span class="tag">框架</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/源码分析/">
                        <span class="tag">源码分析</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/百度地图/">
                        <span class="tag">百度地图</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/系统源码/">
                        <span class="tag">系统源码</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/终端/">
                        <span class="tag">终端</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/聚合数据/">
                        <span class="tag">聚合数据</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/自定义View/">
                        <span class="tag">自定义View</span>
                        <span class="tag is-grey">8</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/虚拟化/">
                        <span class="tag">虚拟化</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/设计模式/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/译文/">
                        <span class="tag">译文</span>
                        <span class="tag is-grey">20</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/贪吃蛇/">
                        <span class="tag">贪吃蛇</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/资源/">
                        <span class="tag">资源</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/资源配置/">
                        <span class="tag">资源配置</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/辅助工具/">
                        <span class="tag">辅助工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/配置/">
                        <span class="tag">配置</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/问题/">
                        <span class="tag">问题</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十五）》Frame Animation/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.039Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十五）》Frame Animation/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十）》 CoordinatorLayout Behavior/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.039Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十）》 CoordinatorLayout Behavior/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（九）》  Ndk配置与Demo/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.037Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（九）》  Ndk配置与Demo/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十七）》 Android Studio常用技巧（免费代理下载Google内容）/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.037Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十七）》 Android Studio常用技巧（免费代理下载Google内容）/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/06/14/《Android 基础（二十一）》Android 屏幕适配/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-06-14T11:22:12.037Z">2019-06-14</time></div>
                    <a href="/2019/06/14/《Android 基础（二十一）》Android 屏幕适配/" class="has-link-black-ter is-size-6"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/10/">
                <span class="level-start">
                    <span class="level-item">十月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">四月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">三月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">十月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">八月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">七月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">六月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">五月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">四月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">三月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">二月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">十月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">九月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">10</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">八月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">七月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">六月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">五月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/04/">
                <span class="level-start">
                    <span class="level-item">四月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/09/">
                <span class="level-start">
                    <span class="level-item">九月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/08/">
                <span class="level-start">
                    <span class="level-item">八月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2014/04/">
                <span class="level-start">
                    <span class="level-item">四月 2014</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Aandroid实战/">
                        <span class="tag">Aandroid实战</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android-Studio/">
                        <span class="tag">Android Studio</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android基础/">
                        <span class="tag">Android基础</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android实战/">
                        <span class="tag">Android实战</span>
                        <span class="tag is-grey">27</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android开源库/">
                        <span class="tag">Android开源库</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Android源码/">
                        <span class="tag">Android源码</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Angular/">
                        <span class="tag">Angular</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/BroadcastReceiver/">
                        <span class="tag">BroadcastReceiver</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CentOS/">
                        <span class="tag">CentOS</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CodeStyle/">
                        <span class="tag">CodeStyle</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Docker/">
                        <span class="tag">Docker</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Drawable/">
                        <span class="tag">Drawable</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/EditText/">
                        <span class="tag">EditText</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/FileProvider/">
                        <span class="tag">FileProvider</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Flex/">
                        <span class="tag">Flex</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Flutter/">
                        <span class="tag">Flutter</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Fragment/">
                        <span class="tag">Fragment</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Framework/">
                        <span class="tag">Framework</span>
                        <span class="tag is-grey">8</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Gank-io/">
                        <span class="tag">Gank.io</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Gitlab/">
                        <span class="tag">Gitlab</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HAL/">
                        <span class="tag">HAL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IDEA插件/">
                        <span class="tag">IDEA插件</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JetPack/">
                        <span class="tag">JetPack</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Kotlin/">
                        <span class="tag">Kotlin</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LeetCode/">
                        <span class="tag">LeetCode</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Linux/">
                        <span class="tag">Linux</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MPAndroidChart/">
                        <span class="tag">MPAndroidChart</span>
                        <span class="tag is-grey">11</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MacOS/">
                        <span class="tag">MacOS</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Markdown/">
                        <span class="tag">Markdown</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MultiDex/">
                        <span class="tag">MultiDex</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Mysql/">
                        <span class="tag">Mysql</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PMDReader/">
                        <span class="tag">PMDReader</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Picasso/">
                        <span class="tag">Picasso</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PowerDesign/">
                        <span class="tag">PowerDesign</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Realm/">
                        <span class="tag">Realm</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RecyclerView/">
                        <span class="tag">RecyclerView</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Retrofit/">
                        <span class="tag">Retrofit</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RxJava/">
                        <span class="tag">RxJava</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Service/">
                        <span class="tag">Service</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Smali/">
                        <span class="tag">Smali</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/TabLayout/">
                        <span class="tag">TabLayout</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Tomcat/">
                        <span class="tag">Tomcat</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/View/">
                        <span class="tag">View</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/WanANdroid/">
                        <span class="tag">WanANdroid</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/WebService/">
                        <span class="tag">WebService</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Xen/">
                        <span class="tag">Xen</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/allowBackup/">
                        <span class="tag">allowBackup</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/事件分发/">
                        <span class="tag">事件分发</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/动画/">
                        <span class="tag">动画</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/四大组件/">
                        <span class="tag">四大组件</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/多线程/">
                        <span class="tag">多线程</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/局域网/">
                        <span class="tag">局域网</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/工具/">
                        <span class="tag">工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/布局控件/">
                        <span class="tag">布局控件</span>
                        <span class="tag is-grey">29</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/应用/">
                        <span class="tag">应用</span>
                        <span class="tag is-grey">24</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开发问题/">
                        <span class="tag">开发问题</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开机动画/">
                        <span class="tag">开机动画</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开源/">
                        <span class="tag">开源</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/开源库/">
                        <span class="tag">开源库</span>
                        <span class="tag is-grey">28</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/微信公众号/">
                        <span class="tag">微信公众号</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/快捷键/">
                        <span class="tag">快捷键</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/手电筒/">
                        <span class="tag">手电筒</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/技术选型/">
                        <span class="tag">技术选型</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/文本/">
                        <span class="tag">文本</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/框架/">
                        <span class="tag">框架</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/源码分析/">
                        <span class="tag">源码分析</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/百度地图/">
                        <span class="tag">百度地图</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/系统源码/">
                        <span class="tag">系统源码</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/终端/">
                        <span class="tag">终端</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/聚合数据/">
                        <span class="tag">聚合数据</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/自定义View/">
                        <span class="tag">自定义View</span>
                        <span class="tag is-grey">8</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/虚拟化/">
                        <span class="tag">虚拟化</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/设计模式/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/译文/">
                        <span class="tag">译文</span>
                        <span class="tag is-grey">20</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/贪吃蛇/">
                        <span class="tag">贪吃蛇</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/资源/">
                        <span class="tag">资源</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/资源配置/">
                        <span class="tag">资源配置</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/辅助工具/">
                        <span class="tag">辅助工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/配置/">
                        <span class="tag">配置</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/问题/">
                        <span class="tag">问题</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="onlyloveyd" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 yidong&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>